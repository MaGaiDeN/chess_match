var uk=Object.defineProperty;var hk=(t,e,n)=>e in t?uk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Tr=(t,e,n)=>hk(t,typeof e!="symbol"?e+"":e,n);function dk(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var fk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pk(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var AT={exports:{}},tp={},xT={exports:{}},Re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ah=Symbol.for("react.element"),gk=Symbol.for("react.portal"),mk=Symbol.for("react.fragment"),vk=Symbol.for("react.strict_mode"),yk=Symbol.for("react.profiler"),_k=Symbol.for("react.provider"),wk=Symbol.for("react.context"),Ek=Symbol.for("react.forward_ref"),Tk=Symbol.for("react.suspense"),Ik=Symbol.for("react.memo"),Sk=Symbol.for("react.lazy"),z0=Symbol.iterator;function bk(t){return t===null||typeof t!="object"?null:(t=z0&&t[z0]||t["@@iterator"],typeof t=="function"?t:null)}var PT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kT=Object.assign,RT={};function oc(t,e,n){this.props=t,this.context=e,this.refs=RT,this.updater=n||PT}oc.prototype.isReactComponent={};oc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};oc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function DT(){}DT.prototype=oc.prototype;function Hv(t,e,n){this.props=t,this.context=e,this.refs=RT,this.updater=n||PT}var Wv=Hv.prototype=new DT;Wv.constructor=Hv;kT(Wv,oc.prototype);Wv.isPureReactComponent=!0;var B0=Array.isArray,OT=Object.prototype.hasOwnProperty,Kv={current:null},NT={key:!0,ref:!0,__self:!0,__source:!0};function LT(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)OT.call(e,r)&&!NT.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:ah,type:t,key:s,ref:o,props:i,_owner:Kv.current}}function Ck(t,e){return{$$typeof:ah,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Gv(t){return typeof t=="object"&&t!==null&&t.$$typeof===ah}function Ak(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var q0=/\/+/g;function ug(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Ak(""+t.key):e.toString(36)}function xd(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ah:case gk:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+ug(o,0):r,B0(i)?(n="",t!=null&&(n=t.replace(q0,"$&/")+"/"),xd(i,e,n,"",function(u){return u})):i!=null&&(Gv(i)&&(i=Ck(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(q0,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",B0(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+ug(s,a);o+=xd(s,e,n,l,i)}else if(l=bk(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+ug(s,a++),o+=xd(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Zh(t,e,n){if(t==null)return t;var r=[],i=0;return xd(t,r,"","",function(s){return e.call(n,s,i++)}),r}function xk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Rn={current:null},Pd={transition:null},Pk={ReactCurrentDispatcher:Rn,ReactCurrentBatchConfig:Pd,ReactCurrentOwner:Kv};function MT(){throw Error("act(...) is not supported in production builds of React.")}Re.Children={map:Zh,forEach:function(t,e,n){Zh(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Zh(t,function(){e++}),e},toArray:function(t){return Zh(t,function(e){return e})||[]},only:function(t){if(!Gv(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Re.Component=oc;Re.Fragment=mk;Re.Profiler=yk;Re.PureComponent=Hv;Re.StrictMode=vk;Re.Suspense=Tk;Re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pk;Re.act=MT;Re.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=kT({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Kv.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)OT.call(e,l)&&!NT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:ah,type:t.type,key:i,ref:s,props:r,_owner:o}};Re.createContext=function(t){return t={$$typeof:wk,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:_k,_context:t},t.Consumer=t};Re.createElement=LT;Re.createFactory=function(t){var e=LT.bind(null,t);return e.type=t,e};Re.createRef=function(){return{current:null}};Re.forwardRef=function(t){return{$$typeof:Ek,render:t}};Re.isValidElement=Gv;Re.lazy=function(t){return{$$typeof:Sk,_payload:{_status:-1,_result:t},_init:xk}};Re.memo=function(t,e){return{$$typeof:Ik,type:t,compare:e===void 0?null:e}};Re.startTransition=function(t){var e=Pd.transition;Pd.transition={};try{t()}finally{Pd.transition=e}};Re.unstable_act=MT;Re.useCallback=function(t,e){return Rn.current.useCallback(t,e)};Re.useContext=function(t){return Rn.current.useContext(t)};Re.useDebugValue=function(){};Re.useDeferredValue=function(t){return Rn.current.useDeferredValue(t)};Re.useEffect=function(t,e){return Rn.current.useEffect(t,e)};Re.useId=function(){return Rn.current.useId()};Re.useImperativeHandle=function(t,e,n){return Rn.current.useImperativeHandle(t,e,n)};Re.useInsertionEffect=function(t,e){return Rn.current.useInsertionEffect(t,e)};Re.useLayoutEffect=function(t,e){return Rn.current.useLayoutEffect(t,e)};Re.useMemo=function(t,e){return Rn.current.useMemo(t,e)};Re.useReducer=function(t,e,n){return Rn.current.useReducer(t,e,n)};Re.useRef=function(t){return Rn.current.useRef(t)};Re.useState=function(t){return Rn.current.useState(t)};Re.useSyncExternalStore=function(t,e,n){return Rn.current.useSyncExternalStore(t,e,n)};Re.useTransition=function(){return Rn.current.useTransition()};Re.version="18.3.1";xT.exports=Re;var N=xT.exports;const VT=pk(N),kk=dk({__proto__:null,default:VT},[N]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rk=N,Dk=Symbol.for("react.element"),Ok=Symbol.for("react.fragment"),Nk=Object.prototype.hasOwnProperty,Lk=Rk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Mk={key:!0,ref:!0,__self:!0,__source:!0};function jT(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Nk.call(e,r)&&!Mk.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Dk,type:t,key:s,ref:o,props:i,_owner:Lk.current}}tp.Fragment=Ok;tp.jsx=jT;tp.jsxs=jT;AT.exports=tp;var y=AT.exports,FT={exports:{}},cr={},UT={exports:{}},$T={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(X,ae){var z=X.length;X.push(ae);e:for(;0<z;){var Le=z-1>>>1,Me=X[Le];if(0<i(Me,ae))X[Le]=ae,X[z]=Me,z=Le;else break e}}function n(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var ae=X[0],z=X.pop();if(z!==ae){X[0]=z;e:for(var Le=0,Me=X.length,Be=Me>>>1;Le<Be;){var ut=2*(Le+1)-1,jt=X[ut],nt=ut+1,de=X[nt];if(0>i(jt,z))nt<Me&&0>i(de,jt)?(X[Le]=de,X[nt]=z,Le=nt):(X[Le]=jt,X[ut]=z,Le=ut);else if(nt<Me&&0>i(de,z))X[Le]=de,X[nt]=z,Le=nt;else break e}}return ae}function i(X,ae){var z=X.sortIndex-ae.sortIndex;return z!==0?z:X.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,p=null,m=3,w=!1,E=!1,x=!1,D=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(X){for(var ae=n(u);ae!==null;){if(ae.callback===null)r(u);else if(ae.startTime<=X)r(u),ae.sortIndex=ae.expirationTime,e(l,ae);else break;ae=n(u)}}function M(X){if(x=!1,S(X),!E)if(n(l)!==null)E=!0,Ie(q);else{var ae=n(u);ae!==null&&Se(M,ae.startTime-X)}}function q(X,ae){E=!1,x&&(x=!1,A(C),C=-1),w=!0;var z=m;try{for(S(ae),p=n(l);p!==null&&(!(p.expirationTime>ae)||X&&!L());){var Le=p.callback;if(typeof Le=="function"){p.callback=null,m=p.priorityLevel;var Me=Le(p.expirationTime<=ae);ae=t.unstable_now(),typeof Me=="function"?p.callback=Me:p===n(l)&&r(l),S(ae)}else r(l);p=n(l)}if(p!==null)var Be=!0;else{var ut=n(u);ut!==null&&Se(M,ut.startTime-ae),Be=!1}return Be}finally{p=null,m=z,w=!1}}var W=!1,P=null,C=-1,R=5,O=-1;function L(){return!(t.unstable_now()-O<R)}function V(){if(P!==null){var X=t.unstable_now();O=X;var ae=!0;try{ae=P(!0,X)}finally{ae?k():(W=!1,P=null)}}else W=!1}var k;if(typeof T=="function")k=function(){T(V)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,Te=ge.port2;ge.port1.onmessage=V,k=function(){Te.postMessage(null)}}else k=function(){D(V,0)};function Ie(X){P=X,W||(W=!0,k())}function Se(X,ae){C=D(function(){X(t.unstable_now())},ae)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(X){X.callback=null},t.unstable_continueExecution=function(){E||w||(E=!0,Ie(q))},t.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<X?Math.floor(1e3/X):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(X){switch(m){case 1:case 2:case 3:var ae=3;break;default:ae=m}var z=m;m=ae;try{return X()}finally{m=z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(X,ae){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var z=m;m=X;try{return ae()}finally{m=z}},t.unstable_scheduleCallback=function(X,ae,z){var Le=t.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?Le+z:Le):z=Le,X){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=z+Me,X={id:d++,callback:ae,priorityLevel:X,startTime:z,expirationTime:Me,sortIndex:-1},z>Le?(X.sortIndex=z,e(u,X),n(l)===null&&X===n(u)&&(x?(A(C),C=-1):x=!0,Se(M,z-Le))):(X.sortIndex=Me,e(l,X),E||w||(E=!0,Ie(q))),X},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(X){var ae=m;return function(){var z=m;m=ae;try{return X.apply(this,arguments)}finally{m=z}}}})($T);UT.exports=$T;var Vk=UT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jk=N,ar=Vk;function Y(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zT=new Set,ku={};function Pa(t,e){Ul(t,e),Ul(t+"Capture",e)}function Ul(t,e){for(ku[t]=e,t=0;t<e.length;t++)zT.add(e[t])}var Yi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),lm=Object.prototype.hasOwnProperty,Fk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,H0={},W0={};function Uk(t){return lm.call(W0,t)?!0:lm.call(H0,t)?!1:Fk.test(t)?W0[t]=!0:(H0[t]=!0,!1)}function $k(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function zk(t,e,n,r){if(e===null||typeof e>"u"||$k(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Dn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var sn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){sn[t]=new Dn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];sn[e]=new Dn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){sn[t]=new Dn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){sn[t]=new Dn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){sn[t]=new Dn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){sn[t]=new Dn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){sn[t]=new Dn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){sn[t]=new Dn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){sn[t]=new Dn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Qv=/[\-:]([a-z])/g;function Yv(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Qv,Yv);sn[e]=new Dn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Qv,Yv);sn[e]=new Dn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Qv,Yv);sn[e]=new Dn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){sn[t]=new Dn(t,1,!1,t.toLowerCase(),null,!1,!1)});sn.xlinkHref=new Dn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){sn[t]=new Dn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Xv(t,e,n,r){var i=sn.hasOwnProperty(e)?sn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(zk(e,n,i,r)&&(n=null),r||i===null?Uk(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ss=jk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ed=Symbol.for("react.element"),ml=Symbol.for("react.portal"),vl=Symbol.for("react.fragment"),Jv=Symbol.for("react.strict_mode"),cm=Symbol.for("react.profiler"),BT=Symbol.for("react.provider"),qT=Symbol.for("react.context"),Zv=Symbol.for("react.forward_ref"),um=Symbol.for("react.suspense"),hm=Symbol.for("react.suspense_list"),ey=Symbol.for("react.memo"),js=Symbol.for("react.lazy"),HT=Symbol.for("react.offscreen"),K0=Symbol.iterator;function jc(t){return t===null||typeof t!="object"?null:(t=K0&&t[K0]||t["@@iterator"],typeof t=="function"?t:null)}var Tt=Object.assign,hg;function Zc(t){if(hg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);hg=e&&e[1]||""}return`
`+hg+t}var dg=!1;function fg(t,e){if(!t||dg)return"";dg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{dg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Zc(t):""}function Bk(t){switch(t.tag){case 5:return Zc(t.type);case 16:return Zc("Lazy");case 13:return Zc("Suspense");case 19:return Zc("SuspenseList");case 0:case 2:case 15:return t=fg(t.type,!1),t;case 11:return t=fg(t.type.render,!1),t;case 1:return t=fg(t.type,!0),t;default:return""}}function dm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case vl:return"Fragment";case ml:return"Portal";case cm:return"Profiler";case Jv:return"StrictMode";case um:return"Suspense";case hm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case qT:return(t.displayName||"Context")+".Consumer";case BT:return(t._context.displayName||"Context")+".Provider";case Zv:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ey:return e=t.displayName||null,e!==null?e:dm(t.type)||"Memo";case js:e=t._payload,t=t._init;try{return dm(t(e))}catch{}}return null}function qk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return dm(e);case 8:return e===Jv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function fo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function WT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Hk(t){var e=WT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function td(t){t._valueTracker||(t._valueTracker=Hk(t))}function KT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=WT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function sf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function fm(t,e){var n=e.checked;return Tt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function G0(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=fo(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function GT(t,e){e=e.checked,e!=null&&Xv(t,"checked",e,!1)}function pm(t,e){GT(t,e);var n=fo(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?gm(t,e.type,n):e.hasOwnProperty("defaultValue")&&gm(t,e.type,fo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Q0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function gm(t,e,n){(e!=="number"||sf(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var eu=Array.isArray;function Pl(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+fo(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function mm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Y(91));return Tt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Y0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Y(92));if(eu(n)){if(1<n.length)throw Error(Y(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:fo(n)}}function QT(t,e){var n=fo(e.value),r=fo(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function X0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function YT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?YT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var nd,XT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(nd=nd||document.createElement("div"),nd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=nd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ru(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var du={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Wk=["Webkit","ms","Moz","O"];Object.keys(du).forEach(function(t){Wk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),du[e]=du[t]})});function JT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||du.hasOwnProperty(t)&&du[t]?(""+e).trim():e+"px"}function ZT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=JT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var Kk=Tt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ym(t,e){if(e){if(Kk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Y(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Y(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Y(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Y(62))}}function _m(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wm=null;function ty(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Em=null,kl=null,Rl=null;function J0(t){if(t=uh(t)){if(typeof Em!="function")throw Error(Y(280));var e=t.stateNode;e&&(e=op(e),Em(t.stateNode,t.type,e))}}function eI(t){kl?Rl?Rl.push(t):Rl=[t]:kl=t}function tI(){if(kl){var t=kl,e=Rl;if(Rl=kl=null,J0(t),e)for(t=0;t<e.length;t++)J0(e[t])}}function nI(t,e){return t(e)}function rI(){}var pg=!1;function iI(t,e,n){if(pg)return t(e,n);pg=!0;try{return nI(t,e,n)}finally{pg=!1,(kl!==null||Rl!==null)&&(rI(),tI())}}function Du(t,e){var n=t.stateNode;if(n===null)return null;var r=op(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Y(231,e,typeof n));return n}var Tm=!1;if(Yi)try{var Fc={};Object.defineProperty(Fc,"passive",{get:function(){Tm=!0}}),window.addEventListener("test",Fc,Fc),window.removeEventListener("test",Fc,Fc)}catch{Tm=!1}function Gk(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var fu=!1,of=null,af=!1,Im=null,Qk={onError:function(t){fu=!0,of=t}};function Yk(t,e,n,r,i,s,o,a,l){fu=!1,of=null,Gk.apply(Qk,arguments)}function Xk(t,e,n,r,i,s,o,a,l){if(Yk.apply(this,arguments),fu){if(fu){var u=of;fu=!1,of=null}else throw Error(Y(198));af||(af=!0,Im=u)}}function ka(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function sI(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Z0(t){if(ka(t)!==t)throw Error(Y(188))}function Jk(t){var e=t.alternate;if(!e){if(e=ka(t),e===null)throw Error(Y(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Z0(i),t;if(s===r)return Z0(i),e;s=s.sibling}throw Error(Y(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(Y(189))}}if(n.alternate!==r)throw Error(Y(190))}if(n.tag!==3)throw Error(Y(188));return n.stateNode.current===n?t:e}function oI(t){return t=Jk(t),t!==null?aI(t):null}function aI(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=aI(t);if(e!==null)return e;t=t.sibling}return null}var lI=ar.unstable_scheduleCallback,ew=ar.unstable_cancelCallback,Zk=ar.unstable_shouldYield,eR=ar.unstable_requestPaint,kt=ar.unstable_now,tR=ar.unstable_getCurrentPriorityLevel,ny=ar.unstable_ImmediatePriority,cI=ar.unstable_UserBlockingPriority,lf=ar.unstable_NormalPriority,nR=ar.unstable_LowPriority,uI=ar.unstable_IdlePriority,np=null,Ei=null;function rR(t){if(Ei&&typeof Ei.onCommitFiberRoot=="function")try{Ei.onCommitFiberRoot(np,t,void 0,(t.current.flags&128)===128)}catch{}}var Yr=Math.clz32?Math.clz32:oR,iR=Math.log,sR=Math.LN2;function oR(t){return t>>>=0,t===0?32:31-(iR(t)/sR|0)|0}var rd=64,id=4194304;function tu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function cf(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=tu(a):(s&=o,s!==0&&(r=tu(s)))}else o=n&~i,o!==0?r=tu(o):s!==0&&(r=tu(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Yr(e),i=1<<n,r|=t[n],e&=~i;return r}function aR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Yr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=aR(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Sm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function hI(){var t=rd;return rd<<=1,!(rd&4194240)&&(rd=64),t}function gg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function lh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Yr(e),t[e]=n}function cR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Yr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function ry(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Yr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Qe=0;function dI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var fI,iy,pI,gI,mI,bm=!1,sd=[],Js=null,Zs=null,eo=null,Ou=new Map,Nu=new Map,$s=[],uR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tw(t,e){switch(t){case"focusin":case"focusout":Js=null;break;case"dragenter":case"dragleave":Zs=null;break;case"mouseover":case"mouseout":eo=null;break;case"pointerover":case"pointerout":Ou.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nu.delete(e.pointerId)}}function Uc(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=uh(e),e!==null&&iy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function hR(t,e,n,r,i){switch(e){case"focusin":return Js=Uc(Js,t,e,n,r,i),!0;case"dragenter":return Zs=Uc(Zs,t,e,n,r,i),!0;case"mouseover":return eo=Uc(eo,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Ou.set(s,Uc(Ou.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Nu.set(s,Uc(Nu.get(s)||null,t,e,n,r,i)),!0}return!1}function vI(t){var e=ra(t.target);if(e!==null){var n=ka(e);if(n!==null){if(e=n.tag,e===13){if(e=sI(n),e!==null){t.blockedOn=e,mI(t.priority,function(){pI(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function kd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Cm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);wm=r,n.target.dispatchEvent(r),wm=null}else return e=uh(n),e!==null&&iy(e),t.blockedOn=n,!1;e.shift()}return!0}function nw(t,e,n){kd(t)&&n.delete(e)}function dR(){bm=!1,Js!==null&&kd(Js)&&(Js=null),Zs!==null&&kd(Zs)&&(Zs=null),eo!==null&&kd(eo)&&(eo=null),Ou.forEach(nw),Nu.forEach(nw)}function $c(t,e){t.blockedOn===e&&(t.blockedOn=null,bm||(bm=!0,ar.unstable_scheduleCallback(ar.unstable_NormalPriority,dR)))}function Lu(t){function e(i){return $c(i,t)}if(0<sd.length){$c(sd[0],t);for(var n=1;n<sd.length;n++){var r=sd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Js!==null&&$c(Js,t),Zs!==null&&$c(Zs,t),eo!==null&&$c(eo,t),Ou.forEach(e),Nu.forEach(e),n=0;n<$s.length;n++)r=$s[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<$s.length&&(n=$s[0],n.blockedOn===null);)vI(n),n.blockedOn===null&&$s.shift()}var Dl=ss.ReactCurrentBatchConfig,uf=!0;function fR(t,e,n,r){var i=Qe,s=Dl.transition;Dl.transition=null;try{Qe=1,sy(t,e,n,r)}finally{Qe=i,Dl.transition=s}}function pR(t,e,n,r){var i=Qe,s=Dl.transition;Dl.transition=null;try{Qe=4,sy(t,e,n,r)}finally{Qe=i,Dl.transition=s}}function sy(t,e,n,r){if(uf){var i=Cm(t,e,n,r);if(i===null)bg(t,e,r,hf,n),tw(t,r);else if(hR(i,t,e,n,r))r.stopPropagation();else if(tw(t,r),e&4&&-1<uR.indexOf(t)){for(;i!==null;){var s=uh(i);if(s!==null&&fI(s),s=Cm(t,e,n,r),s===null&&bg(t,e,r,hf,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else bg(t,e,r,null,n)}}var hf=null;function Cm(t,e,n,r){if(hf=null,t=ty(r),t=ra(t),t!==null)if(e=ka(t),e===null)t=null;else if(n=e.tag,n===13){if(t=sI(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return hf=t,null}function yI(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tR()){case ny:return 1;case cI:return 4;case lf:case nR:return 16;case uI:return 536870912;default:return 16}default:return 16}}var Gs=null,oy=null,Rd=null;function _I(){if(Rd)return Rd;var t,e=oy,n=e.length,r,i="value"in Gs?Gs.value:Gs.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Rd=i.slice(t,1<r?1-r:void 0)}function Dd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function od(){return!0}function rw(){return!1}function ur(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?od:rw,this.isPropagationStopped=rw,this}return Tt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=od)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=od)},persist:function(){},isPersistent:od}),e}var ac={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ay=ur(ac),ch=Tt({},ac,{view:0,detail:0}),gR=ur(ch),mg,vg,zc,rp=Tt({},ch,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ly,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==zc&&(zc&&t.type==="mousemove"?(mg=t.screenX-zc.screenX,vg=t.screenY-zc.screenY):vg=mg=0,zc=t),mg)},movementY:function(t){return"movementY"in t?t.movementY:vg}}),iw=ur(rp),mR=Tt({},rp,{dataTransfer:0}),vR=ur(mR),yR=Tt({},ch,{relatedTarget:0}),yg=ur(yR),_R=Tt({},ac,{animationName:0,elapsedTime:0,pseudoElement:0}),wR=ur(_R),ER=Tt({},ac,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),TR=ur(ER),IR=Tt({},ac,{data:0}),sw=ur(IR),SR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},CR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function AR(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=CR[t])?!!e[t]:!1}function ly(){return AR}var xR=Tt({},ch,{key:function(t){if(t.key){var e=SR[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Dd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?bR[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ly,charCode:function(t){return t.type==="keypress"?Dd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Dd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),PR=ur(xR),kR=Tt({},rp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ow=ur(kR),RR=Tt({},ch,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ly}),DR=ur(RR),OR=Tt({},ac,{propertyName:0,elapsedTime:0,pseudoElement:0}),NR=ur(OR),LR=Tt({},rp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),MR=ur(LR),VR=[9,13,27,32],cy=Yi&&"CompositionEvent"in window,pu=null;Yi&&"documentMode"in document&&(pu=document.documentMode);var jR=Yi&&"TextEvent"in window&&!pu,wI=Yi&&(!cy||pu&&8<pu&&11>=pu),aw=" ",lw=!1;function EI(t,e){switch(t){case"keyup":return VR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function TI(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var yl=!1;function FR(t,e){switch(t){case"compositionend":return TI(e);case"keypress":return e.which!==32?null:(lw=!0,aw);case"textInput":return t=e.data,t===aw&&lw?null:t;default:return null}}function UR(t,e){if(yl)return t==="compositionend"||!cy&&EI(t,e)?(t=_I(),Rd=oy=Gs=null,yl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return wI&&e.locale!=="ko"?null:e.data;default:return null}}var $R={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!$R[t.type]:e==="textarea"}function II(t,e,n,r){eI(r),e=df(e,"onChange"),0<e.length&&(n=new ay("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var gu=null,Mu=null;function zR(t){NI(t,0)}function ip(t){var e=El(t);if(KT(e))return t}function BR(t,e){if(t==="change")return e}var SI=!1;if(Yi){var _g;if(Yi){var wg="oninput"in document;if(!wg){var uw=document.createElement("div");uw.setAttribute("oninput","return;"),wg=typeof uw.oninput=="function"}_g=wg}else _g=!1;SI=_g&&(!document.documentMode||9<document.documentMode)}function hw(){gu&&(gu.detachEvent("onpropertychange",bI),Mu=gu=null)}function bI(t){if(t.propertyName==="value"&&ip(Mu)){var e=[];II(e,Mu,t,ty(t)),iI(zR,e)}}function qR(t,e,n){t==="focusin"?(hw(),gu=e,Mu=n,gu.attachEvent("onpropertychange",bI)):t==="focusout"&&hw()}function HR(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ip(Mu)}function WR(t,e){if(t==="click")return ip(e)}function KR(t,e){if(t==="input"||t==="change")return ip(e)}function GR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ei=typeof Object.is=="function"?Object.is:GR;function Vu(t,e){if(ei(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!lm.call(e,i)||!ei(t[i],e[i]))return!1}return!0}function dw(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function fw(t,e){var n=dw(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=dw(n)}}function CI(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?CI(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function AI(){for(var t=window,e=sf();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=sf(t.document)}return e}function uy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function QR(t){var e=AI(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&CI(n.ownerDocument.documentElement,n)){if(r!==null&&uy(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=fw(n,s);var o=fw(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var YR=Yi&&"documentMode"in document&&11>=document.documentMode,_l=null,Am=null,mu=null,xm=!1;function pw(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xm||_l==null||_l!==sf(r)||(r=_l,"selectionStart"in r&&uy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),mu&&Vu(mu,r)||(mu=r,r=df(Am,"onSelect"),0<r.length&&(e=new ay("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=_l)))}function ad(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var wl={animationend:ad("Animation","AnimationEnd"),animationiteration:ad("Animation","AnimationIteration"),animationstart:ad("Animation","AnimationStart"),transitionend:ad("Transition","TransitionEnd")},Eg={},xI={};Yi&&(xI=document.createElement("div").style,"AnimationEvent"in window||(delete wl.animationend.animation,delete wl.animationiteration.animation,delete wl.animationstart.animation),"TransitionEvent"in window||delete wl.transitionend.transition);function sp(t){if(Eg[t])return Eg[t];if(!wl[t])return t;var e=wl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in xI)return Eg[t]=e[n];return t}var PI=sp("animationend"),kI=sp("animationiteration"),RI=sp("animationstart"),DI=sp("transitionend"),OI=new Map,gw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _o(t,e){OI.set(t,e),Pa(e,[t])}for(var Tg=0;Tg<gw.length;Tg++){var Ig=gw[Tg],XR=Ig.toLowerCase(),JR=Ig[0].toUpperCase()+Ig.slice(1);_o(XR,"on"+JR)}_o(PI,"onAnimationEnd");_o(kI,"onAnimationIteration");_o(RI,"onAnimationStart");_o("dblclick","onDoubleClick");_o("focusin","onFocus");_o("focusout","onBlur");_o(DI,"onTransitionEnd");Ul("onMouseEnter",["mouseout","mouseover"]);Ul("onMouseLeave",["mouseout","mouseover"]);Ul("onPointerEnter",["pointerout","pointerover"]);Ul("onPointerLeave",["pointerout","pointerover"]);Pa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Pa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Pa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Pa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Pa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Pa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ZR=new Set("cancel close invalid load scroll toggle".split(" ").concat(nu));function mw(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Xk(r,e,void 0,t),t.currentTarget=null}function NI(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;mw(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;mw(i,a,u),s=l}}}if(af)throw t=Im,af=!1,Im=null,t}function ht(t,e){var n=e[Om];n===void 0&&(n=e[Om]=new Set);var r=t+"__bubble";n.has(r)||(LI(e,t,2,!1),n.add(r))}function Sg(t,e,n){var r=0;e&&(r|=4),LI(n,t,r,e)}var ld="_reactListening"+Math.random().toString(36).slice(2);function ju(t){if(!t[ld]){t[ld]=!0,zT.forEach(function(n){n!=="selectionchange"&&(ZR.has(n)||Sg(n,!1,t),Sg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ld]||(e[ld]=!0,Sg("selectionchange",!1,e))}}function LI(t,e,n,r){switch(yI(e)){case 1:var i=fR;break;case 4:i=pR;break;default:i=sy}n=i.bind(null,e,n,t),i=void 0,!Tm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function bg(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=ra(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}iI(function(){var u=s,d=ty(n),p=[];e:{var m=OI.get(t);if(m!==void 0){var w=ay,E=t;switch(t){case"keypress":if(Dd(n)===0)break e;case"keydown":case"keyup":w=PR;break;case"focusin":E="focus",w=yg;break;case"focusout":E="blur",w=yg;break;case"beforeblur":case"afterblur":w=yg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=iw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=vR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=DR;break;case PI:case kI:case RI:w=wR;break;case DI:w=NR;break;case"scroll":w=gR;break;case"wheel":w=MR;break;case"copy":case"cut":case"paste":w=TR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=ow}var x=(e&4)!==0,D=!x&&t==="scroll",A=x?m!==null?m+"Capture":null:m;x=[];for(var T=u,S;T!==null;){S=T;var M=S.stateNode;if(S.tag===5&&M!==null&&(S=M,A!==null&&(M=Du(T,A),M!=null&&x.push(Fu(T,M,S)))),D)break;T=T.return}0<x.length&&(m=new w(m,E,null,n,d),p.push({event:m,listeners:x}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",m&&n!==wm&&(E=n.relatedTarget||n.fromElement)&&(ra(E)||E[Xi]))break e;if((w||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,w?(E=n.relatedTarget||n.toElement,w=u,E=E?ra(E):null,E!==null&&(D=ka(E),E!==D||E.tag!==5&&E.tag!==6)&&(E=null)):(w=null,E=u),w!==E)){if(x=iw,M="onMouseLeave",A="onMouseEnter",T="mouse",(t==="pointerout"||t==="pointerover")&&(x=ow,M="onPointerLeave",A="onPointerEnter",T="pointer"),D=w==null?m:El(w),S=E==null?m:El(E),m=new x(M,T+"leave",w,n,d),m.target=D,m.relatedTarget=S,M=null,ra(d)===u&&(x=new x(A,T+"enter",E,n,d),x.target=S,x.relatedTarget=D,M=x),D=M,w&&E)t:{for(x=w,A=E,T=0,S=x;S;S=sl(S))T++;for(S=0,M=A;M;M=sl(M))S++;for(;0<T-S;)x=sl(x),T--;for(;0<S-T;)A=sl(A),S--;for(;T--;){if(x===A||A!==null&&x===A.alternate)break t;x=sl(x),A=sl(A)}x=null}else x=null;w!==null&&vw(p,m,w,x,!1),E!==null&&D!==null&&vw(p,D,E,x,!0)}}e:{if(m=u?El(u):window,w=m.nodeName&&m.nodeName.toLowerCase(),w==="select"||w==="input"&&m.type==="file")var q=BR;else if(cw(m))if(SI)q=KR;else{q=HR;var W=qR}else(w=m.nodeName)&&w.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(q=WR);if(q&&(q=q(t,u))){II(p,q,n,d);break e}W&&W(t,m,u),t==="focusout"&&(W=m._wrapperState)&&W.controlled&&m.type==="number"&&gm(m,"number",m.value)}switch(W=u?El(u):window,t){case"focusin":(cw(W)||W.contentEditable==="true")&&(_l=W,Am=u,mu=null);break;case"focusout":mu=Am=_l=null;break;case"mousedown":xm=!0;break;case"contextmenu":case"mouseup":case"dragend":xm=!1,pw(p,n,d);break;case"selectionchange":if(YR)break;case"keydown":case"keyup":pw(p,n,d)}var P;if(cy)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else yl?EI(t,n)&&(C="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(wI&&n.locale!=="ko"&&(yl||C!=="onCompositionStart"?C==="onCompositionEnd"&&yl&&(P=_I()):(Gs=d,oy="value"in Gs?Gs.value:Gs.textContent,yl=!0)),W=df(u,C),0<W.length&&(C=new sw(C,t,null,n,d),p.push({event:C,listeners:W}),P?C.data=P:(P=TI(n),P!==null&&(C.data=P)))),(P=jR?FR(t,n):UR(t,n))&&(u=df(u,"onBeforeInput"),0<u.length&&(d=new sw("onBeforeInput","beforeinput",null,n,d),p.push({event:d,listeners:u}),d.data=P))}NI(p,e)})}function Fu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function df(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Du(t,n),s!=null&&r.unshift(Fu(t,s,i)),s=Du(t,e),s!=null&&r.push(Fu(t,s,i))),t=t.return}return r}function sl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function vw(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=Du(n,s),l!=null&&o.unshift(Fu(n,l,a))):i||(l=Du(n,s),l!=null&&o.push(Fu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var eD=/\r\n?/g,tD=/\u0000|\uFFFD/g;function yw(t){return(typeof t=="string"?t:""+t).replace(eD,`
`).replace(tD,"")}function cd(t,e,n){if(e=yw(e),yw(t)!==e&&n)throw Error(Y(425))}function ff(){}var Pm=null,km=null;function Rm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Dm=typeof setTimeout=="function"?setTimeout:void 0,nD=typeof clearTimeout=="function"?clearTimeout:void 0,_w=typeof Promise=="function"?Promise:void 0,rD=typeof queueMicrotask=="function"?queueMicrotask:typeof _w<"u"?function(t){return _w.resolve(null).then(t).catch(iD)}:Dm;function iD(t){setTimeout(function(){throw t})}function Cg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Lu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Lu(e)}function to(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ww(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var lc=Math.random().toString(36).slice(2),mi="__reactFiber$"+lc,Uu="__reactProps$"+lc,Xi="__reactContainer$"+lc,Om="__reactEvents$"+lc,sD="__reactListeners$"+lc,oD="__reactHandles$"+lc;function ra(t){var e=t[mi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Xi]||n[mi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ww(t);t!==null;){if(n=t[mi])return n;t=ww(t)}return e}t=n,n=t.parentNode}return null}function uh(t){return t=t[mi]||t[Xi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function El(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Y(33))}function op(t){return t[Uu]||null}var Nm=[],Tl=-1;function wo(t){return{current:t}}function ft(t){0>Tl||(t.current=Nm[Tl],Nm[Tl]=null,Tl--)}function ct(t,e){Tl++,Nm[Tl]=t.current,t.current=e}var po={},vn=wo(po),zn=wo(!1),fa=po;function $l(t,e){var n=t.type.contextTypes;if(!n)return po;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Bn(t){return t=t.childContextTypes,t!=null}function pf(){ft(zn),ft(vn)}function Ew(t,e,n){if(vn.current!==po)throw Error(Y(168));ct(vn,e),ct(zn,n)}function MI(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Y(108,qk(t)||"Unknown",i));return Tt({},n,r)}function gf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||po,fa=vn.current,ct(vn,t),ct(zn,zn.current),!0}function Tw(t,e,n){var r=t.stateNode;if(!r)throw Error(Y(169));n?(t=MI(t,e,fa),r.__reactInternalMemoizedMergedChildContext=t,ft(zn),ft(vn),ct(vn,t)):ft(zn),ct(zn,n)}var Fi=null,ap=!1,Ag=!1;function VI(t){Fi===null?Fi=[t]:Fi.push(t)}function aD(t){ap=!0,VI(t)}function Eo(){if(!Ag&&Fi!==null){Ag=!0;var t=0,e=Qe;try{var n=Fi;for(Qe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Fi=null,ap=!1}catch(i){throw Fi!==null&&(Fi=Fi.slice(t+1)),lI(ny,Eo),i}finally{Qe=e,Ag=!1}}return null}var Il=[],Sl=0,mf=null,vf=0,br=[],Cr=0,pa=null,$i=1,zi="";function Qo(t,e){Il[Sl++]=vf,Il[Sl++]=mf,mf=t,vf=e}function jI(t,e,n){br[Cr++]=$i,br[Cr++]=zi,br[Cr++]=pa,pa=t;var r=$i;t=zi;var i=32-Yr(r)-1;r&=~(1<<i),n+=1;var s=32-Yr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,$i=1<<32-Yr(e)+i|n<<i|r,zi=s+t}else $i=1<<s|n<<i|r,zi=t}function hy(t){t.return!==null&&(Qo(t,1),jI(t,1,0))}function dy(t){for(;t===mf;)mf=Il[--Sl],Il[Sl]=null,vf=Il[--Sl],Il[Sl]=null;for(;t===pa;)pa=br[--Cr],br[Cr]=null,zi=br[--Cr],br[Cr]=null,$i=br[--Cr],br[Cr]=null}var ir=null,tr=null,gt=!1,Gr=null;function FI(t,e){var n=xr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Iw(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ir=t,tr=to(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ir=t,tr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=pa!==null?{id:$i,overflow:zi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=xr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ir=t,tr=null,!0):!1;default:return!1}}function Lm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Mm(t){if(gt){var e=tr;if(e){var n=e;if(!Iw(t,e)){if(Lm(t))throw Error(Y(418));e=to(n.nextSibling);var r=ir;e&&Iw(t,e)?FI(r,n):(t.flags=t.flags&-4097|2,gt=!1,ir=t)}}else{if(Lm(t))throw Error(Y(418));t.flags=t.flags&-4097|2,gt=!1,ir=t}}}function Sw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ir=t}function ud(t){if(t!==ir)return!1;if(!gt)return Sw(t),gt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Rm(t.type,t.memoizedProps)),e&&(e=tr)){if(Lm(t))throw UI(),Error(Y(418));for(;e;)FI(t,e),e=to(e.nextSibling)}if(Sw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Y(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){tr=to(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}tr=null}}else tr=ir?to(t.stateNode.nextSibling):null;return!0}function UI(){for(var t=tr;t;)t=to(t.nextSibling)}function zl(){tr=ir=null,gt=!1}function fy(t){Gr===null?Gr=[t]:Gr.push(t)}var lD=ss.ReactCurrentBatchConfig;function Bc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Y(309));var r=n.stateNode}if(!r)throw Error(Y(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Y(284));if(!n._owner)throw Error(Y(290,t))}return t}function hd(t,e){throw t=Object.prototype.toString.call(e),Error(Y(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function bw(t){var e=t._init;return e(t._payload)}function $I(t){function e(A,T){if(t){var S=A.deletions;S===null?(A.deletions=[T],A.flags|=16):S.push(T)}}function n(A,T){if(!t)return null;for(;T!==null;)e(A,T),T=T.sibling;return null}function r(A,T){for(A=new Map;T!==null;)T.key!==null?A.set(T.key,T):A.set(T.index,T),T=T.sibling;return A}function i(A,T){return A=so(A,T),A.index=0,A.sibling=null,A}function s(A,T,S){return A.index=S,t?(S=A.alternate,S!==null?(S=S.index,S<T?(A.flags|=2,T):S):(A.flags|=2,T)):(A.flags|=1048576,T)}function o(A){return t&&A.alternate===null&&(A.flags|=2),A}function a(A,T,S,M){return T===null||T.tag!==6?(T=Ng(S,A.mode,M),T.return=A,T):(T=i(T,S),T.return=A,T)}function l(A,T,S,M){var q=S.type;return q===vl?d(A,T,S.props.children,M,S.key):T!==null&&(T.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===js&&bw(q)===T.type)?(M=i(T,S.props),M.ref=Bc(A,T,S),M.return=A,M):(M=Fd(S.type,S.key,S.props,null,A.mode,M),M.ref=Bc(A,T,S),M.return=A,M)}function u(A,T,S,M){return T===null||T.tag!==4||T.stateNode.containerInfo!==S.containerInfo||T.stateNode.implementation!==S.implementation?(T=Lg(S,A.mode,M),T.return=A,T):(T=i(T,S.children||[]),T.return=A,T)}function d(A,T,S,M,q){return T===null||T.tag!==7?(T=ca(S,A.mode,M,q),T.return=A,T):(T=i(T,S),T.return=A,T)}function p(A,T,S){if(typeof T=="string"&&T!==""||typeof T=="number")return T=Ng(""+T,A.mode,S),T.return=A,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case ed:return S=Fd(T.type,T.key,T.props,null,A.mode,S),S.ref=Bc(A,null,T),S.return=A,S;case ml:return T=Lg(T,A.mode,S),T.return=A,T;case js:var M=T._init;return p(A,M(T._payload),S)}if(eu(T)||jc(T))return T=ca(T,A.mode,S,null),T.return=A,T;hd(A,T)}return null}function m(A,T,S,M){var q=T!==null?T.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return q!==null?null:a(A,T,""+S,M);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ed:return S.key===q?l(A,T,S,M):null;case ml:return S.key===q?u(A,T,S,M):null;case js:return q=S._init,m(A,T,q(S._payload),M)}if(eu(S)||jc(S))return q!==null?null:d(A,T,S,M,null);hd(A,S)}return null}function w(A,T,S,M,q){if(typeof M=="string"&&M!==""||typeof M=="number")return A=A.get(S)||null,a(T,A,""+M,q);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case ed:return A=A.get(M.key===null?S:M.key)||null,l(T,A,M,q);case ml:return A=A.get(M.key===null?S:M.key)||null,u(T,A,M,q);case js:var W=M._init;return w(A,T,S,W(M._payload),q)}if(eu(M)||jc(M))return A=A.get(S)||null,d(T,A,M,q,null);hd(T,M)}return null}function E(A,T,S,M){for(var q=null,W=null,P=T,C=T=0,R=null;P!==null&&C<S.length;C++){P.index>C?(R=P,P=null):R=P.sibling;var O=m(A,P,S[C],M);if(O===null){P===null&&(P=R);break}t&&P&&O.alternate===null&&e(A,P),T=s(O,T,C),W===null?q=O:W.sibling=O,W=O,P=R}if(C===S.length)return n(A,P),gt&&Qo(A,C),q;if(P===null){for(;C<S.length;C++)P=p(A,S[C],M),P!==null&&(T=s(P,T,C),W===null?q=P:W.sibling=P,W=P);return gt&&Qo(A,C),q}for(P=r(A,P);C<S.length;C++)R=w(P,A,C,S[C],M),R!==null&&(t&&R.alternate!==null&&P.delete(R.key===null?C:R.key),T=s(R,T,C),W===null?q=R:W.sibling=R,W=R);return t&&P.forEach(function(L){return e(A,L)}),gt&&Qo(A,C),q}function x(A,T,S,M){var q=jc(S);if(typeof q!="function")throw Error(Y(150));if(S=q.call(S),S==null)throw Error(Y(151));for(var W=q=null,P=T,C=T=0,R=null,O=S.next();P!==null&&!O.done;C++,O=S.next()){P.index>C?(R=P,P=null):R=P.sibling;var L=m(A,P,O.value,M);if(L===null){P===null&&(P=R);break}t&&P&&L.alternate===null&&e(A,P),T=s(L,T,C),W===null?q=L:W.sibling=L,W=L,P=R}if(O.done)return n(A,P),gt&&Qo(A,C),q;if(P===null){for(;!O.done;C++,O=S.next())O=p(A,O.value,M),O!==null&&(T=s(O,T,C),W===null?q=O:W.sibling=O,W=O);return gt&&Qo(A,C),q}for(P=r(A,P);!O.done;C++,O=S.next())O=w(P,A,C,O.value,M),O!==null&&(t&&O.alternate!==null&&P.delete(O.key===null?C:O.key),T=s(O,T,C),W===null?q=O:W.sibling=O,W=O);return t&&P.forEach(function(V){return e(A,V)}),gt&&Qo(A,C),q}function D(A,T,S,M){if(typeof S=="object"&&S!==null&&S.type===vl&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case ed:e:{for(var q=S.key,W=T;W!==null;){if(W.key===q){if(q=S.type,q===vl){if(W.tag===7){n(A,W.sibling),T=i(W,S.props.children),T.return=A,A=T;break e}}else if(W.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===js&&bw(q)===W.type){n(A,W.sibling),T=i(W,S.props),T.ref=Bc(A,W,S),T.return=A,A=T;break e}n(A,W);break}else e(A,W);W=W.sibling}S.type===vl?(T=ca(S.props.children,A.mode,M,S.key),T.return=A,A=T):(M=Fd(S.type,S.key,S.props,null,A.mode,M),M.ref=Bc(A,T,S),M.return=A,A=M)}return o(A);case ml:e:{for(W=S.key;T!==null;){if(T.key===W)if(T.tag===4&&T.stateNode.containerInfo===S.containerInfo&&T.stateNode.implementation===S.implementation){n(A,T.sibling),T=i(T,S.children||[]),T.return=A,A=T;break e}else{n(A,T);break}else e(A,T);T=T.sibling}T=Lg(S,A.mode,M),T.return=A,A=T}return o(A);case js:return W=S._init,D(A,T,W(S._payload),M)}if(eu(S))return E(A,T,S,M);if(jc(S))return x(A,T,S,M);hd(A,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,T!==null&&T.tag===6?(n(A,T.sibling),T=i(T,S),T.return=A,A=T):(n(A,T),T=Ng(S,A.mode,M),T.return=A,A=T),o(A)):n(A,T)}return D}var Bl=$I(!0),zI=$I(!1),yf=wo(null),_f=null,bl=null,py=null;function gy(){py=bl=_f=null}function my(t){var e=yf.current;ft(yf),t._currentValue=e}function Vm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ol(t,e){_f=t,py=bl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&($n=!0),t.firstContext=null)}function Or(t){var e=t._currentValue;if(py!==t)if(t={context:t,memoizedValue:e,next:null},bl===null){if(_f===null)throw Error(Y(308));bl=t,_f.dependencies={lanes:0,firstContext:t}}else bl=bl.next=t;return e}var ia=null;function vy(t){ia===null?ia=[t]:ia.push(t)}function BI(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,vy(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ji(t,r)}function Ji(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Fs=!1;function yy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qI(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ki(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function no(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Fe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ji(t,n)}return i=r.interleaved,i===null?(e.next=e,vy(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ji(t,n)}function Od(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ry(t,n)}}function Cw(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function wf(t,e,n,r){var i=t.updateQueue;Fs=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;o=0,d=u=l=null,a=s;do{var m=a.lane,w=a.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:w,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=t,x=a;switch(m=e,w=n,x.tag){case 1:if(E=x.payload,typeof E=="function"){p=E.call(w,p,m);break e}p=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=x.payload,m=typeof E=="function"?E.call(w,p,m):E,m==null)break e;p=Tt({},p,m);break e;case 2:Fs=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[a]:m.push(a))}else w={eventTime:w,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=w,l=p):d=d.next=w,o|=m;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;m=a,a=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(d===null&&(l=p),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ma|=o,t.lanes=o,t.memoizedState=p}}function Aw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Y(191,i));i.call(r)}}}var hh={},Ti=wo(hh),$u=wo(hh),zu=wo(hh);function sa(t){if(t===hh)throw Error(Y(174));return t}function _y(t,e){switch(ct(zu,e),ct($u,t),ct(Ti,hh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:vm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=vm(e,t)}ft(Ti),ct(Ti,e)}function ql(){ft(Ti),ft($u),ft(zu)}function HI(t){sa(zu.current);var e=sa(Ti.current),n=vm(e,t.type);e!==n&&(ct($u,t),ct(Ti,n))}function wy(t){$u.current===t&&(ft(Ti),ft($u))}var yt=wo(0);function Ef(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var xg=[];function Ey(){for(var t=0;t<xg.length;t++)xg[t]._workInProgressVersionPrimary=null;xg.length=0}var Nd=ss.ReactCurrentDispatcher,Pg=ss.ReactCurrentBatchConfig,ga=0,wt=null,Bt=null,Jt=null,Tf=!1,vu=!1,Bu=0,cD=0;function un(){throw Error(Y(321))}function Ty(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ei(t[n],e[n]))return!1;return!0}function Iy(t,e,n,r,i,s){if(ga=s,wt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Nd.current=t===null||t.memoizedState===null?fD:pD,t=n(r,i),vu){s=0;do{if(vu=!1,Bu=0,25<=s)throw Error(Y(301));s+=1,Jt=Bt=null,e.updateQueue=null,Nd.current=gD,t=n(r,i)}while(vu)}if(Nd.current=If,e=Bt!==null&&Bt.next!==null,ga=0,Jt=Bt=wt=null,Tf=!1,e)throw Error(Y(300));return t}function Sy(){var t=Bu!==0;return Bu=0,t}function gi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?wt.memoizedState=Jt=t:Jt=Jt.next=t,Jt}function Nr(){if(Bt===null){var t=wt.alternate;t=t!==null?t.memoizedState:null}else t=Bt.next;var e=Jt===null?wt.memoizedState:Jt.next;if(e!==null)Jt=e,Bt=t;else{if(t===null)throw Error(Y(310));Bt=t,t={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},Jt===null?wt.memoizedState=Jt=t:Jt=Jt.next=t}return Jt}function qu(t,e){return typeof e=="function"?e(t):e}function kg(t){var e=Nr(),n=e.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=t;var r=Bt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var d=u.lane;if((ga&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=p,o=r):l=l.next=p,wt.lanes|=d,ma|=d}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,ei(r,e.memoizedState)||($n=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,wt.lanes|=s,ma|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Rg(t){var e=Nr(),n=e.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);ei(s,e.memoizedState)||($n=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function WI(){}function KI(t,e){var n=wt,r=Nr(),i=e(),s=!ei(r.memoizedState,i);if(s&&(r.memoizedState=i,$n=!0),r=r.queue,by(YI.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Jt!==null&&Jt.memoizedState.tag&1){if(n.flags|=2048,Hu(9,QI.bind(null,n,r,i,e),void 0,null),Zt===null)throw Error(Y(349));ga&30||GI(n,e,i)}return i}function GI(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=wt.updateQueue,e===null?(e={lastEffect:null,stores:null},wt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function QI(t,e,n,r){e.value=n,e.getSnapshot=r,XI(e)&&JI(t)}function YI(t,e,n){return n(function(){XI(e)&&JI(t)})}function XI(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ei(t,n)}catch{return!0}}function JI(t){var e=Ji(t,1);e!==null&&Xr(e,t,1,-1)}function xw(t){var e=gi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qu,lastRenderedState:t},e.queue=t,t=t.dispatch=dD.bind(null,wt,t),[e.memoizedState,t]}function Hu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=wt.updateQueue,e===null?(e={lastEffect:null,stores:null},wt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function ZI(){return Nr().memoizedState}function Ld(t,e,n,r){var i=gi();wt.flags|=t,i.memoizedState=Hu(1|e,n,void 0,r===void 0?null:r)}function lp(t,e,n,r){var i=Nr();r=r===void 0?null:r;var s=void 0;if(Bt!==null){var o=Bt.memoizedState;if(s=o.destroy,r!==null&&Ty(r,o.deps)){i.memoizedState=Hu(e,n,s,r);return}}wt.flags|=t,i.memoizedState=Hu(1|e,n,s,r)}function Pw(t,e){return Ld(8390656,8,t,e)}function by(t,e){return lp(2048,8,t,e)}function eS(t,e){return lp(4,2,t,e)}function tS(t,e){return lp(4,4,t,e)}function nS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function rS(t,e,n){return n=n!=null?n.concat([t]):null,lp(4,4,nS.bind(null,e,t),n)}function Cy(){}function iS(t,e){var n=Nr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ty(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function sS(t,e){var n=Nr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ty(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function oS(t,e,n){return ga&21?(ei(n,e)||(n=hI(),wt.lanes|=n,ma|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,$n=!0),t.memoizedState=n)}function uD(t,e){var n=Qe;Qe=n!==0&&4>n?n:4,t(!0);var r=Pg.transition;Pg.transition={};try{t(!1),e()}finally{Qe=n,Pg.transition=r}}function aS(){return Nr().memoizedState}function hD(t,e,n){var r=io(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},lS(t))cS(e,n);else if(n=BI(t,e,n,r),n!==null){var i=xn();Xr(n,t,r,i),uS(n,e,r)}}function dD(t,e,n){var r=io(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(lS(t))cS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ei(a,o)){var l=e.interleaved;l===null?(i.next=i,vy(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=BI(t,e,i,r),n!==null&&(i=xn(),Xr(n,t,r,i),uS(n,e,r))}}function lS(t){var e=t.alternate;return t===wt||e!==null&&e===wt}function cS(t,e){vu=Tf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function uS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ry(t,n)}}var If={readContext:Or,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},fD={readContext:Or,useCallback:function(t,e){return gi().memoizedState=[t,e===void 0?null:e],t},useContext:Or,useEffect:Pw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ld(4194308,4,nS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ld(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ld(4,2,t,e)},useMemo:function(t,e){var n=gi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=gi();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=hD.bind(null,wt,t),[r.memoizedState,t]},useRef:function(t){var e=gi();return t={current:t},e.memoizedState=t},useState:xw,useDebugValue:Cy,useDeferredValue:function(t){return gi().memoizedState=t},useTransition:function(){var t=xw(!1),e=t[0];return t=uD.bind(null,t[1]),gi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=wt,i=gi();if(gt){if(n===void 0)throw Error(Y(407));n=n()}else{if(n=e(),Zt===null)throw Error(Y(349));ga&30||GI(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Pw(YI.bind(null,r,s,t),[t]),r.flags|=2048,Hu(9,QI.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=gi(),e=Zt.identifierPrefix;if(gt){var n=zi,r=$i;n=(r&~(1<<32-Yr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Bu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=cD++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},pD={readContext:Or,useCallback:iS,useContext:Or,useEffect:by,useImperativeHandle:rS,useInsertionEffect:eS,useLayoutEffect:tS,useMemo:sS,useReducer:kg,useRef:ZI,useState:function(){return kg(qu)},useDebugValue:Cy,useDeferredValue:function(t){var e=Nr();return oS(e,Bt.memoizedState,t)},useTransition:function(){var t=kg(qu)[0],e=Nr().memoizedState;return[t,e]},useMutableSource:WI,useSyncExternalStore:KI,useId:aS,unstable_isNewReconciler:!1},gD={readContext:Or,useCallback:iS,useContext:Or,useEffect:by,useImperativeHandle:rS,useInsertionEffect:eS,useLayoutEffect:tS,useMemo:sS,useReducer:Rg,useRef:ZI,useState:function(){return Rg(qu)},useDebugValue:Cy,useDeferredValue:function(t){var e=Nr();return Bt===null?e.memoizedState=t:oS(e,Bt.memoizedState,t)},useTransition:function(){var t=Rg(qu)[0],e=Nr().memoizedState;return[t,e]},useMutableSource:WI,useSyncExternalStore:KI,useId:aS,unstable_isNewReconciler:!1};function Wr(t,e){if(t&&t.defaultProps){e=Tt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function jm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Tt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var cp={isMounted:function(t){return(t=t._reactInternals)?ka(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=xn(),i=io(t),s=Ki(r,i);s.payload=e,n!=null&&(s.callback=n),e=no(t,s,i),e!==null&&(Xr(e,t,i,r),Od(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=xn(),i=io(t),s=Ki(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=no(t,s,i),e!==null&&(Xr(e,t,i,r),Od(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=xn(),r=io(t),i=Ki(n,r);i.tag=2,e!=null&&(i.callback=e),e=no(t,i,r),e!==null&&(Xr(e,t,r,n),Od(e,t,r))}};function kw(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Vu(n,r)||!Vu(i,s):!0}function hS(t,e,n){var r=!1,i=po,s=e.contextType;return typeof s=="object"&&s!==null?s=Or(s):(i=Bn(e)?fa:vn.current,r=e.contextTypes,s=(r=r!=null)?$l(t,i):po),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=cp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Rw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&cp.enqueueReplaceState(e,e.state,null)}function Fm(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},yy(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Or(s):(s=Bn(e)?fa:vn.current,i.context=$l(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(jm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&cp.enqueueReplaceState(i,i.state,null),wf(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Hl(t,e){try{var n="",r=e;do n+=Bk(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Dg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Um(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var mD=typeof WeakMap=="function"?WeakMap:Map;function dS(t,e,n){n=Ki(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){bf||(bf=!0,Ym=r),Um(t,e)},n}function fS(t,e,n){n=Ki(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Um(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Um(t,e),typeof r!="function"&&(ro===null?ro=new Set([this]):ro.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Dw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new mD;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=kD.bind(null,t,e,n),e.then(t,t))}function Ow(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Nw(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ki(-1,1),e.tag=2,no(n,e,1))),n.lanes|=1),t)}var vD=ss.ReactCurrentOwner,$n=!1;function In(t,e,n,r){e.child=t===null?zI(e,null,n,r):Bl(e,t.child,n,r)}function Lw(t,e,n,r,i){n=n.render;var s=e.ref;return Ol(e,i),r=Iy(t,e,n,r,s,i),n=Sy(),t!==null&&!$n?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Zi(t,e,i)):(gt&&n&&hy(e),e.flags|=1,In(t,e,r,i),e.child)}function Mw(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Ny(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,pS(t,e,s,r,i)):(t=Fd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Vu,n(o,r)&&t.ref===e.ref)return Zi(t,e,i)}return e.flags|=1,t=so(s,r),t.ref=e.ref,t.return=e,e.child=t}function pS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Vu(s,r)&&t.ref===e.ref)if($n=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&($n=!0);else return e.lanes=t.lanes,Zi(t,e,i)}return $m(t,e,n,r,i)}function gS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(Al,er),er|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ct(Al,er),er|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ct(Al,er),er|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ct(Al,er),er|=r;return In(t,e,i,n),e.child}function mS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function $m(t,e,n,r,i){var s=Bn(n)?fa:vn.current;return s=$l(e,s),Ol(e,i),n=Iy(t,e,n,r,s,i),r=Sy(),t!==null&&!$n?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Zi(t,e,i)):(gt&&r&&hy(e),e.flags|=1,In(t,e,n,i),e.child)}function Vw(t,e,n,r,i){if(Bn(n)){var s=!0;gf(e)}else s=!1;if(Ol(e,i),e.stateNode===null)Md(t,e),hS(e,n,r),Fm(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Or(u):(u=Bn(n)?fa:vn.current,u=$l(e,u));var d=n.getDerivedStateFromProps,p=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&Rw(e,o,r,u),Fs=!1;var m=e.memoizedState;o.state=m,wf(e,r,o,i),l=e.memoizedState,a!==r||m!==l||zn.current||Fs?(typeof d=="function"&&(jm(e,n,d,r),l=e.memoizedState),(a=Fs||kw(e,n,a,r,m,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,qI(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Wr(e.type,a),o.props=u,p=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Or(l):(l=Bn(n)?fa:vn.current,l=$l(e,l));var w=n.getDerivedStateFromProps;(d=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||m!==l)&&Rw(e,o,r,l),Fs=!1,m=e.memoizedState,o.state=m,wf(e,r,o,i);var E=e.memoizedState;a!==p||m!==E||zn.current||Fs?(typeof w=="function"&&(jm(e,n,w,r),E=e.memoizedState),(u=Fs||kw(e,n,u,r,m,E,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return zm(t,e,n,r,s,i)}function zm(t,e,n,r,i,s){mS(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Tw(e,n,!1),Zi(t,e,s);r=e.stateNode,vD.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Bl(e,t.child,null,s),e.child=Bl(e,null,a,s)):In(t,e,a,s),e.memoizedState=r.state,i&&Tw(e,n,!0),e.child}function vS(t){var e=t.stateNode;e.pendingContext?Ew(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Ew(t,e.context,!1),_y(t,e.containerInfo)}function jw(t,e,n,r,i){return zl(),fy(i),e.flags|=256,In(t,e,n,r),e.child}var Bm={dehydrated:null,treeContext:null,retryLane:0};function qm(t){return{baseLanes:t,cachePool:null,transitions:null}}function yS(t,e,n){var r=e.pendingProps,i=yt.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ct(yt,i&1),t===null)return Mm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=dp(o,r,0,null),t=ca(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=qm(n),e.memoizedState=Bm,t):Ay(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return yD(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=so(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=so(a,s):(s=ca(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?qm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Bm,r}return s=t.child,t=s.sibling,r=so(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ay(t,e){return e=dp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function dd(t,e,n,r){return r!==null&&fy(r),Bl(e,t.child,null,n),t=Ay(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function yD(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Dg(Error(Y(422))),dd(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=dp({mode:"visible",children:r.children},i,0,null),s=ca(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Bl(e,t.child,null,o),e.child.memoizedState=qm(o),e.memoizedState=Bm,s);if(!(e.mode&1))return dd(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(Y(419)),r=Dg(s,r,void 0),dd(t,e,o,r)}if(a=(o&t.childLanes)!==0,$n||a){if(r=Zt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ji(t,i),Xr(r,t,i,-1))}return Oy(),r=Dg(Error(Y(421))),dd(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=RD.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,tr=to(i.nextSibling),ir=e,gt=!0,Gr=null,t!==null&&(br[Cr++]=$i,br[Cr++]=zi,br[Cr++]=pa,$i=t.id,zi=t.overflow,pa=e),e=Ay(e,r.children),e.flags|=4096,e)}function Fw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Vm(t.return,e,n)}function Og(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function _S(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(In(t,e,r.children,n),r=yt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Fw(t,n,e);else if(t.tag===19)Fw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ct(yt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ef(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Og(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ef(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Og(e,!0,n,null,s);break;case"together":Og(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Md(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Zi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ma|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Y(153));if(e.child!==null){for(t=e.child,n=so(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=so(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function _D(t,e,n){switch(e.tag){case 3:vS(e),zl();break;case 5:HI(e);break;case 1:Bn(e.type)&&gf(e);break;case 4:_y(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ct(yf,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ct(yt,yt.current&1),e.flags|=128,null):n&e.child.childLanes?yS(t,e,n):(ct(yt,yt.current&1),t=Zi(t,e,n),t!==null?t.sibling:null);ct(yt,yt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return _S(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ct(yt,yt.current),r)break;return null;case 22:case 23:return e.lanes=0,gS(t,e,n)}return Zi(t,e,n)}var wS,Hm,ES,TS;wS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Hm=function(){};ES=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,sa(Ti.current);var s=null;switch(n){case"input":i=fm(t,i),r=fm(t,r),s=[];break;case"select":i=Tt({},i,{value:void 0}),r=Tt({},r,{value:void 0}),s=[];break;case"textarea":i=mm(t,i),r=mm(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ff)}ym(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ku.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ku.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&ht("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};TS=function(t,e,n,r){n!==r&&(e.flags|=4)};function qc(t,e){if(!gt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function hn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function wD(t,e,n){var r=e.pendingProps;switch(dy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hn(e),null;case 1:return Bn(e.type)&&pf(),hn(e),null;case 3:return r=e.stateNode,ql(),ft(zn),ft(vn),Ey(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ud(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Gr!==null&&(Zm(Gr),Gr=null))),Hm(t,e),hn(e),null;case 5:wy(e);var i=sa(zu.current);if(n=e.type,t!==null&&e.stateNode!=null)ES(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Y(166));return hn(e),null}if(t=sa(Ti.current),ud(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[mi]=e,r[Uu]=s,t=(e.mode&1)!==0,n){case"dialog":ht("cancel",r),ht("close",r);break;case"iframe":case"object":case"embed":ht("load",r);break;case"video":case"audio":for(i=0;i<nu.length;i++)ht(nu[i],r);break;case"source":ht("error",r);break;case"img":case"image":case"link":ht("error",r),ht("load",r);break;case"details":ht("toggle",r);break;case"input":G0(r,s),ht("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ht("invalid",r);break;case"textarea":Y0(r,s),ht("invalid",r)}ym(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&cd(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&cd(r.textContent,a,t),i=["children",""+a]):ku.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ht("scroll",r)}switch(n){case"input":td(r),Q0(r,s,!0);break;case"textarea":td(r),X0(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=ff)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=YT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[mi]=e,t[Uu]=r,wS(t,e,!1,!1),e.stateNode=t;e:{switch(o=_m(n,r),n){case"dialog":ht("cancel",t),ht("close",t),i=r;break;case"iframe":case"object":case"embed":ht("load",t),i=r;break;case"video":case"audio":for(i=0;i<nu.length;i++)ht(nu[i],t);i=r;break;case"source":ht("error",t),i=r;break;case"img":case"image":case"link":ht("error",t),ht("load",t),i=r;break;case"details":ht("toggle",t),i=r;break;case"input":G0(t,r),i=fm(t,r),ht("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Tt({},r,{value:void 0}),ht("invalid",t);break;case"textarea":Y0(t,r),i=mm(t,r),ht("invalid",t);break;default:i=r}ym(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?ZT(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&XT(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Ru(t,l):typeof l=="number"&&Ru(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ku.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ht("scroll",t):l!=null&&Xv(t,s,l,o))}switch(n){case"input":td(t),Q0(t,r,!1);break;case"textarea":td(t),X0(t);break;case"option":r.value!=null&&t.setAttribute("value",""+fo(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Pl(t,!!r.multiple,s,!1):r.defaultValue!=null&&Pl(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ff)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return hn(e),null;case 6:if(t&&e.stateNode!=null)TS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Y(166));if(n=sa(zu.current),sa(Ti.current),ud(e)){if(r=e.stateNode,n=e.memoizedProps,r[mi]=e,(s=r.nodeValue!==n)&&(t=ir,t!==null))switch(t.tag){case 3:cd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&cd(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[mi]=e,e.stateNode=r}return hn(e),null;case 13:if(ft(yt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(gt&&tr!==null&&e.mode&1&&!(e.flags&128))UI(),zl(),e.flags|=98560,s=!1;else if(s=ud(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Y(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Y(317));s[mi]=e}else zl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;hn(e),s=!1}else Gr!==null&&(Zm(Gr),Gr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||yt.current&1?qt===0&&(qt=3):Oy())),e.updateQueue!==null&&(e.flags|=4),hn(e),null);case 4:return ql(),Hm(t,e),t===null&&ju(e.stateNode.containerInfo),hn(e),null;case 10:return my(e.type._context),hn(e),null;case 17:return Bn(e.type)&&pf(),hn(e),null;case 19:if(ft(yt),s=e.memoizedState,s===null)return hn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)qc(s,!1);else{if(qt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ef(t),o!==null){for(e.flags|=128,qc(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ct(yt,yt.current&1|2),e.child}t=t.sibling}s.tail!==null&&kt()>Wl&&(e.flags|=128,r=!0,qc(s,!1),e.lanes=4194304)}else{if(!r)if(t=Ef(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),qc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!gt)return hn(e),null}else 2*kt()-s.renderingStartTime>Wl&&n!==1073741824&&(e.flags|=128,r=!0,qc(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=kt(),e.sibling=null,n=yt.current,ct(yt,r?n&1|2:n&1),e):(hn(e),null);case 22:case 23:return Dy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?er&1073741824&&(hn(e),e.subtreeFlags&6&&(e.flags|=8192)):hn(e),null;case 24:return null;case 25:return null}throw Error(Y(156,e.tag))}function ED(t,e){switch(dy(e),e.tag){case 1:return Bn(e.type)&&pf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ql(),ft(zn),ft(vn),Ey(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return wy(e),null;case 13:if(ft(yt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Y(340));zl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ft(yt),null;case 4:return ql(),null;case 10:return my(e.type._context),null;case 22:case 23:return Dy(),null;case 24:return null;default:return null}}var fd=!1,gn=!1,TD=typeof WeakSet=="function"?WeakSet:Set,ie=null;function Cl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){bt(t,e,r)}else n.current=null}function Wm(t,e,n){try{n()}catch(r){bt(t,e,r)}}var Uw=!1;function ID(t,e){if(Pm=uf,t=AI(),uy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,p=t,m=null;t:for(;;){for(var w;p!==n||i!==0&&p.nodeType!==3||(a=o+i),p!==s||r!==0&&p.nodeType!==3||(l=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(w=p.firstChild)!==null;)m=p,p=w;for(;;){if(p===t)break t;if(m===n&&++u===i&&(a=o),m===s&&++d===r&&(l=o),(w=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=w}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(km={focusedElem:t,selectionRange:n},uf=!1,ie=e;ie!==null;)if(e=ie,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ie=t;else for(;ie!==null;){e=ie;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var x=E.memoizedProps,D=E.memoizedState,A=e.stateNode,T=A.getSnapshotBeforeUpdate(e.elementType===e.type?x:Wr(e.type,x),D);A.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Y(163))}}catch(M){bt(e,e.return,M)}if(t=e.sibling,t!==null){t.return=e.return,ie=t;break}ie=e.return}return E=Uw,Uw=!1,E}function yu(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Wm(e,n,s)}i=i.next}while(i!==r)}}function up(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Km(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function IS(t){var e=t.alternate;e!==null&&(t.alternate=null,IS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[mi],delete e[Uu],delete e[Om],delete e[sD],delete e[oD])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function SS(t){return t.tag===5||t.tag===3||t.tag===4}function $w(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||SS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Gm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ff));else if(r!==4&&(t=t.child,t!==null))for(Gm(t,e,n),t=t.sibling;t!==null;)Gm(t,e,n),t=t.sibling}function Qm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Qm(t,e,n),t=t.sibling;t!==null;)Qm(t,e,n),t=t.sibling}var tn=null,Kr=!1;function Rs(t,e,n){for(n=n.child;n!==null;)bS(t,e,n),n=n.sibling}function bS(t,e,n){if(Ei&&typeof Ei.onCommitFiberUnmount=="function")try{Ei.onCommitFiberUnmount(np,n)}catch{}switch(n.tag){case 5:gn||Cl(n,e);case 6:var r=tn,i=Kr;tn=null,Rs(t,e,n),tn=r,Kr=i,tn!==null&&(Kr?(t=tn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):tn.removeChild(n.stateNode));break;case 18:tn!==null&&(Kr?(t=tn,n=n.stateNode,t.nodeType===8?Cg(t.parentNode,n):t.nodeType===1&&Cg(t,n),Lu(t)):Cg(tn,n.stateNode));break;case 4:r=tn,i=Kr,tn=n.stateNode.containerInfo,Kr=!0,Rs(t,e,n),tn=r,Kr=i;break;case 0:case 11:case 14:case 15:if(!gn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Wm(n,e,o),i=i.next}while(i!==r)}Rs(t,e,n);break;case 1:if(!gn&&(Cl(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){bt(n,e,a)}Rs(t,e,n);break;case 21:Rs(t,e,n);break;case 22:n.mode&1?(gn=(r=gn)||n.memoizedState!==null,Rs(t,e,n),gn=r):Rs(t,e,n);break;default:Rs(t,e,n)}}function zw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new TD),e.forEach(function(r){var i=DD.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Hr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:tn=a.stateNode,Kr=!1;break e;case 3:tn=a.stateNode.containerInfo,Kr=!0;break e;case 4:tn=a.stateNode.containerInfo,Kr=!0;break e}a=a.return}if(tn===null)throw Error(Y(160));bS(s,o,i),tn=null,Kr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){bt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)CS(e,t),e=e.sibling}function CS(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Hr(e,t),pi(t),r&4){try{yu(3,t,t.return),up(3,t)}catch(x){bt(t,t.return,x)}try{yu(5,t,t.return)}catch(x){bt(t,t.return,x)}}break;case 1:Hr(e,t),pi(t),r&512&&n!==null&&Cl(n,n.return);break;case 5:if(Hr(e,t),pi(t),r&512&&n!==null&&Cl(n,n.return),t.flags&32){var i=t.stateNode;try{Ru(i,"")}catch(x){bt(t,t.return,x)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&GT(i,s),_m(a,o);var u=_m(a,s);for(o=0;o<l.length;o+=2){var d=l[o],p=l[o+1];d==="style"?ZT(i,p):d==="dangerouslySetInnerHTML"?XT(i,p):d==="children"?Ru(i,p):Xv(i,d,p,u)}switch(a){case"input":pm(i,s);break;case"textarea":QT(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var w=s.value;w!=null?Pl(i,!!s.multiple,w,!1):m!==!!s.multiple&&(s.defaultValue!=null?Pl(i,!!s.multiple,s.defaultValue,!0):Pl(i,!!s.multiple,s.multiple?[]:"",!1))}i[Uu]=s}catch(x){bt(t,t.return,x)}}break;case 6:if(Hr(e,t),pi(t),r&4){if(t.stateNode===null)throw Error(Y(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){bt(t,t.return,x)}}break;case 3:if(Hr(e,t),pi(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Lu(e.containerInfo)}catch(x){bt(t,t.return,x)}break;case 4:Hr(e,t),pi(t);break;case 13:Hr(e,t),pi(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(ky=kt())),r&4&&zw(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(gn=(u=gn)||d,Hr(e,t),gn=u):Hr(e,t),pi(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(ie=t,d=t.child;d!==null;){for(p=ie=d;ie!==null;){switch(m=ie,w=m.child,m.tag){case 0:case 11:case 14:case 15:yu(4,m,m.return);break;case 1:Cl(m,m.return);var E=m.stateNode;if(typeof E.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(x){bt(r,n,x)}}break;case 5:Cl(m,m.return);break;case 22:if(m.memoizedState!==null){qw(p);continue}}w!==null?(w.return=m,ie=w):qw(p)}d=d.sibling}e:for(d=null,p=t;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=JT("display",o))}catch(x){bt(t,t.return,x)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(x){bt(t,t.return,x)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Hr(e,t),pi(t),r&4&&zw(t);break;case 21:break;default:Hr(e,t),pi(t)}}function pi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(SS(n)){var r=n;break e}n=n.return}throw Error(Y(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ru(i,""),r.flags&=-33);var s=$w(t);Qm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=$w(t);Gm(t,a,o);break;default:throw Error(Y(161))}}catch(l){bt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function SD(t,e,n){ie=t,AS(t)}function AS(t,e,n){for(var r=(t.mode&1)!==0;ie!==null;){var i=ie,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||fd;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||gn;a=fd;var u=gn;if(fd=o,(gn=l)&&!u)for(ie=i;ie!==null;)o=ie,l=o.child,o.tag===22&&o.memoizedState!==null?Hw(i):l!==null?(l.return=o,ie=l):Hw(i);for(;s!==null;)ie=s,AS(s),s=s.sibling;ie=i,fd=a,gn=u}Bw(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ie=s):Bw(t)}}function Bw(t){for(;ie!==null;){var e=ie;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:gn||up(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!gn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Wr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Aw(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Aw(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&Lu(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Y(163))}gn||e.flags&512&&Km(e)}catch(m){bt(e,e.return,m)}}if(e===t){ie=null;break}if(n=e.sibling,n!==null){n.return=e.return,ie=n;break}ie=e.return}}function qw(t){for(;ie!==null;){var e=ie;if(e===t){ie=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ie=n;break}ie=e.return}}function Hw(t){for(;ie!==null;){var e=ie;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{up(4,e)}catch(l){bt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){bt(e,i,l)}}var s=e.return;try{Km(e)}catch(l){bt(e,s,l)}break;case 5:var o=e.return;try{Km(e)}catch(l){bt(e,o,l)}}}catch(l){bt(e,e.return,l)}if(e===t){ie=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ie=a;break}ie=e.return}}var bD=Math.ceil,Sf=ss.ReactCurrentDispatcher,xy=ss.ReactCurrentOwner,kr=ss.ReactCurrentBatchConfig,Fe=0,Zt=null,Lt=null,rn=0,er=0,Al=wo(0),qt=0,Wu=null,ma=0,hp=0,Py=0,_u=null,Un=null,ky=0,Wl=1/0,ji=null,bf=!1,Ym=null,ro=null,pd=!1,Qs=null,Cf=0,wu=0,Xm=null,Vd=-1,jd=0;function xn(){return Fe&6?kt():Vd!==-1?Vd:Vd=kt()}function io(t){return t.mode&1?Fe&2&&rn!==0?rn&-rn:lD.transition!==null?(jd===0&&(jd=hI()),jd):(t=Qe,t!==0||(t=window.event,t=t===void 0?16:yI(t.type)),t):1}function Xr(t,e,n,r){if(50<wu)throw wu=0,Xm=null,Error(Y(185));lh(t,n,r),(!(Fe&2)||t!==Zt)&&(t===Zt&&(!(Fe&2)&&(hp|=n),qt===4&&zs(t,rn)),qn(t,r),n===1&&Fe===0&&!(e.mode&1)&&(Wl=kt()+500,ap&&Eo()))}function qn(t,e){var n=t.callbackNode;lR(t,e);var r=cf(t,t===Zt?rn:0);if(r===0)n!==null&&ew(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&ew(n),e===1)t.tag===0?aD(Ww.bind(null,t)):VI(Ww.bind(null,t)),rD(function(){!(Fe&6)&&Eo()}),n=null;else{switch(dI(r)){case 1:n=ny;break;case 4:n=cI;break;case 16:n=lf;break;case 536870912:n=uI;break;default:n=lf}n=LS(n,xS.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function xS(t,e){if(Vd=-1,jd=0,Fe&6)throw Error(Y(327));var n=t.callbackNode;if(Nl()&&t.callbackNode!==n)return null;var r=cf(t,t===Zt?rn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Af(t,r);else{e=r;var i=Fe;Fe|=2;var s=kS();(Zt!==t||rn!==e)&&(ji=null,Wl=kt()+500,la(t,e));do try{xD();break}catch(a){PS(t,a)}while(!0);gy(),Sf.current=s,Fe=i,Lt!==null?e=0:(Zt=null,rn=0,e=qt)}if(e!==0){if(e===2&&(i=Sm(t),i!==0&&(r=i,e=Jm(t,i))),e===1)throw n=Wu,la(t,0),zs(t,r),qn(t,kt()),n;if(e===6)zs(t,r);else{if(i=t.current.alternate,!(r&30)&&!CD(i)&&(e=Af(t,r),e===2&&(s=Sm(t),s!==0&&(r=s,e=Jm(t,s))),e===1))throw n=Wu,la(t,0),zs(t,r),qn(t,kt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Y(345));case 2:Yo(t,Un,ji);break;case 3:if(zs(t,r),(r&130023424)===r&&(e=ky+500-kt(),10<e)){if(cf(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){xn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Dm(Yo.bind(null,t,Un,ji),e);break}Yo(t,Un,ji);break;case 4:if(zs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Yr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=kt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*bD(r/1960))-r,10<r){t.timeoutHandle=Dm(Yo.bind(null,t,Un,ji),r);break}Yo(t,Un,ji);break;case 5:Yo(t,Un,ji);break;default:throw Error(Y(329))}}}return qn(t,kt()),t.callbackNode===n?xS.bind(null,t):null}function Jm(t,e){var n=_u;return t.current.memoizedState.isDehydrated&&(la(t,e).flags|=256),t=Af(t,e),t!==2&&(e=Un,Un=n,e!==null&&Zm(e)),t}function Zm(t){Un===null?Un=t:Un.push.apply(Un,t)}function CD(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ei(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function zs(t,e){for(e&=~Py,e&=~hp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Yr(e),r=1<<n;t[n]=-1,e&=~r}}function Ww(t){if(Fe&6)throw Error(Y(327));Nl();var e=cf(t,0);if(!(e&1))return qn(t,kt()),null;var n=Af(t,e);if(t.tag!==0&&n===2){var r=Sm(t);r!==0&&(e=r,n=Jm(t,r))}if(n===1)throw n=Wu,la(t,0),zs(t,e),qn(t,kt()),n;if(n===6)throw Error(Y(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Yo(t,Un,ji),qn(t,kt()),null}function Ry(t,e){var n=Fe;Fe|=1;try{return t(e)}finally{Fe=n,Fe===0&&(Wl=kt()+500,ap&&Eo())}}function va(t){Qs!==null&&Qs.tag===0&&!(Fe&6)&&Nl();var e=Fe;Fe|=1;var n=kr.transition,r=Qe;try{if(kr.transition=null,Qe=1,t)return t()}finally{Qe=r,kr.transition=n,Fe=e,!(Fe&6)&&Eo()}}function Dy(){er=Al.current,ft(Al)}function la(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,nD(n)),Lt!==null)for(n=Lt.return;n!==null;){var r=n;switch(dy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&pf();break;case 3:ql(),ft(zn),ft(vn),Ey();break;case 5:wy(r);break;case 4:ql();break;case 13:ft(yt);break;case 19:ft(yt);break;case 10:my(r.type._context);break;case 22:case 23:Dy()}n=n.return}if(Zt=t,Lt=t=so(t.current,null),rn=er=e,qt=0,Wu=null,Py=hp=ma=0,Un=_u=null,ia!==null){for(e=0;e<ia.length;e++)if(n=ia[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}ia=null}return t}function PS(t,e){do{var n=Lt;try{if(gy(),Nd.current=If,Tf){for(var r=wt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Tf=!1}if(ga=0,Jt=Bt=wt=null,vu=!1,Bu=0,xy.current=null,n===null||n.return===null){qt=1,Wu=e,Lt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=rn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var w=Ow(o);if(w!==null){w.flags&=-257,Nw(w,o,a,s,e),w.mode&1&&Dw(s,u,e),e=w,l=u;var E=e.updateQueue;if(E===null){var x=new Set;x.add(l),e.updateQueue=x}else E.add(l);break e}else{if(!(e&1)){Dw(s,u,e),Oy();break e}l=Error(Y(426))}}else if(gt&&a.mode&1){var D=Ow(o);if(D!==null){!(D.flags&65536)&&(D.flags|=256),Nw(D,o,a,s,e),fy(Hl(l,a));break e}}s=l=Hl(l,a),qt!==4&&(qt=2),_u===null?_u=[s]:_u.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var A=dS(s,l,e);Cw(s,A);break e;case 1:a=l;var T=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof T.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(ro===null||!ro.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var M=fS(s,a,e);Cw(s,M);break e}}s=s.return}while(s!==null)}DS(n)}catch(q){e=q,Lt===n&&n!==null&&(Lt=n=n.return);continue}break}while(!0)}function kS(){var t=Sf.current;return Sf.current=If,t===null?If:t}function Oy(){(qt===0||qt===3||qt===2)&&(qt=4),Zt===null||!(ma&268435455)&&!(hp&268435455)||zs(Zt,rn)}function Af(t,e){var n=Fe;Fe|=2;var r=kS();(Zt!==t||rn!==e)&&(ji=null,la(t,e));do try{AD();break}catch(i){PS(t,i)}while(!0);if(gy(),Fe=n,Sf.current=r,Lt!==null)throw Error(Y(261));return Zt=null,rn=0,qt}function AD(){for(;Lt!==null;)RS(Lt)}function xD(){for(;Lt!==null&&!Zk();)RS(Lt)}function RS(t){var e=NS(t.alternate,t,er);t.memoizedProps=t.pendingProps,e===null?DS(t):Lt=e,xy.current=null}function DS(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=ED(n,e),n!==null){n.flags&=32767,Lt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{qt=6,Lt=null;return}}else if(n=wD(n,e,er),n!==null){Lt=n;return}if(e=e.sibling,e!==null){Lt=e;return}Lt=e=t}while(e!==null);qt===0&&(qt=5)}function Yo(t,e,n){var r=Qe,i=kr.transition;try{kr.transition=null,Qe=1,PD(t,e,n,r)}finally{kr.transition=i,Qe=r}return null}function PD(t,e,n,r){do Nl();while(Qs!==null);if(Fe&6)throw Error(Y(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Y(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(cR(t,s),t===Zt&&(Lt=Zt=null,rn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||pd||(pd=!0,LS(lf,function(){return Nl(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=kr.transition,kr.transition=null;var o=Qe;Qe=1;var a=Fe;Fe|=4,xy.current=null,ID(t,n),CS(n,t),QR(km),uf=!!Pm,km=Pm=null,t.current=n,SD(n),eR(),Fe=a,Qe=o,kr.transition=s}else t.current=n;if(pd&&(pd=!1,Qs=t,Cf=i),s=t.pendingLanes,s===0&&(ro=null),rR(n.stateNode),qn(t,kt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(bf)throw bf=!1,t=Ym,Ym=null,t;return Cf&1&&t.tag!==0&&Nl(),s=t.pendingLanes,s&1?t===Xm?wu++:(wu=0,Xm=t):wu=0,Eo(),null}function Nl(){if(Qs!==null){var t=dI(Cf),e=kr.transition,n=Qe;try{if(kr.transition=null,Qe=16>t?16:t,Qs===null)var r=!1;else{if(t=Qs,Qs=null,Cf=0,Fe&6)throw Error(Y(331));var i=Fe;for(Fe|=4,ie=t.current;ie!==null;){var s=ie,o=s.child;if(ie.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(ie=u;ie!==null;){var d=ie;switch(d.tag){case 0:case 11:case 15:yu(8,d,s)}var p=d.child;if(p!==null)p.return=d,ie=p;else for(;ie!==null;){d=ie;var m=d.sibling,w=d.return;if(IS(d),d===u){ie=null;break}if(m!==null){m.return=w,ie=m;break}ie=w}}}var E=s.alternate;if(E!==null){var x=E.child;if(x!==null){E.child=null;do{var D=x.sibling;x.sibling=null,x=D}while(x!==null)}}ie=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ie=o;else e:for(;ie!==null;){if(s=ie,s.flags&2048)switch(s.tag){case 0:case 11:case 15:yu(9,s,s.return)}var A=s.sibling;if(A!==null){A.return=s.return,ie=A;break e}ie=s.return}}var T=t.current;for(ie=T;ie!==null;){o=ie;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,ie=S;else e:for(o=T;ie!==null;){if(a=ie,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:up(9,a)}}catch(q){bt(a,a.return,q)}if(a===o){ie=null;break e}var M=a.sibling;if(M!==null){M.return=a.return,ie=M;break e}ie=a.return}}if(Fe=i,Eo(),Ei&&typeof Ei.onPostCommitFiberRoot=="function")try{Ei.onPostCommitFiberRoot(np,t)}catch{}r=!0}return r}finally{Qe=n,kr.transition=e}}return!1}function Kw(t,e,n){e=Hl(n,e),e=dS(t,e,1),t=no(t,e,1),e=xn(),t!==null&&(lh(t,1,e),qn(t,e))}function bt(t,e,n){if(t.tag===3)Kw(t,t,n);else for(;e!==null;){if(e.tag===3){Kw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ro===null||!ro.has(r))){t=Hl(n,t),t=fS(e,t,1),e=no(e,t,1),t=xn(),e!==null&&(lh(e,1,t),qn(e,t));break}}e=e.return}}function kD(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=xn(),t.pingedLanes|=t.suspendedLanes&n,Zt===t&&(rn&n)===n&&(qt===4||qt===3&&(rn&130023424)===rn&&500>kt()-ky?la(t,0):Py|=n),qn(t,e)}function OS(t,e){e===0&&(t.mode&1?(e=id,id<<=1,!(id&130023424)&&(id=4194304)):e=1);var n=xn();t=Ji(t,e),t!==null&&(lh(t,e,n),qn(t,n))}function RD(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),OS(t,n)}function DD(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Y(314))}r!==null&&r.delete(e),OS(t,n)}var NS;NS=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||zn.current)$n=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return $n=!1,_D(t,e,n);$n=!!(t.flags&131072)}else $n=!1,gt&&e.flags&1048576&&jI(e,vf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Md(t,e),t=e.pendingProps;var i=$l(e,vn.current);Ol(e,n),i=Iy(null,e,r,t,i,n);var s=Sy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Bn(r)?(s=!0,gf(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,yy(e),i.updater=cp,e.stateNode=i,i._reactInternals=e,Fm(e,r,t,n),e=zm(null,e,r,!0,s,n)):(e.tag=0,gt&&s&&hy(e),In(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Md(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=ND(r),t=Wr(r,t),i){case 0:e=$m(null,e,r,t,n);break e;case 1:e=Vw(null,e,r,t,n);break e;case 11:e=Lw(null,e,r,t,n);break e;case 14:e=Mw(null,e,r,Wr(r.type,t),n);break e}throw Error(Y(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wr(r,i),$m(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wr(r,i),Vw(t,e,r,i,n);case 3:e:{if(vS(e),t===null)throw Error(Y(387));r=e.pendingProps,s=e.memoizedState,i=s.element,qI(t,e),wf(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Hl(Error(Y(423)),e),e=jw(t,e,r,n,i);break e}else if(r!==i){i=Hl(Error(Y(424)),e),e=jw(t,e,r,n,i);break e}else for(tr=to(e.stateNode.containerInfo.firstChild),ir=e,gt=!0,Gr=null,n=zI(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(zl(),r===i){e=Zi(t,e,n);break e}In(t,e,r,n)}e=e.child}return e;case 5:return HI(e),t===null&&Mm(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Rm(r,i)?o=null:s!==null&&Rm(r,s)&&(e.flags|=32),mS(t,e),In(t,e,o,n),e.child;case 6:return t===null&&Mm(e),null;case 13:return yS(t,e,n);case 4:return _y(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Bl(e,null,r,n):In(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wr(r,i),Lw(t,e,r,i,n);case 7:return In(t,e,e.pendingProps,n),e.child;case 8:return In(t,e,e.pendingProps.children,n),e.child;case 12:return In(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,ct(yf,r._currentValue),r._currentValue=o,s!==null)if(ei(s.value,o)){if(s.children===i.children&&!zn.current){e=Zi(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Ki(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Vm(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Y(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Vm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}In(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ol(e,n),i=Or(i),r=r(i),e.flags|=1,In(t,e,r,n),e.child;case 14:return r=e.type,i=Wr(r,e.pendingProps),i=Wr(r.type,i),Mw(t,e,r,i,n);case 15:return pS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wr(r,i),Md(t,e),e.tag=1,Bn(r)?(t=!0,gf(e)):t=!1,Ol(e,n),hS(e,r,i),Fm(e,r,i,n),zm(null,e,r,!0,t,n);case 19:return _S(t,e,n);case 22:return gS(t,e,n)}throw Error(Y(156,e.tag))};function LS(t,e){return lI(t,e)}function OD(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xr(t,e,n,r){return new OD(t,e,n,r)}function Ny(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ND(t){if(typeof t=="function")return Ny(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Zv)return 11;if(t===ey)return 14}return 2}function so(t,e){var n=t.alternate;return n===null?(n=xr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Fd(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Ny(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case vl:return ca(n.children,i,s,e);case Jv:o=8,i|=8;break;case cm:return t=xr(12,n,e,i|2),t.elementType=cm,t.lanes=s,t;case um:return t=xr(13,n,e,i),t.elementType=um,t.lanes=s,t;case hm:return t=xr(19,n,e,i),t.elementType=hm,t.lanes=s,t;case HT:return dp(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case BT:o=10;break e;case qT:o=9;break e;case Zv:o=11;break e;case ey:o=14;break e;case js:o=16,r=null;break e}throw Error(Y(130,t==null?t:typeof t,""))}return e=xr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function ca(t,e,n,r){return t=xr(7,t,r,e),t.lanes=n,t}function dp(t,e,n,r){return t=xr(22,t,r,e),t.elementType=HT,t.lanes=n,t.stateNode={isHidden:!1},t}function Ng(t,e,n){return t=xr(6,t,null,e),t.lanes=n,t}function Lg(t,e,n){return e=xr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function LD(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gg(0),this.expirationTimes=gg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Ly(t,e,n,r,i,s,o,a,l){return t=new LD(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=xr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},yy(s),t}function MD(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ml,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function MS(t){if(!t)return po;t=t._reactInternals;e:{if(ka(t)!==t||t.tag!==1)throw Error(Y(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Bn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Y(171))}if(t.tag===1){var n=t.type;if(Bn(n))return MI(t,n,e)}return e}function VS(t,e,n,r,i,s,o,a,l){return t=Ly(n,r,!0,t,i,s,o,a,l),t.context=MS(null),n=t.current,r=xn(),i=io(n),s=Ki(r,i),s.callback=e??null,no(n,s,i),t.current.lanes=i,lh(t,i,r),qn(t,r),t}function fp(t,e,n,r){var i=e.current,s=xn(),o=io(i);return n=MS(n),e.context===null?e.context=n:e.pendingContext=n,e=Ki(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=no(i,e,o),t!==null&&(Xr(t,i,o,s),Od(t,i,o)),o}function xf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Gw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function My(t,e){Gw(t,e),(t=t.alternate)&&Gw(t,e)}function VD(){return null}var jS=typeof reportError=="function"?reportError:function(t){console.error(t)};function Vy(t){this._internalRoot=t}pp.prototype.render=Vy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Y(409));fp(t,e,null,null)};pp.prototype.unmount=Vy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;va(function(){fp(null,t,null,null)}),e[Xi]=null}};function pp(t){this._internalRoot=t}pp.prototype.unstable_scheduleHydration=function(t){if(t){var e=gI();t={blockedOn:null,target:t,priority:e};for(var n=0;n<$s.length&&e!==0&&e<$s[n].priority;n++);$s.splice(n,0,t),n===0&&vI(t)}};function jy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function gp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Qw(){}function jD(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=xf(o);s.call(u)}}var o=VS(e,r,t,0,null,!1,!1,"",Qw);return t._reactRootContainer=o,t[Xi]=o.current,ju(t.nodeType===8?t.parentNode:t),va(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=xf(l);a.call(u)}}var l=Ly(t,0,!1,null,null,!1,!1,"",Qw);return t._reactRootContainer=l,t[Xi]=l.current,ju(t.nodeType===8?t.parentNode:t),va(function(){fp(e,l,n,r)}),l}function mp(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=xf(o);a.call(l)}}fp(e,o,t,i)}else o=jD(n,e,t,i,r);return xf(o)}fI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=tu(e.pendingLanes);n!==0&&(ry(e,n|1),qn(e,kt()),!(Fe&6)&&(Wl=kt()+500,Eo()))}break;case 13:va(function(){var r=Ji(t,1);if(r!==null){var i=xn();Xr(r,t,1,i)}}),My(t,1)}};iy=function(t){if(t.tag===13){var e=Ji(t,134217728);if(e!==null){var n=xn();Xr(e,t,134217728,n)}My(t,134217728)}};pI=function(t){if(t.tag===13){var e=io(t),n=Ji(t,e);if(n!==null){var r=xn();Xr(n,t,e,r)}My(t,e)}};gI=function(){return Qe};mI=function(t,e){var n=Qe;try{return Qe=t,e()}finally{Qe=n}};Em=function(t,e,n){switch(e){case"input":if(pm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=op(r);if(!i)throw Error(Y(90));KT(r),pm(r,i)}}}break;case"textarea":QT(t,n);break;case"select":e=n.value,e!=null&&Pl(t,!!n.multiple,e,!1)}};nI=Ry;rI=va;var FD={usingClientEntryPoint:!1,Events:[uh,El,op,eI,tI,Ry]},Hc={findFiberByHostInstance:ra,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},UD={bundleType:Hc.bundleType,version:Hc.version,rendererPackageName:Hc.rendererPackageName,rendererConfig:Hc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ss.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=oI(t),t===null?null:t.stateNode},findFiberByHostInstance:Hc.findFiberByHostInstance||VD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gd.isDisabled&&gd.supportsFiber)try{np=gd.inject(UD),Ei=gd}catch{}}cr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FD;cr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jy(e))throw Error(Y(200));return MD(t,e,null,n)};cr.createRoot=function(t,e){if(!jy(t))throw Error(Y(299));var n=!1,r="",i=jS;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Ly(t,1,!1,null,null,n,!1,r,i),t[Xi]=e.current,ju(t.nodeType===8?t.parentNode:t),new Vy(e)};cr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Y(188)):(t=Object.keys(t).join(","),Error(Y(268,t)));return t=oI(e),t=t===null?null:t.stateNode,t};cr.flushSync=function(t){return va(t)};cr.hydrate=function(t,e,n){if(!gp(e))throw Error(Y(200));return mp(null,t,e,!0,n)};cr.hydrateRoot=function(t,e,n){if(!jy(t))throw Error(Y(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=jS;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=VS(e,null,t,1,n??null,i,!1,s,o),t[Xi]=e.current,ju(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new pp(e)};cr.render=function(t,e,n){if(!gp(e))throw Error(Y(200));return mp(null,t,e,!1,n)};cr.unmountComponentAtNode=function(t){if(!gp(t))throw Error(Y(40));return t._reactRootContainer?(va(function(){mp(null,null,t,!1,function(){t._reactRootContainer=null,t[Xi]=null})}),!0):!1};cr.unstable_batchedUpdates=Ry;cr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!gp(n))throw Error(Y(200));if(t==null||t._reactInternals===void 0)throw Error(Y(38));return mp(t,e,n,!1,r)};cr.version="18.3.1-next-f1338f8080-20240426";function FS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(FS)}catch(t){console.error(t)}}FS(),FT.exports=cr;var $D=FT.exports,US,Yw=$D;US=Yw.createRoot,Yw.hydrateRoot;var zD={exports:{}};/*!
  * Bootstrap v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(t,e){(function(n,r){t.exports=r()})(fk,function(){const n=new Map,r={set(_,h,g){n.has(_)||n.set(_,new Map);const I=n.get(_);I.has(h)||I.size===0?I.set(h,g):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(I.keys())[0]}.`)},get:(_,h)=>n.has(_)&&n.get(_).get(h)||null,remove(_,h){if(!n.has(_))return;const g=n.get(_);g.delete(h),g.size===0&&n.delete(_)}},i="transitionend",s=_=>(_&&window.CSS&&window.CSS.escape&&(_=_.replace(/#([^\s"#']+)/g,(h,g)=>`#${CSS.escape(g)}`)),_),o=_=>{_.dispatchEvent(new Event(i))},a=_=>!(!_||typeof _!="object")&&(_.jquery!==void 0&&(_=_[0]),_.nodeType!==void 0),l=_=>a(_)?_.jquery?_[0]:_:typeof _=="string"&&_.length>0?document.querySelector(s(_)):null,u=_=>{if(!a(_)||_.getClientRects().length===0)return!1;const h=getComputedStyle(_).getPropertyValue("visibility")==="visible",g=_.closest("details:not([open])");if(!g)return h;if(g!==_){const I=_.closest("summary");if(I&&I.parentNode!==g||I===null)return!1}return h},d=_=>!_||_.nodeType!==Node.ELEMENT_NODE||!!_.classList.contains("disabled")||(_.disabled!==void 0?_.disabled:_.hasAttribute("disabled")&&_.getAttribute("disabled")!=="false"),p=_=>{if(!document.documentElement.attachShadow)return null;if(typeof _.getRootNode=="function"){const h=_.getRootNode();return h instanceof ShadowRoot?h:null}return _ instanceof ShadowRoot?_:_.parentNode?p(_.parentNode):null},m=()=>{},w=_=>{_.offsetHeight},E=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,x=[],D=()=>document.documentElement.dir==="rtl",A=_=>{var h;h=()=>{const g=E();if(g){const I=_.NAME,j=g.fn[I];g.fn[I]=_.jQueryInterface,g.fn[I].Constructor=_,g.fn[I].noConflict=()=>(g.fn[I]=j,_.jQueryInterface)}},document.readyState==="loading"?(x.length||document.addEventListener("DOMContentLoaded",()=>{for(const g of x)g()}),x.push(h)):h()},T=(_,h=[],g=_)=>typeof _=="function"?_(...h):g,S=(_,h,g=!0)=>{if(!g)return void T(_);const I=(H=>{if(!H)return 0;let{transitionDuration:G,transitionDelay:Z}=window.getComputedStyle(H);const re=Number.parseFloat(G),oe=Number.parseFloat(Z);return re||oe?(G=G.split(",")[0],Z=Z.split(",")[0],1e3*(Number.parseFloat(G)+Number.parseFloat(Z))):0})(h)+5;let j=!1;const F=({target:H})=>{H===h&&(j=!0,h.removeEventListener(i,F),T(_))};h.addEventListener(i,F),setTimeout(()=>{j||o(h)},I)},M=(_,h,g,I)=>{const j=_.length;let F=_.indexOf(h);return F===-1?!g&&I?_[j-1]:_[0]:(F+=g?1:-1,I&&(F=(F+j)%j),_[Math.max(0,Math.min(F,j-1))])},q=/[^.]*(?=\..*)\.|.*/,W=/\..*/,P=/::\d+$/,C={};let R=1;const O={mouseenter:"mouseover",mouseleave:"mouseout"},L=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function V(_,h){return h&&`${h}::${R++}`||_.uidEvent||R++}function k(_){const h=V(_);return _.uidEvent=h,C[h]=C[h]||{},C[h]}function ge(_,h,g=null){return Object.values(_).find(I=>I.callable===h&&I.delegationSelector===g)}function Te(_,h,g){const I=typeof h=="string",j=I?g:h||g;let F=ae(_);return L.has(F)||(F=_),[I,j,F]}function Ie(_,h,g,I,j){if(typeof h!="string"||!_)return;let[F,H,G]=Te(h,g,I);h in O&&(H=(ye=>function(pe){if(!pe.relatedTarget||pe.relatedTarget!==pe.delegateTarget&&!pe.delegateTarget.contains(pe.relatedTarget))return ye.call(this,pe)})(H));const Z=k(_),re=Z[G]||(Z[G]={}),oe=ge(re,H,F?g:null);if(oe)return void(oe.oneOff=oe.oneOff&&j);const ee=V(H,h.replace(q,"")),Ce=F?function(he,ye,pe){return function _e(Ze){const ot=he.querySelectorAll(ye);for(let{target:ke}=Ze;ke&&ke!==this;ke=ke.parentNode)for(const ze of ot)if(ze===ke)return Le(Ze,{delegateTarget:ke}),_e.oneOff&&z.off(he,Ze.type,ye,pe),pe.apply(ke,[Ze])}}(_,g,H):function(he,ye){return function pe(_e){return Le(_e,{delegateTarget:he}),pe.oneOff&&z.off(he,_e.type,ye),ye.apply(he,[_e])}}(_,H);Ce.delegationSelector=F?g:null,Ce.callable=H,Ce.oneOff=j,Ce.uidEvent=ee,re[ee]=Ce,_.addEventListener(G,Ce,F)}function Se(_,h,g,I,j){const F=ge(h[g],I,j);F&&(_.removeEventListener(g,F,!!j),delete h[g][F.uidEvent])}function X(_,h,g,I){const j=h[g]||{};for(const[F,H]of Object.entries(j))F.includes(I)&&Se(_,h,g,H.callable,H.delegationSelector)}function ae(_){return _=_.replace(W,""),O[_]||_}const z={on(_,h,g,I){Ie(_,h,g,I,!1)},one(_,h,g,I){Ie(_,h,g,I,!0)},off(_,h,g,I){if(typeof h!="string"||!_)return;const[j,F,H]=Te(h,g,I),G=H!==h,Z=k(_),re=Z[H]||{},oe=h.startsWith(".");if(F===void 0){if(oe)for(const ee of Object.keys(Z))X(_,Z,ee,h.slice(1));for(const[ee,Ce]of Object.entries(re)){const he=ee.replace(P,"");G&&!h.includes(he)||Se(_,Z,H,Ce.callable,Ce.delegationSelector)}}else{if(!Object.keys(re).length)return;Se(_,Z,H,F,j?g:null)}},trigger(_,h,g){if(typeof h!="string"||!_)return null;const I=E();let j=null,F=!0,H=!0,G=!1;h!==ae(h)&&I&&(j=I.Event(h,g),I(_).trigger(j),F=!j.isPropagationStopped(),H=!j.isImmediatePropagationStopped(),G=j.isDefaultPrevented());const Z=Le(new Event(h,{bubbles:F,cancelable:!0}),g);return G&&Z.preventDefault(),H&&_.dispatchEvent(Z),Z.defaultPrevented&&j&&j.preventDefault(),Z}};function Le(_,h={}){for(const[g,I]of Object.entries(h))try{_[g]=I}catch{Object.defineProperty(_,g,{configurable:!0,get:()=>I})}return _}function Me(_){if(_==="true")return!0;if(_==="false")return!1;if(_===Number(_).toString())return Number(_);if(_===""||_==="null")return null;if(typeof _!="string")return _;try{return JSON.parse(decodeURIComponent(_))}catch{return _}}function Be(_){return _.replace(/[A-Z]/g,h=>`-${h.toLowerCase()}`)}const ut={setDataAttribute(_,h,g){_.setAttribute(`data-bs-${Be(h)}`,g)},removeDataAttribute(_,h){_.removeAttribute(`data-bs-${Be(h)}`)},getDataAttributes(_){if(!_)return{};const h={},g=Object.keys(_.dataset).filter(I=>I.startsWith("bs")&&!I.startsWith("bsConfig"));for(const I of g){let j=I.replace(/^bs/,"");j=j.charAt(0).toLowerCase()+j.slice(1,j.length),h[j]=Me(_.dataset[I])}return h},getDataAttribute:(_,h)=>Me(_.getAttribute(`data-bs-${Be(h)}`))};class jt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(h){return h=this._mergeConfigObj(h),h=this._configAfterMerge(h),this._typeCheckConfig(h),h}_configAfterMerge(h){return h}_mergeConfigObj(h,g){const I=a(g)?ut.getDataAttribute(g,"config"):{};return{...this.constructor.Default,...typeof I=="object"?I:{},...a(g)?ut.getDataAttributes(g):{},...typeof h=="object"?h:{}}}_typeCheckConfig(h,g=this.constructor.DefaultType){for(const[j,F]of Object.entries(g)){const H=h[j],G=a(H)?"element":(I=H)==null?`${I}`:Object.prototype.toString.call(I).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(F).test(G))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${j}" provided type "${G}" but expected type "${F}".`)}var I}}class nt extends jt{constructor(h,g){super(),(h=l(h))&&(this._element=h,this._config=this._getConfig(g),r.set(this._element,this.constructor.DATA_KEY,this))}dispose(){r.remove(this._element,this.constructor.DATA_KEY),z.off(this._element,this.constructor.EVENT_KEY);for(const h of Object.getOwnPropertyNames(this))this[h]=null}_queueCallback(h,g,I=!0){S(h,g,I)}_getConfig(h){return h=this._mergeConfigObj(h,this._element),h=this._configAfterMerge(h),this._typeCheckConfig(h),h}static getInstance(h){return r.get(l(h),this.DATA_KEY)}static getOrCreateInstance(h,g={}){return this.getInstance(h)||new this(h,typeof g=="object"?g:null)}static get VERSION(){return"5.3.3"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(h){return`${h}${this.EVENT_KEY}`}}const de=_=>{let h=_.getAttribute("data-bs-target");if(!h||h==="#"){let g=_.getAttribute("href");if(!g||!g.includes("#")&&!g.startsWith("."))return null;g.includes("#")&&!g.startsWith("#")&&(g=`#${g.split("#")[1]}`),h=g&&g!=="#"?g.trim():null}return h?h.split(",").map(g=>s(g)).join(","):null},se={find:(_,h=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(h,_)),findOne:(_,h=document.documentElement)=>Element.prototype.querySelector.call(h,_),children:(_,h)=>[].concat(..._.children).filter(g=>g.matches(h)),parents(_,h){const g=[];let I=_.parentNode.closest(h);for(;I;)g.push(I),I=I.parentNode.closest(h);return g},prev(_,h){let g=_.previousElementSibling;for(;g;){if(g.matches(h))return[g];g=g.previousElementSibling}return[]},next(_,h){let g=_.nextElementSibling;for(;g;){if(g.matches(h))return[g];g=g.nextElementSibling}return[]},focusableChildren(_){const h=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(g=>`${g}:not([tabindex^="-"])`).join(",");return this.find(h,_).filter(g=>!d(g)&&u(g))},getSelectorFromElement(_){const h=de(_);return h&&se.findOne(h)?h:null},getElementFromSelector(_){const h=de(_);return h?se.findOne(h):null},getMultipleElementsFromSelector(_){const h=de(_);return h?se.find(h):[]}},Wn=(_,h="hide")=>{const g=`click.dismiss${_.EVENT_KEY}`,I=_.NAME;z.on(document,g,`[data-bs-dismiss="${I}"]`,function(j){if(["A","AREA"].includes(this.tagName)&&j.preventDefault(),d(this))return;const F=se.getElementFromSelector(this)||this.closest(`.${I}`);_.getOrCreateInstance(F)[h]()})},Kn=".bs.alert",At=`close${Kn}`,Kt=`closed${Kn}`;class On extends nt{static get NAME(){return"alert"}close(){if(z.trigger(this._element,At).defaultPrevented)return;this._element.classList.remove("show");const h=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,h)}_destroyElement(){this._element.remove(),z.trigger(this._element,Kt),this.dispose()}static jQueryInterface(h){return this.each(function(){const g=On.getOrCreateInstance(this);if(typeof h=="string"){if(g[h]===void 0||h.startsWith("_")||h==="constructor")throw new TypeError(`No method named "${h}"`);g[h](this)}})}}Wn(On,"close"),A(On);const hs='[data-bs-toggle="button"]';class Gn extends nt{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(h){return this.each(function(){const g=Gn.getOrCreateInstance(this);h==="toggle"&&g[h]()})}}z.on(document,"click.bs.button.data-api",hs,_=>{_.preventDefault();const h=_.target.closest(hs);Gn.getOrCreateInstance(h).toggle()}),A(Gn);const on=".bs.swipe",mc=`touchstart${on}`,xo=`touchmove${on}`,ja=`touchend${on}`,ds=`pointerdown${on}`,Fa=`pointerup${on}`,Po={endCallback:null,leftCallback:null,rightCallback:null},fs={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class hr extends jt{constructor(h,g){super(),this._element=h,h&&hr.isSupported()&&(this._config=this._getConfig(g),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Po}static get DefaultType(){return fs}static get NAME(){return"swipe"}dispose(){z.off(this._element,on)}_start(h){this._supportPointerEvents?this._eventIsPointerPenTouch(h)&&(this._deltaX=h.clientX):this._deltaX=h.touches[0].clientX}_end(h){this._eventIsPointerPenTouch(h)&&(this._deltaX=h.clientX-this._deltaX),this._handleSwipe(),T(this._config.endCallback)}_move(h){this._deltaX=h.touches&&h.touches.length>1?0:h.touches[0].clientX-this._deltaX}_handleSwipe(){const h=Math.abs(this._deltaX);if(h<=40)return;const g=h/this._deltaX;this._deltaX=0,g&&T(g>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(z.on(this._element,ds,h=>this._start(h)),z.on(this._element,Fa,h=>this._end(h)),this._element.classList.add("pointer-event")):(z.on(this._element,mc,h=>this._start(h)),z.on(this._element,xo,h=>this._move(h)),z.on(this._element,ja,h=>this._end(h)))}_eventIsPointerPenTouch(h){return this._supportPointerEvents&&(h.pointerType==="pen"||h.pointerType==="touch")}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Dt=".bs.carousel",vt=".data-api",it="next",Qn="prev",Mr="left",Ci="right",ps=`slide${Dt}`,Yn=`slid${Dt}`,Ua=`keydown${Dt}`,Ai=`mouseenter${Dt}`,ri=`mouseleave${Dt}`,vc=`dragstart${Dt}`,yc=`load${Dt}${vt}`,ko=`click${Dt}${vt}`,Ro="carousel",Vr="active",ii=".active",gs=".carousel-item",Do=ii+gs,jr={ArrowLeft:Ci,ArrowRight:Mr},ms={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},vs={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Nn extends nt{constructor(h,g){super(h,g),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=se.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===Ro&&this.cycle()}static get Default(){return ms}static get DefaultType(){return vs}static get NAME(){return"carousel"}next(){this._slide(it)}nextWhenVisible(){!document.hidden&&u(this._element)&&this.next()}prev(){this._slide(Qn)}pause(){this._isSliding&&o(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?z.one(this._element,Yn,()=>this.cycle()):this.cycle())}to(h){const g=this._getItems();if(h>g.length-1||h<0)return;if(this._isSliding)return void z.one(this._element,Yn,()=>this.to(h));const I=this._getItemIndex(this._getActive());if(I===h)return;const j=h>I?it:Qn;this._slide(j,g[h])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(h){return h.defaultInterval=h.interval,h}_addEventListeners(){this._config.keyboard&&z.on(this._element,Ua,h=>this._keydown(h)),this._config.pause==="hover"&&(z.on(this._element,Ai,()=>this.pause()),z.on(this._element,ri,()=>this._maybeEnableCycle())),this._config.touch&&hr.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const g of se.find(".carousel-item img",this._element))z.on(g,vc,I=>I.preventDefault());const h={leftCallback:()=>this._slide(this._directionToOrder(Mr)),rightCallback:()=>this._slide(this._directionToOrder(Ci)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new hr(this._element,h)}_keydown(h){if(/input|textarea/i.test(h.target.tagName))return;const g=jr[h.key];g&&(h.preventDefault(),this._slide(this._directionToOrder(g)))}_getItemIndex(h){return this._getItems().indexOf(h)}_setActiveIndicatorElement(h){if(!this._indicatorsElement)return;const g=se.findOne(ii,this._indicatorsElement);g.classList.remove(Vr),g.removeAttribute("aria-current");const I=se.findOne(`[data-bs-slide-to="${h}"]`,this._indicatorsElement);I&&(I.classList.add(Vr),I.setAttribute("aria-current","true"))}_updateInterval(){const h=this._activeElement||this._getActive();if(!h)return;const g=Number.parseInt(h.getAttribute("data-bs-interval"),10);this._config.interval=g||this._config.defaultInterval}_slide(h,g=null){if(this._isSliding)return;const I=this._getActive(),j=h===it,F=g||M(this._getItems(),I,j,this._config.wrap);if(F===I)return;const H=this._getItemIndex(F),G=ee=>z.trigger(this._element,ee,{relatedTarget:F,direction:this._orderToDirection(h),from:this._getItemIndex(I),to:H});if(G(ps).defaultPrevented||!I||!F)return;const Z=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(H),this._activeElement=F;const re=j?"carousel-item-start":"carousel-item-end",oe=j?"carousel-item-next":"carousel-item-prev";F.classList.add(oe),w(F),I.classList.add(re),F.classList.add(re),this._queueCallback(()=>{F.classList.remove(re,oe),F.classList.add(Vr),I.classList.remove(Vr,oe,re),this._isSliding=!1,G(Yn)},I,this._isAnimated()),Z&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return se.findOne(Do,this._element)}_getItems(){return se.find(gs,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(h){return D()?h===Mr?Qn:it:h===Mr?it:Qn}_orderToDirection(h){return D()?h===Qn?Mr:Ci:h===Qn?Ci:Mr}static jQueryInterface(h){return this.each(function(){const g=Nn.getOrCreateInstance(this,h);if(typeof h!="number"){if(typeof h=="string"){if(g[h]===void 0||h.startsWith("_")||h==="constructor")throw new TypeError(`No method named "${h}"`);g[h]()}}else g.to(h)})}}z.on(document,ko,"[data-bs-slide], [data-bs-slide-to]",function(_){const h=se.getElementFromSelector(this);if(!h||!h.classList.contains(Ro))return;_.preventDefault();const g=Nn.getOrCreateInstance(h),I=this.getAttribute("data-bs-slide-to");return I?(g.to(I),void g._maybeEnableCycle()):ut.getDataAttribute(this,"slide")==="next"?(g.next(),void g._maybeEnableCycle()):(g.prev(),void g._maybeEnableCycle())}),z.on(window,yc,()=>{const _=se.find('[data-bs-ride="carousel"]');for(const h of _)Nn.getOrCreateInstance(h)}),A(Nn);const yn=".bs.collapse",$a=`show${yn}`,Ft=`shown${yn}`,za=`hide${yn}`,xi=`hidden${yn}`,Ue=`click${yn}.data-api`,Xe="show",xt="collapse",qe="collapsing",dr=`:scope .${xt} .${xt}`,en='[data-bs-toggle="collapse"]',ys={parent:null,toggle:!0},Ch={parent:"(null|element)",toggle:"boolean"};class si extends nt{constructor(h,g){super(h,g),this._isTransitioning=!1,this._triggerArray=[];const I=se.find(en);for(const j of I){const F=se.getSelectorFromElement(j),H=se.find(F).filter(G=>G===this._element);F!==null&&H.length&&this._triggerArray.push(j)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return ys}static get DefaultType(){return Ch}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let h=[];if(this._config.parent&&(h=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(j=>j!==this._element).map(j=>si.getOrCreateInstance(j,{toggle:!1}))),h.length&&h[0]._isTransitioning||z.trigger(this._element,$a).defaultPrevented)return;for(const j of h)j.hide();const g=this._getDimension();this._element.classList.remove(xt),this._element.classList.add(qe),this._element.style[g]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const I=`scroll${g[0].toUpperCase()+g.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(qe),this._element.classList.add(xt,Xe),this._element.style[g]="",z.trigger(this._element,Ft)},this._element,!0),this._element.style[g]=`${this._element[I]}px`}hide(){if(this._isTransitioning||!this._isShown()||z.trigger(this._element,za).defaultPrevented)return;const h=this._getDimension();this._element.style[h]=`${this._element.getBoundingClientRect()[h]}px`,w(this._element),this._element.classList.add(qe),this._element.classList.remove(xt,Xe);for(const g of this._triggerArray){const I=se.getElementFromSelector(g);I&&!this._isShown(I)&&this._addAriaAndCollapsedClass([g],!1)}this._isTransitioning=!0,this._element.style[h]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(qe),this._element.classList.add(xt),z.trigger(this._element,xi)},this._element,!0)}_isShown(h=this._element){return h.classList.contains(Xe)}_configAfterMerge(h){return h.toggle=!!h.toggle,h.parent=l(h.parent),h}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const h=this._getFirstLevelChildren(en);for(const g of h){const I=se.getElementFromSelector(g);I&&this._addAriaAndCollapsedClass([g],this._isShown(I))}}_getFirstLevelChildren(h){const g=se.find(dr,this._config.parent);return se.find(h,this._config.parent).filter(I=>!g.includes(I))}_addAriaAndCollapsedClass(h,g){if(h.length)for(const I of h)I.classList.toggle("collapsed",!g),I.setAttribute("aria-expanded",g)}static jQueryInterface(h){const g={};return typeof h=="string"&&/show|hide/.test(h)&&(g.toggle=!1),this.each(function(){const I=si.getOrCreateInstance(this,g);if(typeof h=="string"){if(I[h]===void 0)throw new TypeError(`No method named "${h}"`);I[h]()}})}}z.on(document,Ue,en,function(_){(_.target.tagName==="A"||_.delegateTarget&&_.delegateTarget.tagName==="A")&&_.preventDefault();for(const h of se.getMultipleElementsFromSelector(this))si.getOrCreateInstance(h,{toggle:!1}).toggle()}),A(si);var Ot="top",It="bottom",an="right",Gt="left",_s="auto",oi=[Ot,It,an,Gt],ai="start",Pi="end",Ah="clippingParents",ws="viewport",ki="popper",Ba="reference",Ri=oi.reduce(function(_,h){return _.concat([h+"-"+ai,h+"-"+Pi])},[]),Fr=[].concat(oi,[_s]).reduce(function(_,h){return _.concat([h,h+"-"+ai,h+"-"+Pi])},[]),qa="beforeRead",xh="read",_c="afterRead",wc="beforeMain",Ec="main",Ha="afterMain",Wa="beforeWrite",Tc="write",Ic="afterWrite",Ph=[qa,xh,_c,wc,Ec,Ha,Wa,Tc,Ic];function fr(_){return _?(_.nodeName||"").toLowerCase():null}function ln(_){if(_==null)return window;if(_.toString()!=="[object Window]"){var h=_.ownerDocument;return h&&h.defaultView||window}return _}function li(_){return _ instanceof ln(_).Element||_ instanceof Element}function Ln(_){return _ instanceof ln(_).HTMLElement||_ instanceof HTMLElement}function Ur(_){return typeof ShadowRoot<"u"&&(_ instanceof ln(_).ShadowRoot||_ instanceof ShadowRoot)}const Xn={name:"applyStyles",enabled:!0,phase:"write",fn:function(_){var h=_.state;Object.keys(h.elements).forEach(function(g){var I=h.styles[g]||{},j=h.attributes[g]||{},F=h.elements[g];Ln(F)&&fr(F)&&(Object.assign(F.style,I),Object.keys(j).forEach(function(H){var G=j[H];G===!1?F.removeAttribute(H):F.setAttribute(H,G===!0?"":G)}))})},effect:function(_){var h=_.state,g={popper:{position:h.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(h.elements.popper.style,g.popper),h.styles=g,h.elements.arrow&&Object.assign(h.elements.arrow.style,g.arrow),function(){Object.keys(h.elements).forEach(function(I){var j=h.elements[I],F=h.attributes[I]||{},H=Object.keys(h.styles.hasOwnProperty(I)?h.styles[I]:g[I]).reduce(function(G,Z){return G[Z]="",G},{});Ln(j)&&fr(j)&&(Object.assign(j.style,H),Object.keys(F).forEach(function(G){j.removeAttribute(G)}))})}},requires:["computeStyles"]};function _n(_){return _.split("-")[0]}var pr=Math.max,Oo=Math.min,$e=Math.round;function Es(){var _=navigator.userAgentData;return _!=null&&_.brands&&Array.isArray(_.brands)?_.brands.map(function(h){return h.brand+"/"+h.version}).join(" "):navigator.userAgent}function Ts(){return!/^((?!chrome|android).)*safari/i.test(Es())}function gr(_,h,g){h===void 0&&(h=!1),g===void 0&&(g=!1);var I=_.getBoundingClientRect(),j=1,F=1;h&&Ln(_)&&(j=_.offsetWidth>0&&$e(I.width)/_.offsetWidth||1,F=_.offsetHeight>0&&$e(I.height)/_.offsetHeight||1);var H=(li(_)?ln(_):window).visualViewport,G=!Ts()&&g,Z=(I.left+(G&&H?H.offsetLeft:0))/j,re=(I.top+(G&&H?H.offsetTop:0))/F,oe=I.width/j,ee=I.height/F;return{width:oe,height:ee,top:re,right:Z+oe,bottom:re+ee,left:Z,x:Z,y:re}}function Sc(_){var h=gr(_),g=_.offsetWidth,I=_.offsetHeight;return Math.abs(h.width-g)<=1&&(g=h.width),Math.abs(h.height-I)<=1&&(I=h.height),{x:_.offsetLeft,y:_.offsetTop,width:g,height:I}}function bc(_,h){var g=h.getRootNode&&h.getRootNode();if(_.contains(h))return!0;if(g&&Ur(g)){var I=h;do{if(I&&_.isSameNode(I))return!0;I=I.parentNode||I.host}while(I)}return!1}function $r(_){return ln(_).getComputedStyle(_)}function Qp(_){return["table","td","th"].indexOf(fr(_))>=0}function ci(_){return((li(_)?_.ownerDocument:_.document)||window.document).documentElement}function Ka(_){return fr(_)==="html"?_:_.assignedSlot||_.parentNode||(Ur(_)?_.host:null)||ci(_)}function Is(_){return Ln(_)&&$r(_).position!=="fixed"?_.offsetParent:null}function Mn(_){for(var h=ln(_),g=Is(_);g&&Qp(g)&&$r(g).position==="static";)g=Is(g);return g&&(fr(g)==="html"||fr(g)==="body"&&$r(g).position==="static")?h:g||function(I){var j=/firefox/i.test(Es());if(/Trident/i.test(Es())&&Ln(I)&&$r(I).position==="fixed")return null;var F=Ka(I);for(Ur(F)&&(F=F.host);Ln(F)&&["html","body"].indexOf(fr(F))<0;){var H=$r(F);if(H.transform!=="none"||H.perspective!=="none"||H.contain==="paint"||["transform","perspective"].indexOf(H.willChange)!==-1||j&&H.willChange==="filter"||j&&H.filter&&H.filter!=="none")return F;F=F.parentNode}return null}(_)||h}function Ga(_){return["top","bottom"].indexOf(_)>=0?"x":"y"}function Ss(_,h,g){return pr(_,Oo(h,g))}function Cc(_){return Object.assign({},{top:0,right:0,bottom:0,left:0},_)}function Di(_,h){return h.reduce(function(g,I){return g[I]=_,g},{})}const kh={name:"arrow",enabled:!0,phase:"main",fn:function(_){var h,g=_.state,I=_.name,j=_.options,F=g.elements.arrow,H=g.modifiersData.popperOffsets,G=_n(g.placement),Z=Ga(G),re=[Gt,an].indexOf(G)>=0?"height":"width";if(F&&H){var oe=function(et,Ke){return Cc(typeof(et=typeof et=="function"?et(Object.assign({},Ke.rects,{placement:Ke.placement})):et)!="number"?et:Di(et,oi))}(j.padding,g),ee=Sc(F),Ce=Z==="y"?Ot:Gt,he=Z==="y"?It:an,ye=g.rects.reference[re]+g.rects.reference[Z]-H[Z]-g.rects.popper[re],pe=H[Z]-g.rects.reference[Z],_e=Mn(F),Ze=_e?Z==="y"?_e.clientHeight||0:_e.clientWidth||0:0,ot=ye/2-pe/2,ke=oe[Ce],ze=Ze-ee[re]-oe[he],Ae=Ze/2-ee[re]/2+ot,Oe=Ss(ke,Ae,ze),We=Z;g.modifiersData[I]=((h={})[We]=Oe,h.centerOffset=Oe-Ae,h)}},effect:function(_){var h=_.state,g=_.options.element,I=g===void 0?"[data-popper-arrow]":g;I!=null&&(typeof I!="string"||(I=h.elements.popper.querySelector(I)))&&bc(h.elements.popper,I)&&(h.elements.arrow=I)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function bs(_){return _.split("-")[1]}var Yp={top:"auto",right:"auto",bottom:"auto",left:"auto"};function zr(_){var h,g=_.popper,I=_.popperRect,j=_.placement,F=_.variation,H=_.offsets,G=_.position,Z=_.gpuAcceleration,re=_.adaptive,oe=_.roundOffsets,ee=_.isFixed,Ce=H.x,he=Ce===void 0?0:Ce,ye=H.y,pe=ye===void 0?0:ye,_e=typeof oe=="function"?oe({x:he,y:pe}):{x:he,y:pe};he=_e.x,pe=_e.y;var Ze=H.hasOwnProperty("x"),ot=H.hasOwnProperty("y"),ke=Gt,ze=Ot,Ae=window;if(re){var Oe=Mn(g),We="clientHeight",et="clientWidth";Oe===ln(g)&&$r(Oe=ci(g)).position!=="static"&&G==="absolute"&&(We="scrollHeight",et="scrollWidth"),(j===Ot||(j===Gt||j===an)&&F===Pi)&&(ze=It,pe-=(ee&&Oe===Ae&&Ae.visualViewport?Ae.visualViewport.height:Oe[We])-I.height,pe*=Z?1:-1),j!==Gt&&(j!==Ot&&j!==It||F!==Pi)||(ke=an,he-=(ee&&Oe===Ae&&Ae.visualViewport?Ae.visualViewport.width:Oe[et])-I.width,he*=Z?1:-1)}var Ke,Pt=Object.assign({position:G},re&&Yp),Jn=oe===!0?function(qr,wn){var _r=qr.x,wr=qr.y,St=wn.devicePixelRatio||1;return{x:$e(_r*St)/St||0,y:$e(wr*St)/St||0}}({x:he,y:pe},ln(g)):{x:he,y:pe};return he=Jn.x,pe=Jn.y,Z?Object.assign({},Pt,((Ke={})[ze]=ot?"0":"",Ke[ke]=Ze?"0":"",Ke.transform=(Ae.devicePixelRatio||1)<=1?"translate("+he+"px, "+pe+"px)":"translate3d("+he+"px, "+pe+"px, 0)",Ke)):Object.assign({},Pt,((h={})[ze]=ot?pe+"px":"",h[ke]=Ze?he+"px":"",h.transform="",h))}const Ac={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(_){var h=_.state,g=_.options,I=g.gpuAcceleration,j=I===void 0||I,F=g.adaptive,H=F===void 0||F,G=g.roundOffsets,Z=G===void 0||G,re={placement:_n(h.placement),variation:bs(h.placement),popper:h.elements.popper,popperRect:h.rects.popper,gpuAcceleration:j,isFixed:h.options.strategy==="fixed"};h.modifiersData.popperOffsets!=null&&(h.styles.popper=Object.assign({},h.styles.popper,zr(Object.assign({},re,{offsets:h.modifiersData.popperOffsets,position:h.options.strategy,adaptive:H,roundOffsets:Z})))),h.modifiersData.arrow!=null&&(h.styles.arrow=Object.assign({},h.styles.arrow,zr(Object.assign({},re,{offsets:h.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:Z})))),h.attributes.popper=Object.assign({},h.attributes.popper,{"data-popper-placement":h.placement})},data:{}};var Qa={passive:!0};const Cs={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(_){var h=_.state,g=_.instance,I=_.options,j=I.scroll,F=j===void 0||j,H=I.resize,G=H===void 0||H,Z=ln(h.elements.popper),re=[].concat(h.scrollParents.reference,h.scrollParents.popper);return F&&re.forEach(function(oe){oe.addEventListener("scroll",g.update,Qa)}),G&&Z.addEventListener("resize",g.update,Qa),function(){F&&re.forEach(function(oe){oe.removeEventListener("scroll",g.update,Qa)}),G&&Z.removeEventListener("resize",g.update,Qa)}},data:{}};var Ya={left:"right",right:"left",bottom:"top",top:"bottom"};function No(_){return _.replace(/left|right|bottom|top/g,function(h){return Ya[h]})}var Lo={start:"end",end:"start"};function As(_){return _.replace(/start|end/g,function(h){return Lo[h]})}function Xa(_){var h=ln(_);return{scrollLeft:h.pageXOffset,scrollTop:h.pageYOffset}}function Mo(_){return gr(ci(_)).left+Xa(_).scrollLeft}function st(_){var h=$r(_),g=h.overflow,I=h.overflowX,j=h.overflowY;return/auto|scroll|overlay|hidden/.test(g+j+I)}function Rh(_){return["html","body","#document"].indexOf(fr(_))>=0?_.ownerDocument.body:Ln(_)&&st(_)?_:Rh(Ka(_))}function Vo(_,h){var g;h===void 0&&(h=[]);var I=Rh(_),j=I===((g=_.ownerDocument)==null?void 0:g.body),F=ln(I),H=j?[F].concat(F.visualViewport||[],st(I)?I:[]):I,G=h.concat(H);return j?G:G.concat(Vo(Ka(H)))}function Ja(_){return Object.assign({},_,{left:_.x,top:_.y,right:_.x+_.width,bottom:_.y+_.height})}function xc(_,h,g){return h===ws?Ja(function(I,j){var F=ln(I),H=ci(I),G=F.visualViewport,Z=H.clientWidth,re=H.clientHeight,oe=0,ee=0;if(G){Z=G.width,re=G.height;var Ce=Ts();(Ce||!Ce&&j==="fixed")&&(oe=G.offsetLeft,ee=G.offsetTop)}return{width:Z,height:re,x:oe+Mo(I),y:ee}}(_,g)):li(h)?function(I,j){var F=gr(I,!1,j==="fixed");return F.top=F.top+I.clientTop,F.left=F.left+I.clientLeft,F.bottom=F.top+I.clientHeight,F.right=F.left+I.clientWidth,F.width=I.clientWidth,F.height=I.clientHeight,F.x=F.left,F.y=F.top,F}(h,g):Ja(function(I){var j,F=ci(I),H=Xa(I),G=(j=I.ownerDocument)==null?void 0:j.body,Z=pr(F.scrollWidth,F.clientWidth,G?G.scrollWidth:0,G?G.clientWidth:0),re=pr(F.scrollHeight,F.clientHeight,G?G.scrollHeight:0,G?G.clientHeight:0),oe=-H.scrollLeft+Mo(I),ee=-H.scrollTop;return $r(G||F).direction==="rtl"&&(oe+=pr(F.clientWidth,G?G.clientWidth:0)-Z),{width:Z,height:re,x:oe,y:ee}}(ci(_)))}function Pc(_){var h,g=_.reference,I=_.element,j=_.placement,F=j?_n(j):null,H=j?bs(j):null,G=g.x+g.width/2-I.width/2,Z=g.y+g.height/2-I.height/2;switch(F){case Ot:h={x:G,y:g.y-I.height};break;case It:h={x:G,y:g.y+g.height};break;case an:h={x:g.x+g.width,y:Z};break;case Gt:h={x:g.x-I.width,y:Z};break;default:h={x:g.x,y:g.y}}var re=F?Ga(F):null;if(re!=null){var oe=re==="y"?"height":"width";switch(H){case ai:h[re]=h[re]-(g[oe]/2-I[oe]/2);break;case Pi:h[re]=h[re]+(g[oe]/2-I[oe]/2)}}return h}function Br(_,h){h===void 0&&(h={});var g=h,I=g.placement,j=I===void 0?_.placement:I,F=g.strategy,H=F===void 0?_.strategy:F,G=g.boundary,Z=G===void 0?Ah:G,re=g.rootBoundary,oe=re===void 0?ws:re,ee=g.elementContext,Ce=ee===void 0?ki:ee,he=g.altBoundary,ye=he!==void 0&&he,pe=g.padding,_e=pe===void 0?0:pe,Ze=Cc(typeof _e!="number"?_e:Di(_e,oi)),ot=Ce===ki?Ba:ki,ke=_.rects.popper,ze=_.elements[ye?ot:Ce],Ae=function(wn,_r,wr,St){var di=_r==="clippingParents"?function(rt){var En=Vo(Ka(rt)),Er=["absolute","fixed"].indexOf($r(rt).position)>=0&&Ln(rt)?Mn(rt):rt;return li(Er)?En.filter(function(ks){return li(ks)&&bc(ks,Er)&&fr(ks)!=="body"}):[]}(wn):[].concat(_r),fi=[].concat(di,[wr]),il=fi[0],Qt=fi.reduce(function(rt,En){var Er=xc(wn,En,St);return rt.top=pr(Er.top,rt.top),rt.right=Oo(Er.right,rt.right),rt.bottom=Oo(Er.bottom,rt.bottom),rt.left=pr(Er.left,rt.left),rt},xc(wn,il,St));return Qt.width=Qt.right-Qt.left,Qt.height=Qt.bottom-Qt.top,Qt.x=Qt.left,Qt.y=Qt.top,Qt}(li(ze)?ze:ze.contextElement||ci(_.elements.popper),Z,oe,H),Oe=gr(_.elements.reference),We=Pc({reference:Oe,element:ke,placement:j}),et=Ja(Object.assign({},ke,We)),Ke=Ce===ki?et:Oe,Pt={top:Ae.top-Ke.top+Ze.top,bottom:Ke.bottom-Ae.bottom+Ze.bottom,left:Ae.left-Ke.left+Ze.left,right:Ke.right-Ae.right+Ze.right},Jn=_.modifiersData.offset;if(Ce===ki&&Jn){var qr=Jn[j];Object.keys(Pt).forEach(function(wn){var _r=[an,It].indexOf(wn)>=0?1:-1,wr=[Ot,It].indexOf(wn)>=0?"y":"x";Pt[wn]+=qr[wr]*_r})}return Pt}function Dh(_,h){h===void 0&&(h={});var g=h,I=g.placement,j=g.boundary,F=g.rootBoundary,H=g.padding,G=g.flipVariations,Z=g.allowedAutoPlacements,re=Z===void 0?Fr:Z,oe=bs(I),ee=oe?G?Ri:Ri.filter(function(ye){return bs(ye)===oe}):oi,Ce=ee.filter(function(ye){return re.indexOf(ye)>=0});Ce.length===0&&(Ce=ee);var he=Ce.reduce(function(ye,pe){return ye[pe]=Br(_,{placement:pe,boundary:j,rootBoundary:F,padding:H})[_n(pe)],ye},{});return Object.keys(he).sort(function(ye,pe){return he[ye]-he[pe]})}const mr={name:"flip",enabled:!0,phase:"main",fn:function(_){var h=_.state,g=_.options,I=_.name;if(!h.modifiersData[I]._skip){for(var j=g.mainAxis,F=j===void 0||j,H=g.altAxis,G=H===void 0||H,Z=g.fallbackPlacements,re=g.padding,oe=g.boundary,ee=g.rootBoundary,Ce=g.altBoundary,he=g.flipVariations,ye=he===void 0||he,pe=g.allowedAutoPlacements,_e=h.options.placement,Ze=_n(_e),ot=Z||(Ze!==_e&&ye?function(rt){if(_n(rt)===_s)return[];var En=No(rt);return[As(rt),En,As(En)]}(_e):[No(_e)]),ke=[_e].concat(ot).reduce(function(rt,En){return rt.concat(_n(En)===_s?Dh(h,{placement:En,boundary:oe,rootBoundary:ee,padding:re,flipVariations:ye,allowedAutoPlacements:pe}):En)},[]),ze=h.rects.reference,Ae=h.rects.popper,Oe=new Map,We=!0,et=ke[0],Ke=0;Ke<ke.length;Ke++){var Pt=ke[Ke],Jn=_n(Pt),qr=bs(Pt)===ai,wn=[Ot,It].indexOf(Jn)>=0,_r=wn?"width":"height",wr=Br(h,{placement:Pt,boundary:oe,rootBoundary:ee,altBoundary:Ce,padding:re}),St=wn?qr?an:Gt:qr?It:Ot;ze[_r]>Ae[_r]&&(St=No(St));var di=No(St),fi=[];if(F&&fi.push(wr[Jn]<=0),G&&fi.push(wr[St]<=0,wr[di]<=0),fi.every(function(rt){return rt})){et=Pt,We=!1;break}Oe.set(Pt,fi)}if(We)for(var il=function(rt){var En=ke.find(function(Er){var ks=Oe.get(Er);if(ks)return ks.slice(0,rt).every(function(Yh){return Yh})});if(En)return et=En,"break"},Qt=ye?3:1;Qt>0&&il(Qt)!=="break";Qt--);h.placement!==et&&(h.modifiersData[I]._skip=!0,h.placement=et,h.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function kc(_,h,g){return g===void 0&&(g={x:0,y:0}),{top:_.top-h.height-g.y,right:_.right-h.width+g.x,bottom:_.bottom-h.height+g.y,left:_.left-h.width-g.x}}function Oh(_){return[Ot,an,It,Gt].some(function(h){return _[h]>=0})}const xs={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(_){var h=_.state,g=_.name,I=h.rects.reference,j=h.rects.popper,F=h.modifiersData.preventOverflow,H=Br(h,{elementContext:"reference"}),G=Br(h,{altBoundary:!0}),Z=kc(H,I),re=kc(G,j,F),oe=Oh(Z),ee=Oh(re);h.modifiersData[g]={referenceClippingOffsets:Z,popperEscapeOffsets:re,isReferenceHidden:oe,hasPopperEscaped:ee},h.attributes.popper=Object.assign({},h.attributes.popper,{"data-popper-reference-hidden":oe,"data-popper-escaped":ee})}},Rc={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(_){var h=_.state,g=_.options,I=_.name,j=g.offset,F=j===void 0?[0,0]:j,H=Fr.reduce(function(oe,ee){return oe[ee]=function(Ce,he,ye){var pe=_n(Ce),_e=[Gt,Ot].indexOf(pe)>=0?-1:1,Ze=typeof ye=="function"?ye(Object.assign({},he,{placement:Ce})):ye,ot=Ze[0],ke=Ze[1];return ot=ot||0,ke=(ke||0)*_e,[Gt,an].indexOf(pe)>=0?{x:ke,y:ot}:{x:ot,y:ke}}(ee,h.rects,F),oe},{}),G=H[h.placement],Z=G.x,re=G.y;h.modifiersData.popperOffsets!=null&&(h.modifiersData.popperOffsets.x+=Z,h.modifiersData.popperOffsets.y+=re),h.modifiersData[I]=H}},jo={name:"popperOffsets",enabled:!0,phase:"read",fn:function(_){var h=_.state,g=_.name;h.modifiersData[g]=Pc({reference:h.rects.reference,element:h.rects.popper,placement:h.placement})},data:{}},Fo={name:"preventOverflow",enabled:!0,phase:"main",fn:function(_){var h=_.state,g=_.options,I=_.name,j=g.mainAxis,F=j===void 0||j,H=g.altAxis,G=H!==void 0&&H,Z=g.boundary,re=g.rootBoundary,oe=g.altBoundary,ee=g.padding,Ce=g.tether,he=Ce===void 0||Ce,ye=g.tetherOffset,pe=ye===void 0?0:ye,_e=Br(h,{boundary:Z,rootBoundary:re,padding:ee,altBoundary:oe}),Ze=_n(h.placement),ot=bs(h.placement),ke=!ot,ze=Ga(Ze),Ae=ze==="x"?"y":"x",Oe=h.modifiersData.popperOffsets,We=h.rects.reference,et=h.rects.popper,Ke=typeof pe=="function"?pe(Object.assign({},h.rects,{placement:h.placement})):pe,Pt=typeof Ke=="number"?{mainAxis:Ke,altAxis:Ke}:Object.assign({mainAxis:0,altAxis:0},Ke),Jn=h.modifiersData.offset?h.modifiersData.offset[h.placement]:null,qr={x:0,y:0};if(Oe){if(F){var wn,_r=ze==="y"?Ot:Gt,wr=ze==="y"?It:an,St=ze==="y"?"height":"width",di=Oe[ze],fi=di+_e[_r],il=di-_e[wr],Qt=he?-et[St]/2:0,rt=ot===ai?We[St]:et[St],En=ot===ai?-et[St]:-We[St],Er=h.elements.arrow,ks=he&&Er?Sc(Er):{width:0,height:0},Yh=h.modifiersData["arrow#persistent"]?h.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},k0=Yh[_r],R0=Yh[wr],Xh=Ss(0,We[St],ks[St]),nk=ke?We[St]/2-Qt-Xh-k0-Pt.mainAxis:rt-Xh-k0-Pt.mainAxis,rk=ke?-We[St]/2+Qt+Xh+R0+Pt.mainAxis:En+Xh+R0+Pt.mainAxis,ag=h.elements.arrow&&Mn(h.elements.arrow),ik=ag?ze==="y"?ag.clientTop||0:ag.clientLeft||0:0,D0=(wn=Jn==null?void 0:Jn[ze])!=null?wn:0,sk=di+rk-D0,O0=Ss(he?Oo(fi,di+nk-D0-ik):fi,di,he?pr(il,sk):il);Oe[ze]=O0,qr[ze]=O0-di}if(G){var N0,ok=ze==="x"?Ot:Gt,ak=ze==="x"?It:an,Ko=Oe[Ae],Jh=Ae==="y"?"height":"width",L0=Ko+_e[ok],M0=Ko-_e[ak],lg=[Ot,Gt].indexOf(Ze)!==-1,V0=(N0=Jn==null?void 0:Jn[Ae])!=null?N0:0,j0=lg?L0:Ko-We[Jh]-et[Jh]-V0+Pt.altAxis,F0=lg?Ko+We[Jh]+et[Jh]-V0-Pt.altAxis:M0,U0=he&&lg?function(lk,ck,cg){var $0=Ss(lk,ck,cg);return $0>cg?cg:$0}(j0,Ko,F0):Ss(he?j0:L0,Ko,he?F0:M0);Oe[Ae]=U0,qr[Ae]=U0-Ko}h.modifiersData[I]=qr}},requiresIfExists:["offset"]};function Nh(_,h,g){g===void 0&&(g=!1);var I,j,F=Ln(h),H=Ln(h)&&function(ee){var Ce=ee.getBoundingClientRect(),he=$e(Ce.width)/ee.offsetWidth||1,ye=$e(Ce.height)/ee.offsetHeight||1;return he!==1||ye!==1}(h),G=ci(h),Z=gr(_,H,g),re={scrollLeft:0,scrollTop:0},oe={x:0,y:0};return(F||!F&&!g)&&((fr(h)!=="body"||st(G))&&(re=(I=h)!==ln(I)&&Ln(I)?{scrollLeft:(j=I).scrollLeft,scrollTop:j.scrollTop}:Xa(I)),Ln(h)?((oe=gr(h,!0)).x+=h.clientLeft,oe.y+=h.clientTop):G&&(oe.x=Mo(G))),{x:Z.left+re.scrollLeft-oe.x,y:Z.top+re.scrollTop-oe.y,width:Z.width,height:Z.height}}function Za(_){var h=new Map,g=new Set,I=[];function j(F){g.add(F.name),[].concat(F.requires||[],F.requiresIfExists||[]).forEach(function(H){if(!g.has(H)){var G=h.get(H);G&&j(G)}}),I.push(F)}return _.forEach(function(F){h.set(F.name,F)}),_.forEach(function(F){g.has(F.name)||j(F)}),I}var Lh={placement:"bottom",modifiers:[],strategy:"absolute"};function Dc(){for(var _=arguments.length,h=new Array(_),g=0;g<_;g++)h[g]=arguments[g];return!h.some(function(I){return!(I&&typeof I.getBoundingClientRect=="function")})}function ui(_){_===void 0&&(_={});var h=_,g=h.defaultModifiers,I=g===void 0?[]:g,j=h.defaultOptions,F=j===void 0?Lh:j;return function(H,G,Z){Z===void 0&&(Z=F);var re,oe,ee={placement:"bottom",orderedModifiers:[],options:Object.assign({},Lh,F),modifiersData:{},elements:{reference:H,popper:G},attributes:{},styles:{}},Ce=[],he=!1,ye={state:ee,setOptions:function(_e){var Ze=typeof _e=="function"?_e(ee.options):_e;pe(),ee.options=Object.assign({},F,ee.options,Ze),ee.scrollParents={reference:li(H)?Vo(H):H.contextElement?Vo(H.contextElement):[],popper:Vo(G)};var ot,ke,ze=function(Ae){var Oe=Za(Ae);return Ph.reduce(function(We,et){return We.concat(Oe.filter(function(Ke){return Ke.phase===et}))},[])}((ot=[].concat(I,ee.options.modifiers),ke=ot.reduce(function(Ae,Oe){var We=Ae[Oe.name];return Ae[Oe.name]=We?Object.assign({},We,Oe,{options:Object.assign({},We.options,Oe.options),data:Object.assign({},We.data,Oe.data)}):Oe,Ae},{}),Object.keys(ke).map(function(Ae){return ke[Ae]})));return ee.orderedModifiers=ze.filter(function(Ae){return Ae.enabled}),ee.orderedModifiers.forEach(function(Ae){var Oe=Ae.name,We=Ae.options,et=We===void 0?{}:We,Ke=Ae.effect;if(typeof Ke=="function"){var Pt=Ke({state:ee,name:Oe,instance:ye,options:et});Ce.push(Pt||function(){})}}),ye.update()},forceUpdate:function(){if(!he){var _e=ee.elements,Ze=_e.reference,ot=_e.popper;if(Dc(Ze,ot)){ee.rects={reference:Nh(Ze,Mn(ot),ee.options.strategy==="fixed"),popper:Sc(ot)},ee.reset=!1,ee.placement=ee.options.placement,ee.orderedModifiers.forEach(function(Ke){return ee.modifiersData[Ke.name]=Object.assign({},Ke.data)});for(var ke=0;ke<ee.orderedModifiers.length;ke++)if(ee.reset!==!0){var ze=ee.orderedModifiers[ke],Ae=ze.fn,Oe=ze.options,We=Oe===void 0?{}:Oe,et=ze.name;typeof Ae=="function"&&(ee=Ae({state:ee,options:We,name:et,instance:ye})||ee)}else ee.reset=!1,ke=-1}}},update:(re=function(){return new Promise(function(_e){ye.forceUpdate(),_e(ee)})},function(){return oe||(oe=new Promise(function(_e){Promise.resolve().then(function(){oe=void 0,_e(re())})})),oe}),destroy:function(){pe(),he=!0}};if(!Dc(H,G))return ye;function pe(){Ce.forEach(function(_e){return _e()}),Ce=[]}return ye.setOptions(Z).then(function(_e){!he&&Z.onFirstUpdate&&Z.onFirstUpdate(_e)}),ye}}var Mh=ui(),Vh=ui({defaultModifiers:[Cs,jo,Ac,Xn]}),Uo=ui({defaultModifiers:[Cs,jo,Ac,Xn,Rc,mr,Fo,kh,xs]});const el=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Ha,afterRead:_c,afterWrite:Ic,applyStyles:Xn,arrow:kh,auto:_s,basePlacements:oi,beforeMain:wc,beforeRead:qa,beforeWrite:Wa,bottom:It,clippingParents:Ah,computeStyles:Ac,createPopper:Uo,createPopperBase:Mh,createPopperLite:Vh,detectOverflow:Br,end:Pi,eventListeners:Cs,flip:mr,hide:xs,left:Gt,main:Ec,modifierPhases:Ph,offset:Rc,placements:Fr,popper:ki,popperGenerator:ui,popperOffsets:jo,preventOverflow:Fo,read:xh,reference:Ba,right:an,start:ai,top:Ot,variationPlacements:Ri,viewport:ws,write:Tc},Symbol.toStringTag,{value:"Module"})),Oc="dropdown",vr=".bs.dropdown",tl=".data-api",jh="ArrowUp",hi="ArrowDown",Fh=`hide${vr}`,Uh=`hidden${vr}`,$h=`show${vr}`,zh=`shown${vr}`,$o=`click${vr}${tl}`,cn=`keydown${vr}${tl}`,Bh=`keyup${vr}${tl}`,Oi="show",Vn='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',c=`${Vn}.${Oi}`,f=".dropdown-menu",v=D()?"top-end":"top-start",b=D()?"top-start":"top-end",U=D()?"bottom-end":"bottom-start",B=D()?"bottom-start":"bottom-end",J=D()?"left-start":"right-start",He=D()?"right-start":"left-start",Ut={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Ve={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Je extends nt{constructor(h,g){super(h,g),this._popper=null,this._parent=this._element.parentNode,this._menu=se.next(this._element,f)[0]||se.prev(this._element,f)[0]||se.findOne(f,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Ut}static get DefaultType(){return Ve}static get NAME(){return Oc}toggle(){return this._isShown()?this.hide():this.show()}show(){if(d(this._element)||this._isShown())return;const h={relatedTarget:this._element};if(!z.trigger(this._element,$h,h).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const g of[].concat(...document.body.children))z.on(g,"mouseover",m);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Oi),this._element.classList.add(Oi),z.trigger(this._element,zh,h)}}hide(){if(d(this._element)||!this._isShown())return;const h={relatedTarget:this._element};this._completeHide(h)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(h){if(!z.trigger(this._element,Fh,h).defaultPrevented){if("ontouchstart"in document.documentElement)for(const g of[].concat(...document.body.children))z.off(g,"mouseover",m);this._popper&&this._popper.destroy(),this._menu.classList.remove(Oi),this._element.classList.remove(Oi),this._element.setAttribute("aria-expanded","false"),ut.removeDataAttribute(this._menu,"popper"),z.trigger(this._element,Uh,h)}}_getConfig(h){if(typeof(h=super._getConfig(h)).reference=="object"&&!a(h.reference)&&typeof h.reference.getBoundingClientRect!="function")throw new TypeError(`${Oc.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return h}_createPopper(){if(el===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let h=this._element;this._config.reference==="parent"?h=this._parent:a(this._config.reference)?h=l(this._config.reference):typeof this._config.reference=="object"&&(h=this._config.reference);const g=this._getPopperConfig();this._popper=Uo(h,this._menu,g)}_isShown(){return this._menu.classList.contains(Oi)}_getPlacement(){const h=this._parent;if(h.classList.contains("dropend"))return J;if(h.classList.contains("dropstart"))return He;if(h.classList.contains("dropup-center"))return"top";if(h.classList.contains("dropdown-center"))return"bottom";const g=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return h.classList.contains("dropup")?g?b:v:g?B:U}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:h}=this._config;return typeof h=="string"?h.split(",").map(g=>Number.parseInt(g,10)):typeof h=="function"?g=>h(g,this._element):h}_getPopperConfig(){const h={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(ut.setDataAttribute(this._menu,"popper","static"),h.modifiers=[{name:"applyStyles",enabled:!1}]),{...h,...T(this._config.popperConfig,[h])}}_selectMenuItem({key:h,target:g}){const I=se.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(j=>u(j));I.length&&M(I,g,h===hi,!I.includes(g)).focus()}static jQueryInterface(h){return this.each(function(){const g=Je.getOrCreateInstance(this,h);if(typeof h=="string"){if(g[h]===void 0)throw new TypeError(`No method named "${h}"`);g[h]()}})}static clearMenus(h){if(h.button===2||h.type==="keyup"&&h.key!=="Tab")return;const g=se.find(c);for(const I of g){const j=Je.getInstance(I);if(!j||j._config.autoClose===!1)continue;const F=h.composedPath(),H=F.includes(j._menu);if(F.includes(j._element)||j._config.autoClose==="inside"&&!H||j._config.autoClose==="outside"&&H||j._menu.contains(h.target)&&(h.type==="keyup"&&h.key==="Tab"||/input|select|option|textarea|form/i.test(h.target.tagName)))continue;const G={relatedTarget:j._element};h.type==="click"&&(G.clickEvent=h),j._completeHide(G)}}static dataApiKeydownHandler(h){const g=/input|textarea/i.test(h.target.tagName),I=h.key==="Escape",j=[jh,hi].includes(h.key);if(!j&&!I||g&&!I)return;h.preventDefault();const F=this.matches(Vn)?this:se.prev(this,Vn)[0]||se.next(this,Vn)[0]||se.findOne(Vn,h.delegateTarget.parentNode),H=Je.getOrCreateInstance(F);if(j)return h.stopPropagation(),H.show(),void H._selectMenuItem(h);H._isShown()&&(h.stopPropagation(),H.hide(),F.focus())}}z.on(document,cn,Vn,Je.dataApiKeydownHandler),z.on(document,cn,f,Je.dataApiKeydownHandler),z.on(document,$o,Je.clearMenus),z.on(document,Bh,Je.clearMenus),z.on(document,$o,Vn,function(_){_.preventDefault(),Je.getOrCreateInstance(this).toggle()}),A(Je);const $t="backdrop",Ni="show",jn=`mousedown.bs.${$t}`,nl={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Nc={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class t0 extends jt{constructor(h){super(),this._config=this._getConfig(h),this._isAppended=!1,this._element=null}static get Default(){return nl}static get DefaultType(){return Nc}static get NAME(){return $t}show(h){if(!this._config.isVisible)return void T(h);this._append();const g=this._getElement();this._config.isAnimated&&w(g),g.classList.add(Ni),this._emulateAnimation(()=>{T(h)})}hide(h){this._config.isVisible?(this._getElement().classList.remove(Ni),this._emulateAnimation(()=>{this.dispose(),T(h)})):T(h)}dispose(){this._isAppended&&(z.off(this._element,jn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const h=document.createElement("div");h.className=this._config.className,this._config.isAnimated&&h.classList.add("fade"),this._element=h}return this._element}_configAfterMerge(h){return h.rootElement=l(h.rootElement),h}_append(){if(this._isAppended)return;const h=this._getElement();this._config.rootElement.append(h),z.on(h,jn,()=>{T(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(h){S(h,this._getElement(),this._config.isAnimated)}}const qh=".bs.focustrap",Qx=`focusin${qh}`,Yx=`keydown.tab${qh}`,n0="backward",Xx={autofocus:!0,trapElement:null},Jx={autofocus:"boolean",trapElement:"element"};class r0 extends jt{constructor(h){super(),this._config=this._getConfig(h),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Xx}static get DefaultType(){return Jx}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),z.off(document,qh),z.on(document,Qx,h=>this._handleFocusin(h)),z.on(document,Yx,h=>this._handleKeydown(h)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,z.off(document,qh))}_handleFocusin(h){const{trapElement:g}=this._config;if(h.target===document||h.target===g||g.contains(h.target))return;const I=se.focusableChildren(g);I.length===0?g.focus():this._lastTabNavDirection===n0?I[I.length-1].focus():I[0].focus()}_handleKeydown(h){h.key==="Tab"&&(this._lastTabNavDirection=h.shiftKey?n0:"forward")}}const i0=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",s0=".sticky-top",Hh="padding-right",o0="margin-right";class Xp{constructor(){this._element=document.body}getWidth(){const h=document.documentElement.clientWidth;return Math.abs(window.innerWidth-h)}hide(){const h=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Hh,g=>g+h),this._setElementAttributes(i0,Hh,g=>g+h),this._setElementAttributes(s0,o0,g=>g-h)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Hh),this._resetElementAttributes(i0,Hh),this._resetElementAttributes(s0,o0)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(h,g,I){const j=this.getWidth();this._applyManipulationCallback(h,F=>{if(F!==this._element&&window.innerWidth>F.clientWidth+j)return;this._saveInitialAttribute(F,g);const H=window.getComputedStyle(F).getPropertyValue(g);F.style.setProperty(g,`${I(Number.parseFloat(H))}px`)})}_saveInitialAttribute(h,g){const I=h.style.getPropertyValue(g);I&&ut.setDataAttribute(h,g,I)}_resetElementAttributes(h,g){this._applyManipulationCallback(h,I=>{const j=ut.getDataAttribute(I,g);j!==null?(ut.removeDataAttribute(I,g),I.style.setProperty(g,j)):I.style.removeProperty(g)})}_applyManipulationCallback(h,g){if(a(h))g(h);else for(const I of se.find(h,this._element))g(I)}}const yr=".bs.modal",Zx=`hide${yr}`,eP=`hidePrevented${yr}`,a0=`hidden${yr}`,l0=`show${yr}`,tP=`shown${yr}`,nP=`resize${yr}`,rP=`click.dismiss${yr}`,iP=`mousedown.dismiss${yr}`,sP=`keydown.dismiss${yr}`,oP=`click${yr}.data-api`,c0="modal-open",u0="show",Jp="modal-static",aP={backdrop:!0,focus:!0,keyboard:!0},lP={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class zo extends nt{constructor(h,g){super(h,g),this._dialog=se.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Xp,this._addEventListeners()}static get Default(){return aP}static get DefaultType(){return lP}static get NAME(){return"modal"}toggle(h){return this._isShown?this.hide():this.show(h)}show(h){this._isShown||this._isTransitioning||z.trigger(this._element,l0,{relatedTarget:h}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(c0),this._adjustDialog(),this._backdrop.show(()=>this._showElement(h)))}hide(){this._isShown&&!this._isTransitioning&&(z.trigger(this._element,Zx).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(u0),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){z.off(window,yr),z.off(this._dialog,yr),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new t0({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new r0({trapElement:this._element})}_showElement(h){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const g=se.findOne(".modal-body",this._dialog);g&&(g.scrollTop=0),w(this._element),this._element.classList.add(u0),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,z.trigger(this._element,tP,{relatedTarget:h})},this._dialog,this._isAnimated())}_addEventListeners(){z.on(this._element,sP,h=>{h.key==="Escape"&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),z.on(window,nP,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),z.on(this._element,iP,h=>{z.one(this._element,rP,g=>{this._element===h.target&&this._element===g.target&&(this._config.backdrop!=="static"?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(c0),this._resetAdjustments(),this._scrollBar.reset(),z.trigger(this._element,a0)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(z.trigger(this._element,eP).defaultPrevented)return;const h=this._element.scrollHeight>document.documentElement.clientHeight,g=this._element.style.overflowY;g==="hidden"||this._element.classList.contains(Jp)||(h||(this._element.style.overflowY="hidden"),this._element.classList.add(Jp),this._queueCallback(()=>{this._element.classList.remove(Jp),this._queueCallback(()=>{this._element.style.overflowY=g},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const h=this._element.scrollHeight>document.documentElement.clientHeight,g=this._scrollBar.getWidth(),I=g>0;if(I&&!h){const j=D()?"paddingLeft":"paddingRight";this._element.style[j]=`${g}px`}if(!I&&h){const j=D()?"paddingRight":"paddingLeft";this._element.style[j]=`${g}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(h,g){return this.each(function(){const I=zo.getOrCreateInstance(this,h);if(typeof h=="string"){if(I[h]===void 0)throw new TypeError(`No method named "${h}"`);I[h](g)}})}}z.on(document,oP,'[data-bs-toggle="modal"]',function(_){const h=se.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&_.preventDefault(),z.one(h,l0,I=>{I.defaultPrevented||z.one(h,a0,()=>{u(this)&&this.focus()})});const g=se.findOne(".modal.show");g&&zo.getInstance(g).hide(),zo.getOrCreateInstance(h).toggle(this)}),Wn(zo),A(zo);const Li=".bs.offcanvas",h0=".data-api",cP=`load${Li}${h0}`,d0="show",f0="showing",p0="hiding",g0=".offcanvas.show",uP=`show${Li}`,hP=`shown${Li}`,dP=`hide${Li}`,m0=`hidePrevented${Li}`,v0=`hidden${Li}`,fP=`resize${Li}`,pP=`click${Li}${h0}`,gP=`keydown.dismiss${Li}`,mP={backdrop:!0,keyboard:!0,scroll:!1},vP={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Mi extends nt{constructor(h,g){super(h,g),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return mP}static get DefaultType(){return vP}static get NAME(){return"offcanvas"}toggle(h){return this._isShown?this.hide():this.show(h)}show(h){this._isShown||z.trigger(this._element,uP,{relatedTarget:h}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new Xp().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(f0),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(d0),this._element.classList.remove(f0),z.trigger(this._element,hP,{relatedTarget:h})},this._element,!0))}hide(){this._isShown&&(z.trigger(this._element,dP).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(p0),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(d0,p0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Xp().reset(),z.trigger(this._element,v0)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const h=!!this._config.backdrop;return new t0({className:"offcanvas-backdrop",isVisible:h,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:h?()=>{this._config.backdrop!=="static"?this.hide():z.trigger(this._element,m0)}:null})}_initializeFocusTrap(){return new r0({trapElement:this._element})}_addEventListeners(){z.on(this._element,gP,h=>{h.key==="Escape"&&(this._config.keyboard?this.hide():z.trigger(this._element,m0))})}static jQueryInterface(h){return this.each(function(){const g=Mi.getOrCreateInstance(this,h);if(typeof h=="string"){if(g[h]===void 0||h.startsWith("_")||h==="constructor")throw new TypeError(`No method named "${h}"`);g[h](this)}})}}z.on(document,pP,'[data-bs-toggle="offcanvas"]',function(_){const h=se.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&_.preventDefault(),d(this))return;z.one(h,v0,()=>{u(this)&&this.focus()});const g=se.findOne(g0);g&&g!==h&&Mi.getInstance(g).hide(),Mi.getOrCreateInstance(h).toggle(this)}),z.on(window,cP,()=>{for(const _ of se.find(g0))Mi.getOrCreateInstance(_).show()}),z.on(window,fP,()=>{for(const _ of se.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(_).position!=="fixed"&&Mi.getOrCreateInstance(_).hide()}),Wn(Mi),A(Mi);const y0={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},yP=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),_P=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,wP=(_,h)=>{const g=_.nodeName.toLowerCase();return h.includes(g)?!yP.has(g)||!!_P.test(_.nodeValue):h.filter(I=>I instanceof RegExp).some(I=>I.test(g))},EP={allowList:y0,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},TP={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},IP={entry:"(string|element|function|null)",selector:"(string|element)"};class SP extends jt{constructor(h){super(),this._config=this._getConfig(h)}static get Default(){return EP}static get DefaultType(){return TP}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(h=>this._resolvePossibleFunction(h)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(h){return this._checkContent(h),this._config.content={...this._config.content,...h},this}toHtml(){const h=document.createElement("div");h.innerHTML=this._maybeSanitize(this._config.template);for(const[j,F]of Object.entries(this._config.content))this._setContent(h,F,j);const g=h.children[0],I=this._resolvePossibleFunction(this._config.extraClass);return I&&g.classList.add(...I.split(" ")),g}_typeCheckConfig(h){super._typeCheckConfig(h),this._checkContent(h.content)}_checkContent(h){for(const[g,I]of Object.entries(h))super._typeCheckConfig({selector:g,entry:I},IP)}_setContent(h,g,I){const j=se.findOne(I,h);j&&((g=this._resolvePossibleFunction(g))?a(g)?this._putElementInTemplate(l(g),j):this._config.html?j.innerHTML=this._maybeSanitize(g):j.textContent=g:j.remove())}_maybeSanitize(h){return this._config.sanitize?function(g,I,j){if(!g.length)return g;if(j&&typeof j=="function")return j(g);const F=new window.DOMParser().parseFromString(g,"text/html"),H=[].concat(...F.body.querySelectorAll("*"));for(const G of H){const Z=G.nodeName.toLowerCase();if(!Object.keys(I).includes(Z)){G.remove();continue}const re=[].concat(...G.attributes),oe=[].concat(I["*"]||[],I[Z]||[]);for(const ee of re)wP(ee,oe)||G.removeAttribute(ee.nodeName)}return F.body.innerHTML}(h,this._config.allowList,this._config.sanitizeFn):h}_resolvePossibleFunction(h){return T(h,[this])}_putElementInTemplate(h,g){if(this._config.html)return g.innerHTML="",void g.append(h);g.textContent=h.textContent}}const bP=new Set(["sanitize","allowList","sanitizeFn"]),Zp="fade",Wh="show",_0=".modal",w0="hide.bs.modal",Lc="hover",eg="focus",CP={AUTO:"auto",TOP:"top",RIGHT:D()?"left":"right",BOTTOM:"bottom",LEFT:D()?"right":"left"},AP={allowList:y0,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},xP={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Bo extends nt{constructor(h,g){if(el===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(h,g),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return AP}static get DefaultType(){return xP}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),z.off(this._element.closest(_0),w0,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const h=z.trigger(this._element,this.constructor.eventName("show")),g=(p(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(h.defaultPrevented||!g)return;this._disposePopper();const I=this._getTipElement();this._element.setAttribute("aria-describedby",I.getAttribute("id"));const{container:j}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(j.append(I),z.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(I),I.classList.add(Wh),"ontouchstart"in document.documentElement)for(const F of[].concat(...document.body.children))z.on(F,"mouseover",m);this._queueCallback(()=>{z.trigger(this._element,this.constructor.eventName("shown")),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!z.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(Wh),"ontouchstart"in document.documentElement)for(const h of[].concat(...document.body.children))z.off(h,"mouseover",m);this._activeTrigger.click=!1,this._activeTrigger[eg]=!1,this._activeTrigger[Lc]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),z.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(h){const g=this._getTemplateFactory(h).toHtml();if(!g)return null;g.classList.remove(Zp,Wh),g.classList.add(`bs-${this.constructor.NAME}-auto`);const I=(j=>{do j+=Math.floor(1e6*Math.random());while(document.getElementById(j));return j})(this.constructor.NAME).toString();return g.setAttribute("id",I),this._isAnimated()&&g.classList.add(Zp),g}setContent(h){this._newContent=h,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(h){return this._templateFactory?this._templateFactory.changeContent(h):this._templateFactory=new SP({...this._config,content:h,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(h){return this.constructor.getOrCreateInstance(h.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Zp)}_isShown(){return this.tip&&this.tip.classList.contains(Wh)}_createPopper(h){const g=T(this._config.placement,[this,h,this._element]),I=CP[g.toUpperCase()];return Uo(this._element,h,this._getPopperConfig(I))}_getOffset(){const{offset:h}=this._config;return typeof h=="string"?h.split(",").map(g=>Number.parseInt(g,10)):typeof h=="function"?g=>h(g,this._element):h}_resolvePossibleFunction(h){return T(h,[this._element])}_getPopperConfig(h){const g={placement:h,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:I=>{this._getTipElement().setAttribute("data-popper-placement",I.state.placement)}}]};return{...g,...T(this._config.popperConfig,[g])}}_setListeners(){const h=this._config.trigger.split(" ");for(const g of h)if(g==="click")z.on(this._element,this.constructor.eventName("click"),this._config.selector,I=>{this._initializeOnDelegatedTarget(I).toggle()});else if(g!=="manual"){const I=g===Lc?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),j=g===Lc?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");z.on(this._element,I,this._config.selector,F=>{const H=this._initializeOnDelegatedTarget(F);H._activeTrigger[F.type==="focusin"?eg:Lc]=!0,H._enter()}),z.on(this._element,j,this._config.selector,F=>{const H=this._initializeOnDelegatedTarget(F);H._activeTrigger[F.type==="focusout"?eg:Lc]=H._element.contains(F.relatedTarget),H._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},z.on(this._element.closest(_0),w0,this._hideModalHandler)}_fixTitle(){const h=this._element.getAttribute("title");h&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",h),this._element.setAttribute("data-bs-original-title",h),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(h,g){clearTimeout(this._timeout),this._timeout=setTimeout(h,g)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(h){const g=ut.getDataAttributes(this._element);for(const I of Object.keys(g))bP.has(I)&&delete g[I];return h={...g,...typeof h=="object"&&h?h:{}},h=this._mergeConfigObj(h),h=this._configAfterMerge(h),this._typeCheckConfig(h),h}_configAfterMerge(h){return h.container=h.container===!1?document.body:l(h.container),typeof h.delay=="number"&&(h.delay={show:h.delay,hide:h.delay}),typeof h.title=="number"&&(h.title=h.title.toString()),typeof h.content=="number"&&(h.content=h.content.toString()),h}_getDelegateConfig(){const h={};for(const[g,I]of Object.entries(this._config))this.constructor.Default[g]!==I&&(h[g]=I);return h.selector=!1,h.trigger="manual",h}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(h){return this.each(function(){const g=Bo.getOrCreateInstance(this,h);if(typeof h=="string"){if(g[h]===void 0)throw new TypeError(`No method named "${h}"`);g[h]()}})}}A(Bo);const PP={...Bo.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},kP={...Bo.DefaultType,content:"(null|string|element|function)"};class Kh extends Bo{static get Default(){return PP}static get DefaultType(){return kP}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(h){return this.each(function(){const g=Kh.getOrCreateInstance(this,h);if(typeof h=="string"){if(g[h]===void 0)throw new TypeError(`No method named "${h}"`);g[h]()}})}}A(Kh);const tg=".bs.scrollspy",RP=`activate${tg}`,E0=`click${tg}`,DP=`load${tg}.data-api`,rl="active",ng="[href]",T0=".nav-link",OP=`${T0}, .nav-item > ${T0}, .list-group-item`,NP={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},LP={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Mc extends nt{constructor(h,g){super(h,g),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return NP}static get DefaultType(){return LP}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const h of this._observableSections.values())this._observer.observe(h)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(h){return h.target=l(h.target)||document.body,h.rootMargin=h.offset?`${h.offset}px 0px -30%`:h.rootMargin,typeof h.threshold=="string"&&(h.threshold=h.threshold.split(",").map(g=>Number.parseFloat(g))),h}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(z.off(this._config.target,E0),z.on(this._config.target,E0,ng,h=>{const g=this._observableSections.get(h.target.hash);if(g){h.preventDefault();const I=this._rootElement||window,j=g.offsetTop-this._element.offsetTop;if(I.scrollTo)return void I.scrollTo({top:j,behavior:"smooth"});I.scrollTop=j}}))}_getNewObserver(){const h={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(g=>this._observerCallback(g),h)}_observerCallback(h){const g=H=>this._targetLinks.get(`#${H.target.id}`),I=H=>{this._previousScrollData.visibleEntryTop=H.target.offsetTop,this._process(g(H))},j=(this._rootElement||document.documentElement).scrollTop,F=j>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=j;for(const H of h){if(!H.isIntersecting){this._activeTarget=null,this._clearActiveClass(g(H));continue}const G=H.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(F&&G){if(I(H),!j)return}else F||G||I(H)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const h=se.find(ng,this._config.target);for(const g of h){if(!g.hash||d(g))continue;const I=se.findOne(decodeURI(g.hash),this._element);u(I)&&(this._targetLinks.set(decodeURI(g.hash),g),this._observableSections.set(g.hash,I))}}_process(h){this._activeTarget!==h&&(this._clearActiveClass(this._config.target),this._activeTarget=h,h.classList.add(rl),this._activateParents(h),z.trigger(this._element,RP,{relatedTarget:h}))}_activateParents(h){if(h.classList.contains("dropdown-item"))se.findOne(".dropdown-toggle",h.closest(".dropdown")).classList.add(rl);else for(const g of se.parents(h,".nav, .list-group"))for(const I of se.prev(g,OP))I.classList.add(rl)}_clearActiveClass(h){h.classList.remove(rl);const g=se.find(`${ng}.${rl}`,h);for(const I of g)I.classList.remove(rl)}static jQueryInterface(h){return this.each(function(){const g=Mc.getOrCreateInstance(this,h);if(typeof h=="string"){if(g[h]===void 0||h.startsWith("_")||h==="constructor")throw new TypeError(`No method named "${h}"`);g[h]()}})}}z.on(window,DP,()=>{for(const _ of se.find('[data-bs-spy="scroll"]'))Mc.getOrCreateInstance(_)}),A(Mc);const qo=".bs.tab",MP=`hide${qo}`,VP=`hidden${qo}`,jP=`show${qo}`,FP=`shown${qo}`,UP=`click${qo}`,$P=`keydown${qo}`,zP=`load${qo}`,BP="ArrowLeft",I0="ArrowRight",qP="ArrowUp",S0="ArrowDown",rg="Home",b0="End",Ho="active",C0="fade",ig="show",A0=".dropdown-toggle",sg=`:not(${A0})`,x0='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',og=`.nav-link${sg}, .list-group-item${sg}, [role="tab"]${sg}, ${x0}`,HP=`.${Ho}[data-bs-toggle="tab"], .${Ho}[data-bs-toggle="pill"], .${Ho}[data-bs-toggle="list"]`;class Wo extends nt{constructor(h){super(h),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),z.on(this._element,$P,g=>this._keydown(g)))}static get NAME(){return"tab"}show(){const h=this._element;if(this._elemIsActive(h))return;const g=this._getActiveElem(),I=g?z.trigger(g,MP,{relatedTarget:h}):null;z.trigger(h,jP,{relatedTarget:g}).defaultPrevented||I&&I.defaultPrevented||(this._deactivate(g,h),this._activate(h,g))}_activate(h,g){h&&(h.classList.add(Ho),this._activate(se.getElementFromSelector(h)),this._queueCallback(()=>{h.getAttribute("role")==="tab"?(h.removeAttribute("tabindex"),h.setAttribute("aria-selected",!0),this._toggleDropDown(h,!0),z.trigger(h,FP,{relatedTarget:g})):h.classList.add(ig)},h,h.classList.contains(C0)))}_deactivate(h,g){h&&(h.classList.remove(Ho),h.blur(),this._deactivate(se.getElementFromSelector(h)),this._queueCallback(()=>{h.getAttribute("role")==="tab"?(h.setAttribute("aria-selected",!1),h.setAttribute("tabindex","-1"),this._toggleDropDown(h,!1),z.trigger(h,VP,{relatedTarget:g})):h.classList.remove(ig)},h,h.classList.contains(C0)))}_keydown(h){if(![BP,I0,qP,S0,rg,b0].includes(h.key))return;h.stopPropagation(),h.preventDefault();const g=this._getChildren().filter(j=>!d(j));let I;if([rg,b0].includes(h.key))I=g[h.key===rg?0:g.length-1];else{const j=[I0,S0].includes(h.key);I=M(g,h.target,j,!0)}I&&(I.focus({preventScroll:!0}),Wo.getOrCreateInstance(I).show())}_getChildren(){return se.find(og,this._parent)}_getActiveElem(){return this._getChildren().find(h=>this._elemIsActive(h))||null}_setInitialAttributes(h,g){this._setAttributeIfNotExists(h,"role","tablist");for(const I of g)this._setInitialAttributesOnChild(I)}_setInitialAttributesOnChild(h){h=this._getInnerElement(h);const g=this._elemIsActive(h),I=this._getOuterElement(h);h.setAttribute("aria-selected",g),I!==h&&this._setAttributeIfNotExists(I,"role","presentation"),g||h.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(h,"role","tab"),this._setInitialAttributesOnTargetPanel(h)}_setInitialAttributesOnTargetPanel(h){const g=se.getElementFromSelector(h);g&&(this._setAttributeIfNotExists(g,"role","tabpanel"),h.id&&this._setAttributeIfNotExists(g,"aria-labelledby",`${h.id}`))}_toggleDropDown(h,g){const I=this._getOuterElement(h);if(!I.classList.contains("dropdown"))return;const j=(F,H)=>{const G=se.findOne(F,I);G&&G.classList.toggle(H,g)};j(A0,Ho),j(".dropdown-menu",ig),I.setAttribute("aria-expanded",g)}_setAttributeIfNotExists(h,g,I){h.hasAttribute(g)||h.setAttribute(g,I)}_elemIsActive(h){return h.classList.contains(Ho)}_getInnerElement(h){return h.matches(og)?h:se.findOne(og,h)}_getOuterElement(h){return h.closest(".nav-item, .list-group-item")||h}static jQueryInterface(h){return this.each(function(){const g=Wo.getOrCreateInstance(this);if(typeof h=="string"){if(g[h]===void 0||h.startsWith("_")||h==="constructor")throw new TypeError(`No method named "${h}"`);g[h]()}})}}z.on(document,UP,x0,function(_){["A","AREA"].includes(this.tagName)&&_.preventDefault(),d(this)||Wo.getOrCreateInstance(this).show()}),z.on(window,zP,()=>{for(const _ of se.find(HP))Wo.getOrCreateInstance(_)}),A(Wo);const Ps=".bs.toast",WP=`mouseover${Ps}`,KP=`mouseout${Ps}`,GP=`focusin${Ps}`,QP=`focusout${Ps}`,YP=`hide${Ps}`,XP=`hidden${Ps}`,JP=`show${Ps}`,ZP=`shown${Ps}`,P0="hide",Gh="show",Qh="showing",ek={animation:"boolean",autohide:"boolean",delay:"number"},tk={animation:!0,autohide:!0,delay:5e3};class Vc extends nt{constructor(h,g){super(h,g),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return tk}static get DefaultType(){return ek}static get NAME(){return"toast"}show(){z.trigger(this._element,JP).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(P0),w(this._element),this._element.classList.add(Gh,Qh),this._queueCallback(()=>{this._element.classList.remove(Qh),z.trigger(this._element,ZP),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(z.trigger(this._element,YP).defaultPrevented||(this._element.classList.add(Qh),this._queueCallback(()=>{this._element.classList.add(P0),this._element.classList.remove(Qh,Gh),z.trigger(this._element,XP)},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Gh),super.dispose()}isShown(){return this._element.classList.contains(Gh)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(h,g){switch(h.type){case"mouseover":case"mouseout":this._hasMouseInteraction=g;break;case"focusin":case"focusout":this._hasKeyboardInteraction=g}if(g)return void this._clearTimeout();const I=h.relatedTarget;this._element===I||this._element.contains(I)||this._maybeScheduleHide()}_setListeners(){z.on(this._element,WP,h=>this._onInteraction(h,!0)),z.on(this._element,KP,h=>this._onInteraction(h,!1)),z.on(this._element,GP,h=>this._onInteraction(h,!0)),z.on(this._element,QP,h=>this._onInteraction(h,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(h){return this.each(function(){const g=Vc.getOrCreateInstance(this,h);if(typeof h=="string"){if(g[h]===void 0)throw new TypeError(`No method named "${h}"`);g[h](this)}})}}return Wn(Vc),A(Vc),{Alert:On,Button:Gn,Carousel:Nn,Collapse:si,Dropdown:Je,Modal:zo,Offcanvas:Mi,Popover:Kh,ScrollSpy:Mc,Tab:Wo,Toast:Vc,Tooltip:Bo}})})(zD);/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ku(){return Ku=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ku.apply(this,arguments)}var Ys;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ys||(Ys={}));const Xw="popstate";function BD(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return ev("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Pf(i)}return HD(e,n,null,t)}function Rt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function $S(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function qD(){return Math.random().toString(36).substr(2,8)}function Jw(t,e){return{usr:t.state,key:t.key,idx:e}}function ev(t,e,n,r){return n===void 0&&(n=null),Ku({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?cc(e):e,{state:n,key:e&&e.key||r||qD()})}function Pf(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function cc(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function HD(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=Ys.Pop,l=null,u=d();u==null&&(u=0,o.replaceState(Ku({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function p(){a=Ys.Pop;let D=d(),A=D==null?null:D-u;u=D,l&&l({action:a,location:x.location,delta:A})}function m(D,A){a=Ys.Push;let T=ev(x.location,D,A);u=d()+1;let S=Jw(T,u),M=x.createHref(T);try{o.pushState(S,"",M)}catch(q){if(q instanceof DOMException&&q.name==="DataCloneError")throw q;i.location.assign(M)}s&&l&&l({action:a,location:x.location,delta:1})}function w(D,A){a=Ys.Replace;let T=ev(x.location,D,A);u=d();let S=Jw(T,u),M=x.createHref(T);o.replaceState(S,"",M),s&&l&&l({action:a,location:x.location,delta:0})}function E(D){let A=i.location.origin!=="null"?i.location.origin:i.location.href,T=typeof D=="string"?D:Pf(D);return T=T.replace(/ $/,"%20"),Rt(A,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,A)}let x={get action(){return a},get location(){return t(i,o)},listen(D){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(Xw,p),l=D,()=>{i.removeEventListener(Xw,p),l=null}},createHref(D){return e(i,D)},createURL:E,encodeLocation(D){let A=E(D);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:m,replace:w,go(D){return o.go(D)}};return x}var Zw;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Zw||(Zw={}));function WD(t,e,n){return n===void 0&&(n="/"),KD(t,e,n,!1)}function KD(t,e,n,r){let i=typeof e=="string"?cc(e):e,s=Fy(i.pathname||"/",n);if(s==null)return null;let o=zS(t);GD(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=sO(s);a=rO(o[l],u,r)}return a}function zS(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Rt(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=oo([r,l.relativePath]),d=n.concat(l);s.children&&s.children.length>0&&(Rt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),zS(s.children,e,d,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:tO(u,s.index),routesMeta:d})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of BS(s.path))i(s,o,l)}),e}function BS(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=BS(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function GD(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:nO(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const QD=/^:[\w-]+$/,YD=3,XD=2,JD=1,ZD=10,eO=-2,eE=t=>t==="*";function tO(t,e){let n=t.split("/"),r=n.length;return n.some(eE)&&(r+=eO),e&&(r+=XD),n.filter(i=>!eE(i)).reduce((i,s)=>i+(QD.test(s)?YD:s===""?JD:ZD),r)}function nO(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function rO(t,e,n){let{routesMeta:r}=t,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],u=a===r.length-1,d=s==="/"?e:e.slice(s.length)||"/",p=tE({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),m=l.route;if(!p&&u&&n&&!r[r.length-1].route.index&&(p=tE({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},d)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:oo([s,p.pathname]),pathnameBase:cO(oo([s,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(s=oo([s,p.pathnameBase]))}return o}function tE(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=iO(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((u,d,p)=>{let{paramName:m,isOptional:w}=d;if(m==="*"){let x=a[p]||"";o=s.slice(0,s.length-x.length).replace(/(.)\/+$/,"$1")}const E=a[p];return w&&!E?u[m]=void 0:u[m]=(E||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function iO(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),$S(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function sO(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return $S(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Fy(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function oO(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?cc(t):t;return{pathname:n?n.startsWith("/")?n:aO(n,e):e,search:uO(r),hash:hO(i)}}function aO(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Mg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function lO(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Uy(t,e){let n=lO(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function $y(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=cc(t):(i=Ku({},t),Rt(!i.pathname||!i.pathname.includes("?"),Mg("?","pathname","search",i)),Rt(!i.pathname||!i.pathname.includes("#"),Mg("#","pathname","hash",i)),Rt(!i.search||!i.search.includes("#"),Mg("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}a=p>=0?e[p]:"/"}let l=oO(i,a),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const oo=t=>t.join("/").replace(/\/\/+/g,"/"),cO=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),uO=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,hO=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function dO(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const qS=["post","put","patch","delete"];new Set(qS);const fO=["get",...qS];new Set(fO);/**
 * React Router v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gu(){return Gu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Gu.apply(this,arguments)}const zy=N.createContext(null),pO=N.createContext(null),To=N.createContext(null),vp=N.createContext(null),os=N.createContext({outlet:null,matches:[],isDataRoute:!1}),HS=N.createContext(null);function gO(t,e){let{relative:n}=e===void 0?{}:e;uc()||Rt(!1);let{basename:r,navigator:i}=N.useContext(To),{hash:s,pathname:o,search:a}=KS(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:oo([r,o])),i.createHref({pathname:l,search:a,hash:s})}function uc(){return N.useContext(vp)!=null}function Ra(){return uc()||Rt(!1),N.useContext(vp).location}function WS(t){N.useContext(To).static||N.useLayoutEffect(t)}function Da(){let{isDataRoute:t}=N.useContext(os);return t?PO():mO()}function mO(){uc()||Rt(!1);let t=N.useContext(zy),{basename:e,future:n,navigator:r}=N.useContext(To),{matches:i}=N.useContext(os),{pathname:s}=Ra(),o=JSON.stringify(Uy(i,n.v7_relativeSplatPath)),a=N.useRef(!1);return WS(()=>{a.current=!0}),N.useCallback(function(u,d){if(d===void 0&&(d={}),!a.current)return;if(typeof u=="number"){r.go(u);return}let p=$y(u,JSON.parse(o),s,d.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:oo([e,p.pathname])),(d.replace?r.replace:r.push)(p,d.state,d)},[e,r,o,s,t])}function vO(){let{matches:t}=N.useContext(os),e=t[t.length-1];return e?e.params:{}}function KS(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=N.useContext(To),{matches:i}=N.useContext(os),{pathname:s}=Ra(),o=JSON.stringify(Uy(i,r.v7_relativeSplatPath));return N.useMemo(()=>$y(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function yO(t,e){return _O(t,e)}function _O(t,e,n,r){uc()||Rt(!1);let{navigator:i}=N.useContext(To),{matches:s}=N.useContext(os),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=Ra(),d;if(e){var p;let D=typeof e=="string"?cc(e):e;l==="/"||(p=D.pathname)!=null&&p.startsWith(l)||Rt(!1),d=D}else d=u;let m=d.pathname||"/",w=m;if(l!=="/"){let D=l.replace(/^\//,"").split("/");w="/"+m.replace(/^\//,"").split("/").slice(D.length).join("/")}let E=WD(t,{pathname:w}),x=SO(E&&E.map(D=>Object.assign({},D,{params:Object.assign({},a,D.params),pathname:oo([l,i.encodeLocation?i.encodeLocation(D.pathname).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?l:oo([l,i.encodeLocation?i.encodeLocation(D.pathnameBase).pathname:D.pathnameBase])})),s,n,r);return e&&x?N.createElement(vp.Provider,{value:{location:Gu({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Ys.Pop}},x):x}function wO(){let t=xO(),e=dO(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),n?N.createElement("pre",{style:i},n):null,null)}const EO=N.createElement(wO,null);class TO extends N.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?N.createElement(os.Provider,{value:this.props.routeContext},N.createElement(HS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function IO(t){let{routeContext:e,match:n,children:r}=t,i=N.useContext(zy);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),N.createElement(os.Provider,{value:e},r)}function SO(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let d=o.findIndex(p=>p.route.id&&(a==null?void 0:a[p.route.id])!==void 0);d>=0||Rt(!1),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let p=o[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=d),p.route.id){let{loaderData:m,errors:w}=n,E=p.route.loader&&m[p.route.id]===void 0&&(!w||w[p.route.id]===void 0);if(p.route.lazy||E){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,p,m)=>{let w,E=!1,x=null,D=null;n&&(w=a&&p.route.id?a[p.route.id]:void 0,x=p.route.errorElement||EO,l&&(u<0&&m===0?(E=!0,D=null):u===m&&(E=!0,D=p.route.hydrateFallbackElement||null)));let A=e.concat(o.slice(0,m+1)),T=()=>{let S;return w?S=x:E?S=D:p.route.Component?S=N.createElement(p.route.Component,null):p.route.element?S=p.route.element:S=d,N.createElement(IO,{match:p,routeContext:{outlet:d,matches:A,isDataRoute:n!=null},children:S})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?N.createElement(TO,{location:n.location,revalidation:n.revalidation,component:x,error:w,children:T(),routeContext:{outlet:null,matches:A,isDataRoute:!0}}):T()},null)}var GS=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(GS||{}),kf=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(kf||{});function bO(t){let e=N.useContext(zy);return e||Rt(!1),e}function CO(t){let e=N.useContext(pO);return e||Rt(!1),e}function AO(t){let e=N.useContext(os);return e||Rt(!1),e}function QS(t){let e=AO(),n=e.matches[e.matches.length-1];return n.route.id||Rt(!1),n.route.id}function xO(){var t;let e=N.useContext(HS),n=CO(kf.UseRouteError),r=QS(kf.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function PO(){let{router:t}=bO(GS.UseNavigateStable),e=QS(kf.UseNavigateStable),n=N.useRef(!1);return WS(()=>{n.current=!0}),N.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Gu({fromRouteId:e},s)))},[t,e])}const nE={};function kO(t,e){nE[e]||(nE[e]=!0,console.warn(e))}const rE=(t,e,n)=>kO(t," React Router Future Flag Warning: "+e+". "+("You can use the `"+t+"` future flag to opt-in early. ")+("For more information, see "+n+"."));function RO(t,e){t!=null&&t.v7_startTransition||rE("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),!(t!=null&&t.v7_relativeSplatPath)&&!e&&rE("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function YS(t){let{to:e,replace:n,state:r,relative:i}=t;uc()||Rt(!1);let{future:s,static:o}=N.useContext(To),{matches:a}=N.useContext(os),{pathname:l}=Ra(),u=Da(),d=$y(e,Uy(a,s.v7_relativeSplatPath),l,i==="path"),p=JSON.stringify(d);return N.useEffect(()=>u(JSON.parse(p),{replace:n,state:r,relative:i}),[u,p,i,n,r]),null}function Tn(t){Rt(!1)}function DO(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Ys.Pop,navigator:s,static:o=!1,future:a}=t;uc()&&Rt(!1);let l=e.replace(/^\/*/,"/"),u=N.useMemo(()=>({basename:l,navigator:s,static:o,future:Gu({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof r=="string"&&(r=cc(r));let{pathname:d="/",search:p="",hash:m="",state:w=null,key:E="default"}=r,x=N.useMemo(()=>{let D=Fy(d,l);return D==null?null:{location:{pathname:D,search:p,hash:m,state:w,key:E},navigationType:i}},[l,d,p,m,w,E,i]);return x==null?null:N.createElement(To.Provider,{value:u},N.createElement(vp.Provider,{children:n,value:x}))}function OO(t){let{children:e,location:n}=t;return yO(tv(e),n)}new Promise(()=>{});function tv(t,e){e===void 0&&(e=[]);let n=[];return N.Children.forEach(t,(r,i)=>{if(!N.isValidElement(r))return;let s=[...e,i];if(r.type===N.Fragment){n.push.apply(n,tv(r.props.children,s));return}r.type!==Tn&&Rt(!1),!r.props.index||!r.props.children||Rt(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=tv(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function nv(){return nv=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},nv.apply(this,arguments)}function NO(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function LO(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function MO(t,e){return t.button===0&&(!e||e==="_self")&&!LO(t)}const VO=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],jO="6";try{window.__reactRouterVersion=jO}catch{}const FO="startTransition",iE=kk[FO];function UO(t){let{basename:e,children:n,future:r,window:i}=t,s=N.useRef();s.current==null&&(s.current=BD({window:i,v5Compat:!0}));let o=s.current,[a,l]=N.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=N.useCallback(p=>{u&&iE?iE(()=>l(p)):l(p)},[l,u]);return N.useLayoutEffect(()=>o.listen(d),[o,d]),N.useEffect(()=>RO(r),[r]),N.createElement(DO,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const $O=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",zO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,sr=N.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:d,viewTransition:p}=e,m=NO(e,VO),{basename:w}=N.useContext(To),E,x=!1;if(typeof u=="string"&&zO.test(u)&&(E=u,$O))try{let S=new URL(window.location.href),M=u.startsWith("//")?new URL(S.protocol+u):new URL(u),q=Fy(M.pathname,w);M.origin===S.origin&&q!=null?u=q+M.search+M.hash:x=!0}catch{}let D=gO(u,{relative:i}),A=BO(u,{replace:o,state:a,target:l,preventScrollReset:d,relative:i,viewTransition:p});function T(S){r&&r(S),S.defaultPrevented||A(S)}return N.createElement("a",nv({},m,{href:E||D,onClick:x||s?r:T,ref:n,target:l}))});var sE;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(sE||(sE={}));var oE;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(oE||(oE={}));function BO(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=Da(),u=Ra(),d=KS(t,{relative:o});return N.useCallback(p=>{if(MO(p,n)){p.preventDefault();let m=r!==void 0?r:Pf(u)===Pf(d);l(t,{replace:m,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[u,l,d,r,i,n,t,s,o,a])}var aE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XS=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},qO=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},JS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,d=s>>2,p=(s&3)<<4|a>>4;let m=(a&15)<<2|u>>6,w=u&63;l||(w=64,o||(m=64)),r.push(n[d],n[p],n[m],n[w])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(XS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):qO(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||p==null)throw new HO;const m=s<<2|a>>4;if(r.push(m),u!==64){const w=a<<4&240|u>>2;if(r.push(w),p!==64){const E=u<<6&192|p;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class HO extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const WO=function(t){const e=XS(t);return JS.encodeByteArray(e,!0)},ZS=function(t){return WO(t).replace(/\./g,"")},eb=function(t){try{return JS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KO(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GO=()=>KO().__FIREBASE_DEFAULTS__,QO=()=>{if(typeof process>"u"||typeof aE>"u")return;const t=aE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},YO=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&eb(t[1]);return e&&JSON.parse(e)},yp=()=>{try{return GO()||QO()||YO()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},XO=t=>{var e,n;return(n=(e=yp())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},tb=()=>{var t;return(t=yp())===null||t===void 0?void 0:t.config},nb=t=>{var e;return(e=yp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ZO(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ht())}function e2(){var t;const e=(t=yp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function t2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function rb(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function n2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function r2(){const t=Ht();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function ib(){return!e2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function By(){try{return typeof indexedDB=="object"}catch{return!1}}function sb(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}function i2(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2="FirebaseError";class ni extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=s2,Object.setPrototypeOf(this,ni.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Oa.prototype.create)}}class Oa{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?o2(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ni(i,a,r)}}function o2(t,e){return t.replace(a2,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const a2=/\{\$([^}]+)}/g;function l2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Kl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(lE(s)&&lE(o)){if(!Kl(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function lE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dh(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ru(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function iu(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function c2(t,e){const n=new u2(t,e);return n.subscribe.bind(n)}class u2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");h2(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Vg),i.error===void 0&&(i.error=Vg),i.complete===void 0&&(i.complete=Vg);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function h2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Vg(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2=1e3,f2=2,p2=4*60*60*1e3,g2=.5;function cE(t,e=d2,n=f2){const r=e*Math.pow(n,t),i=Math.round(g2*r*(Math.random()-.5)*2);return Math.min(p2,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mt(t){return t&&t._delegate?t._delegate:t}class ti{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new JO;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(y2(e))try{this.getOrInitializeService({instanceIdentifier:Xo})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Xo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xo){return this.instances.has(e)}getOptions(e=Xo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:v2(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Xo){return this.component?this.component.multipleInstances?e:Xo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function v2(t){return t===Xo?void 0:t}function y2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new m2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var De;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(De||(De={}));const w2={debug:De.DEBUG,verbose:De.VERBOSE,info:De.INFO,warn:De.WARN,error:De.ERROR,silent:De.SILENT},E2=De.INFO,T2={[De.DEBUG]:"log",[De.VERBOSE]:"log",[De.INFO]:"info",[De.WARN]:"warn",[De.ERROR]:"error"},I2=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=T2[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class _p{constructor(e){this.name=e,this._logLevel=E2,this._logHandler=I2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in De))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?w2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,De.DEBUG,...e),this._logHandler(this,De.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,De.VERBOSE,...e),this._logHandler(this,De.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,De.INFO,...e),this._logHandler(this,De.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,De.WARN,...e),this._logHandler(this,De.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,De.ERROR,...e),this._logHandler(this,De.ERROR,...e)}}const S2=(t,e)=>e.some(n=>t instanceof n);let uE,hE;function b2(){return uE||(uE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function C2(){return hE||(hE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ob=new WeakMap,rv=new WeakMap,ab=new WeakMap,jg=new WeakMap,qy=new WeakMap;function A2(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(ao(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&ob.set(n,t)}).catch(()=>{}),qy.set(e,t),e}function x2(t){if(rv.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});rv.set(t,e)}let iv={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return rv.get(t);if(e==="objectStoreNames")return t.objectStoreNames||ab.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ao(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function P2(t){iv=t(iv)}function k2(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Fg(this),e,...n);return ab.set(r,e.sort?e.sort():[e]),ao(r)}:C2().includes(t)?function(...e){return t.apply(Fg(this),e),ao(ob.get(this))}:function(...e){return ao(t.apply(Fg(this),e))}}function R2(t){return typeof t=="function"?k2(t):(t instanceof IDBTransaction&&x2(t),S2(t,b2())?new Proxy(t,iv):t)}function ao(t){if(t instanceof IDBRequest)return A2(t);if(jg.has(t))return jg.get(t);const e=R2(t);return e!==t&&(jg.set(t,e),qy.set(e,t)),e}const Fg=t=>qy.get(t);function lb(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=ao(o);return r&&o.addEventListener("upgradeneeded",l=>{r(ao(o.result),l.oldVersion,l.newVersion,ao(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const D2=["get","getKey","getAll","getAllKeys","count"],O2=["put","add","delete","clear"],Ug=new Map;function dE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ug.get(e))return Ug.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=O2.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||D2.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return Ug.set(e,s),s}P2(t=>({...t,get:(e,n,r)=>dE(e,n)||t.get(e,n,r),has:(e,n)=>!!dE(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(L2(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function L2(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const sv="@firebase/app",fE="0.10.16";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const es=new _p("@firebase/app"),M2="@firebase/app-compat",V2="@firebase/analytics-compat",j2="@firebase/analytics",F2="@firebase/app-check-compat",U2="@firebase/app-check",$2="@firebase/auth",z2="@firebase/auth-compat",B2="@firebase/database",q2="@firebase/data-connect",H2="@firebase/database-compat",W2="@firebase/functions",K2="@firebase/functions-compat",G2="@firebase/installations",Q2="@firebase/installations-compat",Y2="@firebase/messaging",X2="@firebase/messaging-compat",J2="@firebase/performance",Z2="@firebase/performance-compat",eN="@firebase/remote-config",tN="@firebase/remote-config-compat",nN="@firebase/storage",rN="@firebase/storage-compat",iN="@firebase/firestore",sN="@firebase/vertexai",oN="@firebase/firestore-compat",aN="firebase",lN="11.0.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ov="[DEFAULT]",cN={[sv]:"fire-core",[M2]:"fire-core-compat",[j2]:"fire-analytics",[V2]:"fire-analytics-compat",[U2]:"fire-app-check",[F2]:"fire-app-check-compat",[$2]:"fire-auth",[z2]:"fire-auth-compat",[B2]:"fire-rtdb",[q2]:"fire-data-connect",[H2]:"fire-rtdb-compat",[W2]:"fire-fn",[K2]:"fire-fn-compat",[G2]:"fire-iid",[Q2]:"fire-iid-compat",[Y2]:"fire-fcm",[X2]:"fire-fcm-compat",[J2]:"fire-perf",[Z2]:"fire-perf-compat",[eN]:"fire-rc",[tN]:"fire-rc-compat",[nN]:"fire-gcs",[rN]:"fire-gcs-compat",[iN]:"fire-fst",[oN]:"fire-fst-compat",[sN]:"fire-vertex","fire-js":"fire-js",[aN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf=new Map,uN=new Map,av=new Map;function pE(t,e){try{t.container.addComponent(e)}catch(n){es.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Si(t){const e=t.name;if(av.has(e))return es.debug(`There were multiple attempts to register component ${e}.`),!1;av.set(e,t);for(const n of Rf.values())pE(n,t);for(const n of uN.values())pE(n,t);return!0}function Na(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Qr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},lo=new Oa("app","Firebase",hN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ti("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw lo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hc=lN;function cb(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:ov,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw lo.create("bad-app-name",{appName:String(i)});if(n||(n=tb()),!n)throw lo.create("no-options");const s=Rf.get(i);if(s){if(Kl(n,s.options)&&Kl(r,s.config))return s;throw lo.create("duplicate-app",{appName:i})}const o=new _2(i);for(const l of av.values())o.addComponent(l);const a=new dN(n,r,o);return Rf.set(i,a),a}function ub(t=ov){const e=Rf.get(t);if(!e&&t===ov&&tb())return cb();if(!e)throw lo.create("no-app",{appName:t});return e}function Rr(t,e,n){var r;let i=(r=cN[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),es.warn(a.join(" "));return}Si(new ti(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fN="firebase-heartbeat-database",pN=1,Qu="firebase-heartbeat-store";let $g=null;function hb(){return $g||($g=lb(fN,pN,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Qu)}catch(n){console.warn(n)}}}}).catch(t=>{throw lo.create("idb-open",{originalErrorMessage:t.message})})),$g}async function gN(t){try{const n=(await hb()).transaction(Qu),r=await n.objectStore(Qu).get(db(t));return await n.done,r}catch(e){if(e instanceof ni)es.warn(e.message);else{const n=lo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});es.warn(n.message)}}}async function gE(t,e){try{const r=(await hb()).transaction(Qu,"readwrite");await r.objectStore(Qu).put(e,db(t)),await r.done}catch(n){if(n instanceof ni)es.warn(n.message);else{const r=lo.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});es.warn(r.message)}}}function db(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mN=1024,vN=30*24*60*60*1e3;class yN{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new wN(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=mE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=vN}),this._storage.overwrite(this._heartbeatsCache))}catch(r){es.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=mE(),{heartbeatsToSend:r,unsentEntries:i}=_N(this._heartbeatsCache.heartbeats),s=ZS(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return es.warn(n),""}}}function mE(){return new Date().toISOString().substring(0,10)}function _N(t,e=mN){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),vE(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),vE(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class wN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return By()?sb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await gN(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return gE(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return gE(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function vE(t){return ZS(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EN(t){Si(new ti("platform-logger",e=>new N2(e),"PRIVATE")),Si(new ti("heartbeat",e=>new yN(e),"PRIVATE")),Rr(sv,fE,t),Rr(sv,fE,"esm2017"),Rr("fire-js","")}EN("");function Hy(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function fb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const TN=fb,pb=new Oa("auth","Firebase",fb());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Df=new _p("@firebase/auth");function IN(t,...e){Df.logLevel<=De.WARN&&Df.warn(`Auth (${hc}): ${t}`,...e)}function Ud(t,...e){Df.logLevel<=De.ERROR&&Df.error(`Auth (${hc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lr(t,...e){throw Ky(t,...e)}function Jr(t,...e){return Ky(t,...e)}function Wy(t,e,n){const r=Object.assign(Object.assign({},TN()),{[e]:n});return new Oa("auth","Firebase",r).create(e,{appName:t.name})}function Gi(t){return Wy(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function SN(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Lr(t,"argument-error"),Wy(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ky(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return pb.create(t,...e)}function fe(t,e,...n){if(!t)throw Ky(e,...n)}function Bi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ud(e),new Error(e)}function ts(t,e){t||Bi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function bN(){return yE()==="http:"||yE()==="https:"}function yE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(bN()||rb()||"connection"in navigator)?navigator.onLine:!0}function AN(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,n){this.shortDelay=e,this.longDelay=n,ts(n>e,"Short delay should be less than long delay!"),this.isMobile=ZO()||n2()}get(){return CN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gy(t,e){ts(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Bi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Bi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Bi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN=new fh(3e4,6e4);function Io(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function as(t,e,n,r,i={}){return mb(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=dh(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},s);return t2()||(u.referrerPolicy="no-referrer"),gb.fetch()(vb(t,t.config.apiHost,n,a),u)})}async function mb(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},xN),e);try{const i=new RN(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw md(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw md(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw md(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw md(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Wy(t,d,u);Lr(t,d)}}catch(i){if(i instanceof ni)throw i;Lr(t,"network-request-failed",{message:String(i)})}}async function ph(t,e,n,r,i={}){const s=await as(t,e,n,r,i);return"mfaPendingCredential"in s&&Lr(t,"multi-factor-auth-required",{_serverResponse:s}),s}function vb(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?Gy(t.config,i):`${t.config.apiScheme}://${i}`}function kN(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class RN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Jr(this.auth,"network-request-failed")),PN.get())})}}function md(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Jr(t,e,r);return i.customData._tokenResponse=n,i}function _E(t){return t!==void 0&&t.enterprise!==void 0}class DN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return kN(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function ON(t,e){return as(t,"GET","/v2/recaptchaConfig",Io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NN(t,e){return as(t,"POST","/v1/accounts:delete",e)}async function yb(t,e){return as(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function LN(t,e=!1){const n=Mt(t),r=await n.getIdToken(e),i=Qy(r);fe(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Eu(zg(i.auth_time)),issuedAtTime:Eu(zg(i.iat)),expirationTime:Eu(zg(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function zg(t){return Number(t)*1e3}function Qy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ud("JWT malformed, contained fewer than 3 sections"),null;try{const i=eb(n);return i?JSON.parse(i):(Ud("Failed to decode base64 JWT payload"),null)}catch(i){return Ud("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function wE(t){const e=Qy(t);return fe(e,"internal-error"),fe(typeof e.exp<"u","internal-error"),fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gl(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ni&&MN(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function MN({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Eu(this.lastLoginAt),this.creationTime=Eu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Of(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Gl(t,yb(n,{idToken:r}));fe(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?_b(s.providerUserInfo):[],a=FN(t.providerData,o),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),d=l?u:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new cv(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,p)}async function jN(t){const e=Mt(t);await Of(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function FN(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function _b(t){return t.map(e=>{var{providerId:n}=e,r=Hy(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UN(t,e){const n=await mb(t,{},async()=>{const r=dh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=vb(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",gb.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function $N(t,e){return as(t,"POST","/v2/accounts:revokeToken",Io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){fe(e.idToken,"internal-error"),fe(typeof e.idToken<"u","internal-error"),fe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):wE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){fe(e.length!==0,"internal-error");const n=wE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await UN(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new Ll;return r&&(fe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(fe(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(fe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ll,this.toJSON())}_performRefresh(){return Bi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ds(t,e){fe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class qi{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=Hy(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new VN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new cv(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Gl(this,this.stsTokenManager.getToken(this.auth,e));return fe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return LN(this,e)}reload(){return jN(this)}_assign(e){this!==e&&(fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new qi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Of(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qr(this.auth.app))return Promise.reject(Gi(this.auth));const e=await this.getIdToken();return await Gl(this,NN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,l,u,d;const p=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(i=n.email)!==null&&i!==void 0?i:void 0,w=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=n.photoURL)!==null&&o!==void 0?o:void 0,x=(a=n.tenantId)!==null&&a!==void 0?a:void 0,D=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,A=(u=n.createdAt)!==null&&u!==void 0?u:void 0,T=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:S,emailVerified:M,isAnonymous:q,providerData:W,stsTokenManager:P}=n;fe(S&&P,e,"internal-error");const C=Ll.fromJSON(this.name,P);fe(typeof S=="string",e,"internal-error"),Ds(p,e.name),Ds(m,e.name),fe(typeof M=="boolean",e,"internal-error"),fe(typeof q=="boolean",e,"internal-error"),Ds(w,e.name),Ds(E,e.name),Ds(x,e.name),Ds(D,e.name),Ds(A,e.name),Ds(T,e.name);const R=new qi({uid:S,auth:e,email:m,emailVerified:M,displayName:p,isAnonymous:q,photoURL:E,phoneNumber:w,tenantId:x,stsTokenManager:C,createdAt:A,lastLoginAt:T});return W&&Array.isArray(W)&&(R.providerData=W.map(O=>Object.assign({},O))),D&&(R._redirectEventId=D),R}static async _fromIdTokenResponse(e,n,r=!1){const i=new Ll;i.updateFromServerResponse(n);const s=new qi({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Of(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];fe(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?_b(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new Ll;a.updateFromIdToken(r);const l=new qi({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new cv(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EE=new Map;function Hi(t){ts(t instanceof Function,"Expected a class definition");let e=EE.get(t);return e?(ts(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,EE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}wb.type="NONE";const TE=wb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $d(t,e,n){return`firebase:${t}:${e}:${n}`}class Ml{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=$d(this.userKey,i.apiKey,s),this.fullPersistenceKey=$d("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?qi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Ml(Hi(TE),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Hi(TE);const o=$d(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const d=await u._get(o);if(d){const p=qi._fromJSON(e,d);u!==s&&(a=p),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Ml(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new Ml(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Sb(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Eb(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Cb(e))return"Blackberry";if(Ab(e))return"Webos";if(Tb(e))return"Safari";if((e.includes("chrome/")||Ib(e))&&!e.includes("edge/"))return"Chrome";if(bb(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Eb(t=Ht()){return/firefox\//i.test(t)}function Tb(t=Ht()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ib(t=Ht()){return/crios\//i.test(t)}function Sb(t=Ht()){return/iemobile/i.test(t)}function bb(t=Ht()){return/android/i.test(t)}function Cb(t=Ht()){return/blackberry/i.test(t)}function Ab(t=Ht()){return/webos/i.test(t)}function Yy(t=Ht()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function zN(t=Ht()){var e;return Yy(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function BN(){return r2()&&document.documentMode===10}function xb(t=Ht()){return Yy(t)||bb(t)||Ab(t)||Cb(t)||/windows phone/i.test(t)||Sb(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pb(t,e=[]){let n;switch(t){case"Browser":n=IE(Ht());break;case"Worker":n=`${IE(Ht())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${hc}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HN(t,e={}){return as(t,"GET","/v2/passwordPolicy",Io(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WN=6;class KN{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:WN,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new SE(this),this.idTokenSubscription=new SE(this),this.beforeStateQueue=new qN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Hi(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Ml.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await yb(this,{idToken:e}),r=await qi._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Qr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Of(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=AN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qr(this.app))return Promise.reject(Gi(this));const n=e?Mt(e):null;return n&&fe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qr(this.app)?Promise.reject(Gi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qr(this.app)?Promise.reject(Gi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Hi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await HN(this),n=new KN(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Oa("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await $N(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Hi(e)||this._popupRedirectResolver;fe(n,this,"argument-error"),this.redirectPersistenceManager=await Ml.create(this,[Hi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(fe(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Pb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&IN(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function So(t){return Mt(t)}class SE{constructor(e){this.auth=e,this.observer=null,this.addObserver=c2(n=>this.observer=n)}get next(){return fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function QN(t){wp=t}function kb(t){return wp.loadJS(t)}function YN(){return wp.recaptchaEnterpriseScript}function XN(){return wp.gapiScript}function JN(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class ZN{constructor(){this.enterprise=new eL}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class eL{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const tL="recaptcha-enterprise",Rb="NO_RECAPTCHA";class nL{constructor(e){this.type=tL,this.auth=So(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{ON(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new DN(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;_E(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(Rb)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new ZN().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&_E(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=YN();l.length!==0&&(l+=a),kb(l).then(()=>{i(a,s,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function bE(t,e,n,r=!1,i=!1){const s=new nL(t);let o;if(i)o=Rb;else try{o=await s.verify(n)}catch{o=await s.verify(n,!0)}const a=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function uv(t,e,n,r,i){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await bE(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await bE(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rL(t,e){const n=Na(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Kl(s,e??{}))return i;Lr(i,"already-initialized")}return n.initialize({options:e})}function iL(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Hi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function sL(t,e,n){const r=So(t);fe(r._canInitEmulator,r,"emulator-config-failed"),fe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=Db(e),{host:o,port:a}=oL(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),aL()}function Db(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function oL(t){const e=Db(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:CE(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:CE(o)}}}function CE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function aL(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Bi("not implemented")}_getIdTokenResponse(e){return Bi("not implemented")}_linkToIdToken(e,n){return Bi("not implemented")}_getReauthenticationResolver(e){return Bi("not implemented")}}async function lL(t,e){return as(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cL(t,e){return ph(t,"POST","/v1/accounts:signInWithPassword",Io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uL(t,e){return ph(t,"POST","/v1/accounts:signInWithEmailLink",Io(t,e))}async function hL(t,e){return ph(t,"POST","/v1/accounts:signInWithEmailLink",Io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu extends Xy{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Yu(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Yu(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return uv(e,n,"signInWithPassword",cL);case"emailLink":return uL(e,{email:this._email,oobCode:this._password});default:Lr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return uv(e,r,"signUpPassword",lL);case"emailLink":return hL(e,{idToken:n,email:this._email,oobCode:this._password});default:Lr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vl(t,e){return ph(t,"POST","/v1/accounts:signInWithIdp",Io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dL="http://localhost";class ya extends Xy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ya(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Lr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=Hy(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new ya(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Vl(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Vl(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Vl(e,n)}buildRequest(){const e={requestUri:dL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=dh(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fL(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function pL(t){const e=ru(iu(t)).link,n=e?ru(iu(e)).deep_link_id:null,r=ru(iu(t)).deep_link_id;return(r?ru(iu(r)).link:null)||r||n||e||t}class Jy{constructor(e){var n,r,i,s,o,a;const l=ru(iu(e)),u=(n=l.apiKey)!==null&&n!==void 0?n:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,p=fL((i=l.mode)!==null&&i!==void 0?i:null);fe(u&&d&&p,"argument-error"),this.apiKey=u,this.operation=p,this.code=d,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=pL(e);try{return new Jy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(){this.providerId=dc.PROVIDER_ID}static credential(e,n){return Yu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Jy.parseLink(n);return fe(r,"argument-error"),Yu._fromEmailAndCode(e,r.code,r.tenantId)}}dc.PROVIDER_ID="password";dc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";dc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh extends Zy{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs extends gh{constructor(){super("facebook.com")}static credential(e){return ya._fromParams({providerId:Bs.PROVIDER_ID,signInMethod:Bs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bs.credentialFromTaggedObject(e)}static credentialFromError(e){return Bs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bs.credential(e.oauthAccessToken)}catch{return null}}}Bs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Bs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi extends gh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ya._fromParams({providerId:vi.PROVIDER_ID,signInMethod:vi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return vi.credentialFromTaggedObject(e)}static credentialFromError(e){return vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return vi.credential(n,r)}catch{return null}}}vi.GOOGLE_SIGN_IN_METHOD="google.com";vi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs extends gh{constructor(){super("github.com")}static credential(e){return ya._fromParams({providerId:qs.PROVIDER_ID,signInMethod:qs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qs.credentialFromTaggedObject(e)}static credentialFromError(e){return qs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qs.credential(e.oauthAccessToken)}catch{return null}}}qs.GITHUB_SIGN_IN_METHOD="github.com";qs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs extends gh{constructor(){super("twitter.com")}static credential(e,n){return ya._fromParams({providerId:Hs.PROVIDER_ID,signInMethod:Hs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Hs.credentialFromTaggedObject(e)}static credentialFromError(e){return Hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Hs.credential(n,r)}catch{return null}}}Hs.TWITTER_SIGN_IN_METHOD="twitter.com";Hs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gL(t,e){return ph(t,"POST","/v1/accounts:signUp",Io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await qi._fromIdTokenResponse(e,r,i),o=AE(r);return new _a({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=AE(r);return new _a({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function AE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf extends ni{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Nf.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Nf(e,n,r,i)}}function Ob(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Nf._fromErrorAndOperation(t,s,e,r):s})}async function mL(t,e,n=!1){const r=await Gl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return _a._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vL(t,e,n=!1){const{auth:r}=t;if(Qr(r.app))return Promise.reject(Gi(r));const i="reauthenticate";try{const s=await Gl(t,Ob(r,i,e,t),n);fe(s.idToken,r,"internal-error");const o=Qy(s.idToken);fe(o,r,"internal-error");const{sub:a}=o;return fe(t.uid===a,r,"user-mismatch"),_a._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Lr(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nb(t,e,n=!1){if(Qr(t.app))return Promise.reject(Gi(t));const r="signIn",i=await Ob(t,r,e),s=await _a._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function yL(t,e){return Nb(So(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lb(t){const e=So(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function _L(t,e,n){if(Qr(t.app))return Promise.reject(Gi(t));const r=So(t),o=await uv(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",gL).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&Lb(t),l}),a=await _a._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function wL(t,e,n){return Qr(t.app)?Promise.reject(Gi(t)):yL(Mt(t),dc.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Lb(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EL(t,e){return as(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mb(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Mt(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Gl(r,EL(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function TL(t,e,n,r){return Mt(t).onIdTokenChanged(e,n,r)}function IL(t,e,n){return Mt(t).beforeAuthStateChanged(e,n)}function Vb(t,e,n,r){return Mt(t).onAuthStateChanged(e,n,r)}function SL(t){return Mt(t).signOut()}const Lf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Lf,"1"),this.storage.removeItem(Lf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bL=1e3,CL=10;class Fb extends jb{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);BN()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,CL):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},bL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Fb.type="LOCAL";const AL=Fb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub extends jb{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Ub.type="SESSION";const $b=Ub;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xL(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Ep(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await xL(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ep.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=e_("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ii(){return window}function kL(t){Ii().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zb(){return typeof Ii().WorkerGlobalScope<"u"&&typeof Ii().importScripts=="function"}async function RL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function DL(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function OL(){return zb()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bb="firebaseLocalStorageDb",NL=1,Mf="firebaseLocalStorage",qb="fbase_key";class mh{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Tp(t,e){return t.transaction([Mf],e?"readwrite":"readonly").objectStore(Mf)}function LL(){const t=indexedDB.deleteDatabase(Bb);return new mh(t).toPromise()}function hv(){const t=indexedDB.open(Bb,NL);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Mf,{keyPath:qb})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Mf)?e(r):(r.close(),await LL(),e(await hv()))})})}async function xE(t,e,n){const r=Tp(t,!0).put({[qb]:e,value:n});return new mh(r).toPromise()}async function ML(t,e){const n=Tp(t,!1).get(e),r=await new mh(n).toPromise();return r===void 0?null:r.value}function PE(t,e){const n=Tp(t,!0).delete(e);return new mh(n).toPromise()}const VL=800,jL=3;class Hb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await hv(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>jL)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return zb()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ep._getInstance(OL()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await RL(),!this.activeServiceWorker)return;this.sender=new PL(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||DL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await hv();return await xE(e,Lf,"1"),await PE(e,Lf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>xE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>ML(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>PE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Tp(i,!1).getAll();return new mh(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),VL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Hb.type="LOCAL";const FL=Hb;new fh(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wb(t,e){return e?Hi(e):(fe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_ extends Xy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vl(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Vl(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Vl(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function UL(t){return Nb(t.auth,new t_(t),t.bypassAuthState)}function $L(t){const{auth:e,user:n}=t;return fe(n,e,"internal-error"),vL(n,new t_(t),t.bypassAuthState)}async function zL(t){const{auth:e,user:n}=t;return fe(n,e,"internal-error"),mL(n,new t_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return UL;case"linkViaPopup":case"linkViaRedirect":return zL;case"reauthViaPopup":case"reauthViaRedirect":return $L;default:Lr(this.auth,"internal-error")}}resolve(e){ts(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ts(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BL=new fh(2e3,1e4);async function Gb(t,e,n){if(Qr(t.app))return Promise.reject(Jr(t,"operation-not-supported-in-this-environment"));const r=So(t);SN(t,e,Zy);const i=Wb(r,n);return new oa(r,"signInViaPopup",e,i).executeNotNull()}class oa extends Kb{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,oa.currentPopupAction&&oa.currentPopupAction.cancel(),oa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return fe(e,this.auth,"internal-error"),e}async onExecution(){ts(this.filter.length===1,"Popup operations only handle one event");const e=e_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Jr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Jr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,oa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Jr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,BL.get())};e()}}oa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL="pendingRedirect",zd=new Map;class HL extends Kb{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=zd.get(this.auth._key());if(!e){try{const r=await WL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}zd.set(this.auth._key(),e)}return this.bypassAuthState||zd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function WL(t,e){const n=QL(e),r=GL(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function KL(t,e){zd.set(t._key(),e)}function GL(t){return Hi(t._redirectPersistence)}function QL(t){return $d(qL,t.config.apiKey,t.name)}async function YL(t,e,n=!1){if(Qr(t.app))return Promise.reject(Gi(t));const r=So(t),i=Wb(r,e),o=await new HL(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL=10*60*1e3;class JL{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!ZL(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Qb(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Jr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=XL&&this.cachedEventUids.clear(),this.cachedEventUids.has(kE(e))}saveEventToCache(e){this.cachedEventUids.add(kE(e)),this.lastProcessedEventTime=Date.now()}}function kE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Qb({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function ZL(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Qb(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eM(t,e={}){return as(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,nM=/^https?/;async function rM(t){if(t.config.emulator)return;const{authorizedDomains:e}=await eM(t);for(const n of e)try{if(iM(n))return}catch{}Lr(t,"unauthorized-domain")}function iM(t){const e=lv(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!nM.test(n))return!1;if(tM.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sM=new fh(3e4,6e4);function RE(){const t=Ii().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function oM(t){return new Promise((e,n)=>{var r,i,s;function o(){RE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{RE(),n(Jr(t,"network-request-failed"))},timeout:sM.get()})}if(!((i=(r=Ii().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Ii().gapi)===null||s===void 0)&&s.load)o();else{const a=JN("iframefcb");return Ii()[a]=()=>{gapi.load?o():n(Jr(t,"network-request-failed"))},kb(`${XN()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Bd=null,e})}let Bd=null;function aM(t){return Bd=Bd||oM(t),Bd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lM=new fh(5e3,15e3),cM="__/auth/iframe",uM="emulator/auth/iframe",hM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},dM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function fM(t){const e=t.config;fe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Gy(e,uM):`https://${t.config.authDomain}/${cM}`,r={apiKey:e.apiKey,appName:t.name,v:hc},i=dM.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${dh(r).slice(1)}`}async function pM(t){const e=await aM(t),n=Ii().gapi;return fe(n,t,"internal-error"),e.open({where:document.body,url:fM(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:hM,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Jr(t,"network-request-failed"),a=Ii().setTimeout(()=>{s(o)},lM.get());function l(){Ii().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},mM=500,vM=600,yM="_blank",_M="http://localhost";class DE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function wM(t,e,n,r=mM,i=vM){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},gM),{width:r.toString(),height:i.toString(),top:s,left:o}),u=Ht().toLowerCase();n&&(a=Ib(u)?yM:n),Eb(u)&&(e=e||_M,l.scrollbars="yes");const d=Object.entries(l).reduce((m,[w,E])=>`${m}${w}=${E},`,"");if(zN(u)&&a!=="_self")return EM(e||"",a),new DE(null);const p=window.open(e||"",a,d);fe(p,t,"popup-blocked");try{p.focus()}catch{}return new DE(p)}function EM(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TM="__/auth/handler",IM="emulator/auth/handler",SM=encodeURIComponent("fac");async function OE(t,e,n,r,i,s){fe(t.config.authDomain,t,"auth-domain-config-required"),fe(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:hc,eventId:i};if(e instanceof Zy){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",l2(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,p]of Object.entries({}))o[d]=p}if(e instanceof gh){const d=e.getScopes().filter(p=>p!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),u=l?`#${SM}=${encodeURIComponent(l)}`:"";return`${bM(t)}?${dh(a).slice(1)}${u}`}function bM({config:t}){return t.emulator?Gy(t,IM):`https://${t.authDomain}/${TM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bg="webStorageSupport";class CM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$b,this._completeRedirectFn=YL,this._overrideRedirectResult=KL}async _openPopup(e,n,r,i){var s;ts((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await OE(e,n,r,lv(),i);return wM(e,o,e_())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await OE(e,n,r,lv(),i);return kL(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(ts(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await pM(e),r=new JL(e);return n.register("authEvent",i=>(fe(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Bg,{type:Bg},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Bg];o!==void 0&&n(!!o),Lr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=rM(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return xb()||Tb()||Yy()}}const AM=CM;var NE="@firebase/auth",LE="1.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PM(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function kM(t){Si(new ti("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;fe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Pb(t)},u=new GN(r,i,s,l);return iL(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Si(new ti("auth-internal",e=>{const n=So(e.getProvider("auth").getImmediate());return(r=>new xM(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Rr(NE,LE,PM(t)),Rr(NE,LE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RM=5*60,DM=nb("authIdTokenMaxAge")||RM;let ME=null;const OM=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>DM)return;const i=n==null?void 0:n.token;ME!==i&&(ME=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function NM(t=ub()){const e=Na(t,"auth");if(e.isInitialized())return e.getImmediate();const n=rL(t,{popupRedirectResolver:AM,persistence:[FL,AL,$b]}),r=nb("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=OM(s.toString());IL(n,o,()=>o(n.currentUser)),TL(n,a=>o(a))}}const i=XO("auth");return i&&sL(n,`http://${i}`),n}function LM(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}QN({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Jr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",LM().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});kM("Browser");var MM="firebase",VM="11.0.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rr(MM,VM,"app");var VE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ua,Yb;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(P,C){function R(){}R.prototype=C.prototype,P.D=C.prototype,P.prototype=new R,P.prototype.constructor=P,P.C=function(O,L,V){for(var k=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)k[ge-2]=arguments[ge];return C.prototype[L].apply(O,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(P,C,R){R||(R=0);var O=Array(16);if(typeof C=="string")for(var L=0;16>L;++L)O[L]=C.charCodeAt(R++)|C.charCodeAt(R++)<<8|C.charCodeAt(R++)<<16|C.charCodeAt(R++)<<24;else for(L=0;16>L;++L)O[L]=C[R++]|C[R++]<<8|C[R++]<<16|C[R++]<<24;C=P.g[0],R=P.g[1],L=P.g[2];var V=P.g[3],k=C+(V^R&(L^V))+O[0]+3614090360&4294967295;C=R+(k<<7&4294967295|k>>>25),k=V+(L^C&(R^L))+O[1]+3905402710&4294967295,V=C+(k<<12&4294967295|k>>>20),k=L+(R^V&(C^R))+O[2]+606105819&4294967295,L=V+(k<<17&4294967295|k>>>15),k=R+(C^L&(V^C))+O[3]+3250441966&4294967295,R=L+(k<<22&4294967295|k>>>10),k=C+(V^R&(L^V))+O[4]+4118548399&4294967295,C=R+(k<<7&4294967295|k>>>25),k=V+(L^C&(R^L))+O[5]+1200080426&4294967295,V=C+(k<<12&4294967295|k>>>20),k=L+(R^V&(C^R))+O[6]+2821735955&4294967295,L=V+(k<<17&4294967295|k>>>15),k=R+(C^L&(V^C))+O[7]+4249261313&4294967295,R=L+(k<<22&4294967295|k>>>10),k=C+(V^R&(L^V))+O[8]+1770035416&4294967295,C=R+(k<<7&4294967295|k>>>25),k=V+(L^C&(R^L))+O[9]+2336552879&4294967295,V=C+(k<<12&4294967295|k>>>20),k=L+(R^V&(C^R))+O[10]+4294925233&4294967295,L=V+(k<<17&4294967295|k>>>15),k=R+(C^L&(V^C))+O[11]+2304563134&4294967295,R=L+(k<<22&4294967295|k>>>10),k=C+(V^R&(L^V))+O[12]+1804603682&4294967295,C=R+(k<<7&4294967295|k>>>25),k=V+(L^C&(R^L))+O[13]+4254626195&4294967295,V=C+(k<<12&4294967295|k>>>20),k=L+(R^V&(C^R))+O[14]+2792965006&4294967295,L=V+(k<<17&4294967295|k>>>15),k=R+(C^L&(V^C))+O[15]+1236535329&4294967295,R=L+(k<<22&4294967295|k>>>10),k=C+(L^V&(R^L))+O[1]+4129170786&4294967295,C=R+(k<<5&4294967295|k>>>27),k=V+(R^L&(C^R))+O[6]+3225465664&4294967295,V=C+(k<<9&4294967295|k>>>23),k=L+(C^R&(V^C))+O[11]+643717713&4294967295,L=V+(k<<14&4294967295|k>>>18),k=R+(V^C&(L^V))+O[0]+3921069994&4294967295,R=L+(k<<20&4294967295|k>>>12),k=C+(L^V&(R^L))+O[5]+3593408605&4294967295,C=R+(k<<5&4294967295|k>>>27),k=V+(R^L&(C^R))+O[10]+38016083&4294967295,V=C+(k<<9&4294967295|k>>>23),k=L+(C^R&(V^C))+O[15]+3634488961&4294967295,L=V+(k<<14&4294967295|k>>>18),k=R+(V^C&(L^V))+O[4]+3889429448&4294967295,R=L+(k<<20&4294967295|k>>>12),k=C+(L^V&(R^L))+O[9]+568446438&4294967295,C=R+(k<<5&4294967295|k>>>27),k=V+(R^L&(C^R))+O[14]+3275163606&4294967295,V=C+(k<<9&4294967295|k>>>23),k=L+(C^R&(V^C))+O[3]+4107603335&4294967295,L=V+(k<<14&4294967295|k>>>18),k=R+(V^C&(L^V))+O[8]+1163531501&4294967295,R=L+(k<<20&4294967295|k>>>12),k=C+(L^V&(R^L))+O[13]+2850285829&4294967295,C=R+(k<<5&4294967295|k>>>27),k=V+(R^L&(C^R))+O[2]+4243563512&4294967295,V=C+(k<<9&4294967295|k>>>23),k=L+(C^R&(V^C))+O[7]+1735328473&4294967295,L=V+(k<<14&4294967295|k>>>18),k=R+(V^C&(L^V))+O[12]+2368359562&4294967295,R=L+(k<<20&4294967295|k>>>12),k=C+(R^L^V)+O[5]+4294588738&4294967295,C=R+(k<<4&4294967295|k>>>28),k=V+(C^R^L)+O[8]+2272392833&4294967295,V=C+(k<<11&4294967295|k>>>21),k=L+(V^C^R)+O[11]+1839030562&4294967295,L=V+(k<<16&4294967295|k>>>16),k=R+(L^V^C)+O[14]+4259657740&4294967295,R=L+(k<<23&4294967295|k>>>9),k=C+(R^L^V)+O[1]+2763975236&4294967295,C=R+(k<<4&4294967295|k>>>28),k=V+(C^R^L)+O[4]+1272893353&4294967295,V=C+(k<<11&4294967295|k>>>21),k=L+(V^C^R)+O[7]+4139469664&4294967295,L=V+(k<<16&4294967295|k>>>16),k=R+(L^V^C)+O[10]+3200236656&4294967295,R=L+(k<<23&4294967295|k>>>9),k=C+(R^L^V)+O[13]+681279174&4294967295,C=R+(k<<4&4294967295|k>>>28),k=V+(C^R^L)+O[0]+3936430074&4294967295,V=C+(k<<11&4294967295|k>>>21),k=L+(V^C^R)+O[3]+3572445317&4294967295,L=V+(k<<16&4294967295|k>>>16),k=R+(L^V^C)+O[6]+76029189&4294967295,R=L+(k<<23&4294967295|k>>>9),k=C+(R^L^V)+O[9]+3654602809&4294967295,C=R+(k<<4&4294967295|k>>>28),k=V+(C^R^L)+O[12]+3873151461&4294967295,V=C+(k<<11&4294967295|k>>>21),k=L+(V^C^R)+O[15]+530742520&4294967295,L=V+(k<<16&4294967295|k>>>16),k=R+(L^V^C)+O[2]+3299628645&4294967295,R=L+(k<<23&4294967295|k>>>9),k=C+(L^(R|~V))+O[0]+4096336452&4294967295,C=R+(k<<6&4294967295|k>>>26),k=V+(R^(C|~L))+O[7]+1126891415&4294967295,V=C+(k<<10&4294967295|k>>>22),k=L+(C^(V|~R))+O[14]+2878612391&4294967295,L=V+(k<<15&4294967295|k>>>17),k=R+(V^(L|~C))+O[5]+4237533241&4294967295,R=L+(k<<21&4294967295|k>>>11),k=C+(L^(R|~V))+O[12]+1700485571&4294967295,C=R+(k<<6&4294967295|k>>>26),k=V+(R^(C|~L))+O[3]+2399980690&4294967295,V=C+(k<<10&4294967295|k>>>22),k=L+(C^(V|~R))+O[10]+4293915773&4294967295,L=V+(k<<15&4294967295|k>>>17),k=R+(V^(L|~C))+O[1]+2240044497&4294967295,R=L+(k<<21&4294967295|k>>>11),k=C+(L^(R|~V))+O[8]+1873313359&4294967295,C=R+(k<<6&4294967295|k>>>26),k=V+(R^(C|~L))+O[15]+4264355552&4294967295,V=C+(k<<10&4294967295|k>>>22),k=L+(C^(V|~R))+O[6]+2734768916&4294967295,L=V+(k<<15&4294967295|k>>>17),k=R+(V^(L|~C))+O[13]+1309151649&4294967295,R=L+(k<<21&4294967295|k>>>11),k=C+(L^(R|~V))+O[4]+4149444226&4294967295,C=R+(k<<6&4294967295|k>>>26),k=V+(R^(C|~L))+O[11]+3174756917&4294967295,V=C+(k<<10&4294967295|k>>>22),k=L+(C^(V|~R))+O[2]+718787259&4294967295,L=V+(k<<15&4294967295|k>>>17),k=R+(V^(L|~C))+O[9]+3951481745&4294967295,P.g[0]=P.g[0]+C&4294967295,P.g[1]=P.g[1]+(L+(k<<21&4294967295|k>>>11))&4294967295,P.g[2]=P.g[2]+L&4294967295,P.g[3]=P.g[3]+V&4294967295}r.prototype.u=function(P,C){C===void 0&&(C=P.length);for(var R=C-this.blockSize,O=this.B,L=this.h,V=0;V<C;){if(L==0)for(;V<=R;)i(this,P,V),V+=this.blockSize;if(typeof P=="string"){for(;V<C;)if(O[L++]=P.charCodeAt(V++),L==this.blockSize){i(this,O),L=0;break}}else for(;V<C;)if(O[L++]=P[V++],L==this.blockSize){i(this,O),L=0;break}}this.h=L,this.o+=C},r.prototype.v=function(){var P=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);P[0]=128;for(var C=1;C<P.length-8;++C)P[C]=0;var R=8*this.o;for(C=P.length-8;C<P.length;++C)P[C]=R&255,R/=256;for(this.u(P),P=Array(16),C=R=0;4>C;++C)for(var O=0;32>O;O+=8)P[R++]=this.g[C]>>>O&255;return P};function s(P,C){var R=a;return Object.prototype.hasOwnProperty.call(R,P)?R[P]:R[P]=C(P)}function o(P,C){this.h=C;for(var R=[],O=!0,L=P.length-1;0<=L;L--){var V=P[L]|0;O&&V==C||(R[L]=V,O=!1)}this.g=R}var a={};function l(P){return-128<=P&&128>P?s(P,function(C){return new o([C|0],0>C?-1:0)}):new o([P|0],0>P?-1:0)}function u(P){if(isNaN(P)||!isFinite(P))return p;if(0>P)return D(u(-P));for(var C=[],R=1,O=0;P>=R;O++)C[O]=P/R|0,R*=4294967296;return new o(C,0)}function d(P,C){if(P.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(P.charAt(0)=="-")return D(d(P.substring(1),C));if(0<=P.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=u(Math.pow(C,8)),O=p,L=0;L<P.length;L+=8){var V=Math.min(8,P.length-L),k=parseInt(P.substring(L,L+V),C);8>V?(V=u(Math.pow(C,V)),O=O.j(V).add(u(k))):(O=O.j(R),O=O.add(u(k)))}return O}var p=l(0),m=l(1),w=l(16777216);t=o.prototype,t.m=function(){if(x(this))return-D(this).m();for(var P=0,C=1,R=0;R<this.g.length;R++){var O=this.i(R);P+=(0<=O?O:4294967296+O)*C,C*=4294967296}return P},t.toString=function(P){if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(E(this))return"0";if(x(this))return"-"+D(this).toString(P);for(var C=u(Math.pow(P,6)),R=this,O="";;){var L=M(R,C).g;R=A(R,L.j(C));var V=((0<R.g.length?R.g[0]:R.h)>>>0).toString(P);if(R=L,E(R))return V+O;for(;6>V.length;)V="0"+V;O=V+O}},t.i=function(P){return 0>P?0:P<this.g.length?this.g[P]:this.h};function E(P){if(P.h!=0)return!1;for(var C=0;C<P.g.length;C++)if(P.g[C]!=0)return!1;return!0}function x(P){return P.h==-1}t.l=function(P){return P=A(this,P),x(P)?-1:E(P)?0:1};function D(P){for(var C=P.g.length,R=[],O=0;O<C;O++)R[O]=~P.g[O];return new o(R,~P.h).add(m)}t.abs=function(){return x(this)?D(this):this},t.add=function(P){for(var C=Math.max(this.g.length,P.g.length),R=[],O=0,L=0;L<=C;L++){var V=O+(this.i(L)&65535)+(P.i(L)&65535),k=(V>>>16)+(this.i(L)>>>16)+(P.i(L)>>>16);O=k>>>16,V&=65535,k&=65535,R[L]=k<<16|V}return new o(R,R[R.length-1]&-2147483648?-1:0)};function A(P,C){return P.add(D(C))}t.j=function(P){if(E(this)||E(P))return p;if(x(this))return x(P)?D(this).j(D(P)):D(D(this).j(P));if(x(P))return D(this.j(D(P)));if(0>this.l(w)&&0>P.l(w))return u(this.m()*P.m());for(var C=this.g.length+P.g.length,R=[],O=0;O<2*C;O++)R[O]=0;for(O=0;O<this.g.length;O++)for(var L=0;L<P.g.length;L++){var V=this.i(O)>>>16,k=this.i(O)&65535,ge=P.i(L)>>>16,Te=P.i(L)&65535;R[2*O+2*L]+=k*Te,T(R,2*O+2*L),R[2*O+2*L+1]+=V*Te,T(R,2*O+2*L+1),R[2*O+2*L+1]+=k*ge,T(R,2*O+2*L+1),R[2*O+2*L+2]+=V*ge,T(R,2*O+2*L+2)}for(O=0;O<C;O++)R[O]=R[2*O+1]<<16|R[2*O];for(O=C;O<2*C;O++)R[O]=0;return new o(R,0)};function T(P,C){for(;(P[C]&65535)!=P[C];)P[C+1]+=P[C]>>>16,P[C]&=65535,C++}function S(P,C){this.g=P,this.h=C}function M(P,C){if(E(C))throw Error("division by zero");if(E(P))return new S(p,p);if(x(P))return C=M(D(P),C),new S(D(C.g),D(C.h));if(x(C))return C=M(P,D(C)),new S(D(C.g),C.h);if(30<P.g.length){if(x(P)||x(C))throw Error("slowDivide_ only works with positive integers.");for(var R=m,O=C;0>=O.l(P);)R=q(R),O=q(O);var L=W(R,1),V=W(O,1);for(O=W(O,2),R=W(R,2);!E(O);){var k=V.add(O);0>=k.l(P)&&(L=L.add(R),V=k),O=W(O,1),R=W(R,1)}return C=A(P,L.j(C)),new S(L,C)}for(L=p;0<=P.l(C);){for(R=Math.max(1,Math.floor(P.m()/C.m())),O=Math.ceil(Math.log(R)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),V=u(R),k=V.j(C);x(k)||0<k.l(P);)R-=O,V=u(R),k=V.j(C);E(V)&&(V=m),L=L.add(V),P=A(P,k)}return new S(L,P)}t.A=function(P){return M(this,P).h},t.and=function(P){for(var C=Math.max(this.g.length,P.g.length),R=[],O=0;O<C;O++)R[O]=this.i(O)&P.i(O);return new o(R,this.h&P.h)},t.or=function(P){for(var C=Math.max(this.g.length,P.g.length),R=[],O=0;O<C;O++)R[O]=this.i(O)|P.i(O);return new o(R,this.h|P.h)},t.xor=function(P){for(var C=Math.max(this.g.length,P.g.length),R=[],O=0;O<C;O++)R[O]=this.i(O)^P.i(O);return new o(R,this.h^P.h)};function q(P){for(var C=P.g.length+1,R=[],O=0;O<C;O++)R[O]=P.i(O)<<1|P.i(O-1)>>>31;return new o(R,P.h)}function W(P,C){var R=C>>5;C%=32;for(var O=P.g.length-R,L=[],V=0;V<O;V++)L[V]=0<C?P.i(V+R)>>>C|P.i(V+R+1)<<32-C:P.i(V+R);return new o(L,P.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Yb=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,ua=o}).apply(typeof VE<"u"?VE:typeof self<"u"?self:typeof window<"u"?window:{});var vd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Xb,su,Jb,qd,dv,Zb,eC,tC;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,f,v){return c==Array.prototype||c==Object.prototype||(c[f]=v.value),c};function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof vd=="object"&&vd];for(var f=0;f<c.length;++f){var v=c[f];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var r=n(this);function i(c,f){if(f)e:{var v=r;c=c.split(".");for(var b=0;b<c.length-1;b++){var U=c[b];if(!(U in v))break e;v=v[U]}c=c[c.length-1],b=v[c],f=f(b),f!=b&&f!=null&&e(v,c,{configurable:!0,writable:!0,value:f})}}function s(c,f){c instanceof String&&(c+="");var v=0,b=!1,U={next:function(){if(!b&&v<c.length){var B=v++;return{value:f(B,c[B]),done:!1}}return b=!0,{done:!0,value:void 0}}};return U[Symbol.iterator]=function(){return U},U}i("Array.prototype.values",function(c){return c||function(){return s(this,function(f,v){return v})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(c){var f=typeof c;return f=f!="object"?f:c?Array.isArray(c)?"array":f:"null",f=="array"||f=="object"&&typeof c.length=="number"}function u(c){var f=typeof c;return f=="object"&&c!=null||f=="function"}function d(c,f,v){return c.call.apply(c.bind,arguments)}function p(c,f,v){if(!c)throw Error();if(2<arguments.length){var b=Array.prototype.slice.call(arguments,2);return function(){var U=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(U,b),c.apply(f,U)}}return function(){return c.apply(f,arguments)}}function m(c,f,v){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:p,m.apply(null,arguments)}function w(c,f){var v=Array.prototype.slice.call(arguments,1);return function(){var b=v.slice();return b.push.apply(b,arguments),c.apply(this,b)}}function E(c,f){function v(){}v.prototype=f.prototype,c.aa=f.prototype,c.prototype=new v,c.prototype.constructor=c,c.Qb=function(b,U,B){for(var J=Array(arguments.length-2),He=2;He<arguments.length;He++)J[He-2]=arguments[He];return f.prototype[U].apply(b,J)}}function x(c){const f=c.length;if(0<f){const v=Array(f);for(let b=0;b<f;b++)v[b]=c[b];return v}return[]}function D(c,f){for(let v=1;v<arguments.length;v++){const b=arguments[v];if(l(b)){const U=c.length||0,B=b.length||0;c.length=U+B;for(let J=0;J<B;J++)c[U+J]=b[J]}else c.push(b)}}class A{constructor(f,v){this.i=f,this.j=v,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function T(c){return/^[\s\xa0]*$/.test(c)}function S(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function M(c){return M[" "](c),c}M[" "]=function(){};var q=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function W(c,f,v){for(const b in c)f.call(v,c[b],b,c)}function P(c,f){for(const v in c)f.call(void 0,c[v],v,c)}function C(c){const f={};for(const v in c)f[v]=c[v];return f}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(c,f){let v,b;for(let U=1;U<arguments.length;U++){b=arguments[U];for(v in b)c[v]=b[v];for(let B=0;B<R.length;B++)v=R[B],Object.prototype.hasOwnProperty.call(b,v)&&(c[v]=b[v])}}function L(c){var f=1;c=c.split(":");const v=[];for(;0<f&&c.length;)v.push(c.shift()),f--;return c.length&&v.push(c.join(":")),v}function V(c){a.setTimeout(()=>{throw c},0)}function k(){var c=ae;let f=null;return c.g&&(f=c.g,c.g=c.g.next,c.g||(c.h=null),f.next=null),f}class ge{constructor(){this.h=this.g=null}add(f,v){const b=Te.get();b.set(f,v),this.h?this.h.next=b:this.g=b,this.h=b}}var Te=new A(()=>new Ie,c=>c.reset());class Ie{constructor(){this.next=this.g=this.h=null}set(f,v){this.h=f,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let Se,X=!1,ae=new ge,z=()=>{const c=a.Promise.resolve(void 0);Se=()=>{c.then(Le)}};var Le=()=>{for(var c;c=k();){try{c.h.call(c.g)}catch(v){V(v)}var f=Te;f.j(c),100>f.h&&(f.h++,c.next=f.g,f.g=c)}X=!1};function Me(){this.s=this.s,this.C=this.C}Me.prototype.s=!1,Me.prototype.ma=function(){this.s||(this.s=!0,this.N())},Me.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Be(c,f){this.type=c,this.g=this.target=f,this.defaultPrevented=!1}Be.prototype.h=function(){this.defaultPrevented=!0};var ut=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,f=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const v=()=>{};a.addEventListener("test",v,f),a.removeEventListener("test",v,f)}catch{}return c}();function jt(c,f){if(Be.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var v=this.type=c.type,b=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=f,f=c.relatedTarget){if(q){e:{try{M(f.nodeName);var U=!0;break e}catch{}U=!1}U||(f=null)}}else v=="mouseover"?f=c.fromElement:v=="mouseout"&&(f=c.toElement);this.relatedTarget=f,b?(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:nt[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&jt.aa.h.call(this)}}E(jt,Be);var nt={2:"touch",3:"pen",4:"mouse"};jt.prototype.h=function(){jt.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),se=0;function Wn(c,f,v,b,U){this.listener=c,this.proxy=null,this.src=f,this.type=v,this.capture=!!b,this.ha=U,this.key=++se,this.da=this.fa=!1}function Kn(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function At(c){this.src=c,this.g={},this.h=0}At.prototype.add=function(c,f,v,b,U){var B=c.toString();c=this.g[B],c||(c=this.g[B]=[],this.h++);var J=On(c,f,b,U);return-1<J?(f=c[J],v||(f.fa=!1)):(f=new Wn(f,this.src,B,!!b,U),f.fa=v,c.push(f)),f};function Kt(c,f){var v=f.type;if(v in c.g){var b=c.g[v],U=Array.prototype.indexOf.call(b,f,void 0),B;(B=0<=U)&&Array.prototype.splice.call(b,U,1),B&&(Kn(f),c.g[v].length==0&&(delete c.g[v],c.h--))}}function On(c,f,v,b){for(var U=0;U<c.length;++U){var B=c[U];if(!B.da&&B.listener==f&&B.capture==!!v&&B.ha==b)return U}return-1}var hs="closure_lm_"+(1e6*Math.random()|0),Gn={};function on(c,f,v,b,U){if(Array.isArray(f)){for(var B=0;B<f.length;B++)on(c,f[B],v,b,U);return null}return v=Dt(v),c&&c[de]?c.K(f,v,u(b)?!!b.capture:!!b,U):mc(c,f,v,!1,b,U)}function mc(c,f,v,b,U,B){if(!f)throw Error("Invalid event type");var J=u(U)?!!U.capture:!!U,He=fs(c);if(He||(c[hs]=He=new At(c)),v=He.add(f,v,b,J,B),v.proxy)return v;if(b=xo(),v.proxy=b,b.src=c,b.listener=v,c.addEventListener)ut||(U=J),U===void 0&&(U=!1),c.addEventListener(f.toString(),b,U);else if(c.attachEvent)c.attachEvent(Fa(f.toString()),b);else if(c.addListener&&c.removeListener)c.addListener(b);else throw Error("addEventListener and attachEvent are unavailable.");return v}function xo(){function c(v){return f.call(c.src,c.listener,v)}const f=Po;return c}function ja(c,f,v,b,U){if(Array.isArray(f))for(var B=0;B<f.length;B++)ja(c,f[B],v,b,U);else b=u(b)?!!b.capture:!!b,v=Dt(v),c&&c[de]?(c=c.i,f=String(f).toString(),f in c.g&&(B=c.g[f],v=On(B,v,b,U),-1<v&&(Kn(B[v]),Array.prototype.splice.call(B,v,1),B.length==0&&(delete c.g[f],c.h--)))):c&&(c=fs(c))&&(f=c.g[f.toString()],c=-1,f&&(c=On(f,v,b,U)),(v=-1<c?f[c]:null)&&ds(v))}function ds(c){if(typeof c!="number"&&c&&!c.da){var f=c.src;if(f&&f[de])Kt(f.i,c);else{var v=c.type,b=c.proxy;f.removeEventListener?f.removeEventListener(v,b,c.capture):f.detachEvent?f.detachEvent(Fa(v),b):f.addListener&&f.removeListener&&f.removeListener(b),(v=fs(f))?(Kt(v,c),v.h==0&&(v.src=null,f[hs]=null)):Kn(c)}}}function Fa(c){return c in Gn?Gn[c]:Gn[c]="on"+c}function Po(c,f){if(c.da)c=!0;else{f=new jt(f,this);var v=c.listener,b=c.ha||c.src;c.fa&&ds(c),c=v.call(b,f)}return c}function fs(c){return c=c[hs],c instanceof At?c:null}var hr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Dt(c){return typeof c=="function"?c:(c[hr]||(c[hr]=function(f){return c.handleEvent(f)}),c[hr])}function vt(){Me.call(this),this.i=new At(this),this.M=this,this.F=null}E(vt,Me),vt.prototype[de]=!0,vt.prototype.removeEventListener=function(c,f,v,b){ja(this,c,f,v,b)};function it(c,f){var v,b=c.F;if(b)for(v=[];b;b=b.F)v.push(b);if(c=c.M,b=f.type||f,typeof f=="string")f=new Be(f,c);else if(f instanceof Be)f.target=f.target||c;else{var U=f;f=new Be(b,c),O(f,U)}if(U=!0,v)for(var B=v.length-1;0<=B;B--){var J=f.g=v[B];U=Qn(J,b,!0,f)&&U}if(J=f.g=c,U=Qn(J,b,!0,f)&&U,U=Qn(J,b,!1,f)&&U,v)for(B=0;B<v.length;B++)J=f.g=v[B],U=Qn(J,b,!1,f)&&U}vt.prototype.N=function(){if(vt.aa.N.call(this),this.i){var c=this.i,f;for(f in c.g){for(var v=c.g[f],b=0;b<v.length;b++)Kn(v[b]);delete c.g[f],c.h--}}this.F=null},vt.prototype.K=function(c,f,v,b){return this.i.add(String(c),f,!1,v,b)},vt.prototype.L=function(c,f,v,b){return this.i.add(String(c),f,!0,v,b)};function Qn(c,f,v,b){if(f=c.i.g[String(f)],!f)return!0;f=f.concat();for(var U=!0,B=0;B<f.length;++B){var J=f[B];if(J&&!J.da&&J.capture==v){var He=J.listener,Ut=J.ha||J.src;J.fa&&Kt(c.i,J),U=He.call(Ut,b)!==!1&&U}}return U&&!b.defaultPrevented}function Mr(c,f,v){if(typeof c=="function")v&&(c=m(c,v));else if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(c,f||0)}function Ci(c){c.g=Mr(()=>{c.g=null,c.i&&(c.i=!1,Ci(c))},c.l);const f=c.h;c.h=null,c.m.apply(null,f)}class ps extends Me{constructor(f,v){super(),this.m=f,this.l=v,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Ci(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Yn(c){Me.call(this),this.h=c,this.g={}}E(Yn,Me);var Ua=[];function Ai(c){W(c.g,function(f,v){this.g.hasOwnProperty(v)&&ds(f)},c),c.g={}}Yn.prototype.N=function(){Yn.aa.N.call(this),Ai(this)},Yn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ri=a.JSON.stringify,vc=a.JSON.parse,yc=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function ko(){}ko.prototype.h=null;function Ro(c){return c.h||(c.h=c.i())}function Vr(){}var ii={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function gs(){Be.call(this,"d")}E(gs,Be);function Do(){Be.call(this,"c")}E(Do,Be);var jr={},ms=null;function vs(){return ms=ms||new vt}jr.La="serverreachability";function Nn(c){Be.call(this,jr.La,c)}E(Nn,Be);function yn(c){const f=vs();it(f,new Nn(f))}jr.STAT_EVENT="statevent";function $a(c,f){Be.call(this,jr.STAT_EVENT,c),this.stat=f}E($a,Be);function Ft(c){const f=vs();it(f,new $a(f,c))}jr.Ma="timingevent";function za(c,f){Be.call(this,jr.Ma,c),this.size=f}E(za,Be);function xi(c,f){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},f)}function Ue(){this.g=!0}Ue.prototype.xa=function(){this.g=!1};function Xe(c,f,v,b,U,B){c.info(function(){if(c.g)if(B)for(var J="",He=B.split("&"),Ut=0;Ut<He.length;Ut++){var Ve=He[Ut].split("=");if(1<Ve.length){var Je=Ve[0];Ve=Ve[1];var $t=Je.split("_");J=2<=$t.length&&$t[1]=="type"?J+(Je+"="+Ve+"&"):J+(Je+"=redacted&")}}else J=null;else J=B;return"XMLHTTP REQ ("+b+") [attempt "+U+"]: "+f+`
`+v+`
`+J})}function xt(c,f,v,b,U,B,J){c.info(function(){return"XMLHTTP RESP ("+b+") [ attempt "+U+"]: "+f+`
`+v+`
`+B+" "+J})}function qe(c,f,v,b){c.info(function(){return"XMLHTTP TEXT ("+f+"): "+en(c,v)+(b?" "+b:"")})}function dr(c,f){c.info(function(){return"TIMEOUT: "+f})}Ue.prototype.info=function(){};function en(c,f){if(!c.g)return f;if(!f)return null;try{var v=JSON.parse(f);if(v){for(c=0;c<v.length;c++)if(Array.isArray(v[c])){var b=v[c];if(!(2>b.length)){var U=b[1];if(Array.isArray(U)&&!(1>U.length)){var B=U[0];if(B!="noop"&&B!="stop"&&B!="close")for(var J=1;J<U.length;J++)U[J]=""}}}}return ri(v)}catch{return f}}var ys={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ch={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},si;function Ot(){}E(Ot,ko),Ot.prototype.g=function(){return new XMLHttpRequest},Ot.prototype.i=function(){return{}},si=new Ot;function It(c,f,v,b){this.j=c,this.i=f,this.l=v,this.R=b||1,this.U=new Yn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new an}function an(){this.i=null,this.g="",this.h=!1}var Gt={},_s={};function oi(c,f,v){c.L=1,c.v=Es(Xn(f)),c.m=v,c.P=!0,ai(c,null)}function ai(c,f){c.F=Date.now(),ws(c),c.A=Xn(c.v);var v=c.A,b=c.R;Array.isArray(b)||(b=[String(b)]),Cc(v.i,"t",b),c.C=0,v=c.j.J,c.h=new an,c.g=$h(c.j,v?f:null,!c.m),0<c.O&&(c.M=new ps(m(c.Y,c,c.g),c.O)),f=c.U,v=c.g,b=c.ca;var U="readystatechange";Array.isArray(U)||(U&&(Ua[0]=U.toString()),U=Ua);for(var B=0;B<U.length;B++){var J=on(v,U[B],b||f.handleEvent,!1,f.h||f);if(!J)break;f.g[J.key]=J}f=c.H?C(c.H):{},c.m?(c.u||(c.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,f)):(c.u="GET",c.g.ea(c.A,c.u,null,f)),yn(),Xe(c.i,c.u,c.A,c.l,c.R,c.m)}It.prototype.ca=function(c){c=c.target;const f=this.M;f&&mr(c)==3?f.j():this.Y(c)},It.prototype.Y=function(c){try{if(c==this.g)e:{const $t=mr(this.g);var f=this.g.Ba();const Ni=this.g.Z();if(!(3>$t)&&($t!=3||this.g&&(this.h.h||this.g.oa()||kc(this.g)))){this.J||$t!=4||f==7||(f==8||0>=Ni?yn(3):yn(2)),Ba(this);var v=this.g.Z();this.X=v;t:if(Pi(this)){var b=kc(this.g);c="";var U=b.length,B=mr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Fr(this),Ri(this);var J="";break t}this.h.i=new a.TextDecoder}for(f=0;f<U;f++)this.h.h=!0,c+=this.h.i.decode(b[f],{stream:!(B&&f==U-1)});b.length=0,this.h.g+=c,this.C=0,J=this.h.g}else J=this.g.oa();if(this.o=v==200,xt(this.i,this.u,this.A,this.l,this.R,$t,v),this.o){if(this.T&&!this.K){t:{if(this.g){var He,Ut=this.g;if((He=Ut.g?Ut.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(He)){var Ve=He;break t}}Ve=null}if(v=Ve)qe(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,qa(this,v);else{this.o=!1,this.s=3,Ft(12),Fr(this),Ri(this);break e}}if(this.P){v=!0;let jn;for(;!this.J&&this.C<J.length;)if(jn=Ah(this,J),jn==_s){$t==4&&(this.s=4,Ft(14),v=!1),qe(this.i,this.l,null,"[Incomplete Response]");break}else if(jn==Gt){this.s=4,Ft(15),qe(this.i,this.l,J,"[Invalid Chunk]"),v=!1;break}else qe(this.i,this.l,jn,null),qa(this,jn);if(Pi(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),$t!=4||J.length!=0||this.h.h||(this.s=1,Ft(16),v=!1),this.o=this.o&&v,!v)qe(this.i,this.l,J,"[Invalid Chunked Response]"),Fr(this),Ri(this);else if(0<J.length&&!this.W){this.W=!0;var Je=this.j;Je.g==this&&Je.ba&&!Je.M&&(Je.j.info("Great, no buffering proxy detected. Bytes received: "+J.length),el(Je),Je.M=!0,Ft(11))}}else qe(this.i,this.l,J,null),qa(this,J);$t==4&&Fr(this),this.o&&!this.J&&($t==4?tl(this.j,this):(this.o=!1,ws(this)))}else Oh(this.g),v==400&&0<J.indexOf("Unknown SID")?(this.s=3,Ft(12)):(this.s=0,Ft(13)),Fr(this),Ri(this)}}}catch{}finally{}};function Pi(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function Ah(c,f){var v=c.C,b=f.indexOf(`
`,v);return b==-1?_s:(v=Number(f.substring(v,b)),isNaN(v)?Gt:(b+=1,b+v>f.length?_s:(f=f.slice(b,b+v),c.C=b+v,f)))}It.prototype.cancel=function(){this.J=!0,Fr(this)};function ws(c){c.S=Date.now()+c.I,ki(c,c.I)}function ki(c,f){if(c.B!=null)throw Error("WatchDog timer not null");c.B=xi(m(c.ba,c),f)}function Ba(c){c.B&&(a.clearTimeout(c.B),c.B=null)}It.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(dr(this.i,this.A),this.L!=2&&(yn(),Ft(17)),Fr(this),this.s=2,Ri(this)):ki(this,this.S-c)};function Ri(c){c.j.G==0||c.J||tl(c.j,c)}function Fr(c){Ba(c);var f=c.M;f&&typeof f.ma=="function"&&f.ma(),c.M=null,Ai(c.U),c.g&&(f=c.g,c.g=null,f.abort(),f.ma())}function qa(c,f){try{var v=c.j;if(v.G!=0&&(v.g==c||Ha(v.h,c))){if(!c.K&&Ha(v.h,c)&&v.G==3){try{var b=v.Da.g.parse(f)}catch{b=null}if(Array.isArray(b)&&b.length==3){var U=b;if(U[0]==0){e:if(!v.u){if(v.g)if(v.g.F+3e3<c.F)vr(v),Fo(v);else break e;Uo(v),Ft(18)}}else v.za=U[1],0<v.za-v.T&&37500>U[2]&&v.F&&v.v==0&&!v.C&&(v.C=xi(m(v.Za,v),6e3));if(1>=Ec(v.h)&&v.ca){try{v.ca()}catch{}v.ca=void 0}}else hi(v,11)}else if((c.K||v.g==c)&&vr(v),!T(f))for(U=v.Da.g.parse(f),f=0;f<U.length;f++){let Ve=U[f];if(v.T=Ve[0],Ve=Ve[1],v.G==2)if(Ve[0]=="c"){v.K=Ve[1],v.ia=Ve[2];const Je=Ve[3];Je!=null&&(v.la=Je,v.j.info("VER="+v.la));const $t=Ve[4];$t!=null&&(v.Aa=$t,v.j.info("SVER="+v.Aa));const Ni=Ve[5];Ni!=null&&typeof Ni=="number"&&0<Ni&&(b=1.5*Ni,v.L=b,v.j.info("backChannelRequestTimeoutMs_="+b)),b=v;const jn=c.g;if(jn){const nl=jn.g?jn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(nl){var B=b.h;B.g||nl.indexOf("spdy")==-1&&nl.indexOf("quic")==-1&&nl.indexOf("h2")==-1||(B.j=B.l,B.g=new Set,B.h&&(Wa(B,B.h),B.h=null))}if(b.D){const Nc=jn.g?jn.g.getResponseHeader("X-HTTP-Session-Id"):null;Nc&&(b.ya=Nc,$e(b.I,b.D,Nc))}}v.G=3,v.l&&v.l.ua(),v.ba&&(v.R=Date.now()-c.F,v.j.info("Handshake RTT: "+v.R+"ms")),b=v;var J=c;if(b.qa=Uh(b,b.J?b.ia:null,b.W),J.K){Tc(b.h,J);var He=J,Ut=b.L;Ut&&(He.I=Ut),He.B&&(Ba(He),ws(He)),b.g=J}else Vh(b);0<v.i.length&&Za(v)}else Ve[0]!="stop"&&Ve[0]!="close"||hi(v,7);else v.G==3&&(Ve[0]=="stop"||Ve[0]=="close"?Ve[0]=="stop"?hi(v,7):jo(v):Ve[0]!="noop"&&v.l&&v.l.ta(Ve),v.v=0)}}yn(4)}catch{}}var xh=class{constructor(c,f){this.g=c,this.map=f}};function _c(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function wc(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Ec(c){return c.h?1:c.g?c.g.size:0}function Ha(c,f){return c.h?c.h==f:c.g?c.g.has(f):!1}function Wa(c,f){c.g?c.g.add(f):c.h=f}function Tc(c,f){c.h&&c.h==f?c.h=null:c.g&&c.g.has(f)&&c.g.delete(f)}_c.prototype.cancel=function(){if(this.i=Ic(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Ic(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let f=c.i;for(const v of c.g.values())f=f.concat(v.D);return f}return x(c.i)}function Ph(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(l(c)){for(var f=[],v=c.length,b=0;b<v;b++)f.push(c[b]);return f}f=[],v=0;for(b in c)f[v++]=c[b];return f}function fr(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(l(c)||typeof c=="string"){var f=[];c=c.length;for(var v=0;v<c;v++)f.push(v);return f}f=[],v=0;for(const b in c)f[v++]=b;return f}}}function ln(c,f){if(c.forEach&&typeof c.forEach=="function")c.forEach(f,void 0);else if(l(c)||typeof c=="string")Array.prototype.forEach.call(c,f,void 0);else for(var v=fr(c),b=Ph(c),U=b.length,B=0;B<U;B++)f.call(void 0,b[B],v&&v[B],c)}var li=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ln(c,f){if(c){c=c.split("&");for(var v=0;v<c.length;v++){var b=c[v].indexOf("="),U=null;if(0<=b){var B=c[v].substring(0,b);U=c[v].substring(b+1)}else B=c[v];f(B,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function Ur(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Ur){this.h=c.h,_n(this,c.j),this.o=c.o,this.g=c.g,pr(this,c.s),this.l=c.l;var f=c.i,v=new Is;v.i=f.i,f.g&&(v.g=new Map(f.g),v.h=f.h),Oo(this,v),this.m=c.m}else c&&(f=String(c).match(li))?(this.h=!1,_n(this,f[1]||"",!0),this.o=Ts(f[2]||""),this.g=Ts(f[3]||"",!0),pr(this,f[4]),this.l=Ts(f[5]||"",!0),Oo(this,f[6]||"",!0),this.m=Ts(f[7]||"")):(this.h=!1,this.i=new Is(null,this.h))}Ur.prototype.toString=function(){var c=[],f=this.j;f&&c.push(gr(f,bc,!0),":");var v=this.g;return(v||f=="file")&&(c.push("//"),(f=this.o)&&c.push(gr(f,bc,!0),"@"),c.push(encodeURIComponent(String(v)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.s,v!=null&&c.push(":",String(v))),(v=this.l)&&(this.g&&v.charAt(0)!="/"&&c.push("/"),c.push(gr(v,v.charAt(0)=="/"?Qp:$r,!0))),(v=this.i.toString())&&c.push("?",v),(v=this.m)&&c.push("#",gr(v,Ka)),c.join("")};function Xn(c){return new Ur(c)}function _n(c,f,v){c.j=v?Ts(f,!0):f,c.j&&(c.j=c.j.replace(/:$/,""))}function pr(c,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);c.s=f}else c.s=null}function Oo(c,f,v){f instanceof Is?(c.i=f,kh(c.i,c.h)):(v||(f=gr(f,ci)),c.i=new Is(f,c.h))}function $e(c,f,v){c.i.set(f,v)}function Es(c){return $e(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Ts(c,f){return c?f?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function gr(c,f,v){return typeof c=="string"?(c=encodeURI(c).replace(f,Sc),v&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Sc(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var bc=/[#\/\?@]/g,$r=/[#\?:]/g,Qp=/[#\?]/g,ci=/[#\?@]/g,Ka=/#/g;function Is(c,f){this.h=this.g=null,this.i=c||null,this.j=!!f}function Mn(c){c.g||(c.g=new Map,c.h=0,c.i&&Ln(c.i,function(f,v){c.add(decodeURIComponent(f.replace(/\+/g," ")),v)}))}t=Is.prototype,t.add=function(c,f){Mn(this),this.i=null,c=Di(this,c);var v=this.g.get(c);return v||this.g.set(c,v=[]),v.push(f),this.h+=1,this};function Ga(c,f){Mn(c),f=Di(c,f),c.g.has(f)&&(c.i=null,c.h-=c.g.get(f).length,c.g.delete(f))}function Ss(c,f){return Mn(c),f=Di(c,f),c.g.has(f)}t.forEach=function(c,f){Mn(this),this.g.forEach(function(v,b){v.forEach(function(U){c.call(f,U,b,this)},this)},this)},t.na=function(){Mn(this);const c=Array.from(this.g.values()),f=Array.from(this.g.keys()),v=[];for(let b=0;b<f.length;b++){const U=c[b];for(let B=0;B<U.length;B++)v.push(f[b])}return v},t.V=function(c){Mn(this);let f=[];if(typeof c=="string")Ss(this,c)&&(f=f.concat(this.g.get(Di(this,c))));else{c=Array.from(this.g.values());for(let v=0;v<c.length;v++)f=f.concat(c[v])}return f},t.set=function(c,f){return Mn(this),this.i=null,c=Di(this,c),Ss(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[f]),this.h+=1,this},t.get=function(c,f){return c?(c=this.V(c),0<c.length?String(c[0]):f):f};function Cc(c,f,v){Ga(c,f),0<v.length&&(c.i=null,c.g.set(Di(c,f),x(v)),c.h+=v.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],f=Array.from(this.g.keys());for(var v=0;v<f.length;v++){var b=f[v];const B=encodeURIComponent(String(b)),J=this.V(b);for(b=0;b<J.length;b++){var U=B;J[b]!==""&&(U+="="+encodeURIComponent(String(J[b]))),c.push(U)}}return this.i=c.join("&")};function Di(c,f){return f=String(f),c.j&&(f=f.toLowerCase()),f}function kh(c,f){f&&!c.j&&(Mn(c),c.i=null,c.g.forEach(function(v,b){var U=b.toLowerCase();b!=U&&(Ga(this,b),Cc(this,U,v))},c)),c.j=f}function bs(c,f){const v=new Ue;if(a.Image){const b=new Image;b.onload=w(zr,v,"TestLoadImage: loaded",!0,f,b),b.onerror=w(zr,v,"TestLoadImage: error",!1,f,b),b.onabort=w(zr,v,"TestLoadImage: abort",!1,f,b),b.ontimeout=w(zr,v,"TestLoadImage: timeout",!1,f,b),a.setTimeout(function(){b.ontimeout&&b.ontimeout()},1e4),b.src=c}else f(!1)}function Yp(c,f){const v=new Ue,b=new AbortController,U=setTimeout(()=>{b.abort(),zr(v,"TestPingServer: timeout",!1,f)},1e4);fetch(c,{signal:b.signal}).then(B=>{clearTimeout(U),B.ok?zr(v,"TestPingServer: ok",!0,f):zr(v,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(U),zr(v,"TestPingServer: error",!1,f)})}function zr(c,f,v,b,U){try{U&&(U.onload=null,U.onerror=null,U.onabort=null,U.ontimeout=null),b(v)}catch{}}function Ac(){this.g=new yc}function Qa(c,f,v){const b=v||"";try{ln(c,function(U,B){let J=U;u(U)&&(J=ri(U)),f.push(b+B+"="+encodeURIComponent(J))})}catch(U){throw f.push(b+"type="+encodeURIComponent("_badmap")),U}}function Cs(c){this.l=c.Ub||null,this.j=c.eb||!1}E(Cs,ko),Cs.prototype.g=function(){return new Ya(this.l,this.j)},Cs.prototype.i=function(c){return function(){return c}}({});function Ya(c,f){vt.call(this),this.D=c,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(Ya,vt),t=Ya.prototype,t.open=function(c,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=f,this.readyState=1,As(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(f.body=c),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Lo(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,As(this)),this.g&&(this.readyState=3,As(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;No(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function No(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var f=c.value?c.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!c.done}))&&(this.response=this.responseText+=f)}c.done?Lo(this):As(this),this.readyState==3&&No(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,Lo(this))},t.Qa=function(c){this.g&&(this.response=c,Lo(this))},t.ga=function(){this.g&&Lo(this)};function Lo(c){c.readyState=4,c.l=null,c.j=null,c.v=null,As(c)}t.setRequestHeader=function(c,f){this.u.append(c,f)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],f=this.h.entries();for(var v=f.next();!v.done;)v=v.value,c.push(v[0]+": "+v[1]),v=f.next();return c.join(`\r
`)};function As(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Ya.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Xa(c){let f="";return W(c,function(v,b){f+=b,f+=":",f+=v,f+=`\r
`}),f}function Mo(c,f,v){e:{for(b in v){var b=!1;break e}b=!0}b||(v=Xa(v),typeof c=="string"?v!=null&&encodeURIComponent(String(v)):$e(c,f,v))}function st(c){vt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(st,vt);var Rh=/^https?$/i,Vo=["POST","PUT"];t=st.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,f,v,b){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);f=f?f.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():si.g(),this.v=this.o?Ro(this.o):Ro(si),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(f,String(c),!0),this.B=!1}catch(B){Ja(this,B);return}if(c=v||"",v=new Map(this.headers),b)if(Object.getPrototypeOf(b)===Object.prototype)for(var U in b)v.set(U,b[U]);else if(typeof b.keys=="function"&&typeof b.get=="function")for(const B of b.keys())v.set(B,b.get(B));else throw Error("Unknown input type for opt_headers: "+String(b));b=Array.from(v.keys()).find(B=>B.toLowerCase()=="content-type"),U=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Vo,f,void 0))||b||U||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[B,J]of v)this.g.setRequestHeader(B,J);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Dh(this),this.u=!0,this.g.send(c),this.u=!1}catch(B){Ja(this,B)}};function Ja(c,f){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=f,c.m=5,xc(c),Br(c)}function xc(c){c.A||(c.A=!0,it(c,"complete"),it(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,it(this,"complete"),it(this,"abort"),Br(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Br(this,!0)),st.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Pc(this):this.bb())},t.bb=function(){Pc(this)};function Pc(c){if(c.h&&typeof o<"u"&&(!c.v[1]||mr(c)!=4||c.Z()!=2)){if(c.u&&mr(c)==4)Mr(c.Ea,0,c);else if(it(c,"readystatechange"),mr(c)==4){c.h=!1;try{const J=c.Z();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var v;if(!(v=f)){var b;if(b=J===0){var U=String(c.D).match(li)[1]||null;!U&&a.self&&a.self.location&&(U=a.self.location.protocol.slice(0,-1)),b=!Rh.test(U?U.toLowerCase():"")}v=b}if(v)it(c,"complete"),it(c,"success");else{c.m=6;try{var B=2<mr(c)?c.g.statusText:""}catch{B=""}c.l=B+" ["+c.Z()+"]",xc(c)}}finally{Br(c)}}}}function Br(c,f){if(c.g){Dh(c);const v=c.g,b=c.v[0]?()=>{}:null;c.g=null,c.v=null,f||it(c,"ready");try{v.onreadystatechange=b}catch{}}}function Dh(c){c.I&&(a.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function mr(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<mr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var f=this.g.responseText;return c&&f.indexOf(c)==0&&(f=f.substring(c.length)),vc(f)}};function kc(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Oh(c){const f={};c=(c.g&&2<=mr(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let b=0;b<c.length;b++){if(T(c[b]))continue;var v=L(c[b]);const U=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const B=f[U]||[];f[U]=B,B.push(v)}P(f,function(b){return b.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function xs(c,f,v){return v&&v.internalChannelParams&&v.internalChannelParams[c]||f}function Rc(c){this.Aa=0,this.i=[],this.j=new Ue,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=xs("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=xs("baseRetryDelayMs",5e3,c),this.cb=xs("retryDelaySeedMs",1e4,c),this.Wa=xs("forwardChannelMaxRetries",2,c),this.wa=xs("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new _c(c&&c.concurrentRequestLimit),this.Da=new Ac,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Rc.prototype,t.la=8,t.G=1,t.connect=function(c,f,v,b){Ft(0),this.W=c,this.H=f||{},v&&b!==void 0&&(this.H.OSID=v,this.H.OAID=b),this.F=this.X,this.I=Uh(this,null,this.W),Za(this)};function jo(c){if(Nh(c),c.G==3){var f=c.U++,v=Xn(c.I);if($e(v,"SID",c.K),$e(v,"RID",f),$e(v,"TYPE","terminate"),ui(c,v),f=new It(c,c.j,f),f.L=2,f.v=Es(Xn(v)),v=!1,a.navigator&&a.navigator.sendBeacon)try{v=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!v&&a.Image&&(new Image().src=f.v,v=!0),v||(f.g=$h(f.j,null),f.g.ea(f.v)),f.F=Date.now(),ws(f)}Fh(c)}function Fo(c){c.g&&(el(c),c.g.cancel(),c.g=null)}function Nh(c){Fo(c),c.u&&(a.clearTimeout(c.u),c.u=null),vr(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function Za(c){if(!wc(c.h)&&!c.s){c.s=!0;var f=c.Ga;Se||z(),X||(Se(),X=!0),ae.add(f,c),c.B=0}}function Lh(c,f){return Ec(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=f.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=xi(m(c.Ga,c,f),jh(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const U=new It(this,this.j,c);let B=this.o;if(this.S&&(B?(B=C(B),O(B,this.S)):B=this.S),this.m!==null||this.O||(U.H=B,B=null),this.P)e:{for(var f=0,v=0;v<this.i.length;v++){t:{var b=this.i[v];if("__data__"in b.map&&(b=b.map.__data__,typeof b=="string")){b=b.length;break t}b=void 0}if(b===void 0)break;if(f+=b,4096<f){f=v;break e}if(f===4096||v===this.i.length-1){f=v+1;break e}}f=1e3}else f=1e3;f=Mh(this,U,f),v=Xn(this.I),$e(v,"RID",c),$e(v,"CVER",22),this.D&&$e(v,"X-HTTP-Session-Id",this.D),ui(this,v),B&&(this.O?f="headers="+encodeURIComponent(String(Xa(B)))+"&"+f:this.m&&Mo(v,this.m,B)),Wa(this.h,U),this.Ua&&$e(v,"TYPE","init"),this.P?($e(v,"$req",f),$e(v,"SID","null"),U.T=!0,oi(U,v,null)):oi(U,v,f),this.G=2}}else this.G==3&&(c?Dc(this,c):this.i.length==0||wc(this.h)||Dc(this))};function Dc(c,f){var v;f?v=f.l:v=c.U++;const b=Xn(c.I);$e(b,"SID",c.K),$e(b,"RID",v),$e(b,"AID",c.T),ui(c,b),c.m&&c.o&&Mo(b,c.m,c.o),v=new It(c,c.j,v,c.B+1),c.m===null&&(v.H=c.o),f&&(c.i=f.D.concat(c.i)),f=Mh(c,v,1e3),v.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Wa(c.h,v),oi(v,b,f)}function ui(c,f){c.H&&W(c.H,function(v,b){$e(f,b,v)}),c.l&&ln({},function(v,b){$e(f,b,v)})}function Mh(c,f,v){v=Math.min(c.i.length,v);var b=c.l?m(c.l.Na,c.l,c):null;e:{var U=c.i;let B=-1;for(;;){const J=["count="+v];B==-1?0<v?(B=U[0].g,J.push("ofs="+B)):B=0:J.push("ofs="+B);let He=!0;for(let Ut=0;Ut<v;Ut++){let Ve=U[Ut].g;const Je=U[Ut].map;if(Ve-=B,0>Ve)B=Math.max(0,U[Ut].g-100),He=!1;else try{Qa(Je,J,"req"+Ve+"_")}catch{b&&b(Je)}}if(He){b=J.join("&");break e}}}return c=c.i.splice(0,v),f.D=c,b}function Vh(c){if(!c.g&&!c.u){c.Y=1;var f=c.Fa;Se||z(),X||(Se(),X=!0),ae.add(f,c),c.v=0}}function Uo(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=xi(m(c.Fa,c),jh(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,Oc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=xi(m(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ft(10),Fo(this),Oc(this))};function el(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function Oc(c){c.g=new It(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var f=Xn(c.qa);$e(f,"RID","rpc"),$e(f,"SID",c.K),$e(f,"AID",c.T),$e(f,"CI",c.F?"0":"1"),!c.F&&c.ja&&$e(f,"TO",c.ja),$e(f,"TYPE","xmlhttp"),ui(c,f),c.m&&c.o&&Mo(f,c.m,c.o),c.L&&(c.g.I=c.L);var v=c.g;c=c.ia,v.L=1,v.v=Es(Xn(f)),v.m=null,v.P=!0,ai(v,c)}t.Za=function(){this.C!=null&&(this.C=null,Fo(this),Uo(this),Ft(19))};function vr(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function tl(c,f){var v=null;if(c.g==f){vr(c),el(c),c.g=null;var b=2}else if(Ha(c.h,f))v=f.D,Tc(c.h,f),b=1;else return;if(c.G!=0){if(f.o)if(b==1){v=f.m?f.m.length:0,f=Date.now()-f.F;var U=c.B;b=vs(),it(b,new za(b,v)),Za(c)}else Vh(c);else if(U=f.s,U==3||U==0&&0<f.X||!(b==1&&Lh(c,f)||b==2&&Uo(c)))switch(v&&0<v.length&&(f=c.h,f.i=f.i.concat(v)),U){case 1:hi(c,5);break;case 4:hi(c,10);break;case 3:hi(c,6);break;default:hi(c,2)}}}function jh(c,f){let v=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(v*=2),v*f}function hi(c,f){if(c.j.info("Error code "+f),f==2){var v=m(c.fb,c),b=c.Xa;const U=!b;b=new Ur(b||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||_n(b,"https"),Es(b),U?bs(b.toString(),v):Yp(b.toString(),v)}else Ft(2);c.G=0,c.l&&c.l.sa(f),Fh(c),Nh(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Ft(2)):(this.j.info("Failed to ping google.com"),Ft(1))};function Fh(c){if(c.G=0,c.ka=[],c.l){const f=Ic(c.h);(f.length!=0||c.i.length!=0)&&(D(c.ka,f),D(c.ka,c.i),c.h.i.length=0,x(c.i),c.i.length=0),c.l.ra()}}function Uh(c,f,v){var b=v instanceof Ur?Xn(v):new Ur(v);if(b.g!="")f&&(b.g=f+"."+b.g),pr(b,b.s);else{var U=a.location;b=U.protocol,f=f?f+"."+U.hostname:U.hostname,U=+U.port;var B=new Ur(null);b&&_n(B,b),f&&(B.g=f),U&&pr(B,U),v&&(B.l=v),b=B}return v=c.D,f=c.ya,v&&f&&$e(b,v,f),$e(b,"VER",c.la),ui(c,b),b}function $h(c,f,v){if(f&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=c.Ca&&!c.pa?new st(new Cs({eb:v})):new st(c.pa),f.Ha(c.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function zh(){}t=zh.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function $o(){}$o.prototype.g=function(c,f){return new cn(c,f)};function cn(c,f){vt.call(this),this.g=new Rc(f),this.l=c,this.h=f&&f.messageUrlParams||null,c=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(c?c["X-WebChannel-Content-Type"]=f.messageContentType:c={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(c?c["X-WebChannel-Client-Profile"]=f.va:c={"X-WebChannel-Client-Profile":f.va}),this.g.S=c,(c=f&&f.Sb)&&!T(c)&&(this.g.m=c),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!T(f)&&(this.g.D=f,c=this.h,c!==null&&f in c&&(c=this.h,f in c&&delete c[f])),this.j=new Vn(this)}E(cn,vt),cn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},cn.prototype.close=function(){jo(this.g)},cn.prototype.o=function(c){var f=this.g;if(typeof c=="string"){var v={};v.__data__=c,c=v}else this.u&&(v={},v.__data__=ri(c),c=v);f.i.push(new xh(f.Ya++,c)),f.G==3&&Za(f)},cn.prototype.N=function(){this.g.l=null,delete this.j,jo(this.g),delete this.g,cn.aa.N.call(this)};function Bh(c){gs.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var f=c.__sm__;if(f){e:{for(const v in f){c=v;break e}c=void 0}(this.i=c)&&(c=this.i,f=f!==null&&c in f?f[c]:void 0),this.data=f}else this.data=c}E(Bh,gs);function Oi(){Do.call(this),this.status=1}E(Oi,Do);function Vn(c){this.g=c}E(Vn,zh),Vn.prototype.ua=function(){it(this.g,"a")},Vn.prototype.ta=function(c){it(this.g,new Bh(c))},Vn.prototype.sa=function(c){it(this.g,new Oi)},Vn.prototype.ra=function(){it(this.g,"b")},$o.prototype.createWebChannel=$o.prototype.g,cn.prototype.send=cn.prototype.o,cn.prototype.open=cn.prototype.m,cn.prototype.close=cn.prototype.close,tC=function(){return new $o},eC=function(){return vs()},Zb=jr,dv={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ys.NO_ERROR=0,ys.TIMEOUT=8,ys.HTTP_ERROR=6,qd=ys,Ch.COMPLETE="complete",Jb=Ch,Vr.EventType=ii,ii.OPEN="a",ii.CLOSE="b",ii.ERROR="c",ii.MESSAGE="d",vt.prototype.listen=vt.prototype.K,su=Vr,st.prototype.listenOnce=st.prototype.L,st.prototype.getLastError=st.prototype.Ka,st.prototype.getLastErrorCode=st.prototype.Ba,st.prototype.getStatus=st.prototype.Z,st.prototype.getResponseJson=st.prototype.Oa,st.prototype.getResponseText=st.prototype.oa,st.prototype.send=st.prototype.ea,st.prototype.setWithCredentials=st.prototype.Ha,Xb=st}).apply(typeof vd<"u"?vd:typeof self<"u"?self:typeof window<"u"?window:{});const jE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Sn.UNAUTHENTICATED=new Sn(null),Sn.GOOGLE_CREDENTIALS=new Sn("google-credentials-uid"),Sn.FIRST_PARTY=new Sn("first-party-uid"),Sn.MOCK_USER=new Sn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fc="11.0.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa=new _p("@firebase/firestore");function hl(){return wa.logLevel}function Q(t,...e){if(wa.logLevel<=De.DEBUG){const n=e.map(n_);wa.debug(`Firestore (${fc}): ${t}`,...n)}}function bn(t,...e){if(wa.logLevel<=De.ERROR){const n=e.map(n_);wa.error(`Firestore (${fc}): ${t}`,...n)}}function Ql(t,...e){if(wa.logLevel<=De.WARN){const n=e.map(n_);wa.warn(`Firestore (${fc}): ${t}`,...n)}}function n_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function le(t="Unexpected state"){const e=`FIRESTORE (${fc}) INTERNAL ASSERTION FAILED: `+t;throw bn(e),new Error(e)}function ce(t,e){t||le()}function ve(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ne extends ni{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class FM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Sn.UNAUTHENTICATED))}shutdown(){}}class UM{constructor(e){this.t=e,this.currentUser=Sn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ce(this.o===void 0);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Qi;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Qi,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{Q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Q("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Qi)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ce(typeof r.accessToken=="string"),new jM(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ce(e===null||typeof e=="string"),new Sn(e)}}class $M{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Sn.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class zM{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new $M(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Sn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class BM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qM{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){ce(this.o===void 0);const r=s=>{s.error!=null&&Q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ce(typeof n.token=="string"),this.R=n.token,new BM(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HM(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=HM(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function we(t,e){return t<e?-1:t>e?1:0}function Yl(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function rC(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{static now(){return Et.fromMillis(Date.now())}static fromDate(e){return Et.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Et(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ne(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ne(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ne(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ne(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?we(this.nanoseconds,e.nanoseconds):we(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{static fromTimestamp(e){return new ue(e)}static min(){return new ue(new Et(0,0))}static max(){return new ue(new Et(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e,n,r){n===void 0?n=0:n>e.length&&le(),r===void 0?r=e.length-n:r>e.length-n&&le(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Xu.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Xu?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ge extends Xu{construct(e,n,r){return new Ge(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ne(K.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Ge(n)}static emptyPath(){return new Ge([])}}const WM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _t extends Xu{construct(e,n,r){return new _t(e,n,r)}static isValidIdentifier(e){return WM.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new _t(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ne(K.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new ne(K.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ne(K.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new ne(K.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new _t(n)}static emptyPath(){return new _t([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.path=e}static fromPath(e){return new te(Ge.fromString(e))}static fromName(e){return new te(Ge.fromString(e).popFirst(5))}static empty(){return new te(Ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ge.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new te(new Ge(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function fv(t){return t.fields.find(e=>e.kind===2)}function Jo(t){return t.fields.filter(e=>e.kind!==2)}Vf.UNKNOWN_ID=-1;class Hd{constructor(e,n){this.fieldPath=e,this.kind=n}}class Ju{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Ju(0,lr.min())}}function KM(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ue.fromTimestamp(r===1e9?new Et(n+1,0):new Et(n,r));return new lr(i,te.empty(),e)}function iC(t){return new lr(t.readTime,t.key,-1)}class lr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new lr(ue.min(),te.empty(),-1)}static max(){return new lr(ue.max(),te.empty(),-1)}}function r_(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=te.comparator(t.documentKey,e.documentKey),n!==0?n:we(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class oC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function La(t){if(t.code!==K.FAILED_PRECONDITION||t.message!==sC)throw t;Q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&le(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new $((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof $?n:$.resolve(n)}catch(n){return $.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):$.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):$.reject(n)}static resolve(e){return new $((n,r)=>{n(e)})}static reject(e){return new $((n,r)=>{r(e)})}static waitFor(e){return new $((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=$.resolve(!1);for(const r of e)n=n.next(i=>i?$.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new $((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(d=>{o[u]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new $((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{static open(e,n,r,i){try{return new Ip(n,e.transaction(i,r))}catch(s){throw new Tu(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Qi,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Tu(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=i_(r.target.error);this.V.reject(new Tu(e,i))}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Q("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new QM(n)}}class co{static delete(e){return Q("SimpleDb","Removing database:",e),Zo(window.indexedDB.deleteDatabase(e)).toPromise()}static p(){if(!By())return!1;if(co.S())return!0;const e=Ht(),n=co.D(e),r=0<n&&n<10,i=aC(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static S(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static C(e,n){return e.store(n)}static D(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.F=r,co.D(Ht())===12.2&&bn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async M(e){return this.db||(Q("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Tu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new ne(K.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new ne(K.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Tu(e,o))},i.onupgradeneeded=s=>{Q("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.F.O(o,i.transaction,s.oldVersion,this.version).next(()=>{Q("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Ip.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),$.reject(u))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(Q("SimpleDb","Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function aC(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class GM{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Zo(this.B.delete())}}class Tu extends ne{constructor(e,n){super(K.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function bo(t){return t.name==="IndexedDbTransactionError"}class QM{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(Q("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(Q("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Zo(r)}add(e){return Q("SimpleDb","ADD",this.store.name,e,e),Zo(this.store.add(e))}get(e){return Zo(this.store.get(e)).next(n=>(n===void 0&&(n=null),Q("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return Q("SimpleDb","DELETE",this.store.name,e),Zo(this.store.delete(e))}count(){return Q("SimpleDb","COUNT",this.store.name),Zo(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new $((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new $((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,n){Q("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new $((r,i)=>{n.onerror=s=>{const o=i_(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){const r=[];return new $((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new GM(a),u=n(a.primaryKey,a.value,l);if(u instanceof $){const d=u.catch(p=>(l.done(),$.reject(p)));r.push(d)}l.isDone?i():l.K===null?a.continue():a.continue(l.K)}}).next(()=>$.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Zo(t){return new $((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=i_(r.target.error);n(i)}})}let FE=!1;function i_(t){const e=co.D(Ht());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new ne("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return FE||(FE=!0,setTimeout(()=>{throw r},0)),r}}return t}class YM{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){Q("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Q("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){bo(n)?Q("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await La(n)}await this.X(6e4)})}}class XM{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,s=!0;return $.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return Q("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(Q("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=iC(s);r_(o,r)>0&&(r=o)}),new lr(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Pr.oe=-1;function Sp(t){return t==null}function Zu(t){return t===0&&1/t==-1/0}function JM(t){return typeof t=="number"&&Number.isInteger(t)&&!Zu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=UE(e)),e=ZM(t.get(n),e);return UE(e)}function ZM(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function UE(t){return t+""}function _i(t){const e=t.length;if(ce(e>=2),e===2)return ce(t.charAt(0)===""&&t.charAt(1)===""),Ge.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&le(),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:le()}s=o+2}return new Ge(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $E=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wd(t,e){return[t,mn(e)]}function lC(t,e,n){return[t,mn(e),n]}const eV={},tV=["prefixPath","collectionGroup","readTime","documentId"],nV=["prefixPath","collectionGroup","documentId"],rV=["collectionGroup","readTime","prefixPath","documentId"],iV=["canonicalId","targetId"],sV=["targetId","path"],oV=["path","targetId"],aV=["collectionId","parent"],lV=["indexId","uid"],cV=["uid","sequenceNumber"],uV=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],hV=["indexId","uid","orderedDocumentKey"],dV=["userId","collectionPath","documentId"],fV=["userId","collectionPath","largestBatchId"],pV=["userId","collectionGroup","largestBatchId"],cC=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],gV=[...cC,"documentOverlays"],uC=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],hC=uC,s_=[...hC,"indexConfiguration","indexState","indexEntries"],mV=s_,vV=[...s_,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv extends oC{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function Wt(t,e){const n=ve(t);return co.C(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Co(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function dC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e,n){this.comparator=e,this.root=n||nn.EMPTY}insert(e,n){return new mt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,nn.BLACK,null,null))}remove(e){return new mt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,nn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new yd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new yd(this.root,e,this.comparator,!1)}getReverseIterator(){return new yd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new yd(this.root,e,this.comparator,!0)}}class yd{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class nn{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??nn.RED,this.left=i??nn.EMPTY,this.right=s??nn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new nn(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return nn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return nn.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw le();const e=this.left.check();if(e!==this.right.check())throw le();return e+(this.isRed()?0:1)}}nn.EMPTY=null,nn.RED=!0,nn.BLACK=!1;nn.EMPTY=new class{constructor(){this.size=0}get key(){throw le()}get value(){throw le()}get color(){throw le()}get left(){throw le()}get right(){throw le()}copy(e,n,r,i,s){return this}insert(e,n,r){return new nn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.comparator=e,this.data=new mt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new BE(this.data.getIterator())}getIteratorFrom(e){return new BE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ye)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ye(this.comparator);return n.data=e,n}}class BE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ol(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e){this.fields=e,e.sort(_t.comparator)}static empty(){return new nr([])}unionWith(e){let n=new Ye(_t.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new nr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Yl(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new fC("Invalid base64 string: "+s):s}}(e);return new Vt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Vt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return we(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Vt.EMPTY_BYTE_STRING=new Vt("");const yV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ns(t){if(ce(!!t),typeof t=="string"){let e=0;const n=yV.exec(t);if(ce(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:pt(t.seconds),nanos:pt(t.nanos)}}function pt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function rs(t){return typeof t=="string"?Vt.fromBase64String(t):Vt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o_(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function bp(t){const e=t.mapValue.fields.__previous_value__;return o_(e)?bp(e):e}function eh(t){const e=ns(t.mapValue.fields.__local_write_time__.timestampValue);return new Et(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _V{constructor(e,n,r,i,s,o,a,l,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class Ea{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Ea("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ea&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Kd={nullValue:"NULL_VALUE"};function go(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?o_(t)?4:pC(t)?9007199254740991:Cp(t)?10:11:le()}function bi(t,e){if(t===e)return!0;const n=go(t);if(n!==go(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return eh(t).isEqual(eh(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=ns(i.timestampValue),a=ns(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return rs(i.bytesValue).isEqual(rs(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return pt(i.geoPointValue.latitude)===pt(s.geoPointValue.latitude)&&pt(i.geoPointValue.longitude)===pt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return pt(i.integerValue)===pt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=pt(i.doubleValue),a=pt(s.doubleValue);return o===a?Zu(o)===Zu(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Yl(t.arrayValue.values||[],e.arrayValue.values||[],bi);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(zE(o)!==zE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!bi(o[l],a[l])))return!1;return!0}(t,e);default:return le()}}function th(t,e){return(t.values||[]).find(n=>bi(n,e))!==void 0}function mo(t,e){if(t===e)return 0;const n=go(t),r=go(e);if(n!==r)return we(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return we(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=pt(s.integerValue||s.doubleValue),l=pt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return qE(t.timestampValue,e.timestampValue);case 4:return qE(eh(t),eh(e));case 5:return we(t.stringValue,e.stringValue);case 6:return function(s,o){const a=rs(s),l=rs(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const d=we(a[u],l[u]);if(d!==0)return d}return we(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=we(pt(s.latitude),pt(o.latitude));return a!==0?a:we(pt(s.longitude),pt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return HE(t.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,u,d;const p=s.fields||{},m=o.fields||{},w=(a=p.value)===null||a===void 0?void 0:a.arrayValue,E=(l=m.value)===null||l===void 0?void 0:l.arrayValue,x=we(((u=w==null?void 0:w.values)===null||u===void 0?void 0:u.length)||0,((d=E==null?void 0:E.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:HE(w,E)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Xs.mapValue&&o===Xs.mapValue)return 0;if(s===Xs.mapValue)return 1;if(o===Xs.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let p=0;p<l.length&&p<d.length;++p){const m=we(l[p],d[p]);if(m!==0)return m;const w=mo(a[l[p]],u[d[p]]);if(w!==0)return w}return we(l.length,d.length)}(t.mapValue,e.mapValue);default:throw le()}}function qE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return we(t,e);const n=ns(t),r=ns(e),i=we(n.seconds,r.seconds);return i!==0?i:we(n.nanos,r.nanos)}function HE(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=mo(n[i],r[i]);if(s)return s}return we(n.length,r.length)}function Xl(t){return gv(t)}function gv(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ns(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return rs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return te.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=gv(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${gv(n.fields[o])}`;return i+"}"}(t.mapValue):le()}function Gd(t){switch(go(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=bp(t);return e?16+Gd(e):16;case 5:return 2*t.stringValue.length;case 6:return rs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Gd(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return Co(r.fields,(s,o)=>{i+=s.length+Gd(o)}),i}(t.mapValue);default:throw le()}}function a_(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function mv(t){return!!t&&"integerValue"in t}function nh(t){return!!t&&"arrayValue"in t}function WE(t){return!!t&&"nullValue"in t}function KE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Qd(t){return!!t&&"mapValue"in t}function Cp(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Iu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Co(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Iu(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Iu(t.arrayValue.values[n]);return e}return Object.assign({},t)}function pC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const gC={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function wV(t){return"nullValue"in t?Kd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?a_(Ea.empty(),te.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Cp(t)?gC:{mapValue:{}}:le()}function EV(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?a_(Ea.empty(),te.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?gC:"mapValue"in t?Cp(t)?{mapValue:{}}:Xs:le()}function GE(t,e){const n=mo(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function QE(t,e){const n=mo(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.value=e}static empty(){return new Cn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Qd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Iu(n)}setAll(e){let n=_t.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Iu(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Qd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return bi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Qd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Co(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Cn(Iu(this.value))}}function mC(t){const e=[];return Co(t.fields,(n,r)=>{const i=new _t([n]);if(Qd(r)){const s=mC(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new nr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ct(e,0,ue.min(),ue.min(),ue.min(),Cn.empty(),0)}static newFoundDocument(e,n,r,i){return new Ct(e,1,n,ue.min(),r,i,0)}static newNoDocument(e,n){return new Ct(e,2,n,ue.min(),ue.min(),Cn.empty(),0)}static newUnknownDocument(e,n){return new Ct(e,3,n,ue.min(),ue.min(),Cn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Cn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Cn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ct&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ct(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(e,n){this.position=e,this.inclusive=n}}function YE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=te.comparator(te.fromName(o.referenceValue),n.key):r=mo(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function XE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!bi(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(e,n="asc"){this.field=e,this.dir=n}}function TV(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{}class Ne extends vC{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new IV(e,n,r):n==="array-contains"?new CV(e,r):n==="in"?new IC(e,r):n==="not-in"?new AV(e,r):n==="array-contains-any"?new xV(e,r):new Ne(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new SV(e,r):new bV(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(mo(n,this.value)):n!==null&&go(this.value)===go(n)&&this.matchesComparison(mo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return le()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class tt extends vC{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new tt(e,n)}matches(e){return Zl(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Zl(t){return t.op==="and"}function vv(t){return t.op==="or"}function l_(t){return yC(t)&&Zl(t)}function yC(t){for(const e of t.filters)if(e instanceof tt)return!1;return!0}function yv(t){if(t instanceof Ne)return t.field.canonicalString()+t.op.toString()+Xl(t.value);if(l_(t))return t.filters.map(e=>yv(e)).join(",");{const e=t.filters.map(n=>yv(n)).join(",");return`${t.op}(${e})`}}function _C(t,e){return t instanceof Ne?function(r,i){return i instanceof Ne&&r.op===i.op&&r.field.isEqual(i.field)&&bi(r.value,i.value)}(t,e):t instanceof tt?function(r,i){return i instanceof tt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&_C(o,i.filters[a]),!0):!1}(t,e):void le()}function wC(t,e){const n=t.filters.concat(e);return tt.create(n,t.op)}function EC(t){return t instanceof Ne?function(n){return`${n.field.canonicalString()} ${n.op} ${Xl(n.value)}`}(t):t instanceof tt?function(n){return n.op.toString()+" {"+n.getFilters().map(EC).join(" ,")+"}"}(t):"Filter"}class IV extends Ne{constructor(e,n,r){super(e,n,r),this.key=te.fromName(r.referenceValue)}matches(e){const n=te.comparator(e.key,this.key);return this.matchesComparison(n)}}class SV extends Ne{constructor(e,n){super(e,"in",n),this.keys=TC("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class bV extends Ne{constructor(e,n){super(e,"not-in",n),this.keys=TC("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function TC(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>te.fromName(r.referenceValue))}class CV extends Ne{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return nh(n)&&th(n.arrayValue,this.value)}}class IC extends Ne{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&th(this.value.arrayValue,n)}}class AV extends Ne{constructor(e,n){super(e,"not-in",n)}matches(e){if(th(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!th(this.value.arrayValue,n)}}class xV extends Ne{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!nh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>th(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PV{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function _v(t,e=null,n=[],r=[],i=null,s=null,o=null){return new PV(t,e,n,r,i,s,o)}function Ta(t){const e=ve(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>yv(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Sp(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Xl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Xl(r)).join(",")),e.ue=n}return e.ue}function vh(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!TV(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!_C(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!XE(t.startAt,e.startAt)&&XE(t.endAt,e.endAt)}function Ff(t){return te.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Uf(t,e){return t.filters.filter(n=>n instanceof Ne&&n.field.isEqual(e))}function JE(t,e,n){let r=Kd,i=!0;for(const s of Uf(t,e)){let o=Kd,a=!0;switch(s.op){case"<":case"<=":o=wV(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Kd}GE({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];GE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function ZE(t,e,n){let r=Xs,i=!0;for(const s of Uf(t,e)){let o=Xs,a=!0;switch(s.op){case">=":case">":o=EV(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Xs}QE({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];QE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ap{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function kV(t,e,n,r,i,s,o,a){return new Ap(t,e,n,r,i,s,o,a)}function yh(t){return new Ap(t)}function e1(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function RV(t){return t.collectionGroup!==null}function Su(t){const e=ve(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ye(_t.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new jf(s,r))}),n.has(_t.keyField().canonicalString())||e.ce.push(new jf(_t.keyField(),r))}return e.ce}function Dr(t){const e=ve(t);return e.le||(e.le=DV(e,Su(t))),e.le}function DV(t,e){if(t.limitType==="F")return _v(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new jf(i.field,s)});const n=t.endAt?new Jl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Jl(t.startAt.position,t.startAt.inclusive):null;return _v(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function wv(t,e,n){return new Ap(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function xp(t,e){return vh(Dr(t),Dr(e))&&t.limitType===e.limitType}function SC(t){return`${Ta(Dr(t))}|lt:${t.limitType}`}function dl(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>EC(i)).join(", ")}]`),Sp(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Xl(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Xl(i)).join(",")),`Target(${r})`}(Dr(t))}; limitType=${t.limitType})`}function _h(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):te.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Su(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=YE(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,Su(r),i)||r.endAt&&!function(o,a,l){const u=YE(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,Su(r),i))}(t,e)}function OV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function bC(t){return(e,n)=>{let r=!1;for(const i of Su(t)){const s=NV(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function NV(t,e,n){const r=t.field.isKeyField()?te.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?mo(l,u):le()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return le()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Co(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return dC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LV=new mt(te.comparator);function rr(){return LV}const CC=new mt(te.comparator);function ou(...t){let e=CC;for(const n of t)e=e.insert(n.key,n);return e}function AC(t){let e=CC;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function wi(){return bu()}function xC(){return bu()}function bu(){return new ls(t=>t.toString(),(t,e)=>t.isEqual(e))}const MV=new mt(te.comparator),VV=new Ye(te.comparator);function Pe(...t){let e=VV;for(const n of t)e=e.add(n);return e}const jV=new Ye(we);function FV(){return jV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Zu(e)?"-0":e}}function PC(t){return{integerValue:""+t}}function UV(t,e){return JM(e)?PC(e):c_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(){this._=void 0}}function $V(t,e,n){return t instanceof ec?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&o_(s)&&(s=bp(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof tc?RC(t,e):t instanceof nc?DC(t,e):function(i,s){const o=kC(i,s),a=t1(o)+t1(i.Pe);return mv(o)&&mv(i.Pe)?PC(a):c_(i.serializer,a)}(t,e)}function zV(t,e,n){return t instanceof tc?RC(t,e):t instanceof nc?DC(t,e):n}function kC(t,e){return t instanceof rh?function(r){return mv(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class ec extends Pp{}class tc extends Pp{constructor(e){super(),this.elements=e}}function RC(t,e){const n=OC(e);for(const r of t.elements)n.some(i=>bi(i,r))||n.push(r);return{arrayValue:{values:n}}}class nc extends Pp{constructor(e){super(),this.elements=e}}function DC(t,e){let n=OC(e);for(const r of t.elements)n=n.filter(i=>!bi(i,r));return{arrayValue:{values:n}}}class rh extends Pp{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function t1(t){return pt(t.integerValue||t.doubleValue)}function OC(t){return nh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e,n){this.field=e,this.transform=n}}function BV(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof tc&&i instanceof tc||r instanceof nc&&i instanceof nc?Yl(r.elements,i.elements,bi):r instanceof rh&&i instanceof rh?bi(r.Pe,i.Pe):r instanceof ec&&i instanceof ec}(t.transform,e.transform)}class qV{constructor(e,n){this.version=e,this.transformResults=n}}class An{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new An}static exists(e){return new An(void 0,e)}static updateTime(e){return new An(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Yd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class kp{}function LC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new u_(t.key,An.none()):new pc(t.key,t.data,An.none());{const n=t.data,r=Cn.empty();let i=new Ye(_t.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new cs(t.key,r,new nr(i.toArray()),An.none())}}function HV(t,e,n){t instanceof pc?function(i,s,o){const a=i.value.clone(),l=r1(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof cs?function(i,s,o){if(!Yd(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=r1(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(MC(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Cu(t,e,n,r){return t instanceof pc?function(s,o,a,l){if(!Yd(s.precondition,o))return a;const u=s.value.clone(),d=i1(s.fieldTransforms,l,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof cs?function(s,o,a,l){if(!Yd(s.precondition,o))return a;const u=i1(s.fieldTransforms,l,o),d=o.data;return d.setAll(MC(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(s,o,a){return Yd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function WV(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=kC(r.transform,i||null);s!=null&&(n===null&&(n=Cn.empty()),n.set(r.field,s))}return n||null}function n1(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Yl(r,i,(s,o)=>BV(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class pc extends kp{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class cs extends kp{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function MC(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function r1(t,e,n){const r=new Map;ce(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,zV(o,a,n[i]))}return r}function i1(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,$V(s,o,e))}return r}class u_ extends kp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class VC extends kp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&HV(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Cu(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Cu(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=xC();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=LC(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(ue.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Pe())}isEqual(e){return this.batchId===e.batchId&&Yl(this.mutations,e.mutations,(n,r)=>n1(n,r))&&Yl(this.baseMutations,e.baseMutations,(n,r)=>n1(n,r))}}class d_{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){ce(e.mutations.length===r.length);let i=function(){return MV}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new d_(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nt,je;function GV(t){switch(t){default:return le();case K.CANCELLED:case K.UNKNOWN:case K.DEADLINE_EXCEEDED:case K.RESOURCE_EXHAUSTED:case K.INTERNAL:case K.UNAVAILABLE:case K.UNAUTHENTICATED:return!1;case K.INVALID_ARGUMENT:case K.NOT_FOUND:case K.ALREADY_EXISTS:case K.PERMISSION_DENIED:case K.FAILED_PRECONDITION:case K.ABORTED:case K.OUT_OF_RANGE:case K.UNIMPLEMENTED:case K.DATA_LOSS:return!0}}function jC(t){if(t===void 0)return bn("GRPC error has no .code"),K.UNKNOWN;switch(t){case Nt.OK:return K.OK;case Nt.CANCELLED:return K.CANCELLED;case Nt.UNKNOWN:return K.UNKNOWN;case Nt.DEADLINE_EXCEEDED:return K.DEADLINE_EXCEEDED;case Nt.RESOURCE_EXHAUSTED:return K.RESOURCE_EXHAUSTED;case Nt.INTERNAL:return K.INTERNAL;case Nt.UNAVAILABLE:return K.UNAVAILABLE;case Nt.UNAUTHENTICATED:return K.UNAUTHENTICATED;case Nt.INVALID_ARGUMENT:return K.INVALID_ARGUMENT;case Nt.NOT_FOUND:return K.NOT_FOUND;case Nt.ALREADY_EXISTS:return K.ALREADY_EXISTS;case Nt.PERMISSION_DENIED:return K.PERMISSION_DENIED;case Nt.FAILED_PRECONDITION:return K.FAILED_PRECONDITION;case Nt.ABORTED:return K.ABORTED;case Nt.OUT_OF_RANGE:return K.OUT_OF_RANGE;case Nt.UNIMPLEMENTED:return K.UNIMPLEMENTED;case Nt.DATA_LOSS:return K.DATA_LOSS;default:return le()}}(je=Nt||(Nt={}))[je.OK=0]="OK",je[je.CANCELLED=1]="CANCELLED",je[je.UNKNOWN=2]="UNKNOWN",je[je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",je[je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",je[je.NOT_FOUND=5]="NOT_FOUND",je[je.ALREADY_EXISTS=6]="ALREADY_EXISTS",je[je.PERMISSION_DENIED=7]="PERMISSION_DENIED",je[je.UNAUTHENTICATED=16]="UNAUTHENTICATED",je[je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",je[je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",je[je.ABORTED=10]="ABORTED",je[je.OUT_OF_RANGE=11]="OUT_OF_RANGE",je[je.UNIMPLEMENTED=12]="UNIMPLEMENTED",je[je.INTERNAL=13]="INTERNAL",je[je.UNAVAILABLE=14]="UNAVAILABLE",je[je.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YV=new ua([4294967295,4294967295],0);function s1(t){const e=QV().encode(t),n=new Yb;return n.update(e),new Uint8Array(n.digest())}function o1(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ua([n,r],0),new ua([i,s],0)]}class p_{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new au(`Invalid padding: ${n}`);if(r<0)throw new au(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new au(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new au(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ie=ua.fromNumber(this.Te)}Ee(e,n,r){let i=e.add(n.multiply(ua.fromNumber(r)));return i.compare(YV)===1&&(i=new ua([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ie).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const n=s1(e),[r,i]=o1(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new p_(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;const n=s1(e),[r,i]=o1(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class au extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,wh.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Rp(ue.min(),i,new mt(we),rr(),Pe())}}class wh{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new wh(r,n,Pe(),Pe(),Pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class FC{constructor(e,n){this.targetId=e,this.me=n}}class UC{constructor(e,n,r=Vt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class a1{constructor(){this.fe=0,this.ge=l1(),this.pe=Vt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Pe(),n=Pe(),r=Pe();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:le()}}),new wh(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=l1()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ce(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class XV{constructor(e){this.Le=e,this.Be=new Map,this.ke=rr(),this.qe=_d(),this.Qe=_d(),this.Ke=new mt(we)}$e(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(n,e.Ve):this.We(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.We(n,e.key,e.Ve)}Ge(e){this.forEachTarget(e,n=>{const r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.je(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.De(e.resumeToken));break;default:le()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){const n=e.targetId,r=e.me.count,i=this.Ye(n);if(i){const s=i.target;if(Ff(s))if(r===0){const o=new te(s.path);this.We(n,o,Ct.newNoDocument(o,ue.min()))}else ce(r===1);else{const o=this.Ze(n);if(o!==r){const a=this.Xe(e),l=a?this.et(a,e,o):1;if(l!==0){this.He(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,u)}}}}}Xe(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=rs(r).toUint8Array()}catch(l){if(l instanceof fC)return Ql("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new p_(o,i,s)}catch(l){return Ql(l instanceof au?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Te===0?null:a}et(e,n,r){return n.me.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){const n=new Map;this.Be.forEach((s,o)=>{const a=this.Ye(o);if(a){if(s.current&&Ff(a.target)){const l=new te(a.target.path);this.st(l).has(o)||this.ot(o,l)||this.We(o,l,Ct.newNoDocument(l,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=Pe();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Ye(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Rp(e,n,this.Ke,this.ke,r);return this.ke=rr(),this.qe=_d(),this.Qe=_d(),this.Ke=new mt(we),i}Ue(e,n){if(!this.je(e))return;const r=this.ot(e,n.key)?2:0;this.ze(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e)),this.Qe=this.Qe.insert(n.key,this._t(n.key).add(e))}We(e,n,r){if(!this.je(e))return;const i=this.ze(e);this.ot(e,n)?i.Fe(n,1):i.Me(n),this.Qe=this.Qe.insert(n,this._t(n).delete(e)),this.Qe=this.Qe.insert(n,this._t(n).add(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let n=this.Be.get(e);return n||(n=new a1,this.Be.set(e,n)),n}_t(e){let n=this.Qe.get(e);return n||(n=new Ye(we),this.Qe=this.Qe.insert(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Ye(we),this.qe=this.qe.insert(e,n)),n}je(e){const n=this.Ye(e)!==null;return n||Q("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ut(e)}He(e){this.Be.set(e,new a1),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}ot(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function _d(){return new mt(te.comparator)}function l1(){return new mt(te.comparator)}const JV={asc:"ASCENDING",desc:"DESCENDING"},ZV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},e5={and:"AND",or:"OR"};class t5{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Ev(t,e){return t.useProto3Json||Sp(e)?e:{value:e}}function rc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $C(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function n5(t,e){return rc(t,e.toTimestamp())}function Pn(t){return ce(!!t),ue.fromTimestamp(function(n){const r=ns(n);return new Et(r.seconds,r.nanos)}(t))}function g_(t,e){return Tv(t,e).canonicalString()}function Tv(t,e){const n=function(i){return new Ge(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function zC(t){const e=Ge.fromString(t);return ce(XC(e)),e}function $f(t,e){return g_(t.databaseId,e.path)}function ha(t,e){const n=zC(e);if(n.get(1)!==t.databaseId.projectId)throw new ne(K.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ne(K.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new te(HC(n))}function BC(t,e){return g_(t.databaseId,e)}function qC(t){const e=zC(t);return e.length===4?Ge.emptyPath():HC(e)}function Iv(t){return new Ge(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function HC(t){return ce(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function c1(t,e,n){return{name:$f(t,e),fields:n.value.mapValue.fields}}function r5(t,e,n){const r=ha(t,e.name),i=Pn(e.updateTime),s=e.createTime?Pn(e.createTime):ue.min(),o=new Cn({mapValue:{fields:e.fields}}),a=Ct.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function i5(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:le()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(ce(d===void 0||typeof d=="string"),Vt.fromBase64String(d||"")):(ce(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Vt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const d=u.code===void 0?K.UNKNOWN:jC(u.code);return new ne(d,u.message||"")}(o);n=new UC(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=ha(t,r.document.name),s=Pn(r.document.updateTime),o=r.document.createTime?Pn(r.document.createTime):ue.min(),a=new Cn({mapValue:{fields:r.document.fields}}),l=Ct.newFoundDocument(i,s,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Xd(u,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=ha(t,r.document),s=r.readTime?Pn(r.readTime):ue.min(),o=Ct.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Xd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=ha(t,r.document),s=r.removedTargetIds||[];n=new Xd([],s,i,null)}else{if(!("filter"in e))return le();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new KV(i,s),a=r.targetId;n=new FC(a,o)}}return n}function zf(t,e){let n;if(e instanceof pc)n={update:c1(t,e.key,e.value)};else if(e instanceof u_)n={delete:$f(t,e.key)};else if(e instanceof cs)n={update:c1(t,e.key,e.data),updateMask:u5(e.fieldMask)};else{if(!(e instanceof VC))return le();n={verify:$f(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof ec)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof tc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof nc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof rh)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw le()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:n5(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:le()}(t,e.precondition)),n}function Sv(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?An.updateTime(Pn(s.updateTime)):s.exists!==void 0?An.exists(s.exists):An.none()}(e.currentDocument):An.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)ce(a.setToServerValue==="REQUEST_TIME"),l=new ec;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];l=new tc(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];l=new nc(d)}else"increment"in a?l=new rh(o,a.increment):le();const u=_t.fromServerFormat(a.fieldPath);return new NC(u,l)}(t,i)):[];if(e.update){e.update.name;const i=ha(t,e.update.name),s=new Cn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new nr(u.map(d=>_t.fromServerFormat(d)))}(e.updateMask);return new cs(i,s,o,n,r)}return new pc(i,s,n,r)}if(e.delete){const i=ha(t,e.delete);return new u_(i,n)}if(e.verify){const i=ha(t,e.verify);return new VC(i,n)}return le()}function s5(t,e){return t&&t.length>0?(ce(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Pn(i.updateTime):Pn(s);return o.isEqual(ue.min())&&(o=Pn(s)),new qV(o,i.transformResults||[])}(n,e))):[]}function WC(t,e){return{documents:[BC(t,e.path)]}}function KC(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=BC(t,i);const s=function(u){if(u.length!==0)return YC(tt.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(d=>function(m){return{field:fl(m.field),direction:a5(m.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Ev(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ct:n,parent:i}}function GC(t){let e=qC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ce(r===1);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(p){const m=QC(p);return m instanceof tt&&l_(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(m=>function(E){return new jf(pl(E.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,Sp(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(p){const m=!!p.before,w=p.values||[];return new Jl(w,m)}(n.startAt));let u=null;return n.endAt&&(u=function(p){const m=!p.before,w=p.values||[];return new Jl(w,m)}(n.endAt)),kV(e,i,o,s,a,"F",l,u)}function o5(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return le()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function QC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=pl(n.unaryFilter.field);return Ne.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=pl(n.unaryFilter.field);return Ne.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=pl(n.unaryFilter.field);return Ne.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=pl(n.unaryFilter.field);return Ne.create(o,"!=",{nullValue:"NULL_VALUE"});default:return le()}}(t):t.fieldFilter!==void 0?function(n){return Ne.create(pl(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return le()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return tt.create(n.compositeFilter.filters.map(r=>QC(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return le()}}(n.compositeFilter.op))}(t):le()}function a5(t){return JV[t]}function l5(t){return ZV[t]}function c5(t){return e5[t]}function fl(t){return{fieldPath:t.canonicalString()}}function pl(t){return _t.fromServerFormat(t.fieldPath)}function YC(t){return t instanceof Ne?function(n){if(n.op==="=="){if(KE(n.value))return{unaryFilter:{field:fl(n.field),op:"IS_NAN"}};if(WE(n.value))return{unaryFilter:{field:fl(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(KE(n.value))return{unaryFilter:{field:fl(n.field),op:"IS_NOT_NAN"}};if(WE(n.value))return{unaryFilter:{field:fl(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fl(n.field),op:l5(n.op),value:n.value}}}(t):t instanceof tt?function(n){const r=n.getFilters().map(i=>YC(i));return r.length===1?r[0]:{compositeFilter:{op:c5(n.op),filters:r}}}(t):le()}function u5(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function XC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e,n,r,i,s=ue.min(),o=ue.min(),a=Vt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Wi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e){this.ht=e}}function h5(t,e){let n;if(e.document)n=r5(t.ht,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=te.fromSegments(e.noDocument.path),i=Sa(e.noDocument.readTime);n=Ct.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return le();{const r=te.fromSegments(e.unknownDocument.path),i=Sa(e.unknownDocument.version);n=Ct.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Et(i[0],i[1]);return ue.fromTimestamp(s)}(e.readTime)),n}function u1(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Bf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:$f(s,o.key),fields:o.data.value.mapValue.fields,updateTime:rc(s,o.version.toTimestamp()),createTime:rc(s,o.createTime.toTimestamp())}}(t.ht,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ia(e.version)};else{if(!e.isUnknownDocument())return le();r.unknownDocument={path:n.path.toArray(),version:Ia(e.version)}}return r}function Bf(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ia(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Sa(t){const e=new Et(t.seconds,t.nanoseconds);return ue.fromTimestamp(e)}function ea(t,e){const n=(e.baseMutations||[]).map(s=>Sv(t.ht,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Sv(t.ht,s)),i=Et.fromMillis(e.localWriteTimeMs);return new h_(e.batchId,i,n,r)}function lu(t){const e=Sa(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Sa(t.lastLimboFreeSnapshotVersion):ue.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return ce(s.documents.length===1),Dr(yh(qC(s.documents[0])))}(t.query):function(s){return Dr(GC(s))}(t.query),new Wi(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Vt.fromBase64String(t.resumeToken))}function ZC(t,e){const n=Ia(e.snapshotVersion),r=Ia(e.lastLimboFreeSnapshotVersion);let i;i=Ff(e.target)?WC(t.ht,e.target):KC(t.ht,e.target).ct;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ta(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function eA(t){const e=GC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?wv(e,e.limit,"L"):e}function qg(t,e){return new f_(e.largestBatchId,Sv(t.ht,e.overlayMutation))}function h1(t,e){const n=e.path.lastSegment();return[t,mn(e.path.popLast()),n]}function d1(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Ia(r.readTime),documentKey:mn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d5{getBundleMetadata(e,n){return f1(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Sa(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return f1(e).put(function(i){return{bundleId:i.id,createTime:Ia(Pn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return p1(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:eA(s.bundledQuery),readTime:Sa(s.readTime)}}(r)})}saveNamedQuery(e,n){return p1(e).put(function(i){return{name:i.name,readTime:Ia(Pn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function f1(t){return Wt(t,"bundles")}function p1(t){return Wt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(e,n){this.serializer=e,this.userId=n}static Pt(e,n){const r=n.uid||"";return new Dp(e,r)}getOverlay(e,n){return Wc(e).get(h1(this.userId,n)).next(r=>r?qg(this.serializer,r):null)}getOverlays(e,n){const r=wi();return $.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new f_(n,o);i.push(this.Tt(e,a))}),$.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(mn(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Wc(e).j("collectionPathOverlayIndex",a))}),$.waitFor(s)}getOverlaysForCollection(e,n,r){const i=wi(),s=mn(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Wc(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const u=qg(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=wi();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Wc(e).J({index:"collectionGroupOverlayIndex",range:a},(l,u,d)=>{const p=qg(this.serializer,u);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):d.done()}).next(()=>s)}Tt(e,n){return Wc(e).put(function(i,s,o){const[a,l,u]=h1(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:zf(i.ht,o.mutation)}}(this.serializer,this.userId,n))}}function Wc(t){return Wt(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f5{It(e){return Wt(e,"globals")}getSessionToken(e){return this.It(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Vt.fromUint8Array(r):Vt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.It(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(){}Et(e,n){this.dt(e,n),n.At()}dt(e,n){if("nullValue"in e)this.Rt(n,5);else if("booleanValue"in e)this.Rt(n,10),n.Vt(e.booleanValue?1:0);else if("integerValue"in e)this.Rt(n,15),n.Vt(pt(e.integerValue));else if("doubleValue"in e){const r=pt(e.doubleValue);isNaN(r)?this.Rt(n,13):(this.Rt(n,15),Zu(r)?n.Vt(0):n.Vt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Rt(n,20),typeof r=="string"&&(r=ns(r)),n.ft(`${r.seconds||""}`),n.Vt(r.nanos||0)}else if("stringValue"in e)this.gt(e.stringValue,n),this.yt(n);else if("bytesValue"in e)this.Rt(n,30),n.wt(rs(e.bytesValue)),this.yt(n);else if("referenceValue"in e)this.St(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Rt(n,45),n.Vt(r.latitude||0),n.Vt(r.longitude||0)}else"mapValue"in e?pC(e)?this.Rt(n,Number.MAX_SAFE_INTEGER):Cp(e)?this.bt(e.mapValue,n):(this.Dt(e.mapValue,n),this.yt(n)):"arrayValue"in e?(this.vt(e.arrayValue,n),this.yt(n)):le()}gt(e,n){this.Rt(n,25),this.Ct(e,n)}Ct(e,n){n.ft(e)}Dt(e,n){const r=e.fields||{};this.Rt(n,55);for(const i of Object.keys(r))this.gt(i,n),this.dt(r[i],n)}bt(e,n){var r,i;const s=e.fields||{};this.Rt(n,53);const o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Rt(n,15),n.Vt(pt(a)),this.gt(o,n),this.dt(s[o],n)}vt(e,n){const r=e.values||[];this.Rt(n,50);for(const i of r)this.dt(i,n)}St(e,n){this.Rt(n,37),te.fromName(e).path.forEach(r=>{this.Rt(n,60),this.Ct(r,n)})}Rt(e,n){e.Vt(n)}yt(e){e.Vt(2)}}ta.Ft=new ta;function p5(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function g1(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=p5(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class g5{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Mt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.xt(r.value),r=n.next();this.Ot()}Nt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Lt(r.value),r=n.next();this.Bt()}kt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.xt(r);else if(r<2048)this.xt(960|r>>>6),this.xt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.xt(480|r>>>12),this.xt(128|63&r>>>6),this.xt(128|63&r);else{const i=n.codePointAt(0);this.xt(240|i>>>18),this.xt(128|63&i>>>12),this.xt(128|63&i>>>6),this.xt(128|63&i)}}this.Ot()}qt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Lt(r);else if(r<2048)this.Lt(960|r>>>6),this.Lt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Lt(480|r>>>12),this.Lt(128|63&r>>>6),this.Lt(128|63&r);else{const i=n.codePointAt(0);this.Lt(240|i>>>18),this.Lt(128|63&i>>>12),this.Lt(128|63&i>>>6),this.Lt(128|63&i)}}this.Bt()}Qt(e){const n=this.Kt(e),r=g1(n);this.$t(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Ut(e){const n=this.Kt(e),r=g1(n);this.$t(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Wt(){this.Gt(255),this.Gt(255)}zt(){this.jt(255),this.jt(255)}reset(){this.position=0}seed(e){this.$t(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ht(){return this.buffer.slice(0,this.position)}Kt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}xt(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(n)}Lt(e){const n=255&e;n===0?(this.jt(0),this.jt(255)):n===255?(this.jt(255),this.jt(0)):this.jt(e)}Ot(){this.Gt(0),this.Gt(1)}Bt(){this.jt(0),this.jt(1)}Gt(e){this.$t(1),this.buffer[this.position++]=e}jt(e){this.$t(1),this.buffer[this.position++]=~e}$t(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class m5{constructor(e){this.Jt=e}wt(e){this.Jt.Mt(e)}ft(e){this.Jt.kt(e)}Vt(e){this.Jt.Qt(e)}At(){this.Jt.Wt()}}class v5{constructor(e){this.Jt=e}wt(e){this.Jt.Nt(e)}ft(e){this.Jt.qt(e)}Vt(e){this.Jt.Ut(e)}At(){this.Jt.zt()}}class Kc{constructor(){this.Jt=new g5,this.Yt=new m5(this.Jt),this.Zt=new v5(this.Jt)}seed(e){this.Jt.seed(e)}Xt(e){return e===0?this.Yt:this.Zt}Ht(){return this.Jt.Ht()}reset(){this.Jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}en(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new na(this.indexId,this.documentKey,this.arrayValue,r)}}function Os(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=m1(t.arrayValue,e.arrayValue),n!==0?n:(n=m1(t.directionalValue,e.directionalValue),n!==0?n:te.comparator(t.documentKey,e.documentKey)))}function m1(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{constructor(e){this.tn=new Ye((n,r)=>_t.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.nn=e.orderBy,this.rn=[];for(const n of e.filters){const r=n;r.isInequality()?this.tn=this.tn.add(r):this.rn.push(r)}}get sn(){return this.tn.size>1}on(e){if(ce(e.collectionGroup===this.collectionId),this.sn)return!1;const n=fv(e);if(n!==void 0&&!this._n(n))return!1;const r=Jo(e);let i=new Set,s=0,o=0;for(;s<r.length&&this._n(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.tn.size>0){const a=this.tn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.an(a,l)||!this.un(this.nn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.nn.length||!this.un(this.nn[o++],a))return!1}return!0}cn(){if(this.sn)return null;let e=new Ye(_t.comparator);const n=[];for(const r of this.rn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Hd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Hd(r.field,0))}for(const r of this.nn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Hd(r.field,r.dir==="asc"?0:1)));return new Vf(Vf.UNKNOWN_ID,this.collectionId,n,Ju.empty())}_n(e){for(const n of this.rn)if(this.an(n,e))return!0;return!1}an(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}un(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(t){var e,n;if(ce(t instanceof Ne||t instanceof tt),t instanceof Ne){if(t instanceof IC){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>Ne.create(t.field,"==",s)))||[];return tt.create(i,"or")}return t}const r=t.filters.map(i=>tA(i));return tt.create(r,t.op)}function y5(t){if(t.getFilters().length===0)return[];const e=Av(tA(t));return ce(nA(e)),bv(e)||Cv(e)?[e]:e.getFilters()}function bv(t){return t instanceof Ne}function Cv(t){return t instanceof tt&&l_(t)}function nA(t){return bv(t)||Cv(t)||function(n){if(n instanceof tt&&vv(n)){for(const r of n.getFilters())if(!bv(r)&&!Cv(r))return!1;return!0}return!1}(t)}function Av(t){if(ce(t instanceof Ne||t instanceof tt),t instanceof Ne)return t;if(t.filters.length===1)return Av(t.filters[0]);const e=t.filters.map(r=>Av(r));let n=tt.create(e,t.op);return n=qf(n),nA(n)?n:(ce(n instanceof tt),ce(Zl(n)),ce(n.filters.length>1),n.filters.reduce((r,i)=>m_(r,i)))}function m_(t,e){let n;return ce(t instanceof Ne||t instanceof tt),ce(e instanceof Ne||e instanceof tt),n=t instanceof Ne?e instanceof Ne?function(i,s){return tt.create([i,s],"and")}(t,e):y1(t,e):e instanceof Ne?y1(e,t):function(i,s){if(ce(i.filters.length>0&&s.filters.length>0),Zl(i)&&Zl(s))return wC(i,s.getFilters());const o=vv(i)?i:s,a=vv(i)?s:i,l=o.filters.map(u=>m_(u,a));return tt.create(l,"or")}(t,e),qf(n)}function y1(t,e){if(Zl(e))return wC(e,t.getFilters());{const n=e.filters.map(r=>m_(t,r));return tt.create(n,"or")}}function qf(t){if(ce(t instanceof Ne||t instanceof tt),t instanceof Ne)return t;const e=t.getFilters();if(e.length===1)return qf(e[0]);if(yC(t))return t;const n=e.map(i=>qf(i)),r=[];return n.forEach(i=>{i instanceof Ne?r.push(i):i instanceof tt&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:tt.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _5{constructor(){this.ln=new v_}addToCollectionParentIndex(e,n){return this.ln.add(n),$.resolve()}getCollectionParents(e,n){return $.resolve(this.ln.getEntries(n))}addFieldIndex(e,n){return $.resolve()}deleteFieldIndex(e,n){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,n){return $.resolve()}getDocumentsMatchingTarget(e,n){return $.resolve(null)}getIndexType(e,n){return $.resolve(0)}getFieldIndexes(e,n){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,n){return $.resolve(lr.min())}getMinOffsetFromCollectionGroup(e,n){return $.resolve(lr.min())}updateCollectionGroup(e,n,r){return $.resolve()}updateIndexEntries(e,n){return $.resolve()}}class v_{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ye(Ge.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ye(Ge.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wd=new Uint8Array(0);class w5{constructor(e,n){this.databaseId=n,this.hn=new v_,this.Pn=new ls(r=>Ta(r),(r,i)=>vh(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.hn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.hn.add(n)});const s={collectionId:r,parent:mn(i)};return _1(e).put(s)}return $.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[rC(n),""],!1,!0);return _1(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(_i(o.parent))}return r})}addFieldIndex(e,n){const r=Gc(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=ll(e);return s.next(a=>{o.put(d1(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Gc(e),i=ll(e),s=al(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Gc(e),r=al(e),i=ll(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return $.forEach(this.Tn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new v1(r).cn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=al(e);let i=!0;const s=new Map;return $.forEach(this.Tn(n),o=>this.In(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Pe();const a=[];return $.forEach(s,(l,u)=>{Q("IndexedDbIndexManager",`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(M=>`${M.fieldPath}:${M.kind}`).join(",")}`}(l)} to execute ${Ta(n)}`);const d=function(S,M){const q=fv(M);if(q===void 0)return null;for(const W of Uf(S,q.fieldPath))switch(W.op){case"array-contains-any":return W.value.arrayValue.values||[];case"array-contains":return[W.value]}return null}(u,l),p=function(S,M){const q=new Map;for(const W of Jo(M))for(const P of Uf(S,W.fieldPath))switch(P.op){case"==":case"in":q.set(W.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return q.set(W.fieldPath.canonicalString(),P.value),Array.from(q.values())}return null}(u,l),m=function(S,M){const q=[];let W=!0;for(const P of Jo(M)){const C=P.kind===0?JE(S,P.fieldPath,S.startAt):ZE(S,P.fieldPath,S.startAt);q.push(C.value),W&&(W=C.inclusive)}return new Jl(q,W)}(u,l),w=function(S,M){const q=[];let W=!0;for(const P of Jo(M)){const C=P.kind===0?ZE(S,P.fieldPath,S.endAt):JE(S,P.fieldPath,S.endAt);q.push(C.value),W&&(W=C.inclusive)}return new Jl(q,W)}(u,l),E=this.En(l,u,m),x=this.En(l,u,w),D=this.dn(l,u,p),A=this.An(l.indexId,d,E,m.inclusive,x,w.inclusive,D);return $.forEach(A,T=>r.G(T,n.limit).next(S=>{S.forEach(M=>{const q=te.fromSegments(M.documentKey);o.has(q)||(o=o.add(q),a.push(q))})}))}).next(()=>a)}return $.resolve(null)})}Tn(e){let n=this.Pn.get(e);return n||(e.filters.length===0?n=[e]:n=y5(tt.create(e.filters,"and")).map(r=>_v(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Pn.set(e,n),n)}An(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),d=[];for(let p=0;p<l;++p){const m=n?this.Rn(n[p/u]):wd,w=this.Vn(e,m,r[p%u],i),E=this.mn(e,m,s[p%u],o),x=a.map(D=>this.Vn(e,m,D,!0));d.push(...this.createRange(w,E,x))}return d}Vn(e,n,r,i){const s=new na(e,te.empty(),n,r);return i?s:s.en()}mn(e,n,r,i){const s=new na(e,te.empty(),n,r);return i?s.en():s}In(e,n){const r=new v1(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.on(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Tn(n);return $.forEach(i,s=>this.In(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new Ye(_t.comparator),d=!1;for(const p of l.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:u=u.add(m.field));for(const p of l.orderBy)p.field.isKeyField()||(u=u.add(p.field));return u.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}fn(e,n){const r=new Kc;for(const i of Jo(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Xt(i.kind);ta.Ft.Et(s,o)}return r.Ht()}Rn(e){const n=new Kc;return ta.Ft.Et(e,n.Xt(0)),n.Ht()}gn(e,n){const r=new Kc;return ta.Ft.Et(a_(this.databaseId,n),r.Xt(function(s){const o=Jo(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Ht()}dn(e,n,r){if(r===null)return[];let i=[];i.push(new Kc);let s=0;for(const o of Jo(e)){const a=r[s++];for(const l of i)if(this.pn(n,o.fieldPath)&&nh(a))i=this.yn(i,o,a);else{const u=l.Xt(o.kind);ta.Ft.Et(a,u)}}return this.wn(i)}En(e,n,r){return this.dn(e,n,r.position)}wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Ht();return n}yn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new Kc;l.seed(a.Ht()),ta.Ft.Et(o,l.Xt(n.kind)),s.push(l)}return s}pn(e,n){return!!e.filters.find(r=>r instanceof Ne&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Gc(e),i=ll(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{const o=[];return $.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(d,p){const m=p?new Ju(p.sequenceNumber,new lr(Sa(p.readTime),new te(_i(p.documentKey)),p.largestBatchId)):Ju.empty(),w=d.fields.map(([E,x])=>new Hd(_t.fromServerFormat(E),x));return new Vf(d.indexId,d.collectionGroup,w,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:we(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Gc(e),s=ll(e);return this.Sn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>$.forEach(a,l=>s.put(d1(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return $.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?$.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),$.forEach(a,l=>this.bn(e,i,l).next(u=>{const d=this.Dn(s,l);return u.isEqual(d)?$.resolve():this.vn(e,s,l,u,d)}))))})}Cn(e,n,r,i){return al(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.gn(r,n.key),documentKey:n.key.path.toArray()})}Fn(e,n,r,i){return al(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.gn(r,n.key),n.key.path.toArray()])}bn(e,n,r){const i=al(e);let s=new Ye(Os);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.gn(r,n)])},(o,a)=>{s=s.add(new na(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}Dn(e,n){let r=new Ye(Os);const i=this.fn(n,e);if(i==null)return r;const s=fv(n);if(s!=null){const o=e.data.field(s.fieldPath);if(nh(o))for(const a of o.arrayValue.values||[])r=r.add(new na(n.indexId,e.key,this.Rn(a),i))}else r=r.add(new na(n.indexId,e.key,wd,i));return r}vn(e,n,r,i,s){Q("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(l,u,d,p,m){const w=l.getIterator(),E=u.getIterator();let x=ol(w),D=ol(E);for(;x||D;){let A=!1,T=!1;if(x&&D){const S=d(x,D);S<0?T=!0:S>0&&(A=!0)}else x!=null?T=!0:A=!0;A?(p(D),D=ol(E)):T?(m(x),x=ol(w)):(x=ol(w),D=ol(E))}}(i,s,Os,a=>{o.push(this.Cn(e,n,r,a))},a=>{o.push(this.Fn(e,n,r,a))}),$.waitFor(o)}Sn(e){let n=1;return ll(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Os(o,a)).filter((o,a,l)=>!a||Os(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Os(o,e),l=Os(o,n);if(a===0)i[0]=e.en();else if(a>0&&l<0)i.push(o),i.push(o.en());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Mn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,wd,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,wd,[]];s.push(IDBKeyRange.bound(a,l))}return s}Mn(e,n){return Os(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(w1)}getMinOffset(e,n){return $.mapArray(this.Tn(n),r=>this.In(e,r).next(i=>i||le())).next(w1)}}function _1(t){return Wt(t,"collectionParents")}function al(t){return Wt(t,"indexEntries")}function Gc(t){return Wt(t,"indexConfiguration")}function ll(t){return Wt(t,"indexState")}function w1(t){ce(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;r_(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new lr(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class pn{static withCacheSize(e){return new pn(e,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rA(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.J({range:o},(d,p,m)=>(a++,m.delete()));s.push(l.next(()=>{ce(a===1)}));const u=[];for(const d of n.mutations){const p=lC(e,d.key.path,n.batchId);s.push(i.delete(p)),u.push(d.key)}return $.waitFor(s).next(()=>u)}function Hf(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw le();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pn.DEFAULT_COLLECTION_PERCENTILE=10,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pn.DEFAULT=new pn(41943040,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pn.DISABLED=new pn(-1,0,0);class Op{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.xn={}}static Pt(e,n,r,i){ce(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Op(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ns(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=gl(e),o=Ns(e);return o.add({}).next(a=>{ce(typeof a=="number");const l=new h_(a,n,r,i),u=function(w,E,x){const D=x.baseMutations.map(T=>zf(w.ht,T)),A=x.mutations.map(T=>zf(w.ht,T));return{userId:E,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:D,mutations:A}}(this.serializer,this.userId,l),d=[];let p=new Ye((m,w)=>we(m.canonicalString(),w.canonicalString()));for(const m of i){const w=lC(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),d.push(o.put(u)),d.push(s.put(w,eV))}return p.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.xn[a]=l.keys()}),$.waitFor(d).next(()=>l)})}lookupMutationBatch(e,n){return Ns(e).get(n).next(r=>r?(ce(r.userId===this.userId),ea(this.serializer,r)):null)}On(e,n){return this.xn[n]?$.resolve(this.xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ns(e).J({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(ce(a.batchId>=r),s=ea(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ns(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ns(e).U("userMutationsIndex",n).next(r=>r.map(i=>ea(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Wd(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return gl(e).J({range:i},(o,a,l)=>{const[u,d,p]=o,m=_i(d);if(u===this.userId&&n.path.isEqual(m))return Ns(e).get(p).next(w=>{if(!w)throw le();ce(w.userId===this.userId),s.push(ea(this.serializer,w))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ye(we);const i=[];return n.forEach(s=>{const o=Wd(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=gl(e).J({range:a},(u,d,p)=>{const[m,w,E]=u,x=_i(w);m===this.userId&&s.path.isEqual(x)?r=r.add(E):p.done()});i.push(l)}),$.waitFor(i).next(()=>this.Nn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Wd(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ye(we);return gl(e).J({range:o},(l,u,d)=>{const[p,m,w]=l,E=_i(m);p===this.userId&&r.isPrefixOf(E)?E.length===i&&(a=a.add(w)):d.done()}).next(()=>this.Nn(e,a))}Nn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Ns(e).get(s).next(o=>{if(o===null)throw le();ce(o.userId===this.userId),r.push(ea(this.serializer,o))}))}),$.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return rA(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Ln(n.batchId)}),$.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Ln(e){delete this.xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return $.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return gl(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=_i(s[1]);i.push(l)}else a.done()}).next(()=>{ce(i.length===0)})})}containsKey(e,n){return iA(e,this.userId,n)}Bn(e){return sA(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function iA(t,e,n){const r=Wd(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return gl(t).J({range:s,H:!0},(a,l,u)=>{const[d,p,m]=a;d===e&&p===i&&(o=!0),u.done()}).next(()=>o)}function Ns(t){return Wt(t,"mutations")}function gl(t){return Wt(t,"documentMutations")}function sA(t){return Wt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new ba(0)}static Qn(){return new ba(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Kn(e).next(n=>{const r=new ba(n.highestTargetId);return n.highestTargetId=r.next(),this.$n(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Kn(e).next(n=>ue.fromTimestamp(new Et(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Kn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Kn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.$n(e,i)))}addTargetData(e,n){return this.Un(e,n).next(()=>this.Kn(e).next(r=>(r.targetCount+=1,this.Wn(n,r),this.$n(e,r))))}updateTargetData(e,n){return this.Un(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>cl(e).delete(n.targetId)).next(()=>this.Kn(e)).next(r=>(ce(r.targetCount>0),r.targetCount-=1,this.$n(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return cl(e).J((o,a)=>{const l=lu(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>$.waitFor(s)).next(()=>i)}forEachTarget(e,n){return cl(e).J((r,i)=>{const s=lu(i);n(s)})}Kn(e){return T1(e).get("targetGlobalKey").next(n=>(ce(n!==null),n))}$n(e,n){return T1(e).put("targetGlobalKey",n)}Un(e,n){return cl(e).put(ZC(this.serializer,n))}Wn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Kn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Ta(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return cl(e).J({range:i,index:"queryTargetsIndex"},(o,a,l)=>{const u=lu(a);vh(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Ws(e);return n.forEach(o=>{const a=mn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),$.waitFor(i)}removeMatchingKeys(e,n,r){const i=Ws(e);return $.forEach(n,s=>{const o=mn(s.path);return $.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Ws(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Ws(e);let s=Pe();return i.J({range:r,H:!0},(o,a,l)=>{const u=_i(o[1]),d=new te(u);s=s.add(d)}).next(()=>s)}containsKey(e,n){const r=mn(n.path),i=IDBKeyRange.bound([r],[rC(r)],!1,!0);let s=0;return Ws(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}ut(e,n){return cl(e).get(n).next(r=>r?lu(r):null)}}function cl(t){return Wt(t,"targets")}function T1(t){return Wt(t,"targetGlobal")}function Ws(t){return Wt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I1([t,e],[n,r]){const i=we(t,n);return i===0?we(e,r):i}class T5{constructor(e){this.Gn=e,this.buffer=new Ye(I1),this.zn=0}jn(){return++this.zn}Hn(e){const n=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();I1(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class oA{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){Q("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){bo(n)?Q("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await La(n)}await this.Yn(3e5)})}}class I5{constructor(e,n){this.Zn=e,this.params=n}calculateTargetCount(e,n){return this.Zn.Xn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return $.resolve(Pr.oe);const r=new T5(n);return this.Zn.forEachTarget(e,i=>r.Hn(i.sequenceNumber)).next(()=>this.Zn.er(e,i=>r.Hn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Zn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Q("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(E1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),E1):this.tr(e,n))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,n){let r,i,s,o,a,l,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(Q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,n))).next(p=>(s=p,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(u=Date.now(),hl()<=De.DEBUG&&Q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${p} documents in `+(u-l)+`ms
Total Duration: ${u-d}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}function aA(t,e){return new I5(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(e,n){this.db=e,this.garbageCollector=aA(this,n)}Xn(e){const n=this.nr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}nr(e){let n=0;return this.er(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}er(e,n){return this.rr(e,(r,i)=>n(i))}addReference(e,n,r){return Ed(e,r)}removeReference(e,n,r){return Ed(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Ed(e,n)}ir(e,n){return function(i,s){let o=!1;return sA(i).Y(a=>iA(i,a,s).next(l=>(l&&(o=!0),$.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.rr(e,(o,a)=>{if(a<=n){const l=this.ir(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ue.min()),Ws(e).delete(function(p){return[0,mn(p.path)]}(o))))});i.push(l)}}).next(()=>$.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Ed(e,n)}rr(e,n){const r=Ws(e);let i,s=Pr.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==Pr.oe&&n(new te(_i(i)),s),s=u,i=l):s=Pr.oe}).next(()=>{s!==Pr.oe&&n(new te(_i(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Ed(t,e){return Ws(t).put(function(r,i){return{targetId:0,path:mn(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{constructor(){this.changes=new ls(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ct.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?$.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b5{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Go(e).put(r)}removeEntry(e,n,r){return Go(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Bf(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.sr(e,r)))}getEntry(e,n){let r=Ct.newInvalidDocument(n);return Go(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Qc(n))},(i,s)=>{r=this._r(n,s)}).next(()=>r)}ar(e,n){let r={size:0,document:Ct.newInvalidDocument(n)};return Go(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Qc(n))},(i,s)=>{r={document:this._r(n,s),size:Hf(s)}}).next(()=>r)}getEntries(e,n){let r=rr();return this.ur(e,n,(i,s)=>{const o=this._r(i,s);r=r.insert(i,o)}).next(()=>r)}cr(e,n){let r=rr(),i=new mt(te.comparator);return this.ur(e,n,(s,o)=>{const a=this._r(s,o);r=r.insert(s,a),i=i.insert(s,Hf(o))}).next(()=>({documents:r,lr:i}))}ur(e,n,r){if(n.isEmpty())return $.resolve();let i=new Ye(C1);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(Qc(i.first()),Qc(i.last())),o=i.getIterator();let a=o.getNext();return Go(e).J({index:"documentKeyIndex",range:s},(l,u,d)=>{const p=te.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&C1(a,p)<0;)r(a,null),a=o.getNext();a&&a.isEqual(p)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?d.$(Qc(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Bf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Go(e).U(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let d=rr();for(const p of u){const m=this._r(te.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(_h(n,m)||i.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,n,r,i){let s=rr();const o=b1(n,r),a=b1(n,lr.max());return Go(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,u,d)=>{const p=this._r(te.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(p.key,p),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new C5(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return S1(e).get("remoteDocumentGlobalKey").next(n=>(ce(!!n),n))}sr(e,n){return S1(e).put("remoteDocumentGlobalKey",n)}_r(e,n){if(n){const r=h5(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(ue.min())))return r}return Ct.newInvalidDocument(e)}}function cA(t){return new b5(t)}class C5 extends lA{constructor(e,n){super(),this.hr=e,this.trackRemovals=n,this.Pr=new ls(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ye((s,o)=>we(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Pr.get(s);if(n.push(this.hr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=u1(this.hr.serializer,o);i=i.add(s.path.popLast());const u=Hf(l);r+=u-a.size,n.push(this.hr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=u1(this.hr.serializer,o.convertToNoDocument(ue.min()));n.push(this.hr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.hr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.hr.updateMetadata(e,r)),$.waitFor(n)}getFromCache(e,n){return this.hr.ar(e,n).next(r=>(this.Pr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.hr.cr(e,n).next(({documents:r,lr:i})=>(i.forEach((s,o)=>{this.Pr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function S1(t){return Wt(t,"remoteDocumentGlobal")}function Go(t){return Wt(t,"remoteDocumentsV14")}function Qc(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function b1(t,e){const n=e.documentKey.path.toArray();return[t,Bf(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function C1(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=we(n[s],r[s]),i)return i;return i=we(n.length,r.length),i||(i=we(n[n.length-2],r[r.length-2]),i||we(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A5{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Cu(r.mutation,i,nr.empty(),Et.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Pe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Pe()){const i=wi();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=ou();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=wi();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Pe()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=rr();const o=bu(),a=function(){return bu()}();return n.forEach((l,u)=>{const d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof cs)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Cu(d.mutation,u,d.mutation.getFieldMask(),Et.now())):o.set(u.key,nr.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var p;return a.set(u,new A5(d,(p=o.get(u))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,n){const r=bu();let i=new mt((o,a)=>o-a),s=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let d=r.get(l)||nr.empty();d=a.applyToLocalView(u,d),r.set(l,d);const p=(i.get(a.batchId)||Pe()).add(l);i=i.insert(a.batchId,p)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,d=l.value,p=xC();d.forEach(m=>{if(!s.has(m)){const w=LC(n.get(m),r.get(m));w!==null&&p.set(m,w),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return $.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return te.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):RV(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):$.resolve(wi());let a=-1,l=s;return o.next(u=>$.forEach(u,(d,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(d)?$.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{l=l.insert(d,m)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Pe())).next(d=>({batchId:a,changes:AC(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new te(n)).next(r=>{let i=ou();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=ou();return this.indexManager.getCollectionParents(e,s).next(a=>$.forEach(a,l=>{const u=function(p,m){return new Ap(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Ct.newInvalidDocument(d)))});let a=ou();return o.forEach((l,u)=>{const d=s.get(l);d!==void 0&&Cu(d.mutation,u,nr.empty(),Et.now()),_h(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,n){return $.resolve(this.Tr.get(n))}saveBundleMetadata(e,n){return this.Tr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Pn(i.createTime)}}(n)),$.resolve()}getNamedQuery(e,n){return $.resolve(this.Ir.get(n))}saveNamedQuery(e,n){return this.Ir.set(n.name,function(i){return{name:i.name,query:eA(i.bundledQuery),readTime:Pn(i.readTime)}}(n)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P5{constructor(){this.overlays=new mt(te.comparator),this.Er=new Map}getOverlay(e,n){return $.resolve(this.overlays.get(n))}getOverlays(e,n){const r=wi();return $.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.Tt(e,n,s)}),$.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Er.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Er.delete(r)),$.resolve()}getOverlaysForCollection(e,n,r){const i=wi(),s=n.length+1,o=new te(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return $.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new mt((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=s.get(u.largestBatchId);d===null&&(d=wi(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=wi(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return $.resolve(a)}Tt(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Er.get(i.largestBatchId).delete(r.key);this.Er.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new f_(n,r));let s=this.Er.get(n);s===void 0&&(s=Pe(),this.Er.set(n,s)),this.Er.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k5{constructor(){this.sessionToken=Vt.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(){this.dr=new Ye(Xt.Ar),this.Rr=new Ye(Xt.Vr)}isEmpty(){return this.dr.isEmpty()}addReference(e,n){const r=new Xt(e,n);this.dr=this.dr.add(r),this.Rr=this.Rr.add(r)}mr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.gr(new Xt(e,n))}pr(e,n){e.forEach(r=>this.removeReference(r,n))}yr(e){const n=new te(new Ge([])),r=new Xt(n,e),i=new Xt(n,e+1),s=[];return this.Rr.forEachInRange([r,i],o=>{this.gr(o),s.push(o.key)}),s}wr(){this.dr.forEach(e=>this.gr(e))}gr(e){this.dr=this.dr.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){const n=new te(new Ge([])),r=new Xt(n,e),i=new Xt(n,e+1);let s=Pe();return this.Rr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Xt(e,0),r=this.dr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Xt{constructor(e,n){this.key=e,this.br=n}static Ar(e,n){return te.comparator(e.key,n.key)||we(e.br,n.br)}static Vr(e,n){return we(e.br,n.br)||te.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R5{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Dr=1,this.vr=new Ye(Xt.Ar)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new h_(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.vr=this.vr.add(new Xt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return $.resolve(o)}lookupMutationBatch(e,n){return $.resolve(this.Cr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.Fr(r),s=i<0?0:i;return $.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Xt(n,0),i=new Xt(n,Number.POSITIVE_INFINITY),s=[];return this.vr.forEachInRange([r,i],o=>{const a=this.Cr(o.br);s.push(a)}),$.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ye(we);return n.forEach(i=>{const s=new Xt(i,0),o=new Xt(i,Number.POSITIVE_INFINITY);this.vr.forEachInRange([s,o],a=>{r=r.add(a.br)})}),$.resolve(this.Mr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;te.isDocumentKey(s)||(s=s.child(""));const o=new Xt(new te(s),0);let a=new Ye(we);return this.vr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.br)),!0)},o),$.resolve(this.Mr(a))}Mr(e){const n=[];return e.forEach(r=>{const i=this.Cr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){ce(this.Or(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.vr;return $.forEach(n.mutations,i=>{const s=new Xt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.vr=r})}Ln(e){}containsKey(e,n){const r=new Xt(n,0),i=this.vr.firstAfterOrEqual(r);return $.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}Or(e,n){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){const n=this.Fr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D5{constructor(e){this.Nr=e,this.docs=function(){return new mt(te.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Nr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return $.resolve(r?r.document.mutableCopy():Ct.newInvalidDocument(n))}getEntries(e,n){let r=rr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ct.newInvalidDocument(i))}),$.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=rr();const o=n.path,a=new te(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:d}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||r_(iC(d),r)<=0||(i.has(d.key)||_h(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return $.resolve(s)}getAllFromCollectionGroup(e,n,r,i){le()}Lr(e,n){return $.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new O5(this)}getSize(e){return $.resolve(this.size)}}class O5 extends lA{constructor(e){super(),this.hr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.hr.addEntry(e,i)):this.hr.removeEntry(r)}),$.waitFor(n)}getFromCache(e,n){return this.hr.getEntry(e,n)}getAllFromCache(e,n){return this.hr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N5{constructor(e){this.persistence=e,this.Br=new ls(n=>Ta(n),vh),this.lastRemoteSnapshotVersion=ue.min(),this.highestTargetId=0,this.kr=0,this.qr=new y_,this.targetCount=0,this.Qr=ba.qn()}forEachTarget(e,n){return this.Br.forEach((r,i)=>n(i)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.kr&&(this.kr=n),$.resolve()}Un(e){this.Br.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Qr=new ba(n),this.highestTargetId=n),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,n){return this.Un(n),this.targetCount+=1,$.resolve()}updateTargetData(e,n){return this.Un(n),$.resolve()}removeTargetData(e,n){return this.Br.delete(n.target),this.qr.yr(n.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Br.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Br.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),$.waitFor(s).next(()=>i)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,n){const r=this.Br.get(n)||null;return $.resolve(r)}addMatchingKeys(e,n,r){return this.qr.mr(n,r),$.resolve()}removeMatchingKeys(e,n,r){this.qr.pr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),$.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.qr.yr(n),$.resolve()}getMatchingKeysForTargetId(e,n){const r=this.qr.Sr(n);return $.resolve(r)}containsKey(e,n){return $.resolve(this.qr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(e,n){this.Kr={},this.overlays={},this.$r=new Pr(0),this.Ur=!1,this.Ur=!0,this.Wr=new k5,this.referenceDelegate=e(this),this.Gr=new N5(this),this.indexManager=new _5,this.remoteDocumentCache=function(i){return new D5(i)}(r=>this.referenceDelegate.zr(r)),this.serializer=new JC(n),this.jr=new x5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new P5,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Kr[e.toKey()];return r||(r=new R5(n,this.referenceDelegate),this.Kr[e.toKey()]=r),r}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,n,r){Q("MemoryPersistence","Starting transaction:",e);const i=new L5(this.$r.next());return this.referenceDelegate.Hr(),r(i).next(s=>this.referenceDelegate.Jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Yr(e,n){return $.or(Object.values(this.Kr).map(r=>()=>r.containsKey(e,n)))}}class L5 extends oC{constructor(e){super(),this.currentSequenceNumber=e}}class Np{constructor(e){this.persistence=e,this.Zr=new y_,this.Xr=null}static ei(e){return new Np(e)}get ti(){if(this.Xr)return this.Xr;throw le()}addReference(e,n,r){return this.Zr.addReference(r,n),this.ti.delete(r.toString()),$.resolve()}removeReference(e,n,r){return this.Zr.removeReference(r,n),this.ti.add(r.toString()),$.resolve()}markPotentiallyOrphaned(e,n){return this.ti.add(n.toString()),$.resolve()}removeTarget(e,n){this.Zr.yr(n.targetId).forEach(i=>this.ti.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.ti.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Hr(){this.Xr=new Set}Jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.ti,r=>{const i=te.fromPath(r);return this.ni(e,i).next(s=>{s||n.removeEntry(i,ue.min())})}).next(()=>(this.Xr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ni(e,n).next(r=>{r?this.ti.delete(n.toString()):this.ti.add(n.toString())})}zr(e){return 0}ni(e,n){return $.or([()=>$.resolve(this.Zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Yr(e,n)])}}class Wf{constructor(e,n){this.persistence=e,this.ri=new ls(r=>mn(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=aA(this,n)}static ei(e,n){return new Wf(e,n)}Hr(){}Jr(e){return $.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}Xn(e){const n=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}nr(e){let n=0;return this.er(e,r=>{n++}).next(()=>n)}er(e,n){return $.forEach(this.ri,(r,i)=>this.ir(e,r,i).next(s=>s?$.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.Lr(e,o=>this.ir(e,o,n).next(a=>{a||(r++,s.removeEntry(o,ue.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.ri.set(n,e.currentSequenceNumber),$.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.ri.set(r,e.currentSequenceNumber),$.resolve()}removeReference(e,n,r){return this.ri.set(r,e.currentSequenceNumber),$.resolve()}updateLimboDocument(e,n){return this.ri.set(n,e.currentSequenceNumber),$.resolve()}zr(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Gd(e.data.value)),n}ir(e,n,r){return $.or([()=>this.persistence.Yr(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.ri.get(n);return $.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M5{constructor(e){this.serializer=e}O(e,n,r,i){const s=new Ip("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$E,{unique:!0}),l.createObjectStore("documentMutations")}(e),A1(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=$.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),A1(e)),o=o.next(()=>function(l){const u=l.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ue.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store("mutations").U().next(d=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$E,{unique:!0});const p=u.store("mutations"),m=d.map(w=>p.put(w));return $.waitFor(m)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ii(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.si(s)))),r<7&&i>=7&&(o=o.next(()=>this.oi(s))),r<8&&i>=8&&(o=o.next(()=>this._i(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ai(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore("documentOverlays",{keyPath:dV});u.createIndex("collectionPathOverlayIndex",fV,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",pV,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore("remoteDocumentsV14",{keyPath:tV});u.createIndex("documentKeyIndex",nV),u.createIndex("collectionGroupIndex",rV)}(e)).next(()=>this.ui(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ci(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:lV}).createIndex("sequenceNumberIndex",cV,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:uV}).createIndex("documentKeyIndex",hV,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}si(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=Hf(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ii(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>$.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>$.forEach(a,l=>{ce(l.userId===s.userId);const u=ea(this.serializer,l);return rA(e,s.userId,u).next(()=>{})}))}))}oi(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,a)=>{const l=new Ge(o),u=function(p){return[0,mn(p)]}(l);s.push(n.get(u).next(d=>d?$.resolve():(p=>n.put({targetId:0,path:mn(p),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>$.waitFor(s))})}_i(e,n){e.createObjectStore("collectionParents",{keyPath:aV});const r=n.store("collectionParents"),i=new v_,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:mn(l)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new Ge(o);return s(l.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,l],u)=>{const d=_i(a);return s(d.popLast())}))}ai(e){const n=e.store("targets");return n.J((r,i)=>{const s=lu(i),o=ZC(this.serializer,s);return n.put(o)})}ui(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{const a=n.store("remoteDocumentsV14"),l=function(p){return p.document?new te(Ge.fromString(p.document.name).popFirst(5)):p.noDocument?te.fromSegments(p.noDocument.path):p.unknownDocument?te.fromSegments(p.unknownDocument.path):le()}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>$.waitFor(i))}ci(e,n){const r=n.store("mutations"),i=cA(this.serializer),s=new __(Np.ei,this.serializer.ht);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var u;let d=(u=a.get(l.userId))!==null&&u!==void 0?u:Pe();ea(this.serializer,l).keys().forEach(p=>d=d.add(p)),a.set(l.userId,d)}),$.forEach(a,(l,u)=>{const d=new Sn(u),p=Dp.Pt(this.serializer,d),m=s.getIndexManager(d),w=Op.Pt(d,this.serializer,m,s.referenceDelegate);return new uA(i,w,p,m).recalculateAndSaveOverlaysForDocumentKeys(new pv(n,Pr.oe),l).next()})})}}function A1(t){t.createObjectStore("targetDocuments",{keyPath:sV}).createIndex("documentTargetsIndex",oV,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",iV,{unique:!0}),t.createObjectStore("targetGlobal")}const Hg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class w_{constructor(e,n,r,i,s,o,a,l,u,d,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.li=s,this.window=o,this.document=a,this.hi=u,this.Pi=d,this.Ti=p,this.$r=null,this.Ur=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ii=null,this.inForeground=!1,this.Ei=null,this.di=null,this.Ai=Number.NEGATIVE_INFINITY,this.Ri=m=>Promise.resolve(),!w_.p())throw new ne(K.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new S5(this,i),this.Vi=n+"main",this.serializer=new JC(l),this.mi=new co(this.Vi,this.Ti,new M5(this.serializer)),this.Wr=new f5,this.Gr=new E5(this.referenceDelegate,this.serializer),this.remoteDocumentCache=cA(this.serializer),this.jr=new d5,this.window&&this.window.localStorage?this.fi=this.window.localStorage:(this.fi=null,d===!1&&bn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ne(K.FAILED_PRECONDITION,Hg);return this.pi(),this.yi(),this.wi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Gr.getHighestSequenceNumber(e))}).then(e=>{this.$r=new Pr(e,this.hi)}).then(()=>{this.Ur=!0}).catch(e=>(this.mi&&this.mi.close(),Promise.reject(e)))}Si(e){return this.Ri=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.mi.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.li.enqueueAndForget(async()=>{this.started&&await this.gi()}))}gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Td(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.bi(e).next(n=>{n||(this.isPrimary=!1,this.li.enqueueRetryable(()=>this.Ri(!1)))})}).next(()=>this.Di(e)).next(n=>this.isPrimary&&!n?this.vi(e).next(()=>!1):!!n&&this.Ci(e).next(()=>!0))).catch(e=>{if(bo(e))return Q("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Q("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.li.enqueueRetryable(()=>this.Ri(e)),this.isPrimary=e})}bi(e){return Yc(e).get("owner").next(n=>$.resolve(this.Fi(n)))}Mi(e){return Td(e).delete(this.clientId)}async xi(){if(this.isPrimary&&!this.Oi(this.Ai,18e5)){this.Ai=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Wt(n,"clientMetadata");return r.U().next(i=>{const s=this.Ni(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return $.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.fi)for(const n of e)this.fi.removeItem(this.Li(n.clientId))}}wi(){this.di=this.li.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.gi().then(()=>this.xi()).then(()=>this.wi()))}Fi(e){return!!e&&e.ownerId===this.clientId}Di(e){return this.Pi?$.resolve(!0):Yc(e).get("owner").next(n=>{if(n!==null&&this.Oi(n.leaseTimestampMs,5e3)&&!this.Bi(n.ownerId)){if(this.Fi(n)&&this.networkEnabled)return!0;if(!this.Fi(n)){if(!n.allowTabSynchronization)throw new ne(K.FAILED_PRECONDITION,Hg);return!1}}return!(!this.networkEnabled||!this.inForeground)||Td(e).U().next(r=>this.Ni(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&Q("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Ur=!1,this.ki(),this.di&&(this.di.cancel(),this.di=null),this.qi(),this.Qi(),await this.mi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new pv(e,Pr.oe);return this.vi(n).next(()=>this.Mi(n))}),this.mi.close(),this.Ki()}Ni(e,n){return e.filter(r=>this.Oi(r.updateTimeMs,n)&&!this.Bi(r.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>Td(e).U().next(n=>this.Ni(n,18e5).map(r=>r.clientId)))}get started(){return this.Ur}getGlobalsCache(){return this.Wr}getMutationQueue(e,n){return Op.Pt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new w5(e,this.serializer.ht.databaseId)}getDocumentOverlayCache(e){return Dp.Pt(this.serializer,e)}getBundleCache(){return this.jr}runTransaction(e,n,r){Q("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===17?vV:l===16?mV:l===15?s_:l===14?hC:l===13?uC:l===12?gV:l===11?cC:void le()}(this.Ti);let o;return this.mi.runTransaction(e,i,s,a=>(o=new pv(a,this.$r?this.$r.next():Pr.oe),n==="readwrite-primary"?this.bi(o).next(l=>!!l||this.Di(o)).next(l=>{if(!l)throw bn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.li.enqueueRetryable(()=>this.Ri(!1)),new ne(K.FAILED_PRECONDITION,sC);return r(o)}).next(l=>this.Ci(o).next(()=>l)):this.Ui(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ui(e){return Yc(e).get("owner").next(n=>{if(n!==null&&this.Oi(n.leaseTimestampMs,5e3)&&!this.Bi(n.ownerId)&&!this.Fi(n)&&!(this.Pi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ne(K.FAILED_PRECONDITION,Hg)})}Ci(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Yc(e).put("owner",n)}static p(){return co.p()}vi(e){const n=Yc(e);return n.get("owner").next(r=>this.Fi(r)?(Q("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):$.resolve())}Oi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(bn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}pi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ei=()=>{this.li.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.gi()))},this.document.addEventListener("visibilitychange",this.Ei),this.inForeground=this.document.visibilityState==="visible")}qi(){this.Ei&&(this.document.removeEventListener("visibilitychange",this.Ei),this.Ei=null)}yi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ii=()=>{this.ki();const n=/(?:Version|Mobile)\/1[456]/;ib()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.li.enterRestrictedMode(!0),this.li.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ii))}Qi(){this.Ii&&(this.window.removeEventListener("pagehide",this.Ii),this.Ii=null)}Bi(e){var n;try{const r=((n=this.fi)===null||n===void 0?void 0:n.getItem(this.Li(e)))!==null;return Q("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return bn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}ki(){if(this.fi)try{this.fi.setItem(this.Li(this.clientId),String(Date.now()))}catch(e){bn("Failed to set zombie client id.",e)}}Ki(){if(this.fi)try{this.fi.removeItem(this.Li(this.clientId))}catch{}}Li(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Yc(t){return Wt(t,"owner")}function Td(t){return Wt(t,"clientMetadata")}function V5(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Wi=r,this.Gi=i}static zi(e,n){let r=Pe(),i=Pe();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new E_(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hA{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return ib()?8:aC(Ht())>0?6:4}()}initialize(e,n){this.Zi=e,this.indexManager=n,this.ji=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Xi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.es(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new j5;return this.ts(e,n,o).next(a=>{if(s.result=a,this.Hi)return this.ns(e,n,o,a.size)})}).next(()=>s.result)}ns(e,n,r,i){return r.documentReadCount<this.Ji?(hl()<=De.DEBUG&&Q("QueryEngine","SDK will not create cache indexes for query:",dl(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),$.resolve()):(hl()<=De.DEBUG&&Q("QueryEngine","Query:",dl(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Yi*i?(hl()<=De.DEBUG&&Q("QueryEngine","The SDK decides to create cache indexes for query:",dl(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Dr(n))):$.resolve())}Xi(e,n){if(e1(n))return $.resolve(null);let r=Dr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=wv(n,null,"F"),r=Dr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Pe(...s);return this.Zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.rs(n,a);return this.ss(n,u,o,l.readTime)?this.Xi(e,wv(n,null,"F")):this.os(e,u,n,l)}))})))}es(e,n,r,i){return e1(n)||i.isEqual(ue.min())?$.resolve(null):this.Zi.getDocuments(e,r).next(s=>{const o=this.rs(n,s);return this.ss(n,o,r,i)?$.resolve(null):(hl()<=De.DEBUG&&Q("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),dl(n)),this.os(e,o,n,KM(i,-1)).next(a=>a))})}rs(e,n){let r=new Ye(bC(e));return n.forEach((i,s)=>{_h(e,s)&&(r=r.add(s))}),r}ss(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ts(e,n,r){return hl()<=De.DEBUG&&Q("QueryEngine","Using full collection scan to execute query:",dl(n)),this.Zi.getDocumentsMatchingQuery(e,n,lr.min(),r)}os(e,n,r,i){return this.Zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F5{constructor(e,n,r,i){this.persistence=e,this._s=n,this.serializer=i,this.us=new mt(we),this.cs=new ls(s=>Ta(s),vh),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(r)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new uA(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.us))}}function dA(t,e,n,r){return new F5(t,e,n,r)}async function fA(t,e){const n=ve(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Ps(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Pe();for(const u of i){o.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}for(const u of s){a.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ts:u,removedBatchIds:o,addedBatchIds:a}))})})}function U5(t,e){const n=ve(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.hs.newChangeBuffer({trackRemovals:!0});return function(a,l,u,d){const p=u.batch,m=p.keys();let w=$.resolve();return m.forEach(E=>{w=w.next(()=>d.getEntry(l,E)).next(x=>{const D=u.docVersions.get(E);ce(D!==null),x.version.compareTo(D)<0&&(p.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),d.addEntry(x)))})}),w.next(()=>a.mutationQueue.removeMutationBatch(l,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Pe();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function pA(t){const e=ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Gr.getLastRemoteSnapshotVersion(n))}function $5(t,e){const n=ve(t),r=e.snapshotVersion;let i=n.us;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.hs.newChangeBuffer({trackRemovals:!0});i=n.us;const a=[];e.targetChanges.forEach((d,p)=>{const m=i.get(p);if(!m)return;a.push(n.Gr.removeMatchingKeys(s,d.removedDocuments,p).next(()=>n.Gr.addMatchingKeys(s,d.addedDocuments,p)));let w=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?w=w.withResumeToken(Vt.EMPTY_BYTE_STRING,ue.min()).withLastLimboFreeSnapshotVersion(ue.min()):d.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(d.resumeToken,r)),i=i.insert(p,w),function(x,D,A){return x.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(m,w,d)&&a.push(n.Gr.updateTargetData(s,w))});let l=rr(),u=Pe();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(z5(s,o,e.documentUpdates).next(d=>{l=d.Is,u=d.Es})),!r.isEqual(ue.min())){const d=n.Gr.getLastRemoteSnapshotVersion(s).next(p=>n.Gr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return $.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.us=i,s))}function z5(t,e,n){let r=Pe(),i=Pe();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=rr();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(ue.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Q("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Is:o,Es:i}})}function B5(t,e){const n=ve(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function q5(t,e){const n=ve(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Gr.getTargetData(r,e).next(s=>s?(i=s,$.resolve(i)):n.Gr.allocateTargetId(r).next(o=>(i=new Wi(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Gr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.us.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.us=n.us.insert(r.targetId,r),n.cs.set(e,r.targetId)),r})}async function xv(t,e,n){const r=ve(t),i=r.us.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!bo(o))throw o;Q("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.us=r.us.remove(e),r.cs.delete(i.target)}function x1(t,e,n){const r=ve(t);let i=ue.min(),s=Pe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,d){const p=ve(l),m=p.cs.get(d);return m!==void 0?$.resolve(p.us.get(m)):p.Gr.getTargetData(u,d)}(r,o,Dr(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Gr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r._s.getDocumentsMatchingQuery(o,e,n?i:ue.min(),n?s:Pe())).next(a=>(H5(r,OV(e),a),{documents:a,ds:s})))}function H5(t,e,n){let r=t.ls.get(e)||ue.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ls.set(e,r)}class P1{constructor(){this.activeTargetIds=FV()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gA{constructor(){this._o=new P1,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,n,r){this.ao[e]=n}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new P1,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W5{uo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){Q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.To)e(0)}Po(){Q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Id=null;function Wg(){return Id===null?Id=function(){return 268435456+Math.round(2147483648*Math.random())}():Id++,"0x"+Id.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G5{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dn="WebChannelConnection";class Q5 extends class{get Co(){return!1}constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Fo=r+"://"+n.host,this.Mo=`projects/${i}/databases/${s}`,this.xo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Oo(n,r,i,s,o){const a=Wg(),l=this.No(n,r.toUriEncodedString());Q("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);const u={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Lo(u,s,o),this.Bo(n,l,u,i).then(d=>(Q("RestConnection",`Received RPC '${n}' ${a}: `,d),d),d=>{throw Ql("RestConnection",`RPC '${n}' ${a} failed with error: `,d,"url: ",l,"request:",i),d})}ko(n,r,i,s,o,a){return this.Oo(n,r,i,s,o)}Lo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+fc}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}No(n,r){const i=K5[n];return`${this.Fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Bo(e,n,r,i){const s=Wg();return new Promise((o,a)=>{const l=new Xb;l.setWithCredentials(!0),l.listenOnce(Jb.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case qd.NO_ERROR:const d=l.getResponseJson();Q(dn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case qd.TIMEOUT:Q(dn,`RPC '${e}' ${s} timed out`),a(new ne(K.DEADLINE_EXCEEDED,"Request time out"));break;case qd.HTTP_ERROR:const p=l.getStatus();if(Q(dn,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const w=m==null?void 0:m.error;if(w&&w.status&&w.message){const E=function(D){const A=D.toLowerCase().replace(/_/g,"-");return Object.values(K).indexOf(A)>=0?A:K.UNKNOWN}(w.status);a(new ne(E,w.message))}else a(new ne(K.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new ne(K.UNAVAILABLE,"Connection failed."));break;default:le()}}finally{Q(dn,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);Q(dn,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",u,r,15)})}qo(e,n,r){const i=Wg(),s=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=tC(),a=eC(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Lo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=s.join("");Q(dn,`Creating RPC '${e}' stream ${i}: ${d}`,l);const p=o.createWebChannel(d,l);let m=!1,w=!1;const E=new G5({Eo:D=>{w?Q(dn,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(m||(Q(dn,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),Q(dn,`RPC '${e}' stream ${i} sending:`,D),p.send(D))},Ao:()=>p.close()}),x=(D,A,T)=>{D.listen(A,S=>{try{T(S)}catch(M){setTimeout(()=>{throw M},0)}})};return x(p,su.EventType.OPEN,()=>{w||(Q(dn,`RPC '${e}' stream ${i} transport opened.`),E.So())}),x(p,su.EventType.CLOSE,()=>{w||(w=!0,Q(dn,`RPC '${e}' stream ${i} transport closed`),E.Do())}),x(p,su.EventType.ERROR,D=>{w||(w=!0,Ql(dn,`RPC '${e}' stream ${i} transport errored:`,D),E.Do(new ne(K.UNAVAILABLE,"The operation could not be completed")))}),x(p,su.EventType.MESSAGE,D=>{var A;if(!w){const T=D.data[0];ce(!!T);const S=T,M=(S==null?void 0:S.error)||((A=S[0])===null||A===void 0?void 0:A.error);if(M){Q(dn,`RPC '${e}' stream ${i} received error:`,M);const q=M.status;let W=function(R){const O=Nt[R];if(O!==void 0)return jC(O)}(q),P=M.message;W===void 0&&(W=K.INTERNAL,P="Unknown error status: "+q+" with message "+M.message),w=!0,E.Do(new ne(W,P)),p.close()}else Q(dn,`RPC '${e}' stream ${i} received:`,T),E.vo(T)}}),x(a,Zb.STAT_EVENT,D=>{D.stat===dv.PROXY?Q(dn,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===dv.NOPROXY&&Q(dn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.bo()},0),E}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y5(){return typeof window<"u"?window:null}function Jd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lp(t){return new t5(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(e,n,r=1e3,i=1.5,s=6e4){this.li=e,this.timerId=n,this.Qo=r,this.Ko=i,this.$o=s,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();const n=Math.floor(this.Uo+this.Ho()),r=Math.max(0,Date.now()-this.Go),i=Math.max(0,n-r);i>0&&Q("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Uo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,i,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(e,n,r,i,s,o,a,l){this.li=e,this.Yo=r,this.Zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new mA(e,n)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}async stop(){this.i_()&&await this.close(0)}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}async u_(){if(this.s_())return this.close(0)}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}async close(e,n){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():n&&n.code===K.RESOURCE_EXHAUSTED?(bn(n.toString()),bn("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):n&&n.code===K.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.po(n)}P_(){}auth(){this.state=1;const e=this.T_(this.Xo),n=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Xo===n&&this.I_(r,i)},r=>{e(()=>{const i=new ne(K.UNKNOWN,"Fetching auth token failed: "+r.message);return this.E_(i)})})}I_(e,n){const r=this.T_(this.Xo);this.stream=this.d_(e,n),this.stream.Ro(()=>{r(()=>this.listener.Ro())}),this.stream.mo(()=>{r(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(i=>{r(()=>this.E_(i))}),this.stream.onMessage(i=>{r(()=>++this.n_==1?this.A_(i):this.onNext(i))})}o_(){this.state=5,this.r_.jo(async()=>{this.state=0,this.start()})}E_(e){return Q("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return n=>{this.li.enqueueAndForget(()=>this.Xo===e?n():(Q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class X5 extends vA{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}d_(e,n){return this.connection.qo("Listen",e,n)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();const n=i5(this.serializer,e),r=function(s){if(!("targetChange"in s))return ue.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ue.min():o.readTime?Pn(o.readTime):ue.min()}(e);return this.listener.R_(n,r)}V_(e){const n={};n.database=Iv(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Ff(l)?{documents:WC(s,l)}:{query:KC(s,l).ct},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=$C(s,o.resumeToken);const u=Ev(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ue.min())>0){a.readTime=rc(s,o.snapshotVersion.toTimestamp());const u=Ev(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=o5(this.serializer,e);r&&(n.labels=r),this.c_(n)}m_(e){const n={};n.database=Iv(this.serializer),n.removeTarget=e,this.c_(n)}}class J5 extends vA{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}d_(e,n){return this.connection.qo("Write",e,n)}A_(e){return ce(!!e.streamToken),this.lastStreamToken=e.streamToken,ce(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){ce(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();const n=s5(e.writeResults,e.commitTime),r=Pn(e.commitTime);return this.listener.y_(r,n)}w_(){const e={};e.database=Iv(this.serializer),this.c_(e)}g_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>zf(this.serializer,r))};this.c_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z5 extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.S_=!1}b_(){if(this.S_)throw new ne(K.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,n,r,i){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Oo(e,Tv(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ne(K.UNKNOWN,s.toString())})}ko(e,n,r,i,s){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.ko(e,Tv(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ne(K.UNKNOWN,o.toString())})}terminate(){this.S_=!0,this.connection.terminate()}}class e3{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(bn(n),this.C_=!1):Q("OnlineStateTracker",n)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t3{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.L_=[],this.B_=new Map,this.k_=new Set,this.q_=[],this.Q_=s,this.Q_.uo(o=>{r.enqueueAndForget(async()=>{Ma(this)&&(Q("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=ve(l);u.k_.add(4),await Eh(u),u.K_.set("Unknown"),u.k_.delete(4),await Mp(u)}(this))})}),this.K_=new e3(r,i)}}async function Mp(t){if(Ma(t))for(const e of t.q_)await e(!0)}async function Eh(t){for(const e of t.q_)await e(!1)}function yA(t,e){const n=ve(t);n.B_.has(e.targetId)||(n.B_.set(e.targetId,e),b_(n)?S_(n):gc(n).s_()&&I_(n,e))}function T_(t,e){const n=ve(t),r=gc(n);n.B_.delete(e),r.s_()&&_A(n,e),n.B_.size===0&&(r.s_()?r.a_():Ma(n)&&n.K_.set("Unknown"))}function I_(t,e){if(t.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}gc(t).V_(e)}function _A(t,e){t.U_.xe(e),gc(t).m_(e)}function S_(t){t.U_=new XV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>t.B_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),gc(t).start(),t.K_.F_()}function b_(t){return Ma(t)&&!gc(t).i_()&&t.B_.size>0}function Ma(t){return ve(t).k_.size===0}function wA(t){t.U_=void 0}async function n3(t){t.K_.set("Online")}async function r3(t){t.B_.forEach((e,n)=>{I_(t,e)})}async function i3(t,e){wA(t),b_(t)?(t.K_.O_(e),S_(t)):t.K_.set("Unknown")}async function s3(t,e,n){if(t.K_.set("Online"),e instanceof UC&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.B_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.B_.delete(a),i.U_.removeTarget(a))}(t,e)}catch(r){Q("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Kf(t,r)}else if(e instanceof Xd?t.U_.$e(e):e instanceof FC?t.U_.Je(e):t.U_.Ge(e),!n.isEqual(ue.min()))try{const r=await pA(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.U_.it(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.B_.get(u);d&&s.B_.set(u,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const d=s.B_.get(l);if(!d)return;s.B_.set(l,d.withResumeToken(Vt.EMPTY_BYTE_STRING,d.snapshotVersion)),_A(s,l);const p=new Wi(d.target,l,u,d.sequenceNumber);I_(s,p)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){Q("RemoteStore","Failed to raise snapshot:",r),await Kf(t,r)}}async function Kf(t,e,n){if(!bo(e))throw e;t.k_.add(1),await Eh(t),t.K_.set("Offline"),n||(n=()=>pA(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Q("RemoteStore","Retrying IndexedDB access"),await n(),t.k_.delete(1),await Mp(t)})}function EA(t,e){return e().catch(n=>Kf(t,n,e))}async function Th(t){const e=ve(t),n=vo(e);let r=e.L_.length>0?e.L_[e.L_.length-1].batchId:-1;for(;o3(e);)try{const i=await B5(e.localStore,r);if(i===null){e.L_.length===0&&n.a_();break}r=i.batchId,a3(e,i)}catch(i){await Kf(e,i)}TA(e)&&IA(e)}function o3(t){return Ma(t)&&t.L_.length<10}function a3(t,e){t.L_.push(e);const n=vo(t);n.s_()&&n.f_&&n.g_(e.mutations)}function TA(t){return Ma(t)&&!vo(t).i_()&&t.L_.length>0}function IA(t){vo(t).start()}async function l3(t){vo(t).w_()}async function c3(t){const e=vo(t);for(const n of t.L_)e.g_(n.mutations)}async function u3(t,e,n){const r=t.L_.shift(),i=d_.from(r,e,n);await EA(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Th(t)}async function h3(t,e){e&&vo(t).f_&&await async function(r,i){if(function(o){return GV(o)&&o!==K.ABORTED}(i.code)){const s=r.L_.shift();vo(r).__(),await EA(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Th(r)}}(t,e),TA(t)&&IA(t)}async function R1(t,e){const n=ve(t);n.asyncQueue.verifyOperationInProgress(),Q("RemoteStore","RemoteStore received new credentials");const r=Ma(n);n.k_.add(3),await Eh(n),r&&n.K_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.k_.delete(3),await Mp(n)}async function d3(t,e){const n=ve(t);e?(n.k_.delete(2),await Mp(n)):e||(n.k_.add(2),await Eh(n),n.K_.set("Unknown"))}function gc(t){return t.W_||(t.W_=function(n,r,i){const s=ve(n);return s.b_(),new X5(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Ro:n3.bind(null,t),mo:r3.bind(null,t),po:i3.bind(null,t),R_:s3.bind(null,t)}),t.q_.push(async e=>{e?(t.W_.__(),b_(t)?S_(t):t.K_.set("Unknown")):(await t.W_.stop(),wA(t))})),t.W_}function vo(t){return t.G_||(t.G_=function(n,r,i){const s=ve(n);return s.b_(),new J5(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Ro:()=>Promise.resolve(),mo:l3.bind(null,t),po:h3.bind(null,t),p_:c3.bind(null,t),y_:u3.bind(null,t)}),t.q_.push(async e=>{e?(t.G_.__(),await Th(t)):(await t.G_.stop(),t.L_.length>0&&(Q("RemoteStore",`Stopping write stream with ${t.L_.length} pending writes`),t.L_=[]))})),t.G_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Qi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new C_(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ne(K.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function A_(t,e){if(bn("AsyncQueue",`${e}: ${t}`),bo(t))return new ne(K.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{static emptySet(e){return new jl(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||te.comparator(n.key,r.key):(n,r)=>te.comparator(n.key,r.key),this.keyedMap=ou(),this.sortedSet=new mt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof jl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new jl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(){this.z_=new mt(te.comparator)}track(e){const n=e.doc.key,r=this.z_.get(n);r?e.type!==0&&r.type===3?this.z_=this.z_.insert(n,e):e.type===3&&r.type!==1?this.z_=this.z_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.z_=this.z_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.z_=this.z_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.z_=this.z_.remove(n):e.type===1&&r.type===2?this.z_=this.z_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.z_=this.z_.insert(n,{type:2,doc:e.doc}):le():this.z_=this.z_.insert(n,e)}j_(){const e=[];return this.z_.inorderTraversal((n,r)=>{e.push(r)}),e}}class ic{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new ic(e,n,jl.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f3{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}}class p3{constructor(){this.queries=O1(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(n,r){const i=ve(n),s=i.queries;i.queries=O1(),s.forEach((o,a)=>{for(const l of a.J_)l.onError(r)})})(this,new ne(K.ABORTED,"Firestore shutting down"))}}function O1(){return new ls(t=>SC(t),xp)}async function SA(t,e){const n=ve(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.Y_()&&e.Z_()&&(r=2):(s=new f3,r=e.Z_()?0:1);try{switch(r){case 0:s.H_=await n.onListen(i,!0);break;case 1:s.H_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=A_(o,`Initialization of query '${dl(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.J_.push(e),e.ea(n.onlineState),s.H_&&e.ta(s.H_)&&x_(n)}async function bA(t,e){const n=ve(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.J_.indexOf(e);o>=0&&(s.J_.splice(o,1),s.J_.length===0?i=e.Z_()?0:1:!s.Y_()&&e.Z_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function g3(t,e){const n=ve(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.J_)a.ta(i)&&(r=!0);o.H_=i}}r&&x_(n)}function m3(t,e,n){const r=ve(t),i=r.queries.get(e);if(i)for(const s of i.J_)s.onError(n);r.queries.delete(e)}function x_(t){t.X_.forEach(e=>{e.next()})}var Pv,N1;(N1=Pv||(Pv={})).na="default",N1.Cache="cache";class CA{constructor(e,n,r){this.query=e,this.ra=n,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=r||{}}ta(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new ic(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.ia?this.oa(e)&&(this.ra.next(e),n=!0):this._a(e,this.onlineState)&&(this.aa(e),n=!0),this.sa=e,n}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let n=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),n=!0),n}_a(e,n){if(!e.fromCache||!this.Z_())return!0;const r=n!=="Offline";return(!this.options.ua||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}oa(e){if(e.docChanges.length>0)return!0;const n=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}aa(e){e=ic.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==Pv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(e){this.key=e}}class xA{constructor(e){this.key=e}}class v3{constructor(e,n){this.query=e,this.da=n,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=Pe(),this.mutatedKeys=Pe(),this.Va=bC(e),this.ma=new jl(this.Va)}get fa(){return this.da}ga(e,n){const r=n?n.pa:new D1,i=n?n.ma:this.ma;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,p)=>{const m=i.get(d),w=_h(this.query,p)?p:null,E=!!m&&this.mutatedKeys.has(m.key),x=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let D=!1;m&&w?m.data.isEqual(w.data)?E!==x&&(r.track({type:3,doc:w}),D=!0):this.ya(m,w)||(r.track({type:2,doc:w}),D=!0,(l&&this.Va(w,l)>0||u&&this.Va(w,u)<0)&&(a=!0)):!m&&w?(r.track({type:0,doc:w}),D=!0):m&&!w&&(r.track({type:1,doc:m}),D=!0,(l||u)&&(a=!0)),D&&(w?(o=o.add(w),s=x?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{ma:o,pa:r,ss:a,mutatedKeys:s}}ya(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;const o=e.pa.j_();o.sort((d,p)=>function(w,E){const x=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return le()}};return x(w)-x(E)}(d.type,p.type)||this.Va(d.doc,p.doc)),this.wa(r),i=i!=null&&i;const a=n&&!i?this.Sa():[],l=this.Ra.size===0&&this.current&&!i?1:0,u=l!==this.Aa;return this.Aa=l,o.length!==0||u?{snapshot:new ic(this.query,e.ma,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),ba:a}:{ba:a}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new D1,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.da.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(n=>this.da=this.da.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.da=this.da.delete(n)),this.current=e.current)}Sa(){if(!this.current)return[];const e=this.Ra;this.Ra=Pe(),this.ma.forEach(r=>{this.Da(r.key)&&(this.Ra=this.Ra.add(r.key))});const n=[];return e.forEach(r=>{this.Ra.has(r)||n.push(new xA(r))}),this.Ra.forEach(r=>{e.has(r)||n.push(new AA(r))}),n}va(e){this.da=e.ds,this.Ra=Pe();const n=this.ga(e.documents);return this.applyChanges(n,!0)}Ca(){return ic.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}}class y3{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class _3{constructor(e){this.key=e,this.Fa=!1}}class w3{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ma={},this.xa=new ls(a=>SC(a),xp),this.Oa=new Map,this.Na=new Set,this.La=new mt(te.comparator),this.Ba=new Map,this.ka=new y_,this.qa={},this.Qa=new Map,this.Ka=ba.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}}async function E3(t,e,n=!0){const r=NA(t);let i;const s=r.xa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Ca()):i=await PA(r,e,n,!0),i}async function T3(t,e){const n=NA(t);await PA(n,e,!0,!1)}async function PA(t,e,n,r){const i=await q5(t.localStore,Dr(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await I3(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&yA(t.remoteStore,i),a}async function I3(t,e,n,r,i){t.Ua=(p,m,w)=>async function(x,D,A,T){let S=D.view.ga(A);S.ss&&(S=await x1(x.localStore,D.query,!1).then(({documents:P})=>D.view.ga(P,S)));const M=T&&T.targetChanges.get(D.targetId),q=T&&T.targetMismatches.get(D.targetId)!=null,W=D.view.applyChanges(S,x.isPrimaryClient,M,q);return M1(x,D.targetId,W.ba),W.snapshot}(t,p,m,w);const s=await x1(t.localStore,e,!0),o=new v3(e,s.ds),a=o.ga(s.documents),l=wh.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);M1(t,n,u.ba);const d=new y3(e,n,o);return t.xa.set(e,d),t.Oa.has(n)?t.Oa.get(n).push(e):t.Oa.set(n,[e]),u.snapshot}async function S3(t,e,n){const r=ve(t),i=r.xa.get(e),s=r.Oa.get(i.targetId);if(s.length>1)return r.Oa.set(i.targetId,s.filter(o=>!xp(o,e))),void r.xa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await xv(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&T_(r.remoteStore,i.targetId),kv(r,i.targetId)}).catch(La)):(kv(r,i.targetId),await xv(r.localStore,i.targetId,!0))}async function b3(t,e){const n=ve(t),r=n.xa.get(e),i=n.Oa.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),T_(n.remoteStore,r.targetId))}async function C3(t,e,n){const r=LA(t);try{const i=await function(o,a){const l=ve(o),u=Et.now(),d=a.reduce((w,E)=>w.add(E.key),Pe());let p,m;return l.persistence.runTransaction("Locally write mutations","readwrite",w=>{let E=rr(),x=Pe();return l.hs.getEntries(w,d).next(D=>{E=D,E.forEach((A,T)=>{T.isValidDocument()||(x=x.add(A))})}).next(()=>l.localDocuments.getOverlayedDocuments(w,E)).next(D=>{p=D;const A=[];for(const T of a){const S=WV(T,p.get(T.key).overlayedDocument);S!=null&&A.push(new cs(T.key,S,mC(S.value.mapValue),An.exists(!0)))}return l.mutationQueue.addMutationBatch(w,u,A,a)}).next(D=>{m=D;const A=D.applyToLocalDocumentSet(p,x);return l.documentOverlayCache.saveOverlays(w,D.batchId,A)})}).then(()=>({batchId:m.batchId,changes:AC(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.qa[o.currentUser.toKey()];u||(u=new mt(we)),u=u.insert(a,l),o.qa[o.currentUser.toKey()]=u}(r,i.batchId,n),await Ih(r,i.changes),await Th(r.remoteStore)}catch(i){const s=A_(i,"Failed to persist write");n.reject(s)}}async function kA(t,e){const n=ve(t);try{const r=await $5(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Ba.get(s);o&&(ce(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Fa=!0:i.modifiedDocuments.size>0?ce(o.Fa):i.removedDocuments.size>0&&(ce(o.Fa),o.Fa=!1))}),await Ih(n,r,e)}catch(r){await La(r)}}function L1(t,e,n){const r=ve(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.xa.forEach((s,o)=>{const a=o.view.ea(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=ve(o);l.onlineState=a;let u=!1;l.queries.forEach((d,p)=>{for(const m of p.J_)m.ea(a)&&(u=!0)}),u&&x_(l)}(r.eventManager,e),i.length&&r.Ma.R_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function A3(t,e,n){const r=ve(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Ba.get(e),s=i&&i.key;if(s){let o=new mt(te.comparator);o=o.insert(s,Ct.newNoDocument(s,ue.min()));const a=Pe().add(s),l=new Rp(ue.min(),new Map,new mt(we),o,a);await kA(r,l),r.La=r.La.remove(s),r.Ba.delete(e),P_(r)}else await xv(r.localStore,e,!1).then(()=>kv(r,e,n)).catch(La)}async function x3(t,e){const n=ve(t),r=e.batch.batchId;try{const i=await U5(n.localStore,e);DA(n,r,null),RA(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ih(n,i)}catch(i){await La(i)}}async function P3(t,e,n){const r=ve(t);try{const i=await function(o,a){const l=ve(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.mutationQueue.lookupMutationBatch(u,a).next(p=>(ce(p!==null),d=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>l.localDocuments.getDocuments(u,d))})}(r.localStore,e);DA(r,e,n),RA(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ih(r,i)}catch(i){await La(i)}}function RA(t,e){(t.Qa.get(e)||[]).forEach(n=>{n.resolve()}),t.Qa.delete(e)}function DA(t,e,n){const r=ve(t);let i=r.qa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.qa[r.currentUser.toKey()]=i}}function kv(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Oa.get(e))t.xa.delete(r),n&&t.Ma.Wa(r,n);t.Oa.delete(e),t.isPrimaryClient&&t.ka.yr(e).forEach(r=>{t.ka.containsKey(r)||OA(t,r)})}function OA(t,e){t.Na.delete(e.path.canonicalString());const n=t.La.get(e);n!==null&&(T_(t.remoteStore,n),t.La=t.La.remove(e),t.Ba.delete(n),P_(t))}function M1(t,e,n){for(const r of n)r instanceof AA?(t.ka.addReference(r.key,e),k3(t,r)):r instanceof xA?(Q("SyncEngine","Document no longer in limbo: "+r.key),t.ka.removeReference(r.key,e),t.ka.containsKey(r.key)||OA(t,r.key)):le()}function k3(t,e){const n=e.key,r=n.path.canonicalString();t.La.get(n)||t.Na.has(r)||(Q("SyncEngine","New document in limbo: "+n),t.Na.add(r),P_(t))}function P_(t){for(;t.Na.size>0&&t.La.size<t.maxConcurrentLimboResolutions;){const e=t.Na.values().next().value;t.Na.delete(e);const n=new te(Ge.fromString(e)),r=t.Ka.next();t.Ba.set(r,new _3(n)),t.La=t.La.insert(n,r),yA(t.remoteStore,new Wi(Dr(yh(n.path)),r,"TargetPurposeLimboResolution",Pr.oe))}}async function Ih(t,e,n){const r=ve(t),i=[],s=[],o=[];r.xa.isEmpty()||(r.xa.forEach((a,l)=>{o.push(r.Ua(l,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const p=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){i.push(u);const p=E_.zi(l.targetId,u);s.push(p)}}))}),await Promise.all(o),r.Ma.R_(i),await async function(l,u){const d=ve(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>$.forEach(u,m=>$.forEach(m.Wi,w=>d.persistence.referenceDelegate.addReference(p,m.targetId,w)).next(()=>$.forEach(m.Gi,w=>d.persistence.referenceDelegate.removeReference(p,m.targetId,w)))))}catch(p){if(!bo(p))throw p;Q("LocalStore","Failed to update sequence numbers: "+p)}for(const p of u){const m=p.targetId;if(!p.fromCache){const w=d.us.get(m),E=w.snapshotVersion,x=w.withLastLimboFreeSnapshotVersion(E);d.us=d.us.insert(m,x)}}}(r.localStore,s))}async function R3(t,e){const n=ve(t);if(!n.currentUser.isEqual(e)){Q("SyncEngine","User change. New user:",e.toKey());const r=await fA(n.localStore,e);n.currentUser=e,function(s,o){s.Qa.forEach(a=>{a.forEach(l=>{l.reject(new ne(K.CANCELLED,o))})}),s.Qa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ih(n,r.Ts)}}function D3(t,e){const n=ve(t),r=n.Ba.get(e);if(r&&r.Fa)return Pe().add(r.key);{let i=Pe();const s=n.Oa.get(e);if(!s)return i;for(const o of s){const a=n.xa.get(o);i=i.unionWith(a.view.fa)}return i}}function NA(t){const e=ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=kA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=D3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=A3.bind(null,e),e.Ma.R_=g3.bind(null,e.eventManager),e.Ma.Wa=m3.bind(null,e.eventManager),e}function LA(t){const e=ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=x3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=P3.bind(null,e),e}class ih{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Lp(e.databaseInfo.databaseId),this.sharedClientState=this.za(e),this.persistence=this.ja(e),await this.persistence.start(),this.localStore=this.Ha(e),this.gcScheduler=this.Ja(e,this.localStore),this.indexBackfillerScheduler=this.Ya(e,this.localStore)}Ja(e,n){return null}Ya(e,n){return null}Ha(e){return dA(this.persistence,new hA,e.initialUser,this.serializer)}ja(e){return new __(Np.ei,this.serializer)}za(e){return new gA}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ih.provider={build:()=>new ih};class O3 extends ih{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,n){ce(this.persistence.referenceDelegate instanceof Wf);const r=this.persistence.referenceDelegate.garbageCollector;return new oA(r,e.asyncQueue,n)}ja(e){const n=this.cacheSizeBytes!==void 0?pn.withCacheSize(this.cacheSizeBytes):pn.DEFAULT;return new __(r=>Wf.ei(r,n),this.serializer)}}class N3 extends ih{constructor(e,n,r){super(),this.Za=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Za.initialize(this,e),await LA(this.Za.syncEngine),await Th(this.Za.remoteStore),await this.persistence.Si(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Ha(e){return dA(this.persistence,new hA,e.initialUser,this.serializer)}Ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new oA(r,e.asyncQueue,n)}Ya(e,n){const r=new XM(n,this.persistence);return new YM(e.asyncQueue,r)}ja(e){const n=V5(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?pn.withCacheSize(this.cacheSizeBytes):pn.DEFAULT;return new w_(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Y5(),Jd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}za(e){return new gA}}class Gf{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>L1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=R3.bind(null,this.syncEngine),await d3(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new p3}()}createDatastore(e){const n=Lp(e.databaseInfo.databaseId),r=function(s){return new Q5(s)}(e.databaseInfo);return function(s,o,a,l){return new Z5(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new t3(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>L1(this.syncEngine,n,0),function(){return k1.p()?new k1:new W5}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,d){const p=new w3(i,s,o,a,l,u);return d&&(p.$a=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=ve(i);Q("RemoteStore","RemoteStore shutting down."),s.k_.add(5),await Eh(s),s.Q_.shutdown(),s.K_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Gf.provider={build:()=>new Gf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):bn("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Sn.UNAUTHENTICATED,this.clientId=nC.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{Q("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Q("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Qi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=A_(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Kg(t,e){t.asyncQueue.verifyOperationInProgress(),Q("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await fA(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function V1(t,e){t.asyncQueue.verifyOperationInProgress();const n=await M3(t);Q("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>R1(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>R1(e.remoteStore,i)),t._onlineComponents=e}async function M3(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Q("FirestoreClient","Using user provided OfflineComponentProvider");try{await Kg(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===K.FAILED_PRECONDITION||i.code===K.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Ql("Error using user provided cache. Falling back to memory cache: "+n),await Kg(t,new ih)}}else Q("FirestoreClient","Using default OfflineComponentProvider"),await Kg(t,new O3(void 0));return t._offlineComponents}async function VA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Q("FirestoreClient","Using user provided OnlineComponentProvider"),await V1(t,t._uninitializedComponentsProvider._online)):(Q("FirestoreClient","Using default OnlineComponentProvider"),await V1(t,new Gf))),t._onlineComponents}function V3(t){return VA(t).then(e=>e.syncEngine)}async function Rv(t){const e=await VA(t),n=e.eventManager;return n.onListen=E3.bind(null,e.syncEngine),n.onUnlisten=S3.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=T3.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=b3.bind(null,e.syncEngine),n}function j3(t,e,n={}){const r=new Qi;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const d=new MA({next:m=>{d.eu(),o.enqueueAndForget(()=>bA(s,p));const w=m.docs.has(a);!w&&m.fromCache?u.reject(new ne(K.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&m.fromCache&&l&&l.source==="server"?u.reject(new ne(K.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),p=new CA(yh(a.path),d,{includeMetadataChanges:!0,ua:!0});return SA(s,p)}(await Rv(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FA(t,e,n){if(!n)throw new ne(K.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function F3(t,e,n,r){if(e===!0&&r===!0)throw new ne(K.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function F1(t){if(!te.isDocumentKey(t))throw new ne(K.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function U1(t){if(te.isDocumentKey(t))throw new ne(K.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function k_(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":le()}function Zr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ne(K.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=k_(t);throw new ne(K.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ne(K.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ne(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}F3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jA((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ne(K.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ne(K.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ne(K.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class R_{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new $1({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ne(K.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ne(K.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new $1(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new FM;switch(r.type){case"firstParty":return new zM(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ne(K.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=j1.get(n);r&&(Q("ComponentProvider","Removing Datastore"),j1.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Vp(this.firestore,e,this._query)}}class kn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new uo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new kn(this.firestore,e,this._key)}}class uo extends Vp{constructor(e,n,r){super(e,n,yh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new kn(this.firestore,null,new te(e))}withConverter(e){return new uo(this.firestore,e,this._path)}}function U3(t,e,...n){if(t=Mt(t),FA("collection","path",e),t instanceof R_){const r=Ge.fromString(e,...n);return U1(r),new uo(t,null,r)}{if(!(t instanceof kn||t instanceof uo))throw new ne(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ge.fromString(e,...n));return U1(r),new uo(t.firestore,null,r)}}function dt(t,e,...n){if(t=Mt(t),arguments.length===1&&(e=nC.newId()),FA("doc","path",e),t instanceof R_){const r=Ge.fromString(e,...n);return F1(r),new kn(t,null,new te(r))}{if(!(t instanceof kn||t instanceof uo))throw new ne(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ge.fromString(e,...n));return F1(r),new kn(t.firestore,t instanceof uo?t.converter:null,new te(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(e=Promise.resolve()){this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new mA(this,"async_queue_retry"),this.fu=()=>{const r=Jd();r&&Q("AsyncQueue","Visibility state changed to "+r.visibilityState),this.r_.Jo()},this.gu=e;const n=Jd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.Eu){this.Eu=!0,this.Vu=e||!1;const n=Jd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.Eu)return new Promise(()=>{});const n=new Qi;return this.yu(()=>this.Eu&&this.Vu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}async wu(){if(this.Iu.length!==0){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!bo(e))throw e;Q("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}}yu(e){const n=this.gu.then(()=>(this.Ru=!0,e().catch(r=>{this.Au=r,this.Ru=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw bn("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Ru=!1,r))));return this.gu=n,n}enqueueAfterDelay(e,n,r){this.pu(),this.mu.indexOf(e)>-1&&(n=0);const i=C_.createAndSchedule(this,e,n,r,s=>this.Su(s));return this.du.push(i),i}pu(){this.Au&&le()}verifyOperationInProgress(){}async bu(){let e;do e=this.gu,await e;while(e!==this.gu)}Du(e){for(const n of this.du)if(n.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.du.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.du)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){const n=this.du.indexOf(e);this.du.splice(n,1)}}function B1(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class yo extends R_{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new z1,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new z1(e),this._firestoreClient=void 0,await e}}}function $3(t,e,n){n||(n="(default)");const r=Na(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),s=r.getOptions(n);if(Kl(s,e))return i;throw new ne(K.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ne(K.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ne(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function D_(t){if(t._terminated)throw new ne(K.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||UA(t),t._firestoreClient}function UA(t){var e,n,r;const i=t._freezeSettings(),s=function(a,l,u,d){return new _V(a,l,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,jA(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new L3(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function z3(t,e){Ql("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return B3(t,Gf.provider,{build:r=>new N3(r,n.cacheSizeBytes,void 0)}),Promise.resolve()}function B3(t,e,n){if((t=Zr(t,yo))._firestoreClient||t._terminated)throw new ne(K.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new ne(K.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},UA(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new sc(Vt.fromBase64String(e))}catch(n){throw new ne(K.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new sc(Vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ne(K.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _t(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ne(K.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ne(K.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return we(this._lat,e._lat)||we(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q3=/^__.*__$/;class H3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new cs(e,this.data,this.fieldMask,n,this.fieldTransforms):new pc(e,this.data,n,this.fieldTransforms)}}class W3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new cs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function $A(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw le()}}class L_{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Fu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new L_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.xu({path:r,Nu:!1});return i.Lu(e),i}Bu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.xu({path:r,Nu:!1});return i.Fu(),i}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return Qf(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lu(this.path.get(e))}Lu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if($A(this.Mu)&&q3.test(e))throw this.qu('Document fields cannot begin and end with "__"')}}class K3{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Lp(e)}$u(e,n,r,i=!1){return new L_({Mu:e,methodName:n,Ku:r,path:_t.emptyPath(),Nu:!1,Qu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function M_(t){const e=t._freezeSettings(),n=Lp(t._databaseId);return new K3(t._databaseId,!!e.ignoreUndefinedProperties,n)}function zA(t,e,n,r,i,s={}){const o=t.$u(s.merge||s.mergeFields?2:0,e,n,i);U_("Data must be an object, but it was:",o,r);const a=BA(r,o);let l,u;if(s.merge)l=new nr(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const p of s.mergeFields){const m=HA(e,p,n);if(!o.contains(m))throw new ne(K.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);X3(d,m)||d.push(m)}l=new nr(d),u=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=o.fieldTransforms;return new H3(new Cn(a),l,u)}class V_ extends Fp{_toFieldTransform(e){if(e.Mu!==2)throw e.Mu===1?e.qu(`${this._methodName}() can only appear at the top level of your update data`):e.qu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof V_}}class j_ extends Fp{_toFieldTransform(e){return new NC(e.path,new ec)}isEqual(e){return e instanceof j_}}function G3(t,e,n,r){const i=t.$u(1,e,n);U_("Data must be an object, but it was:",i,r);const s=[],o=Cn.empty();Co(r,(l,u)=>{const d=$_(e,l,n);u=Mt(u);const p=i.Bu(d);if(u instanceof V_)s.push(d);else{const m=F_(u,p);m!=null&&(s.push(d),o.set(d,m))}});const a=new nr(s);return new W3(o,a,i.fieldTransforms)}function Q3(t,e,n,r,i,s){if(t.$u(1,e,n),HA(e,r,n),s.length%2!=0)throw new ne(K.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`)}function F_(t,e){if(qA(t=Mt(t)))return U_("Unsupported field value:",e,t),BA(t,e);if(t instanceof Fp)return function(r,i){if(!$A(i.Mu))throw i.qu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.qu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=F_(a,i.ku(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Mt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return UV(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Et.fromDate(r);return{timestampValue:rc(i.serializer,s)}}if(r instanceof Et){const s=new Et(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:rc(i.serializer,s)}}if(r instanceof O_)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof sc)return{bytesValue:$C(i.serializer,r._byteString)};if(r instanceof kn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.qu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:g_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof N_)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.qu("VectorValues must only contain numeric values.");return c_(a.serializer,l)})}}}}}}(r,i);throw i.qu(`Unsupported field value: ${k_(r)}`)}(t,e)}function BA(t,e){const n={};return dC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Co(t,(r,i)=>{const s=F_(i,e.Ou(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function qA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Et||t instanceof O_||t instanceof sc||t instanceof kn||t instanceof Fp||t instanceof N_)}function U_(t,e,n){if(!qA(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=k_(n);throw r==="an object"?e.qu(t+" a custom object"):e.qu(t+" "+r)}}function HA(t,e,n){if((e=Mt(e))instanceof jp)return e._internalPath;if(typeof e=="string")return $_(t,e);throw Qf("Field path arguments must be of type string or ",t,!1,void 0,n)}const Y3=new RegExp("[~\\*/\\[\\]]");function $_(t,e,n){if(e.search(Y3)>=0)throw Qf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new jp(...e.split("."))._internalPath}catch{throw Qf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Qf(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new ne(K.INVALID_ARGUMENT,a+t+l)}function X3(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new kn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new J3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(KA("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class J3 extends WA{data(){return super.data()}}function KA(t,e){return typeof e=="string"?$_(t,e):e instanceof jp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z3(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ne(K.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ej{convertValue(e,n="none"){switch(go(e)){case 0:return null;case 1:return e.booleanValue;case 2:return pt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(rs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw le()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Co(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>pt(o.doubleValue));return new N_(s)}convertGeoPoint(e){return new O_(pt(e.latitude),pt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=bp(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(eh(e));default:return null}}convertTimestamp(e){const n=ns(e);return new Et(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ge.fromString(e);ce(XC(r));const i=new Ea(r.get(1),r.get(3)),s=new te(r.popFirst(5));return i.isEqual(n)||bn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GA(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class QA extends WA{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Zd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(KA("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Zd extends QA{data(e={}){return super.data(e)}}class tj{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new cu(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Zd(this._firestore,this._userDataWriter,r.key,r,new cu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ne(K.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Zd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new cu(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Zd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new cu(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:nj(a.type),doc:l,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function nj(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return le()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yi(t){t=Zr(t,kn);const e=Zr(t.firestore,yo);return j3(D_(e),t._key).then(n=>XA(e,t,n))}class YA extends ej{constructor(e){super(),this.firestore=e}convertBytes(e){return new sc(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new kn(this.firestore,null,n)}}function Yf(t,e,n){t=Zr(t,kn);const r=Zr(t.firestore,yo),i=GA(t.converter,e);return z_(r,[zA(M_(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,An.none())])}function Vs(t,e,n,...r){t=Zr(t,kn);const i=Zr(t.firestore,yo),s=M_(i);let o;return o=typeof(e=Mt(e))=="string"||e instanceof jp?Q3(s,"updateDoc",t._key,e,n,r):G3(s,"updateDoc",t._key,e),z_(i,[o.toMutation(t._key,An.exists(!0))])}function rj(t,e){const n=Zr(t.firestore,yo),r=dt(t),i=GA(t.converter,e);return z_(n,[zA(M_(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,An.exists(!1))]).then(()=>r)}function q1(t,...e){var n,r,i;t=Mt(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||B1(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(B1(e[o])){const p=e[o];e[o]=(n=p.next)===null||n===void 0?void 0:n.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let l,u,d;if(t instanceof kn)u=Zr(t.firestore,yo),d=yh(t._key.path),l={next:p=>{e[o]&&e[o](XA(u,t,p))},error:e[o+1],complete:e[o+2]};else{const p=Zr(t,Vp);u=Zr(p.firestore,yo),d=p._query;const m=new YA(u);l={next:w=>{e[o]&&e[o](new tj(u,m,p,w))},error:e[o+1],complete:e[o+2]},Z3(t._query)}return function(m,w,E,x){const D=new MA(x),A=new CA(w,D,E);return m.asyncQueue.enqueueAndForget(async()=>SA(await Rv(m),A)),()=>{D.eu(),m.asyncQueue.enqueueAndForget(async()=>bA(await Rv(m),A))}}(D_(u),d,a,l)}function z_(t,e){return function(r,i){const s=new Qi;return r.asyncQueue.enqueueAndForget(async()=>C3(await V3(r),i,s)),s.promise}(D_(t),e)}function XA(t,e,n){const r=n.docs.get(e._key),i=new YA(t);return new QA(t,i,e._key,r,new cu(n.hasPendingWrites,n.fromCache),e.converter)}function Dv(){return new j_("serverTimestamp")}(function(e,n=!0){(function(i){fc=i})(hc),Si(new ti("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new yo(new UM(r.getProvider("auth-internal")),new qM(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ne(K.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ea(u.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Rr(jE,"4.7.5",e),Rr(jE,"4.7.5","esm2017")})();const JA="@firebase/installations",B_="0.6.11";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZA=1e4,ex=`w:${B_}`,tx="FIS_v2",ij="https://firebaseinstallations.googleapis.com/v1",sj=60*60*1e3,oj="installations",aj="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ca=new Oa(oj,aj,lj);function nx(t){return t instanceof ni&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rx({projectId:t}){return`${ij}/projects/${t}/installations`}function ix(t){return{token:t.token,requestStatus:2,expiresIn:uj(t.expiresIn),creationTime:Date.now()}}async function sx(t,e){const r=(await e.json()).error;return Ca.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function ox({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function cj(t,{refreshToken:e}){const n=ox(t);return n.append("Authorization",hj(e)),n}async function ax(t){const e=await t();return e.status>=500&&e.status<600?t():e}function uj(t){return Number(t.replace("s","000"))}function hj(t){return`${tx} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dj({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=rx(t),i=ox(t),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={fid:n,authVersion:tx,appId:t.appId,sdkVersion:ex},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await ax(()=>fetch(r,a));if(l.ok){const u=await l.json();return{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:ix(u.authToken)}}else throw await sx("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lx(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fj(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pj=/^[cdef][\w-]{21}$/,Ov="";function gj(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=mj(t);return pj.test(n)?n:Ov}catch{return Ov}}function mj(t){return fj(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Up(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cx=new Map;function ux(t,e){const n=Up(t);hx(n,e),vj(n,e)}function hx(t,e){const n=cx.get(t);if(n)for(const r of n)r(e)}function vj(t,e){const n=yj();n&&n.postMessage({key:t,fid:e}),_j()}let aa=null;function yj(){return!aa&&"BroadcastChannel"in self&&(aa=new BroadcastChannel("[Firebase] FID Change"),aa.onmessage=t=>{hx(t.data.key,t.data.fid)}),aa}function _j(){cx.size===0&&aa&&(aa.close(),aa=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wj="firebase-installations-database",Ej=1,Aa="firebase-installations-store";let Gg=null;function q_(){return Gg||(Gg=lb(wj,Ej,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Aa)}}})),Gg}async function Xf(t,e){const n=Up(t),i=(await q_()).transaction(Aa,"readwrite"),s=i.objectStore(Aa),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&ux(t,e.fid),e}async function dx(t){const e=Up(t),r=(await q_()).transaction(Aa,"readwrite");await r.objectStore(Aa).delete(e),await r.done}async function $p(t,e){const n=Up(t),i=(await q_()).transaction(Aa,"readwrite"),s=i.objectStore(Aa),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&ux(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H_(t){let e;const n=await $p(t.appConfig,r=>{const i=Tj(r),s=Ij(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===Ov?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function Tj(t){const e=t||{fid:gj(),registrationStatus:0};return fx(e)}function Ij(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(Ca.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=Sj(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:bj(t)}:{installationEntry:e}}async function Sj(t,e){try{const n=await dj(t,e);return Xf(t.appConfig,n)}catch(n){throw nx(n)&&n.customData.serverCode===409?await dx(t.appConfig):await Xf(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function bj(t){let e=await H1(t.appConfig);for(;e.registrationStatus===1;)await lx(100),e=await H1(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await H_(t);return r||n}return e}function H1(t){return $p(t,e=>{if(!e)throw Ca.create("installation-not-found");return fx(e)})}function fx(t){return Cj(t)?{fid:t.fid,registrationStatus:0}:t}function Cj(t){return t.registrationStatus===1&&t.registrationTime+ZA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Aj({appConfig:t,heartbeatServiceProvider:e},n){const r=xj(t,n),i=cj(t,n),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={installation:{sdkVersion:ex,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await ax(()=>fetch(r,a));if(l.ok){const u=await l.json();return ix(u)}else throw await sx("Generate Auth Token",l)}function xj(t,{fid:e}){return`${rx(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W_(t,e=!1){let n;const r=await $p(t.appConfig,s=>{if(!px(s))throw Ca.create("not-registered");const o=s.authToken;if(!e&&Rj(o))return s;if(o.requestStatus===1)return n=Pj(t,e),s;{if(!navigator.onLine)throw Ca.create("app-offline");const a=Oj(s);return n=kj(t,a),a}});return n?await n:r.authToken}async function Pj(t,e){let n=await W1(t.appConfig);for(;n.authToken.requestStatus===1;)await lx(100),n=await W1(t.appConfig);const r=n.authToken;return r.requestStatus===0?W_(t,e):r}function W1(t){return $p(t,e=>{if(!px(e))throw Ca.create("not-registered");const n=e.authToken;return Nj(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function kj(t,e){try{const n=await Aj(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await Xf(t.appConfig,r),n}catch(n){if(nx(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await dx(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Xf(t.appConfig,r)}throw n}}function px(t){return t!==void 0&&t.registrationStatus===2}function Rj(t){return t.requestStatus===2&&!Dj(t)}function Dj(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+sj}function Oj(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function Nj(t){return t.requestStatus===1&&t.requestTime+ZA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lj(t){const e=t,{installationEntry:n,registrationPromise:r}=await H_(e);return r?r.catch(console.error):W_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mj(t,e=!1){const n=t;return await Vj(n),(await W_(n,e)).token}async function Vj(t){const{registrationPromise:e}=await H_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jj(t){if(!t||!t.options)throw Qg("App Configuration");if(!t.name)throw Qg("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Qg(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Qg(t){return Ca.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gx="installations",Fj="installations-internal",Uj=t=>{const e=t.getProvider("app").getImmediate(),n=jj(e),r=Na(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},$j=t=>{const e=t.getProvider("app").getImmediate(),n=Na(e,gx).getImmediate();return{getId:()=>Lj(n),getToken:i=>Mj(n,i)}};function zj(){Si(new ti(gx,Uj,"PUBLIC")),Si(new ti(Fj,$j,"PRIVATE"))}zj();Rr(JA,B_);Rr(JA,B_,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jf="analytics",Bj="firebase_id",qj="origin",Hj=60*1e3,Wj="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",K_="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hn=new _p("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kj={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},or=new Oa("analytics","Analytics",Kj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gj(t){if(!t.startsWith(K_)){const e=or.create("invalid-gtag-resource",{gtagURL:t});return Hn.warn(e.message),""}return t}function mx(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function Qj(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function Yj(t,e){const n=Qj("firebase-js-sdk-policy",{createScriptURL:Gj}),r=document.createElement("script"),i=`${K_}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function Xj(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function Jj(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const l=(await mx(n)).find(u=>u.measurementId===i);l&&await e[l.appId]}}catch(a){Hn.error(a)}t("config",i,s)}async function Zj(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await mx(n);for(const l of o){const u=a.find(p=>p.measurementId===l),d=u&&e[u.appId];if(d)s.push(d);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){Hn.error(s)}}function e4(t,e,n,r){async function i(s,...o){try{if(s==="event"){const[a,l]=o;await Zj(t,e,n,a,l)}else if(s==="config"){const[a,l]=o;await Jj(t,e,n,r,a,l)}else if(s==="consent"){const[a,l]=o;t("consent",a,l)}else if(s==="get"){const[a,l,u]=o;t("get",a,l,u)}else if(s==="set"){const[a]=o;t("set",a)}else t(s,...o)}catch(a){Hn.error(a)}}return i}function t4(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=e4(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function n4(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(K_)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r4=30,i4=1e3;class s4{constructor(e={},n=i4){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const vx=new s4;function o4(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function a4(t){var e;const{appId:n,apiKey:r}=t,i={method:"GET",headers:o4(r)},s=Wj.replace("{app-id}",n),o=await fetch(s,i);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw or.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function l4(t,e=vx,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw or.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw or.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new h4;return setTimeout(async()=>{a.abort()},Hj),yx({appId:r,apiKey:i,measurementId:s},o,a,e)}async function yx(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=vx){var s;const{appId:o,measurementId:a}=t;try{await c4(r,e)}catch(l){if(a)return Hn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw l}try{const l=await a4(t);return i.deleteThrottleMetadata(o),l}catch(l){const u=l;if(!u4(u)){if(i.deleteThrottleMetadata(o),a)return Hn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:o,measurementId:a};throw l}const d=Number((s=u==null?void 0:u.customData)===null||s===void 0?void 0:s.httpStatus)===503?cE(n,i.intervalMillis,r4):cE(n,i.intervalMillis),p={throttleEndTimeMillis:Date.now()+d,backoffCount:n+1};return i.setThrottleMetadata(o,p),Hn.debug(`Calling attemptFetch again in ${d} millis`),yx(t,p,r,i)}}function c4(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(or.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function u4(t){if(!(t instanceof ni)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class h4{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function d4(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,o=Object.assign(Object.assign({},r),{send_to:s});t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f4(){if(By())try{await sb()}catch(t){return Hn.warn(or.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return Hn.warn(or.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function p4(t,e,n,r,i,s,o){var a;const l=l4(t);l.then(w=>{n[w.measurementId]=w.appId,t.options.measurementId&&w.measurementId!==t.options.measurementId&&Hn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${w.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(w=>Hn.error(w)),e.push(l);const u=f4().then(w=>{if(w)return r.getId()}),[d,p]=await Promise.all([l,u]);n4(s)||Yj(s,d.measurementId),i("js",new Date);const m=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return m[qj]="firebase",m.update=!0,p!=null&&(m[Bj]=p),i("config",d.measurementId,m),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{constructor(e){this.app=e}_delete(){return delete Au[this.app.options.appId],Promise.resolve()}}let Au={},K1=[];const G1={};let Yg="dataLayer",m4="gtag",Q1,_x,Y1=!1;function v4(){const t=[];if(rb()&&t.push("This is a browser extension environment."),i2()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=or.create("invalid-analytics-context",{errorInfo:e});Hn.warn(n.message)}}function y4(t,e,n){v4();const r=t.options.appId;if(!r)throw or.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Hn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw or.create("no-api-key");if(Au[r]!=null)throw or.create("already-exists",{id:r});if(!Y1){Xj(Yg);const{wrappedGtag:s,gtagCore:o}=t4(Au,K1,G1,Yg,m4);_x=s,Q1=o,Y1=!0}return Au[r]=p4(t,K1,G1,e,Q1,Yg,n),new g4(t)}function _4(t=ub()){t=Mt(t);const e=Na(t,Jf);return e.isInitialized()?e.getImmediate():w4(t)}function w4(t,e={}){const n=Na(t,Jf);if(n.isInitialized()){const i=n.getImmediate();if(Kl(e,n.getOptions()))return i;throw or.create("already-initialized")}return n.initialize({options:e})}function E4(t,e,n,r){t=Mt(t),d4(_x,Au[t.app.options.appId],e,n,r).catch(i=>Hn.error(i))}const X1="@firebase/analytics",J1="0.10.10";function T4(){Si(new ti(Jf,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return y4(r,i,n)},"PUBLIC")),Si(new ti("analytics-internal",t,"PRIVATE")),Rr(X1,J1),Rr(X1,J1,"esm2017");function t(e){try{const n=e.getProvider(Jf).getImmediate();return{logEvent:(r,i,s)=>E4(n,r,i,s)}}catch(n){throw or.create("interop-component-reg-failed",{reason:n})}}}T4();const I4={apiKey:"AIzaSyDcGX1V06Iox4rkwOm9BW2gfC1-jj8TiSs",authDomain:"chessmatch-b38ef.firebaseapp.com",projectId:"chessmatch-b38ef",storageBucket:"chessmatch-b38ef.firebasestorage.app",messagingSenderId:"293162008011",appId:"1:293162008011:web:e605313c7055f1ce784a4e",measurementId:"G-2V8DL9QX5J"},G_=cb(I4),lt=NM(G_),at=$3(G_,{cacheSizeBytes:5242880,experimentalForceLongPolling:!0});_4(G_);z3(at).catch(t=>{console.error("Error enabling persistence:",t)});function S4(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}const sh="abcdefgh".split(""),ef={a8:"bR",b8:"bN",c8:"bB",d8:"bQ",e8:"bK",f8:"bB",g8:"bN",h8:"bR",a7:"bP",b7:"bP",c7:"bP",d7:"bP",e7:"bP",f7:"bP",g7:"bP",h7:"bP",a2:"wP",b2:"wP",c2:"wP",d2:"wP",e2:"wP",f2:"wP",g2:"wP",h2:"wP",a1:"wR",b1:"wN",c1:"wB",d1:"wQ",e1:"wK",f1:"wB",g1:"wN",h1:"wR"},b4={a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},C4={a:7,b:6,c:5,d:4,e:3,f:2,g:1,h:0},A4=[7,6,5,4,3,2,1,0],x4=[0,1,2,3,4,5,6,7],Z1={wP:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsx("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:"#ffffff",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})})),wR:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{opacity:"1",fill:"#ffffff",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsx("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 34,14 L 31,17 L 14,17 L 11,14"}),y.jsx("path",{d:"M 31,17 L 31,29.5 L 14,29.5 L 14,17",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5"}),y.jsx("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]}))})),wN:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsx("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:"#ffffff",stroke:"#000000"}}),y.jsx("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:"#ffffff",stroke:"#000000"}}),y.jsx("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#000000",stroke:"#000000"}}),y.jsx("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#000000",stroke:"#000000"}})]}))})),wB:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsxs("g",Object.assign({style:{fill:"#ffffff",stroke:"#000000",strokeLinecap:"butt"}},{children:[y.jsx("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),y.jsx("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),y.jsx("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]})),y.jsx("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]}))})),wQ:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{fill:"#ffffff",stroke:"#000000",strokeWidth:"1.5",strokeLinejoin:"round"}},{children:[y.jsx("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"}),y.jsx("path",{d:"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 11,36 11,36 C 9.5,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"}),y.jsx("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30",style:{fill:"none"}}),y.jsx("path",{d:"M 12,33.5 C 18,32.5 27,32.5 33,33.5",style:{fill:"none"}}),y.jsx("circle",{cx:"6",cy:"12",r:"2"}),y.jsx("circle",{cx:"14",cy:"9",r:"2"}),y.jsx("circle",{cx:"22.5",cy:"8",r:"2"}),y.jsx("circle",{cx:"31",cy:"9",r:"2"}),y.jsx("circle",{cx:"39",cy:"12",r:"2"})]}))})),wK:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsx("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:"#ffffff",stroke:"#000000",strokeLinecap:"butt",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:"#ffffff",stroke:"#000000"}}),y.jsx("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30",style:{fill:"none",stroke:"#000000"}}),y.jsx("path",{d:"M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5",style:{fill:"none",stroke:"#000000"}}),y.jsx("path",{d:"M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#000000"}})]}))})),bP:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsx("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:"#000000",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})})),bR:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{opacity:"1",fill:"#000000",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsx("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z ",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z ",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z ",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z ",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 12,35.5 L 33,35.5 L 33,35.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 13,31.5 L 32,31.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 14,29.5 L 31,29.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 14,16.5 L 31,16.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}})]}))})),bN:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsx("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:"#000000",stroke:"#000000"}}),y.jsx("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:"#000000",stroke:"#000000"}}),y.jsx("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#ffffff",stroke:"#ffffff"}}),y.jsx("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#ffffff",stroke:"#ffffff"}}),y.jsx("path",{d:"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z ",style:{fill:"#ffffff",stroke:"none"}})]}))})),bB:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsxs("g",Object.assign({style:{fill:"#000000",stroke:"#000000",strokeLinecap:"butt"}},{children:[y.jsx("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),y.jsx("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),y.jsx("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]})),y.jsx("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#ffffff",strokeLinejoin:"miter"}})]}))})),bQ:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{fill:"#000000",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}},{children:[y.jsx("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z",style:{strokeLinecap:"butt",fill:"#000000"}}),y.jsx("path",{d:"m 9,26 c 0,2 1.5,2 2.5,4 1,1.5 1,1 0.5,3.5 -1.5,1 -1,2.5 -1,2.5 -1.5,1.5 0,2.5 0,2.5 6.5,1 16.5,1 23,0 0,0 1.5,-1 0,-2.5 0,0 0.5,-1.5 -1,-2.5 -0.5,-2.5 -0.5,-2 0.5,-3.5 1,-2 2.5,-2 2.5,-4 -8.5,-1.5 -18.5,-1.5 -27,0 z"}),y.jsx("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30"}),y.jsx("path",{d:"m 12,33.5 c 6,-1 15,-1 21,0"}),y.jsx("circle",{cx:"6",cy:"12",r:"2"}),y.jsx("circle",{cx:"14",cy:"9",r:"2"}),y.jsx("circle",{cx:"22.5",cy:"8",r:"2"}),y.jsx("circle",{cx:"31",cy:"9",r:"2"}),y.jsx("circle",{cx:"39",cy:"12",r:"2"}),y.jsx("path",{d:"M 11,38.5 A 35,35 1 0 0 34,38.5",style:{fill:"none",stroke:"#000000",strokeLinecap:"butt"}}),y.jsxs("g",Object.assign({style:{fill:"none",stroke:"#ffffff"}},{children:[y.jsx("path",{d:"M 11,29 A 35,35 1 0 1 34,29"}),y.jsx("path",{d:"M 12.5,31.5 L 32.5,31.5"}),y.jsx("path",{d:"M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"}),y.jsx("path",{d:"M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"})]}))]}))})),bK:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsx("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"},id:"path6570"}),y.jsx("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:"#000000",fillOpacity:"1",strokeLinecap:"butt",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:"#000000",stroke:"#000000"}}),y.jsx("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.5,26.6 L 22.5,24.5 C 20,18 10.85,14 6.97,19.85 C 4.5,25.5 13,29.5 13,29.5",style:{fill:"none",stroke:"#ffffff"}}),y.jsx("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30 M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5 M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#ffffff"}})]}))}))};function Nv(t,e,n){const r=e/8,i=t==="white"?b4:C4,s=t==="white"?A4:x4,o=i[n[0]]*r+r/2,a=s[parseInt(n[1],10)-1]*r+r/2;return{x:o,y:a}}function eT(t){let e=!1;return Object.keys(ef).forEach(n=>{t[n]!==ef[n]&&(e=!0)}),Object.keys(t).forEach(n=>{ef[n]!==t[n]&&(e=!0)}),e}function P4(t,e){const n={removed:{},added:{}};return Object.keys(t).forEach(r=>{e[r]!==t[r]&&(n.removed[r]=t[r])}),Object.keys(e).forEach(r=>{t[r]!==e[r]&&(n.added[r]=e[r])}),n}function tT(t){return t==="start"?ef:typeof t=="string"?k4(t):t}function k4(t){if(!R4(t))return{};t=t.replace(/ .+$/,"");const e=t.split("/"),n={};let r=8;for(let i=0;i<8;i++){const s=e[i].split("");let o=0;for(let a=0;a<s.length;a++)if(s[a].search(/[1-8]/)!==-1){const l=parseInt(s[a],10);o=o+l}else{const l=sh[o]+r;n[l]=O4(s[a]),o=o+1}r=r-1}return n}function R4(t){t=t.replace(/ .+$/,""),t=D4(t);const e=t.split("/");if(e.length!==8)return!1;for(let n=0;n<8;n++)if(e[n].length!==8||e[n].search(/[^kqrnbpKQRNBP1]/)!==-1)return!1;return!0}function D4(t){return t.replace(/8/g,"11111111").replace(/7/g,"1111111").replace(/6/g,"111111").replace(/5/g,"11111").replace(/4/g,"1111").replace(/3/g,"111").replace(/2/g,"11")}function O4(t){return t.toLowerCase()===t?"b"+t.toUpperCase():"w"+t.toUpperCase()}const N4=(t,e=!0,n,r)=>{const[i,s]=N.useState([]),[o,a]=N.useState([]),[l,u]=N.useState();N.useEffect(()=>{Array.isArray(t)&&(d(),s(t==null?void 0:t.filter(E=>E[0]!==E[1])))},[t]),N.useEffect(()=>{n==null||n(o)},[o]);function d(){a([]),u(void 0)}const p=(E,x)=>{e&&u([E,x,r])},m=[...o,...i];return{arrows:m,newArrow:l,clearArrows:d,drawNewArrow:p,setArrows:a,onArrowDrawEnd:(E,x)=>{if(E===x||!e)return;let D;const A=[E,x,r];m.every(([S,M])=>!(S===E&&M===x))?D=[...o,A]:D=o.filter(([S,M])=>!(S===E&&M===x)),u(void 0),a(D)}}},wx=N.createContext({}),us=()=>N.useContext(wx),L4=N.forwardRef(({allowDragOutsideBoard:t=!0,animationDuration:e=300,areArrowsAllowed:n=!0,arePiecesDraggable:r=!0,arePremovesAllowed:i=!1,autoPromoteToQueen:s=!1,boardOrientation:o="white",boardWidth:a,children:l,clearPremovesOnRightClick:u=!0,customArrows:d,customArrowColor:p="rgb(255,170,0)",customBoardStyle:m,customNotationStyle:w,customDarkSquareStyle:E={backgroundColor:"#B58863"},customDropSquareStyle:x={boxShadow:"inset 0 0 1px 6px rgba(255,255,255,0.75)"},customLightSquareStyle:D={backgroundColor:"#F0D9B5"},customPieces:A,customPremoveDarkSquareStyle:T={backgroundColor:"#A42323"},customPremoveLightSquareStyle:S={backgroundColor:"#BD2828"},customSquare:M="div",customSquareStyles:q,dropOffBoardAction:W="snapback",id:P=0,isDraggablePiece:C=()=>!0,getPositionObject:R=()=>{},onArrowsChange:O=()=>{},onDragOverSquare:L=()=>{},onMouseOutSquare:V=()=>{},onMouseOverSquare:k=()=>{},onPieceClick:ge=()=>{},onPieceDragBegin:Te=()=>{},onPieceDragEnd:Ie=()=>{},onPieceDrop:Se=()=>!0,onPieceDropOffBoard:X=()=>{},onPromotionCheck:ae=(At,Kt,On)=>(On==="wP"&&At[1]==="7"&&Kt[1]==="8"||On==="bP"&&At[1]==="2"&&Kt[1]==="1")&&Math.abs(At.charCodeAt(0)-Kt.charCodeAt(0))<=1,onPromotionPieceSelect:z=()=>!0,onSparePieceDrop:Le=()=>!0,onSquareClick:Me=()=>{},onSquareRightClick:Be=()=>{},position:ut="start",promotionDialogVariant:jt="default",promotionToSquare:nt=null,showBoardNotation:de=!0,showPromotionDialog:se=!1,snapToCursor:Wn=!0},Kn)=>{const[At,Kt]=N.useState(tT(ut)),[On,hs]=N.useState({removed:{},added:{}}),[Gn,on]=N.useState(void 0),[mc,xo]=N.useState(se&&!s),[ja,ds]=N.useState(null),[Fa,Po]=N.useState(nt),[fs,hr]=N.useState([]),Dt=N.useRef(fs),[vt,it]=N.useState(),[Qn,Mr]=N.useState(Object.assign(Object.assign({},Z1),A)),[Ci,ps]=N.useState(!1),[Yn,Ua]=N.useState(),[Ai,ri]=N.useState(!1),[vc,yc]=N.useState(null);N.useImperativeHandle(Kn,()=>({clearPremoves(Ue=!0){Nn(Ue)}})),N.useEffect(()=>{Mr(Object.assign(Object.assign({},Z1),A))},[A]),N.useEffect(()=>{xo(se),Po(nt)},[nt,se]),N.useEffect(()=>{var Ue,Xe,xt;yn();const qe=tT(ut),dr=P4(At,qe),en=((Ue=Object.keys(dr.added))===null||Ue===void 0?void 0:Ue.length)<=2?(xt=(Xe=Object.entries(dr.added))===null||Xe===void 0?void 0:Xe[0])===null||xt===void 0?void 0:xt[1][0]:void 0;if(Ai)Kt(qe),ri(!1),i&&ms(en),Yn&&clearTimeout(Yn);else if(Ci)Kt(qe),ri(!1),i&&ms(en);else{eT(qe)&&Gn!==void 0?on(en):eT(qe)?on(void 0):on("b"),hs(dr),ri(!0);const ys=setTimeout(()=>{Kt(qe),ri(!1),i&&ms(en)},e);Ua(ys)}return ps(!1),R(qe),Vr(),()=>{clearTimeout(Yn)}},[ut]);const{arrows:ko,newArrow:Ro,clearArrows:Vr,drawNewArrow:ii,onArrowDrawEnd:gs}=N4(d,n,O,p);function Do(Ue,Xe,xt,qe){if(Ue===Xe)return;if(Vr(),i&&Ai||i&&(Gn===xt[0]||Dt.current.filter(en=>en.piece[0]===xt[0]).length>0)){const en=[...Dt.current];en.push({sourceSq:Ue,targetSq:Xe,piece:xt}),Dt.current=en,hr([...en]),yn();return}if(!i&&Ai)return;const dr=Object.assign({},At);ps(!!qe),on(xt[0]),Se.length?Se(Ue,Xe,xt)||(Nn(),ps(!1)):(delete dr[Ue],dr[Xe]=xt,Kt(dr)),yn(),R(dr)}function jr(Ue){const Xe=Object.assign({},At);delete Xe[Ue],Kt(Xe),R(Xe)}function ms(Ue){if(Dt.current.length===0)return;const Xe=Dt.current[0];if(Xe.piece[0]!==void 0&&Xe.piece[0]!==Ue&&Se.length)if(on(Xe.piece[0]),ps(!0),Se(Xe.sourceSq,Xe.targetSq,Xe.piece)){const qe=[...Dt.current];qe.shift(),Dt.current=qe,hr([...qe])}else Nn()}function vs(Ue,Xe){if(!Le(Ue,Xe))return;const qe=Object.assign({},At);qe[Xe]=Ue,Kt(qe),R(qe)}function Nn(Ue=!0){Ue&&on(void 0),Dt.current=[],hr([])}function yn(){ds(null),Po(null),xo(!1)}function $a(Ue){it(Ue)}function Ft(Ue){if(vt){if(vt===Ue){it(void 0),u&&Nn(!1),Be(Ue);return}}else it(void 0)}function za(){it(void 0)}const xi={allowDragOutsideBoard:t,animationDuration:e,arePiecesDraggable:r,arePremovesAllowed:i,arrows:ko,autoPromoteToQueen:s,boardOrientation:o,boardWidth:a,chessPieces:Qn,clearArrows:Vr,clearCurrentRightClickDown:za,currentPosition:At,currentRightClickDown:vt,customArrowColor:p,customBoardStyle:m,customDarkSquareStyle:E,customDropSquareStyle:x,customLightSquareStyle:D,customNotationStyle:w,customPremoveDarkSquareStyle:T,customPremoveLightSquareStyle:S,customSquare:M,customSquareStyles:q,deletePieceFromSquare:jr,drawNewArrow:ii,dropOffBoardAction:W,handleSetPosition:Do,handleSparePieceDrop:vs,id:P,isDraggablePiece:C,isWaitingForAnimation:Ai,lastPieceColour:Gn,lastSquareDraggedOver:vc,newArrow:Ro,onArrowDrawEnd:gs,onDragOverSquare:L,onMouseOutSquare:V,onMouseOverSquare:k,onPieceClick:ge,onPieceDragBegin:Te,onPieceDragEnd:Ie,onPieceDrop:Se,onPieceDropOffBoard:X,onPromotionCheck:ae,onPromotionPieceSelect:z,onRightClickDown:$a,onRightClickUp:Ft,onSparePieceDrop:Le,onSquareClick:Me,positionDifferences:On,premoves:fs,promoteFromSquare:ja,promoteToSquare:Fa,promotionDialogVariant:jt,setLastSquareDraggedOver:yc,setPromoteFromSquare:ds,setPromoteToSquare:Po,setShowPromoteDialog:xo,showBoardNotation:de,showPromoteDialog:mc,snapToCursor:Wn};return y.jsx(wx.Provider,Object.assign({value:xi},{children:l}))});function M4({row:t,col:e}){const{boardOrientation:n,boardWidth:r,customDarkSquareStyle:i,customLightSquareStyle:s,customNotationStyle:o}=us(),a=s.backgroundColor,l=i.backgroundColor,u=e===0,d=t===7,p=u&&d;function m(){return n==="white"?8-t:t+1}function w(){return n==="black"?sh[7-e]:sh[e]}function E(){return y.jsxs(y.Fragment,{children:[y.jsx("div",Object.assign({style:Object.assign(Object.assign({zIndex:3,position:"absolute"},{color:a}),rT(r,o))},{children:m()})),y.jsx("div",Object.assign({style:Object.assign(Object.assign({zIndex:3,position:"absolute"},{color:a}),nT(r,o))},{children:w()}))]})}function x(){return y.jsx("div",Object.assign({style:Object.assign(Object.assign({userSelect:"none",zIndex:3,position:"absolute"},{color:e%2!==0?l:a}),nT(r,o))},{children:w()}))}function D(){return y.jsx("div",Object.assign({style:Object.assign(Object.assign({userSelect:"none",zIndex:3,position:"absolute"},n==="black"?{color:t%2===0?l:a}:{color:t%2===0?l:a}),rT(r,o))},{children:m()}))}return p?E():d?x():u?D():null}const nT=(t,e)=>Object.assign({alignSelf:"flex-end",paddingLeft:t/8-t/48,fontSize:t/48},e),rT=(t,e)=>Object.assign({alignSelf:"flex-start",paddingRight:t/8-t/48,fontSize:t/48},e),Ex=N.createContext({dragDropManager:void 0});function Ir(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var iT=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),sT=function(){return Math.random().toString(36).substring(7).split("").join(".")},oT={INIT:"@@redux/INIT"+sT(),REPLACE:"@@redux/REPLACE"+sT()};function V4(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function Tx(t,e,n){var r;if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Ir(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Ir(1));return n(Tx)(t,e)}if(typeof t!="function")throw new Error(Ir(2));var i=t,s=e,o=[],a=o,l=!1;function u(){a===o&&(a=o.slice())}function d(){if(l)throw new Error(Ir(3));return s}function p(x){if(typeof x!="function")throw new Error(Ir(4));if(l)throw new Error(Ir(5));var D=!0;return u(),a.push(x),function(){if(D){if(l)throw new Error(Ir(6));D=!1,u();var T=a.indexOf(x);a.splice(T,1),o=null}}}function m(x){if(!V4(x))throw new Error(Ir(7));if(typeof x.type>"u")throw new Error(Ir(8));if(l)throw new Error(Ir(9));try{l=!0,s=i(s,x)}finally{l=!1}for(var D=o=a,A=0;A<D.length;A++){var T=D[A];T()}return x}function w(x){if(typeof x!="function")throw new Error(Ir(10));i=x,m({type:oT.REPLACE})}function E(){var x,D=p;return x={subscribe:function(T){if(typeof T!="object"||T===null)throw new Error(Ir(11));function S(){T.next&&T.next(d())}S();var M=D(S);return{unsubscribe:M}}},x[iT]=function(){return this},x}return m({type:oT.INIT}),r={dispatch:m,subscribe:p,getState:d,replaceReducer:w},r[iT]=E,r}function Ee(t,e,...n){if(j4()&&e===void 0)throw new Error("invariant requires an error message argument");if(!t){let r;if(e===void 0)r=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let i=0;r=new Error(e.replace(/%s/g,function(){return n[i++]})),r.name="Invariant Violation"}throw r.framesToPop=1,r}}function j4(){return typeof process<"u"&&!0}function F4(t,e,n){return e.split(".").reduce((r,i)=>r&&r[i]?r[i]:n||null,t)}function U4(t,e){return t.filter(n=>n!==e)}function Ix(t){return typeof t=="object"}function $4(t,e){const n=new Map,r=s=>{n.set(s,n.has(s)?n.get(s)+1:1)};t.forEach(r),e.forEach(r);const i=[];return n.forEach((s,o)=>{s===1&&i.push(o)}),i}function z4(t,e){return t.filter(n=>e.indexOf(n)>-1)}const Q_="dnd-core/INIT_COORDS",zp="dnd-core/BEGIN_DRAG",Y_="dnd-core/PUBLISH_DRAG_SOURCE",Bp="dnd-core/HOVER",qp="dnd-core/DROP",Hp="dnd-core/END_DRAG";function aT(t,e){return{type:Q_,payload:{sourceClientOffset:e||null,clientOffset:t||null}}}const B4={type:Q_,payload:{clientOffset:null,sourceClientOffset:null}};function q4(t){return function(n=[],r={publishSource:!0}){const{publishSource:i=!0,clientOffset:s,getSourceClientOffset:o}=r,a=t.getMonitor(),l=t.getRegistry();t.dispatch(aT(s)),H4(n,a,l);const u=G4(n,a);if(u==null){t.dispatch(B4);return}let d=null;if(s){if(!o)throw new Error("getSourceClientOffset must be defined");W4(o),d=o(u)}t.dispatch(aT(s,d));const m=l.getSource(u).beginDrag(a,u);if(m==null)return;K4(m),l.pinSource(u);const w=l.getSourceType(u);return{type:zp,payload:{itemType:w,item:m,sourceId:u,clientOffset:s||null,sourceClientOffset:d||null,isSourcePublic:!!i}}}}function H4(t,e,n){Ee(!e.isDragging(),"Cannot call beginDrag while dragging."),t.forEach(function(r){Ee(n.getSource(r),"Expected sourceIds to be registered.")})}function W4(t){Ee(typeof t=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function K4(t){Ee(Ix(t),"Item must be an object.")}function G4(t,e){let n=null;for(let r=t.length-1;r>=0;r--)if(e.canDragSource(t[r])){n=t[r];break}return n}function Q4(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y4(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),r.forEach(function(i){Q4(t,i,n[i])})}return t}function X4(t){return function(n={}){const r=t.getMonitor(),i=t.getRegistry();J4(r),tF(r).forEach((o,a)=>{const l=Z4(o,a,i,r),u={type:qp,payload:{dropResult:Y4({},n,l)}};t.dispatch(u)})}}function J4(t){Ee(t.isDragging(),"Cannot call drop while not dragging."),Ee(!t.didDrop(),"Cannot call drop twice during one drag operation.")}function Z4(t,e,n,r){const i=n.getTarget(t);let s=i?i.drop(r,t):void 0;return eF(s),typeof s>"u"&&(s=e===0?{}:r.getDropResult()),s}function eF(t){Ee(typeof t>"u"||Ix(t),"Drop result must either be an object or undefined.")}function tF(t){const e=t.getTargetIds().filter(t.canDropOnTarget,t);return e.reverse(),e}function nF(t){return function(){const n=t.getMonitor(),r=t.getRegistry();rF(n);const i=n.getSourceId();return i!=null&&(r.getSource(i,!0).endDrag(n,i),r.unpinSource()),{type:Hp}}}function rF(t){Ee(t.isDragging(),"Cannot call endDrag while not dragging.")}function Lv(t,e){return e===null?t===null:Array.isArray(t)?t.some(n=>n===e):t===e}function iF(t){return function(n,{clientOffset:r}={}){sF(n);const i=n.slice(0),s=t.getMonitor(),o=t.getRegistry(),a=s.getItemType();return aF(i,o,a),oF(i,s,o),lF(i,s,o),{type:Bp,payload:{targetIds:i,clientOffset:r||null}}}}function sF(t){Ee(Array.isArray(t),"Expected targetIds to be an array.")}function oF(t,e,n){Ee(e.isDragging(),"Cannot call hover while not dragging."),Ee(!e.didDrop(),"Cannot call hover after drop.");for(let r=0;r<t.length;r++){const i=t[r];Ee(t.lastIndexOf(i)===r,"Expected targetIds to be unique in the passed array.");const s=n.getTarget(i);Ee(s,"Expected targetIds to be registered.")}}function aF(t,e,n){for(let r=t.length-1;r>=0;r--){const i=t[r],s=e.getTargetType(i);Lv(s,n)||t.splice(r,1)}}function lF(t,e,n){t.forEach(function(r){n.getTarget(r).hover(e,r)})}function cF(t){return function(){if(t.getMonitor().isDragging())return{type:Y_}}}function uF(t){return{beginDrag:q4(t),publishDragSource:cF(t),hover:iF(t),drop:X4(t),endDrag:nF(t)}}class hF{receiveBackend(e){this.backend=e}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const e=this,{dispatch:n}=this.store;function r(s){return(...o)=>{const a=s.apply(e,o);typeof a<"u"&&n(a)}}const i=uF(this);return Object.keys(i).reduce((s,o)=>{const a=i[o];return s[o]=r(a),s},{})}dispatch(e){this.store.dispatch(e)}constructor(e,n){this.isSetUp=!1,this.handleRefCountChange=()=>{const r=this.store.getState().refCount>0;this.backend&&(r&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!r&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=e,this.monitor=n,e.subscribe(this.handleRefCountChange)}}function dF(t,e){return{x:t.x+e.x,y:t.y+e.y}}function Sx(t,e){return{x:t.x-e.x,y:t.y-e.y}}function fF(t){const{clientOffset:e,initialClientOffset:n,initialSourceClientOffset:r}=t;return!e||!n||!r?null:Sx(dF(e,r),n)}function pF(t){const{clientOffset:e,initialClientOffset:n}=t;return!e||!n?null:Sx(e,n)}const xu=[],X_=[];xu.__IS_NONE__=!0;X_.__IS_ALL__=!0;function gF(t,e){return t===xu?!1:t===X_||typeof e>"u"?!0:z4(e,t).length>0}class mF{subscribeToStateChange(e,n={}){const{handlerIds:r}=n;Ee(typeof e=="function","listener must be a function."),Ee(typeof r>"u"||Array.isArray(r),"handlerIds, when specified, must be an array of strings.");let i=this.store.getState().stateId;const s=()=>{const o=this.store.getState(),a=o.stateId;try{a===i||a===i+1&&!gF(o.dirtyHandlerIds,r)||e()}finally{i=a}};return this.store.subscribe(s)}subscribeToOffsetChange(e){Ee(typeof e=="function","listener must be a function.");let n=this.store.getState().dragOffset;const r=()=>{const i=this.store.getState().dragOffset;i!==n&&(n=i,e())};return this.store.subscribe(r)}canDragSource(e){if(!e)return!1;const n=this.registry.getSource(e);return Ee(n,`Expected to find a valid source. sourceId=${e}`),this.isDragging()?!1:n.canDrag(this,e)}canDropOnTarget(e){if(!e)return!1;const n=this.registry.getTarget(e);if(Ee(n,`Expected to find a valid target. targetId=${e}`),!this.isDragging()||this.didDrop())return!1;const r=this.registry.getTargetType(e),i=this.getItemType();return Lv(r,i)&&n.canDrop(this,e)}isDragging(){return!!this.getItemType()}isDraggingSource(e){if(!e)return!1;const n=this.registry.getSource(e,!0);if(Ee(n,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()||!this.isSourcePublic())return!1;const r=this.registry.getSourceType(e),i=this.getItemType();return r!==i?!1:n.isDragging(this,e)}isOverTarget(e,n={shallow:!1}){if(!e)return!1;const{shallow:r}=n;if(!this.isDragging())return!1;const i=this.registry.getTargetType(e),s=this.getItemType();if(s&&!Lv(i,s))return!1;const o=this.getTargetIds();if(!o.length)return!1;const a=o.indexOf(e);return r?a===o.length-1:a>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return fF(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return pF(this.store.getState().dragOffset)}constructor(e,n){this.store=e,this.registry=n}}const lT=typeof global<"u"?global:self,bx=lT.MutationObserver||lT.WebKitMutationObserver;function Cx(t){return function(){const n=setTimeout(i,0),r=setInterval(i,50);function i(){clearTimeout(n),clearInterval(r),t()}}}function vF(t){let e=1;const n=new bx(t),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){e=-e,r.data=e}}const yF=typeof bx=="function"?vF:Cx;class _F{enqueueTask(e){const{queue:n,requestFlush:r}=this;n.length||(r(),this.flushing=!0),n[n.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const n=this.index;if(this.index++,e[n].call(),this.index>this.capacity){for(let r=0,i=e.length-this.index;r<i;r++)e[r]=e[r+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=yF(this.flush),this.requestErrorThrow=Cx(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class wF{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,n){this.onError=e,this.release=n,this.task=null}}class EF{create(e){const n=this.freeTasks,r=n.length?n.pop():new wF(this.onError,i=>n[n.length]=i);return r.task=e,r}constructor(e){this.onError=e,this.freeTasks=[]}}const Ax=new _F,TF=new EF(Ax.registerPendingError);function IF(t){Ax.enqueueTask(TF.create(t))}const J_="dnd-core/ADD_SOURCE",Z_="dnd-core/ADD_TARGET",e0="dnd-core/REMOVE_SOURCE",Wp="dnd-core/REMOVE_TARGET";function SF(t){return{type:J_,payload:{sourceId:t}}}function bF(t){return{type:Z_,payload:{targetId:t}}}function CF(t){return{type:e0,payload:{sourceId:t}}}function AF(t){return{type:Wp,payload:{targetId:t}}}function xF(t){Ee(typeof t.canDrag=="function","Expected canDrag to be a function."),Ee(typeof t.beginDrag=="function","Expected beginDrag to be a function."),Ee(typeof t.endDrag=="function","Expected endDrag to be a function.")}function PF(t){Ee(typeof t.canDrop=="function","Expected canDrop to be a function."),Ee(typeof t.hover=="function","Expected hover to be a function."),Ee(typeof t.drop=="function","Expected beginDrag to be a function.")}function Mv(t,e){if(e&&Array.isArray(t)){t.forEach(n=>Mv(n,!1));return}Ee(typeof t=="string"||typeof t=="symbol",e?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var Ar;(function(t){t.SOURCE="SOURCE",t.TARGET="TARGET"})(Ar||(Ar={}));let kF=0;function RF(){return kF++}function DF(t){const e=RF().toString();switch(t){case Ar.SOURCE:return`S${e}`;case Ar.TARGET:return`T${e}`;default:throw new Error(`Unknown Handler Role: ${t}`)}}function cT(t){switch(t[0]){case"S":return Ar.SOURCE;case"T":return Ar.TARGET;default:throw new Error(`Cannot parse handler ID: ${t}`)}}function uT(t,e){const n=t.entries();let r=!1;do{const{done:i,value:[,s]}=n.next();if(s===e)return!0;r=!!i}while(!r);return!1}class OF{addSource(e,n){Mv(e),xF(n);const r=this.addHandler(Ar.SOURCE,e,n);return this.store.dispatch(SF(r)),r}addTarget(e,n){Mv(e,!0),PF(n);const r=this.addHandler(Ar.TARGET,e,n);return this.store.dispatch(bF(r)),r}containsHandler(e){return uT(this.dragSources,e)||uT(this.dropTargets,e)}getSource(e,n=!1){return Ee(this.isSourceId(e),"Expected a valid source ID."),n&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}getTarget(e){return Ee(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}getSourceType(e){return Ee(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}getTargetType(e){return Ee(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}isSourceId(e){return cT(e)===Ar.SOURCE}isTargetId(e){return cT(e)===Ar.TARGET}removeSource(e){Ee(this.getSource(e),"Expected an existing source."),this.store.dispatch(CF(e)),IF(()=>{this.dragSources.delete(e),this.types.delete(e)})}removeTarget(e){Ee(this.getTarget(e),"Expected an existing target."),this.store.dispatch(AF(e)),this.dropTargets.delete(e),this.types.delete(e)}pinSource(e){const n=this.getSource(e);Ee(n,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=n}unpinSource(){Ee(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(e,n,r){const i=DF(e);return this.types.set(i,n),e===Ar.SOURCE?this.dragSources.set(i,r):e===Ar.TARGET&&this.dropTargets.set(i,r),i}constructor(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}}const NF=(t,e)=>t===e;function LF(t,e){return!t&&!e?!0:!t||!e?!1:t.x===e.x&&t.y===e.y}function MF(t,e,n=NF){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!n(t[r],e[r]))return!1;return!0}function VF(t=xu,e){switch(e.type){case Bp:break;case J_:case Z_:case Wp:case e0:return xu;case zp:case Y_:case Hp:case qp:default:return X_}const{targetIds:n=[],prevTargetIds:r=[]}=e.payload,i=$4(n,r);if(!(i.length>0||!MF(n,r)))return xu;const o=r[r.length-1],a=n[n.length-1];return o!==a&&(o&&i.push(o),a&&i.push(a)),i}function jF(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FF(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),r.forEach(function(i){jF(t,i,n[i])})}return t}const hT={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function UF(t=hT,e){const{payload:n}=e;switch(e.type){case Q_:case zp:return{initialSourceClientOffset:n.sourceClientOffset,initialClientOffset:n.clientOffset,clientOffset:n.clientOffset};case Bp:return LF(t.clientOffset,n.clientOffset)?t:FF({},t,{clientOffset:n.clientOffset});case Hp:case qp:return hT;default:return t}}function $F(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ul(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),r.forEach(function(i){$F(t,i,n[i])})}return t}const zF={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function BF(t=zF,e){const{payload:n}=e;switch(e.type){case zp:return ul({},t,{itemType:n.itemType,item:n.item,sourceId:n.sourceId,isSourcePublic:n.isSourcePublic,dropResult:null,didDrop:!1});case Y_:return ul({},t,{isSourcePublic:!0});case Bp:return ul({},t,{targetIds:n.targetIds});case Wp:return t.targetIds.indexOf(n.targetId)===-1?t:ul({},t,{targetIds:U4(t.targetIds,n.targetId)});case qp:return ul({},t,{dropResult:n.dropResult,didDrop:!0,targetIds:[]});case Hp:return ul({},t,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return t}}function qF(t=0,e){switch(e.type){case J_:case Z_:return t+1;case e0:case Wp:return t-1;default:return t}}function HF(t=0){return t+1}function WF(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KF(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),r.forEach(function(i){WF(t,i,n[i])})}return t}function GF(t={},e){return{dirtyHandlerIds:VF(t.dirtyHandlerIds,{type:e.type,payload:KF({},e.payload,{prevTargetIds:F4(t,"dragOperation.targetIds",[])})}),dragOffset:UF(t.dragOffset,e),refCount:qF(t.refCount,e),dragOperation:BF(t.dragOperation,e),stateId:HF(t.stateId)}}function QF(t,e=void 0,n={},r=!1){const i=YF(r),s=new mF(i,new OF(i)),o=new hF(i,s),a=t(o,e,n);return o.receiveBackend(a),o}function YF(t){const e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return Tx(GF,t&&e&&e({name:"dnd-core",instanceId:"dnd-core"}))}function XF(t,e){if(t==null)return{};var n=JF(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function JF(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}let dT=0;const tf=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var ZF=N.memo(function(e){var{children:n}=e,r=XF(e,["children"]);const[i,s]=eU(r);return N.useEffect(()=>{if(s){const o=xx();return++dT,()=>{--dT===0&&(o[tf]=null)}}},[]),y.jsx(Ex.Provider,{value:i,children:n})});function eU(t){if("manager"in t)return[{dragDropManager:t.manager},!1];const e=tU(t.backend,t.context,t.options,t.debugMode),n=!t.context;return[e,n]}function tU(t,e=xx(),n,r){const i=e;return i[tf]||(i[tf]={dragDropManager:QF(t,e,n,r)}),i[tf]}function xx(){return typeof global<"u"?global:window}var nU=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;i--!==0;){var o=s[i];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n};const xa=typeof window<"u"?N.useLayoutEffect:N.useEffect;function Px(t,e,n){const[r,i]=N.useState(()=>e(t)),s=N.useCallback(()=>{const o=e(t);nU(r,o)||(i(o),n&&n())},[r,t,n]);return xa(s),[r,s]}function rU(t,e,n){const[r,i]=Px(t,e,n);return xa(function(){const o=t.getHandlerId();if(o!=null)return t.subscribeToStateChange(i,{handlerIds:[o]})},[t,i]),r}function kx(t,e,n){return rU(e,t||(()=>({})),()=>n.reconnect())}function Rx(t,e){const n=[...e||[]];return e==null&&typeof t!="function"&&n.push(t),N.useMemo(()=>typeof t=="function"?t():t,n)}function iU(t){return N.useMemo(()=>t.hooks.dragSource(),[t])}function sU(t){return N.useMemo(()=>t.hooks.dragPreview(),[t])}let Xg=!1,Jg=!1;class oU{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){Ee(!Xg,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Xg=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{Xg=!1}}isDragging(){if(!this.sourceId)return!1;Ee(!Jg,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Jg=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{Jg=!1}}subscribeToStateChange(e,n){return this.internalMonitor.subscribeToStateChange(e,n)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,n){return this.internalMonitor.isOverTarget(e,n)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}let Zg=!1;class aU{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,n){return this.internalMonitor.subscribeToStateChange(e,n)}canDrop(){if(!this.targetId)return!1;Ee(!Zg,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return Zg=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{Zg=!1}}isOver(e){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,e):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}}function lU(t,e,n){const r=n.getRegistry(),i=r.addTarget(t,e);return[i,()=>r.removeTarget(i)]}function cU(t,e,n){const r=n.getRegistry(),i=r.addSource(t,e);return[i,()=>r.removeSource(i)]}function Vv(t,e,n,r){let i;if(i!==void 0)return!!i;if(t===e)return!0;if(typeof t!="object"||!t||typeof e!="object"||!e)return!1;const s=Object.keys(t),o=Object.keys(e);if(s.length!==o.length)return!1;const a=Object.prototype.hasOwnProperty.bind(e);for(let l=0;l<s.length;l++){const u=s[l];if(!a(u))return!1;const d=t[u],p=e[u];if(i=void 0,i===!1||i===void 0&&d!==p)return!1}return!0}function jv(t){return t!==null&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function uU(t){if(typeof t.type=="string")return;const e=t.type.displayName||t.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${e} into a <div>, or turn it into a drag source or a drop target itself.`)}function hU(t){return(e=null,n=null)=>{if(!N.isValidElement(e)){const s=e;return t(s,n),s}const r=e;return uU(r),dU(r,n?s=>t(s,n):t)}}function Dx(t){const e={};return Object.keys(t).forEach(n=>{const r=t[n];if(n.endsWith("Ref"))e[n]=t[n];else{const i=hU(r);e[n]=()=>i}}),e}function fT(t,e){typeof t=="function"?t(e):t.current=e}function dU(t,e){const n=t.ref;return Ee(typeof n!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),n?N.cloneElement(t,{ref:r=>{fT(n,r),fT(e,r)}}):N.cloneElement(t,{ref:e})}class fU{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,n=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return n&&this.disconnectDragSource(),this.handlerId?e?(n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),n):(this.lastConnectedDragSource=e,n):n}reconnectDragPreview(e=!1){const n=this.dragPreview,r=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(r&&this.disconnectDragPreview(),!!this.handlerId){if(!n){this.lastConnectedDragPreview=n;return}r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=n,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,n,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!Vv(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!Vv(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=Dx({dragSource:(n,r)=>{this.clearDragSource(),this.dragSourceOptions=r||null,jv(n)?this.dragSourceRef=n:this.dragSourceNode=n,this.reconnectDragSource()},dragPreview:(n,r)=>{this.clearDragPreview(),this.dragPreviewOptions=r||null,jv(n)?this.dragPreviewRef=n:this.dragPreviewNode=n,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}class pU{get connectTarget(){return this.dropTarget}reconnect(){const e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();const n=this.dropTarget;if(this.handlerId){if(!n){this.lastConnectedDropTarget=n;return}e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=n,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,n,this.dropTargetOptions))}}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!Vv(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=Dx({dropTarget:(n,r)=>{this.clearDropTarget(),this.dropTargetOptions=r,jv(n)?this.dropTargetRef=n:this.dropTargetNode=n,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}}function Va(){const{dragDropManager:t}=N.useContext(Ex);return Ee(t!=null,"Expected drag drop context"),t}function gU(t,e){const n=Va(),r=N.useMemo(()=>new fU(n.getBackend()),[n]);return xa(()=>(r.dragSourceOptions=t||null,r.reconnect(),()=>r.disconnectDragSource()),[r,t]),xa(()=>(r.dragPreviewOptions=e||null,r.reconnect(),()=>r.disconnectDragPreview()),[r,e]),r}function mU(){const t=Va();return N.useMemo(()=>new oU(t),[t])}class vU{beginDrag(){const e=this.spec,n=this.monitor;let r=null;return typeof e.item=="object"?r=e.item:typeof e.item=="function"?r=e.item(n):r={},r??null}canDrag(){const e=this.spec,n=this.monitor;return typeof e.canDrag=="boolean"?e.canDrag:typeof e.canDrag=="function"?e.canDrag(n):!0}isDragging(e,n){const r=this.spec,i=this.monitor,{isDragging:s}=r;return s?s(i):n===e.getSourceId()}endDrag(){const e=this.spec,n=this.monitor,r=this.connector,{end:i}=e;i&&i(n.getItem(),n),r.reconnect()}constructor(e,n,r){this.spec=e,this.monitor=n,this.connector=r}}function yU(t,e,n){const r=N.useMemo(()=>new vU(t,e,n),[e,n]);return N.useEffect(()=>{r.spec=t},[t]),r}function _U(t){return N.useMemo(()=>{const e=t.type;return Ee(e!=null,"spec.type must be defined"),e},[t])}function wU(t,e,n){const r=Va(),i=yU(t,e,n),s=_U(t);xa(function(){if(s!=null){const[a,l]=cU(s,i,r);return e.receiveHandlerId(a),n.receiveHandlerId(a),l}},[r,e,n,i,s])}function EU(t,e){const n=Rx(t,e);Ee(!n.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const r=mU(),i=gU(n.options,n.previewOptions);return wU(n,r,i),[kx(n.collect,r,i),iU(i),sU(i)]}function TU(t){const n=Va().getMonitor(),[r,i]=Px(n,t);return N.useEffect(()=>n.subscribeToOffsetChange(i)),N.useEffect(()=>n.subscribeToStateChange(i)),r}function IU(t){return N.useMemo(()=>t.hooks.dropTarget(),[t])}function SU(t){const e=Va(),n=N.useMemo(()=>new pU(e.getBackend()),[e]);return xa(()=>(n.dropTargetOptions=t||null,n.reconnect(),()=>n.disconnectDropTarget()),[t]),n}function bU(){const t=Va();return N.useMemo(()=>new aU(t),[t])}function CU(t){const{accept:e}=t;return N.useMemo(()=>(Ee(t.accept!=null,"accept must be defined"),Array.isArray(e)?e:[e]),[e])}class AU{canDrop(){const e=this.spec,n=this.monitor;return e.canDrop?e.canDrop(n.getItem(),n):!0}hover(){const e=this.spec,n=this.monitor;e.hover&&e.hover(n.getItem(),n)}drop(){const e=this.spec,n=this.monitor;if(e.drop)return e.drop(n.getItem(),n)}constructor(e,n){this.spec=e,this.monitor=n}}function xU(t,e){const n=N.useMemo(()=>new AU(t,e),[e]);return N.useEffect(()=>{n.spec=t},[t]),n}function PU(t,e,n){const r=Va(),i=xU(t,e),s=CU(t);xa(function(){const[a,l]=lU(s,i,r);return e.receiveHandlerId(a),n.receiveHandlerId(a),l},[r,e,i,n,s.map(o=>o.toString()).join("|")])}function kU(t,e){const n=Rx(t,e),r=bU(),i=SU(n.options);return PU(n,r,i),[kx(n.collect,r,i),IU(i)]}function Ox(t){let e=null;return()=>(e==null&&(e=t()),e)}function RU(t,e){return t.filter(n=>n!==e)}function DU(t,e){const n=new Set,r=s=>n.add(s);t.forEach(r),e.forEach(r);const i=[];return n.forEach(s=>i.push(s)),i}class OU{enter(e){const n=this.entered.length,r=i=>this.isNodeInDocument(i)&&(!i.contains||i.contains(e));return this.entered=DU(this.entered.filter(r),[e]),n===0&&this.entered.length>0}leave(e){const n=this.entered.length;return this.entered=RU(this.entered.filter(this.isNodeInDocument),e),n>0&&this.entered.length===0}reset(){this.entered=[]}constructor(e){this.entered=[],this.isNodeInDocument=e}}class NU{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(e=>{Object.defineProperty(this.item,e,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${e}" until the drop event.`),null}})})}loadDataTransfer(e){if(e){const n={};Object.keys(this.config.exposeProperties).forEach(r=>{const i=this.config.exposeProperties[r];i!=null&&(n[r]={value:i(e,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,n)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(e,n){return n===e.getSourceId()}endDrag(){}constructor(e){this.config=e,this.item={},this.initializeExposedProperties()}}const Nx="__NATIVE_FILE__",Lx="__NATIVE_URL__",Mx="__NATIVE_TEXT__",Vx="__NATIVE_HTML__";var pT=Object.freeze({__proto__:null,FILE:Nx,HTML:Vx,TEXT:Mx,URL:Lx});function em(t,e,n){const r=e.reduce((i,s)=>i||t.getData(s),"");return r??n}const Fv={[Nx]:{exposeProperties:{files:t=>Array.prototype.slice.call(t.files),items:t=>t.items,dataTransfer:t=>t},matchesTypes:["Files"]},[Vx]:{exposeProperties:{html:(t,e)=>em(t,e,""),dataTransfer:t=>t},matchesTypes:["Html","text/html"]},[Lx]:{exposeProperties:{urls:(t,e)=>em(t,e,"").split(`
`),dataTransfer:t=>t},matchesTypes:["Url","text/uri-list"]},[Mx]:{exposeProperties:{text:(t,e)=>em(t,e,""),dataTransfer:t=>t},matchesTypes:["Text","text/plain"]}};function LU(t,e){const n=Fv[t];if(!n)throw new Error(`native type ${t} has no configuration`);const r=new NU(n);return r.loadDataTransfer(e),r}function tm(t){if(!t)return null;const e=Array.prototype.slice.call(t.types||[]);return Object.keys(Fv).filter(n=>{const r=Fv[n];return r!=null&&r.matchesTypes?r.matchesTypes.some(i=>e.indexOf(i)>-1):!1})[0]||null}const MU=Ox(()=>/firefox/i.test(navigator.userAgent)),jx=Ox(()=>!!window.safari);class gT{interpolate(e){const{xs:n,ys:r,c1s:i,c2s:s,c3s:o}=this;let a=n.length-1;if(e===n[a])return r[a];let l=0,u=o.length-1,d;for(;l<=u;){d=Math.floor(.5*(l+u));const w=n[d];if(w<e)l=d+1;else if(w>e)u=d-1;else return r[d]}a=Math.max(0,u);const p=e-n[a],m=p*p;return r[a]+i[a]*p+s[a]*m+o[a]*p*m}constructor(e,n){const{length:r}=e,i=[];for(let w=0;w<r;w++)i.push(w);i.sort((w,E)=>e[w]<e[E]?-1:1);const s=[],o=[];let a,l;for(let w=0;w<r-1;w++)a=e[w+1]-e[w],l=n[w+1]-n[w],s.push(a),o.push(l/a);const u=[o[0]];for(let w=0;w<s.length-1;w++){const E=o[w],x=o[w+1];if(E*x<=0)u.push(0);else{a=s[w];const D=s[w+1],A=a+D;u.push(3*A/((A+D)/E+(A+a)/x))}}u.push(o[o.length-1]);const d=[],p=[];let m;for(let w=0;w<u.length-1;w++){m=o[w];const E=u[w],x=1/s[w],D=E+u[w+1]-m-m;d.push((m-E-D)*x),p.push(D*x*x)}this.xs=e,this.ys=n,this.c1s=u,this.c2s=d,this.c3s=p}}const VU=1;function Fx(t){const e=t.nodeType===VU?t:t.parentElement;if(!e)return null;const{top:n,left:r}=e.getBoundingClientRect();return{x:r,y:n}}function Sd(t){return{x:t.clientX,y:t.clientY}}function jU(t){var e;return t.nodeName==="IMG"&&(MU()||!(!((e=document.documentElement)===null||e===void 0)&&e.contains(t)))}function FU(t,e,n,r){let i=t?e.width:n,s=t?e.height:r;return jx()&&t&&(s/=window.devicePixelRatio,i/=window.devicePixelRatio),{dragPreviewWidth:i,dragPreviewHeight:s}}function UU(t,e,n,r,i){const s=jU(e),a=Fx(s?t:e),l={x:n.x-a.x,y:n.y-a.y},{offsetWidth:u,offsetHeight:d}=t,{anchorX:p,anchorY:m}=r,{dragPreviewWidth:w,dragPreviewHeight:E}=FU(s,e,u,d),x=()=>{let W=new gT([0,.5,1],[l.y,l.y/d*E,l.y+E-d]).interpolate(m);return jx()&&s&&(W+=(window.devicePixelRatio-1)*E),W},D=()=>new gT([0,.5,1],[l.x,l.x/u*w,l.x+w-u]).interpolate(p),{offsetX:A,offsetY:T}=i,S=A===0||A,M=T===0||T;return{x:S?A:D(),y:M?T:x()}}let $U=class{get window(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}get document(){var e;return!((e=this.globalContext)===null||e===void 0)&&e.document?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var e;return((e=this.optionsArgs)===null||e===void 0?void 0:e.rootElement)||this.window}constructor(e,n){this.ownerDocument=null,this.globalContext=e,this.optionsArgs=n}};function zU(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mT(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),r.forEach(function(i){zU(t,i,n[i])})}return t}class BU{profile(){var e,n;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((e=this.dragStartSourceIds)===null||e===void 0?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((n=this.dragOverTargetIds)===null||n===void 0?void 0:n.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const e=this.rootElement;if(e!==void 0){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}teardown(){const e=this.rootElement;if(e!==void 0&&(e.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var n;(n=this.window)===null||n===void 0||n.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(e,n,r){return this.sourcePreviewNodeOptions.set(e,r),this.sourcePreviewNodes.set(e,n),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDragSource(e,n,r){this.sourceNodes.set(e,n),this.sourceNodeOptions.set(e,r);const i=o=>this.handleDragStart(o,e),s=o=>this.handleSelectStart(o);return n.setAttribute("draggable","true"),n.addEventListener("dragstart",i),n.addEventListener("selectstart",s),()=>{this.sourceNodes.delete(e),this.sourceNodeOptions.delete(e),n.removeEventListener("dragstart",i),n.removeEventListener("selectstart",s),n.setAttribute("draggable","false")}}connectDropTarget(e,n){const r=o=>this.handleDragEnter(o,e),i=o=>this.handleDragOver(o,e),s=o=>this.handleDrop(o,e);return n.addEventListener("dragenter",r),n.addEventListener("dragover",i),n.addEventListener("drop",s),()=>{n.removeEventListener("dragenter",r),n.removeEventListener("dragover",i),n.removeEventListener("drop",s)}}addEventListeners(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const e=this.monitor.getSourceId(),n=this.sourceNodeOptions.get(e);return mT({dropEffect:this.altKeyPressed?"copy":"move"},n||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const e=this.monitor.getSourceId(),n=this.sourcePreviewNodeOptions.get(e);return mT({anchorX:.5,anchorY:.5,captureDraggingState:!1},n||{})}isDraggingNativeItem(){const e=this.monitor.getItemType();return Object.keys(pT).some(n=>pT[n]===e)}beginDragNativeItem(e,n){this.clearCurrentDragSourceNode(),this.currentNativeSource=LU(e,n),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(e){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;const n=1e3;this.mouseMoveTimeoutTimer=setTimeout(()=>{var r;return(r=this.rootElement)===null||r===void 0?void 0:r.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},n)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var e;(e=this.window)===null||e===void 0||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(e,n){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(n))}handleDragEnter(e,n){this.dragEnterTargetIds.unshift(n)}handleDragOver(e,n){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(n)}handleDrop(e,n){this.dropTargetIds.unshift(n)}constructor(e,n,r){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=i=>{const s=this.sourceNodes.get(i);return s&&Fx(s)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=i=>!!(i&&this.document&&this.document.body&&this.document.body.contains(i)),this.endDragIfSourceWasRemovedFromDOM=()=>{const i=this.currentDragSourceNode;i==null||this.isNodeInDocument(i)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=i=>{this.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(i||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{this.hoverRafId!==null&&typeof cancelAnimationFrame<"u"&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=i=>{if(i.defaultPrevented)return;const{dragStartSourceIds:s}=this;this.dragStartSourceIds=null;const o=Sd(i);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(s||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:o});const{dataTransfer:a}=i,l=tm(a);if(this.monitor.isDragging()){if(a&&typeof a.setDragImage=="function"){const d=this.monitor.getSourceId(),p=this.sourceNodes.get(d),m=this.sourcePreviewNodes.get(d)||p;if(m){const{anchorX:w,anchorY:E,offsetX:x,offsetY:D}=this.getCurrentSourcePreviewNodeOptions(),S=UU(p,m,o,{anchorX:w,anchorY:E},{offsetX:x,offsetY:D});a.setDragImage(m,S.x,S.y)}}try{a==null||a.setData("application/json",{})}catch{}this.setCurrentDragSourceNode(i.target);const{captureDraggingState:u}=this.getCurrentSourcePreviewNodeOptions();u?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(l)this.beginDragNativeItem(l);else{if(a&&!a.types&&(i.target&&!i.target.hasAttribute||!i.target.hasAttribute("draggable")))return;i.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=i=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var s;(s=this.currentNativeSource)===null||s===void 0||s.loadDataTransfer(i.dataTransfer)}if(!this.enterLeaveCounter.enter(i.target)||this.monitor.isDragging())return;const{dataTransfer:a}=i,l=tm(a);l&&this.beginDragNativeItem(l,a)},this.handleTopDragEnter=i=>{const{dragEnterTargetIds:s}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=i.altKey,s.length>0&&this.actions.hover(s,{clientOffset:Sd(i)}),s.some(a=>this.monitor.canDropOnTarget(a))&&(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=i=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var s;(s=this.currentNativeSource)===null||s===void 0||s.loadDataTransfer(i.dataTransfer)}},this.handleTopDragOver=i=>{const{dragOverTargetIds:s}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect="none");return}this.altKeyPressed=i.altKey,this.lastClientOffset=Sd(i),this.scheduleHover(s),(s||[]).some(a=>this.monitor.canDropOnTarget(a))?(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?i.preventDefault():(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=i=>{this.isDraggingNativeItem()&&i.preventDefault(),this.enterLeaveCounter.leave(i.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=i=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var s;i.preventDefault(),(s=this.currentNativeSource)===null||s===void 0||s.loadDataTransfer(i.dataTransfer)}else tm(i.dataTransfer)&&i.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=i=>{const{dropTargetIds:s}=this;this.dropTargetIds=[],this.actions.hover(s,{clientOffset:Sd(i)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=i=>{const s=i.target;typeof s.dragDrop=="function"&&(s.tagName==="INPUT"||s.tagName==="SELECT"||s.tagName==="TEXTAREA"||s.isContentEditable||(i.preventDefault(),s.dragDrop()))},this.options=new $U(n,r),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new OU(this.isNodeInDocument)}}let bd;function qU(){return bd||(bd=new Image,bd.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),bd}const HU=function(e,n,r){return new BU(e,n,r)};function vT({isPremovedPiece:t=!1,piece:e,square:n,squares:r}){const{animationDuration:i,arePiecesDraggable:s,boardWidth:o,boardOrientation:a,chessPieces:l,currentPosition:u,deletePieceFromSquare:d,dropOffBoardAction:p,id:m,isDraggablePiece:w,isWaitingForAnimation:E,onPieceClick:x,onPieceDragBegin:D,onPieceDragEnd:A,onPieceDropOffBoard:T,onPromotionCheck:S,positionDifferences:M}=us(),[q,W]=N.useState({opacity:1,zIndex:5,touchAction:"none",cursor:s&&w({piece:e,sourceSquare:n})?"-webkit-grab":"default"}),[{canDrag:P,isDragging:C},R,O]=EU(()=>({type:"piece",item:()=>(D(e,n),{piece:e,square:n,id:m}),end:(V,k)=>{A(e,n),!k.didDrop()&&(p==="trash"&&d(n),T==null||T(n,e))},collect:V=>({canDrag:w({piece:e,sourceSquare:n}),isDragging:!!V.isDragging()})}),[e,n,u,m]);O(qU(),{captureDraggingState:!0}),N.useEffect(()=>{W(V=>Object.assign(Object.assign({},V),{opacity:C?0:1}))},[C]),N.useEffect(()=>{var V;const k=(V=M.removed)===null||V===void 0?void 0:V[n];if(!M.added||!k)return;const ge=Object.entries(M.added).find(([Te,Ie])=>Ie===k||S(n,Te,k));if(E&&k&&ge&&!t){const Te=n,Ie=ge[0];if(Te&&Ie){const Se=o/8;W(X=>Object.assign(Object.assign({},X),{transform:`translate(${(a==="black"?-1:1)*(Ie.charCodeAt(0)-Te.charCodeAt(0))*Se}px, ${(a==="black"?-1:1)*(Number(Te[1])-Number(Ie[1]))*Se}px)`,transition:`transform ${i}ms`,zIndex:6}))}}},[M]),N.useEffect(()=>{const{sourceSq:V}=L();V&&W(k=>Object.assign(Object.assign({},k),{transform:"translate(0px, 0px)",transition:"transform 0ms"}))},[u]),N.useEffect(()=>{W(V=>Object.assign(Object.assign({},V),{cursor:s&&w({piece:e,sourceSquare:n})?"-webkit-grab":"default"}))},[n,u,s]);function L(){return{sourceSq:r[n]}}return y.jsx("div",Object.assign({ref:s&&P?R:null,onClick:()=>x(e,n),"data-piece":e,style:q},{children:typeof l[e]=="function"?l[e]({squareWidth:o/8,isDragging:C,square:n}):y.jsx("svg",Object.assign({viewBox:"1 1 43 43",width:o/8,height:o/8,style:{display:"block"}},{children:y.jsx("g",{children:l[e]})}))}))}function WU({square:t,squareColor:e,setSquares:n,squareHasPremove:r,children:i}){const s=N.useRef(null),{autoPromoteToQueen:o,boardWidth:a,boardOrientation:l,clearArrows:u,currentPosition:d,currentRightClickDown:p,customBoardStyle:m,customDarkSquareStyle:w,customDropSquareStyle:E,customLightSquareStyle:x,customPremoveDarkSquareStyle:D,customPremoveLightSquareStyle:A,customSquare:T,customSquareStyles:S,drawNewArrow:M,handleSetPosition:q,handleSparePieceDrop:W,isWaitingForAnimation:P,lastPieceColour:C,lastSquareDraggedOver:R,onArrowDrawEnd:O,onDragOverSquare:L,onMouseOutSquare:V,onMouseOverSquare:k,onPieceDrop:ge,onPromotionCheck:Te,onRightClickDown:Ie,onRightClickUp:Se,onSquareClick:X,setLastSquareDraggedOver:ae,setPromoteFromSquare:z,setPromoteToSquare:Le,setShowPromoteDialog:Me}=us(),[{isOver:Be},ut]=kU(()=>({accept:"piece",drop:jt,collect:de=>({isOver:!!de.isOver()})}),[t,d,ge,P,C]);function jt(de){if(de.isSpare){W(de.piece,t);return}Te(de.square,t,de.piece)?o?q(de.square,t,de.piece[0]==="w"?"wQ":"bQ"):(z(de.square),Le(t),Me(!0)):q(de.square,t,de.piece,!0)}N.useEffect(()=>{if(s.current){const{x:de,y:se}=s.current.getBoundingClientRect();n(Wn=>Object.assign(Object.assign({},Wn),{[t]:{x:de,y:se}}))}},[a,l]);const nt=Object.assign(Object.assign(Object.assign(Object.assign({},KU(t,l,m)),e==="black"?w:x),r&&(e==="black"?D:A)),Be&&E);return y.jsx("div",Object.assign({ref:ut,style:nt,"data-square-color":e,"data-square":t,onTouchMove:de=>{var se;const Wn=de.touches[0],Kn=document.elementsFromPoint(Wn.clientX,Wn.clientY),At=(se=Kn==null?void 0:Kn.find(Kt=>Kt.getAttribute("data-square")))===null||se===void 0?void 0:se.getAttribute("data-square");At&&At!==R&&(ae(At),L(At))},onMouseOver:de=>{de.buttons===2&&p&&M(p,t),!(de.relatedTarget&&de.currentTarget.contains(de.relatedTarget))&&k(t)},onMouseOut:de=>{de.relatedTarget&&de.currentTarget.contains(de.relatedTarget)||V(t)},onMouseDown:de=>{de.button===2&&Ie(t)},onMouseUp:de=>{de.button===2&&(p&&O(p,t),Se(t))},onDragEnter:()=>L(t),onClick:()=>{const de=d[t];X(t,de),u()},onContextMenu:de=>{de.preventDefault()}},{children:typeof T=="string"?y.jsx(T,Object.assign({ref:s,style:Object.assign(Object.assign(Object.assign({},_T(a)),yT),!r&&(S==null?void 0:S[t]))},{children:i})):y.jsx(T,Object.assign({ref:s,square:t,squareColor:e,style:Object.assign(Object.assign(Object.assign({},_T(a)),yT),!r&&(S==null?void 0:S[t]))},{children:i}))}))}const yT={display:"flex",justifyContent:"center"},_T=t=>({width:t/8,height:t/8}),KU=(t,e,n)=>n!=null&&n.borderRadius?t==="a1"?e==="white"?{borderBottomLeftRadius:n.borderRadius}:{borderTopRightRadius:n.borderRadius}:t==="a8"?e==="white"?{borderTopLeftRadius:n.borderRadius}:{borderBottomRightRadius:n.borderRadius}:t==="h1"?e==="white"?{borderBottomRightRadius:n.borderRadius}:{borderTopLeftRadius:n.borderRadius}:t==="h8"?e==="white"?{borderTopRightRadius:n.borderRadius}:{borderBottomLeftRadius:n.borderRadius}:{}:{};function GU(){const[t,e]=N.useState({}),{arePremovesAllowed:n,boardOrientation:r,boardWidth:i,currentPosition:s,id:o,premoves:a,showBoardNotation:l}=us(),u=N.useMemo(()=>{const d=[];return n?(a.forEach((p,m)=>{const{sourceSq:w,targetSq:E,piece:x}=p,D=d.find(A=>{var T;return A.piece===x&&((T=A.premovesRoute.at(-1))===null||T===void 0?void 0:T.targetSq)===w});D?D.premovesRoute.push({sourceSq:w,targetSq:E,index:m}):d.push({piece:x,premovesRoute:[{sourceSq:w,targetSq:E,index:m}]})}),d):[]},[a]);return y.jsx("div",Object.assign({"data-boardid":o},{children:[...Array(8)].map((d,p)=>y.jsx("div",Object.assign({style:{display:"flex",flexWrap:"nowrap",width:i}},{children:[...Array(8)].map((m,w)=>{const E=r==="black"?sh[7-w]+(p+1):sh[w]+(8-p),x=w%2===p%2?"white":"black",D=a.find(T=>T.sourceSq===E||T.targetSq===E),A=u.filter(({premovesRoute:T})=>{var S;return((S=T.at(-1))===null||S===void 0?void 0:S.targetSq)===E}).sort((T,S)=>{var M,q;return((M=S.premovesRoute.at(-1))===null||M===void 0?void 0:M.index)-((q=T.premovesRoute.at(-1))===null||q===void 0?void 0:q.index)}).at(0);return y.jsxs(WU,Object.assign({square:E,squareColor:x,setSquares:e,squareHasPremove:!!D},{children:[!D&&s[E]&&y.jsx(vT,{piece:s[E],square:E,squares:t}),A&&y.jsx(vT,{isPremovedPiece:!0,piece:A.piece,square:E,squares:t}),l&&y.jsx(M4,{row:p,col:w})]}),`${w}${p}`)})}),p.toString()))}))}const QU=()=>{const{arrows:t,newArrow:e,boardOrientation:n,boardWidth:r,customArrowColor:i}=us(),s=[...t,e].filter(Boolean);return y.jsx("svg",Object.assign({width:r,height:r,style:{position:"absolute",top:"0",left:"0",pointerEvents:"none",zIndex:"10"}},{children:s.map((o,a)=>{const[l,u,d]=o;if(l===u)return null;const p=Nv(n,r,l),m=Nv(n,r,u);let w=r/32;const E=a===t.length;t.some(S=>S[0]!==l&&S[1]===u)&&!E&&(w=r/16);const x=m.x-p.x,D=m.y-p.y,A=Math.hypot(D,x),T={x:p.x+x*(A-w)/A,y:p.y+D*(A-w)/A};return y.jsxs(N.Fragment,{children:[y.jsx("marker",Object.assign({id:`arrowhead-${a}`,markerWidth:"2",markerHeight:"2.5",refX:"1.25",refY:"1.25",orient:"auto"},{children:y.jsx("polygon",{points:"0.3 0, 2 1.25, 0.3 2.5",fill:d??i})})),y.jsx("line",{x1:p.x,y1:p.y,x2:T.x,y2:T.y,opacity:E?"0.5":"0.65",stroke:d??i,strokeWidth:E?.9*r/40:r/40,markerEnd:`url(#arrowhead-${a})`})]},`${l}-${u}${E?"-active":""}`)})}))};function YU({option:t}){const[e,n]=N.useState(!1),{boardWidth:r,chessPieces:i,customDarkSquareStyle:s,customLightSquareStyle:o,handleSetPosition:a,onPromotionPieceSelect:l,promoteFromSquare:u,promoteToSquare:d,promotionDialogVariant:p}=us(),m=()=>{switch(t[1]){case"Q":return s.backgroundColor;case"R":return o.backgroundColor;case"N":return p==="default"?o.backgroundColor:s.backgroundColor;case"B":return p==="default"?s.backgroundColor:o.backgroundColor}};return y.jsx("div",Object.assign({onClick:()=>{l(t,u??void 0,d??void 0)&&a(u,d,t,!0)},onMouseOver:()=>n(!0),onMouseOut:()=>n(!1),"data-piece":t,style:{cursor:"pointer",backgroundColor:e?m():`${m()}aa`,borderRadius:"4px",transition:"all 0.1s ease-out"}},{children:typeof i[t]=="function"?y.jsx("div",Object.assign({style:{transition:"all 0.1s ease-out",transform:e?"scale(1)":"scale(0.85)"}},{children:i[t]({squareWidth:r/8,isDragging:!1})})):y.jsx("svg",Object.assign({viewBox:"1 1 43 43",width:r/8,height:r/8,style:{transition:"all 0.1s ease-out",transform:e?"scale(1)":"scale(0.85)"}},{children:y.jsx("g",{children:i[t]})}))}))}function XU(){const{boardOrientation:t,boardWidth:e,promotionDialogVariant:n,promoteToSquare:r}=us(),i=(r==null?void 0:r[1])==="1"?"b":"w",s=[`${i??"w"}Q`,`${i??"w"}R`,`${i??"w"}N`,`${i??"w"}B`],o={default:{display:"grid",gridTemplateColumns:"1fr 1fr",transform:`translate(${-e/8}px, ${-e/8}px)`},vertical:{transform:`translate(${-e/16}px, ${-e/16}px)`},modal:{display:"flex",justifyContent:"center",alignItems:"center",transform:`translate(0px, ${3*e/8}px)`,width:"100%",height:`${e/4}px`,top:0,backgroundColor:"white",left:0}},a=Nv(t,e,r||"a8");return y.jsx("div",Object.assign({style:Object.assign({position:"absolute",top:`${a==null?void 0:a.y}px`,left:`${a==null?void 0:a.x}px`,zIndex:1e3},o[n]),title:"Choose promotion piece"},{children:s.map(l=>y.jsx(YU,{option:l},l))}))}const JU={whiteKing:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",imageRendering:"crisp-edges"},viewBox:"0 0 4210 12970",x:"0px",y:"0px",fillRule:"evenodd",clipRule:"evenodd",width:"250",height:"250"},{children:y.jsx("g",{children:y.jsx("path",{style:{fill:"black",fillRule:"nonzero"},d:"M2105 0c169,0 286,160 249,315l200 0c-172,266 -231,479 -256,792 315,-24 530,-86 792,-255l0 897c-265,-171 -479,-231 -792,-256 18,234 75,495 185,682l339 0c233,0 369,269 225,456l545 0 -595 1916c130,94 158,275 59,402 465,0 416,568 51,568l-334 0 465 2867 332 0c250,0 381,306 199,485 162,63 273,220 273,399l0 633 168 0 0 475c-1403,0 -2807,0 -4210,0l0 -475 167 0 0 -633c0,-179 112,-336 274,-399 -181,-178 -52,-485 199,-485l332 0 465 -2867 -335 0c-353,0 -418,-568 51,-568 -98,-127 -70,-308 59,-402l-594 -1916c181,0 363,0 545,0 -144,-187 -9,-456 225,-456l339 0c110,-187 167,-448 185,-682 -315,25 -530,87 -793,256l0 -897c266,171 480,231 793,255 -25,-315 -87,-529 -256,-792l199 0c-36,-155 81,-315 250,-315zm-1994 10012l0 253 3988 0 0 -253c-1330,0 -2659,0 -3988,0zm484 -1060c-174,0 -316,142 -316,316l0 633 3652 0 0 -633c0,-174 -142,-316 -316,-316 -1007,0 -2013,0 -3020,0zm45 -457c-230,0 -225,345 0,345l2930 0c230,0 225,-345 0,-345 -977,0 -1953,0 -2930,0zm2020 -2978l-1111 0 -465 2867 2041 0 -465 -2867zm-1558 -456c-229,0 -224,345 0,345 669,0 1337,0 2005,0 230,0 225,-345 0,-345 -668,0 -1336,0 -2005,0zm1730 -457l-1454 0c-229,0 -224,345 0,345l1454 0c229,0 224,-345 0,-345zm-2064 -1862l544 1751c529,0 1057,0 1586,0l544 -1751c-892,0 -1783,0 -2674,0zm1085 -567l504 0c-126,-247 -163,-526 -177,-800 273,15 553,52 800,177l0 -504c-247,126 -527,163 -800,177 14,-273 51,-552 177,-799 -168,0 -336,0 -504,0 125,247 162,526 177,799 -274,-14 -553,-51 -800,-177l0 504c247,-125 527,-162 800,-177 -15,274 -52,553 -177,800zm969 111l-1434 0c-230,0 -225,345 0,345l1434 0c230,0 225,-345 0,-345zm-717 -2175c-105,0 -175,109 -133,204l266 0c42,-96 -30,-205 -133,-204z"})})}))};function ZU({children:t}){try{return y.jsx(y.Fragment,{children:t})}catch(e){return console.log(e),y.jsx(Ux,{showError:!0})}}function Ux({showError:t=!1}){return y.jsxs("div",Object.assign({style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},{children:[y.jsx("div",Object.assign({style:{width:250,height:250,transform:"rotate(90deg)"}},{children:JU.whiteKing})),t&&y.jsx("h1",{children:"Something went wrong"})]}))}function e6(){const t=N.useRef(null),{boardWidth:e,clearCurrentRightClickDown:n,onPromotionPieceSelect:r,setShowPromoteDialog:i,showPromoteDialog:s,customBoardStyle:o}=us();return N.useEffect(()=>{function a(l){t.current&&!t.current.contains(l.target)&&n()}return document.addEventListener("mouseup",a),()=>{document.removeEventListener("mouseup",a)}},[]),e?y.jsx("div",Object.assign({style:{perspective:"1000px"}},{children:y.jsxs("div",Object.assign({ref:t,style:Object.assign(Object.assign({position:"relative"},t6(e)),o)},{children:[y.jsx(GU,{}),y.jsx(QU,{}),s&&y.jsxs(y.Fragment,{children:[y.jsx("div",{onClick:()=>{i(!1),r==null||r()},style:{position:"absolute",top:"0",left:"0",zIndex:"100",backgroundColor:"rgba(22,21,18,.7)",width:e,height:e}}),y.jsx(XU,{})]})]}))})):y.jsx(Ux,{})}const t6=t=>({cursor:"default",height:t,width:t});var ho;(function(t){t.mouse="mouse",t.touch="touch",t.keyboard="keyboard"})(ho||(ho={}));class n6{get delay(){var e;return(e=this.args.delay)!==null&&e!==void 0?e:0}get scrollAngleRanges(){return this.args.scrollAngleRanges}get getDropTargetElementsAtPoint(){return this.args.getDropTargetElementsAtPoint}get ignoreContextMenu(){var e;return(e=this.args.ignoreContextMenu)!==null&&e!==void 0?e:!1}get enableHoverOutsideTarget(){var e;return(e=this.args.enableHoverOutsideTarget)!==null&&e!==void 0?e:!1}get enableKeyboardEvents(){var e;return(e=this.args.enableKeyboardEvents)!==null&&e!==void 0?e:!1}get enableMouseEvents(){var e;return(e=this.args.enableMouseEvents)!==null&&e!==void 0?e:!1}get enableTouchEvents(){var e;return(e=this.args.enableTouchEvents)!==null&&e!==void 0?e:!0}get touchSlop(){return this.args.touchSlop||0}get delayTouchStart(){var e,n,r,i;return(i=(r=(e=this.args)===null||e===void 0?void 0:e.delayTouchStart)!==null&&r!==void 0?r:(n=this.args)===null||n===void 0?void 0:n.delay)!==null&&i!==void 0?i:0}get delayMouseStart(){var e,n,r,i;return(i=(r=(e=this.args)===null||e===void 0?void 0:e.delayMouseStart)!==null&&r!==void 0?r:(n=this.args)===null||n===void 0?void 0:n.delay)!==null&&i!==void 0?i:0}get window(){if(this.context&&this.context.window)return this.context.window;if(typeof window<"u")return window}get document(){var e;if(!((e=this.context)===null||e===void 0)&&e.document)return this.context.document;if(this.window)return this.window.document}get rootElement(){var e;return((e=this.args)===null||e===void 0?void 0:e.rootElement)||this.document}constructor(e,n){this.args=e,this.context=n}}function r6(t,e,n,r){return Math.sqrt(Math.pow(Math.abs(n-t),2)+Math.pow(Math.abs(r-e),2))}function i6(t,e,n,r,i){if(!i)return!1;const s=Math.atan2(r-e,n-t)*180/Math.PI+180;for(let o=0;o<i.length;++o){const a=i[o];if(a&&(a.start==null||s>=a.start)&&(a.end==null||s<=a.end))return!0}return!1}const s6={Left:1},o6={Left:0};function nm(t){return t.button===void 0||t.button===o6.Left}function a6(t){return t.buttons===void 0||(t.buttons&s6.Left)===0}function $x(t){return!!t.targetTouches}const l6=1;function c6(t){const e=t.nodeType===l6?t:t.parentElement;if(!e)return;const{top:n,left:r}=e.getBoundingClientRect();return{x:r,y:n}}function u6(t,e){if(t.targetTouches.length===1)return Zf(t.targetTouches[0]);if(e&&t.touches.length===1&&t.touches[0].target===e.target)return Zf(t.touches[0])}function Zf(t,e){return $x(t)?u6(t,e):{x:t.clientX,y:t.clientY}}const wT=(()=>{let t=!1;try{addEventListener("test",()=>{},Object.defineProperty({},"passive",{get(){return t=!0,!0}}))}catch{}return t})(),Xc={[ho.mouse]:{start:"mousedown",move:"mousemove",end:"mouseup",contextmenu:"contextmenu"},[ho.touch]:{start:"touchstart",move:"touchmove",end:"touchend"},[ho.keyboard]:{keydown:"keydown"}};class Pu{profile(){var e;return{sourceNodes:this.sourceNodes.size,sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,targetNodes:this.targetNodes.size,dragOverTargetIds:((e=this.dragOverTargetIds)===null||e===void 0?void 0:e.length)||0}}get document(){return this.options.document}setup(){const e=this.options.rootElement;e&&(Ee(!Pu.isSetUp,"Cannot have two Touch backends at the same time."),Pu.isSetUp=!0,this.addEventListener(e,"start",this.getTopMoveStartHandler()),this.addEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.addEventListener(e,"move",this.handleTopMove),this.addEventListener(e,"move",this.handleTopMoveCapture,!0),this.addEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.addEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.addEventListener(e,"keydown",this.handleCancelOnEscape,!0))}teardown(){const e=this.options.rootElement;e&&(Pu.isSetUp=!1,this._mouseClientOffset={},this.removeEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.removeEventListener(e,"start",this.handleTopMoveStart),this.removeEventListener(e,"move",this.handleTopMoveCapture,!0),this.removeEventListener(e,"move",this.handleTopMove),this.removeEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.removeEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.removeEventListener(e,"keydown",this.handleCancelOnEscape,!0),this.uninstallSourceNodeRemovalObserver())}addEventListener(e,n,r,i=!1){const s=wT?{capture:i,passive:!1}:i;this.listenerTypes.forEach(function(o){const a=Xc[o][n];a&&e.addEventListener(a,r,s)})}removeEventListener(e,n,r,i=!1){const s=wT?{capture:i,passive:!1}:i;this.listenerTypes.forEach(function(o){const a=Xc[o][n];a&&e.removeEventListener(a,r,s)})}connectDragSource(e,n){const r=this.handleMoveStart.bind(this,e);return this.sourceNodes.set(e,n),this.addEventListener(n,"start",r),()=>{this.sourceNodes.delete(e),this.removeEventListener(n,"start",r)}}connectDragPreview(e,n,r){return this.sourcePreviewNodeOptions.set(e,r),this.sourcePreviewNodes.set(e,n),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDropTarget(e,n){const r=this.options.rootElement;if(!this.document||!r)return()=>{};const i=s=>{if(!this.document||!r||!this.monitor.isDragging())return;let o;switch(s.type){case Xc.mouse.move:o={x:s.clientX,y:s.clientY};break;case Xc.touch.move:var a,l;o={x:((a=s.touches[0])===null||a===void 0?void 0:a.clientX)||0,y:((l=s.touches[0])===null||l===void 0?void 0:l.clientY)||0};break}const u=o!=null?this.document.elementFromPoint(o.x,o.y):void 0,d=u&&n.contains(u);if(u===n||d)return this.handleMove(s,e)};return this.addEventListener(this.document.body,"move",i),this.targetNodes.set(e,n),()=>{this.document&&(this.targetNodes.delete(e),this.removeEventListener(this.document.body,"move",i))}}getTopMoveStartHandler(){return!this.options.delayTouchStart&&!this.options.delayMouseStart?this.handleTopMoveStart:this.handleTopMoveStartDelay}installSourceNodeRemovalObserver(e){this.uninstallSourceNodeRemovalObserver(),this.draggedSourceNode=e,this.draggedSourceNodeRemovalObserver=new MutationObserver(()=>{e&&!e.parentElement&&(this.resurrectSourceNode(),this.uninstallSourceNodeRemovalObserver())}),!(!e||!e.parentElement)&&this.draggedSourceNodeRemovalObserver.observe(e.parentElement,{childList:!0})}resurrectSourceNode(){this.document&&this.draggedSourceNode&&(this.draggedSourceNode.style.display="none",this.draggedSourceNode.removeAttribute("data-reactid"),this.document.body.appendChild(this.draggedSourceNode))}uninstallSourceNodeRemovalObserver(){this.draggedSourceNodeRemovalObserver&&this.draggedSourceNodeRemovalObserver.disconnect(),this.draggedSourceNodeRemovalObserver=void 0,this.draggedSourceNode=void 0}constructor(e,n,r){this.getSourceClientOffset=i=>{const s=this.sourceNodes.get(i);return s&&c6(s)},this.handleTopMoveStartCapture=i=>{nm(i)&&(this.moveStartSourceIds=[])},this.handleMoveStart=i=>{Array.isArray(this.moveStartSourceIds)&&this.moveStartSourceIds.unshift(i)},this.handleTopMoveStart=i=>{if(!nm(i))return;const s=Zf(i);s&&($x(i)&&(this.lastTargetTouchFallback=i.targetTouches[0]),this._mouseClientOffset=s),this.waitingForDelay=!1},this.handleTopMoveStartDelay=i=>{if(!nm(i))return;const s=i.type===Xc.touch.start?this.options.delayTouchStart:this.options.delayMouseStart;this.timeout=setTimeout(this.handleTopMoveStart.bind(this,i),s),this.waitingForDelay=!0},this.handleTopMoveCapture=()=>{this.dragOverTargetIds=[]},this.handleMove=(i,s)=>{this.dragOverTargetIds&&this.dragOverTargetIds.unshift(s)},this.handleTopMove=i=>{if(this.timeout&&clearTimeout(this.timeout),!this.document||this.waitingForDelay)return;const{moveStartSourceIds:s,dragOverTargetIds:o}=this,a=this.options.enableHoverOutsideTarget,l=Zf(i,this.lastTargetTouchFallback);if(!l)return;if(this._isScrolling||!this.monitor.isDragging()&&i6(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,l.x,l.y,this.options.scrollAngleRanges)){this._isScrolling=!0;return}if(!this.monitor.isDragging()&&this._mouseClientOffset.hasOwnProperty("x")&&s&&r6(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,l.x,l.y)>(this.options.touchSlop?this.options.touchSlop:0)&&(this.moveStartSourceIds=void 0,this.actions.beginDrag(s,{clientOffset:this._mouseClientOffset,getSourceClientOffset:this.getSourceClientOffset,publishSource:!1})),!this.monitor.isDragging())return;const u=this.sourceNodes.get(this.monitor.getSourceId());this.installSourceNodeRemovalObserver(u),this.actions.publishDragSource(),i.cancelable&&i.preventDefault();const d=(o||[]).map(E=>this.targetNodes.get(E)).filter(E=>!!E),p=this.options.getDropTargetElementsAtPoint?this.options.getDropTargetElementsAtPoint(l.x,l.y,d):this.document.elementsFromPoint(l.x,l.y),m=[];for(const E in p){if(!p.hasOwnProperty(E))continue;let x=p[E];for(x!=null&&m.push(x);x;)x=x.parentElement,x&&m.indexOf(x)===-1&&m.push(x)}const w=m.filter(E=>d.indexOf(E)>-1).map(E=>this._getDropTargetId(E)).filter(E=>!!E).filter((E,x,D)=>D.indexOf(E)===x);if(a)for(const E in this.targetNodes){const x=this.targetNodes.get(E);if(u&&x&&x.contains(u)&&w.indexOf(E)===-1){w.unshift(E);break}}w.reverse(),this.actions.hover(w,{clientOffset:l})},this._getDropTargetId=i=>{const s=this.targetNodes.keys();let o=s.next();for(;o.done===!1;){const a=o.value;if(i===this.targetNodes.get(a))return a;o=s.next()}},this.handleTopMoveEndCapture=i=>{if(this._isScrolling=!1,this.lastTargetTouchFallback=void 0,!!a6(i)){if(!this.monitor.isDragging()||this.monitor.didDrop()){this.moveStartSourceIds=void 0;return}i.cancelable&&i.preventDefault(),this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.drop(),this.actions.endDrag()}},this.handleCancelOnEscape=i=>{i.key==="Escape"&&this.monitor.isDragging()&&(this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.endDrag())},this.options=new n6(r,n),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.sourceNodes=new Map,this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.targetNodes=new Map,this.listenerTypes=[],this._mouseClientOffset={},this._isScrolling=!1,this.options.enableMouseEvents&&this.listenerTypes.push(ho.mouse),this.options.enableTouchEvents&&this.listenerTypes.push(ho.touch),this.options.enableKeyboardEvents&&this.listenerTypes.push(ho.keyboard)}}const h6=function(e,n={},r={}){return new Pu(e,n,r)},d6=N.createContext({isCustomDndProviderSet:!1}),f6=({children:t})=>y.jsx(y.Fragment,{children:t}),p6=({customDndBackend:t,customDndBackendOptions:e,children:n})=>{const[r,i]=N.useState(),[s,o]=N.useState(!1),[a,l]=N.useState(!1),{isCustomDndProviderSet:u}=N.useContext(d6);N.useEffect(()=>{l("ontouchstart"in window),o(!0),i(window)},[]);const d=u?f6:ZF;return s?r?y.jsx(d,Object.assign({backend:t||(a?h6:HU),context:r,options:t?e:void 0},{children:n})):y.jsx(y.Fragment,{children:n}):null};function g6({boardContainer:t}){const{boardWidth:e,chessPieces:n,id:r,snapToCursor:i,allowDragOutsideBoard:s}=us(),o=TU(m=>({item:m.getItem(),clientOffset:m.getClientOffset(),sourceClientOffset:m.getSourceClientOffset(),isDragging:m.isDragging()})),{isDragging:a,item:l,clientOffset:u,sourceClientOffset:d}=o,p=N.useCallback((m,w)=>{if(!m||!w)return{display:"none"};let{x:E,y:x}=i?m:w;const D=e/8/2;if(i&&(E-=D,x-=D),!s){const{left:T,top:S}=t,M=T-D,q=S-D,W=T+e-D,P=S+e-D;E=Math.max(M,Math.min(E,W)),x=Math.max(q,Math.min(x,P))}const A=`translate(${E}px, ${x}px)`;return{transform:A,WebkitTransform:A,touchAction:"none"}},[e,s,i,t]);return a&&l.id===r?y.jsx("div",Object.assign({style:{position:"fixed",pointerEvents:"none",zIndex:10,left:0,top:0}},{children:y.jsx("div",Object.assign({style:p(u,d)},{children:typeof n[l.piece]=="function"?n[l.piece]({squareWidth:e/8,isDragging:!0}):y.jsx("svg",Object.assign({viewBox:"1 1 43 43",width:e/8,height:e/8},{children:y.jsx("g",{children:n[l.piece]})}))}))})):null}const zx=N.forwardRef((t,e)=>{const{customDndBackend:n,customDndBackendOptions:r,onBoardWidthChange:i}=t,s=S4(t,["customDndBackend","customDndBackendOptions","onBoardWidthChange"]),[o,a]=N.useState(t.boardWidth),l=N.useRef(null),u=N.useRef(null),[d,p]=N.useState({left:0,top:0}),m=N.useMemo(()=>{var w;return(w=l.current)===null||w===void 0?void 0:w.getBoundingClientRect()},[l.current]);return N.useEffect(()=>{o&&(i==null||i(o))},[o]),N.useEffect(()=>{p({left:m!=null&&m.left?m==null?void 0:m.left:0,top:m!=null&&m.top?m==null?void 0:m.top:0})},[m]),N.useEffect(()=>{var w;if(t.boardWidth===void 0&&(!((w=l.current)===null||w===void 0)&&w.offsetWidth)){const E=new ResizeObserver(()=>{var x;a((x=l.current)===null||x===void 0?void 0:x.offsetWidth)});return E.observe(l.current),()=>{E.disconnect()}}},[l.current]),y.jsx(ZU,{children:y.jsxs("div",Object.assign({ref:u,style:{display:"flex",flexDirection:"column",width:"100%"}},{children:[y.jsx("div",{ref:l,style:{width:"100%"}}),y.jsx(p6,Object.assign({customDndBackend:n,customDndBackendOptions:r},{children:o&&y.jsxs(L4,Object.assign({boardWidth:o},s,{ref:e},{children:[y.jsx(g6,{boardContainer:d}),y.jsx(e6,{})]}))}))]}))})});/**
 * @license
 * Copyright (c) 2023, Jeff Hlywa (jhlywa@gmail.com)
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice,
 *    this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */const fn="w",Sr="b",Yt="p",Uv="n",nf="b",uu="r",Us="q",zt="k",rm="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",Fn=-1,m6={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},me={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},be={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},im={b:[16,32,17,15],w:[-16,-32,-17,-15]},ET={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},v6=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],y6=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],_6={p:1,n:2,b:4,r:8,q:16,k:32},w6="pnbrqkPNBRQK",TT=[Uv,nf,uu,Us],E6=7,T6=6,I6=1,S6=0,Cd={[zt]:me.KSIDE_CASTLE,[Us]:me.QSIDE_CASTLE},Ls={w:[{square:be.a1,flag:me.QSIDE_CASTLE},{square:be.h1,flag:me.KSIDE_CASTLE}],b:[{square:be.a8,flag:me.QSIDE_CASTLE},{square:be.h8,flag:me.KSIDE_CASTLE}]},b6={b:I6,w:T6},C6=["1-0","0-1","1/2-1/2","*"];function da(t){return t>>4}function oh(t){return t&15}function Bx(t){return"0123456789".indexOf(t)!==-1}function Zn(t){const e=oh(t),n=da(t);return"abcdefgh".substring(e,e+1)+"87654321".substring(n,n+1)}function Jc(t){return t===fn?Sr:fn}function A6(t){const e=t.split(/\s+/);if(e.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const n=parseInt(e[5],10);if(isNaN(n)||n<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const r=parseInt(e[4],10);if(isNaN(r)||r<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(e[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(e[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(e[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const i=e[0].split("/");if(i.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let o=0;o<i.length;o++){let a=0,l=!1;for(let u=0;u<i[o].length;u++)if(Bx(i[o][u])){if(l)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};a+=parseInt(i[o][u],10),l=!0}else{if(!/^[prnbqkPRNBQK]$/.test(i[o][u]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};a+=1,l=!1}if(a!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(e[3][1]=="3"&&e[1]=="w"||e[3][1]=="6"&&e[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const s=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:o,regex:a}of s){if(!a.test(e[0]))return{ok:!1,error:`Invalid FEN: missing ${o} king`};if((e[0].match(a)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${o} kings`}}return Array.from(i[0]+i[7]).some(o=>o.toUpperCase()==="P")?{ok:!1,error:"Invalid FEN: some pawns are on the edge rows"}:{ok:!0}}function x6(t,e){const n=t.from,r=t.to,i=t.piece;let s=0,o=0,a=0;for(let l=0,u=e.length;l<u;l++){const d=e[l].from,p=e[l].to,m=e[l].piece;i===m&&n!==d&&r===p&&(s++,da(n)===da(d)&&o++,oh(n)===oh(d)&&a++)}return s>0?o>0&&a>0?Zn(n):a>0?Zn(n).charAt(1):Zn(n).charAt(0):""}function Ms(t,e,n,r,i,s=void 0,o=me.NORMAL){const a=da(r);if(i===Yt&&(a===E6||a===S6))for(let l=0;l<TT.length;l++){const u=TT[l];t.push({color:e,from:n,to:r,piece:i,captured:s,promotion:u,flags:o|me.PROMOTION})}else t.push({color:e,from:n,to:r,piece:i,captured:s,flags:o})}function IT(t){let e=t.charAt(0);return e>="a"&&e<="h"?t.match(/[a-h]\d.*[a-h]\d/)?void 0:Yt:(e=e.toLowerCase(),e==="o"?zt:e)}function sm(t){return t.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function om(t){return t.split(" ").slice(0,4).join(" ")}class Ui{constructor(e=rm){Tr(this,"_board",new Array(128));Tr(this,"_turn",fn);Tr(this,"_header",{});Tr(this,"_kings",{w:Fn,b:Fn});Tr(this,"_epSquare",-1);Tr(this,"_halfMoves",0);Tr(this,"_moveNumber",0);Tr(this,"_history",[]);Tr(this,"_comments",{});Tr(this,"_castling",{w:0,b:0});Tr(this,"_positionCount",{});this.load(e)}clear({preserveHeaders:e=!1}={}){this._board=new Array(128),this._kings={w:Fn,b:Fn},this._turn=fn,this._castling={w:0,b:0},this._epSquare=Fn,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=e?this._header:{},this._positionCount={},delete this._header.SetUp,delete this._header.FEN}removeHeader(e){e in this._header&&delete this._header[e]}load(e,{skipValidation:n=!1,preserveHeaders:r=!1}={}){let i=e.split(/\s+/);if(i.length>=2&&i.length<6){const a=["-","-","0","1"];e=i.concat(a.slice(-(6-i.length))).join(" ")}if(i=e.split(/\s+/),!n){const{ok:a,error:l}=A6(e);if(!a)throw new Error(l)}const s=i[0];let o=0;this.clear({preserveHeaders:r});for(let a=0;a<s.length;a++){const l=s.charAt(a);if(l==="/")o+=8;else if(Bx(l))o+=parseInt(l,10);else{const u=l<"a"?fn:Sr;this._put({type:l.toLowerCase(),color:u},Zn(o)),o++}}this._turn=i[1],i[2].indexOf("K")>-1&&(this._castling.w|=me.KSIDE_CASTLE),i[2].indexOf("Q")>-1&&(this._castling.w|=me.QSIDE_CASTLE),i[2].indexOf("k")>-1&&(this._castling.b|=me.KSIDE_CASTLE),i[2].indexOf("q")>-1&&(this._castling.b|=me.QSIDE_CASTLE),this._epSquare=i[3]==="-"?Fn:be[i[3]],this._halfMoves=parseInt(i[4],10),this._moveNumber=parseInt(i[5],10),this._updateSetup(e),this._incPositionCount(e)}fen(){var s,o;let e=0,n="";for(let a=be.a8;a<=be.h1;a++){if(this._board[a]){e>0&&(n+=e,e=0);const{color:l,type:u}=this._board[a];n+=l===fn?u.toUpperCase():u.toLowerCase()}else e++;a+1&136&&(e>0&&(n+=e),a!==be.h1&&(n+="/"),e=0,a+=8)}let r="";this._castling[fn]&me.KSIDE_CASTLE&&(r+="K"),this._castling[fn]&me.QSIDE_CASTLE&&(r+="Q"),this._castling[Sr]&me.KSIDE_CASTLE&&(r+="k"),this._castling[Sr]&me.QSIDE_CASTLE&&(r+="q"),r=r||"-";let i="-";if(this._epSquare!==Fn){const a=this._epSquare+(this._turn===fn?16:-16),l=[a+1,a-1];for(const u of l){if(u&136)continue;const d=this._turn;if(((s=this._board[u])==null?void 0:s.color)===d&&((o=this._board[u])==null?void 0:o.type)===Yt){this._makeMove({color:d,from:u,to:this._epSquare,piece:Yt,captured:Yt,flags:me.EP_CAPTURE});const p=!this._isKingAttacked(d);if(this._undoMove(),p){i=Zn(this._epSquare);break}}}}return[n,this._turn,r,i,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(e){this._history.length>0||(e!==rm?(this._header.SetUp="1",this._header.FEN=e):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(rm)}get(e){return this._board[be[e]]||!1}put({type:e,color:n},r){return this._put({type:e,color:n},r)?(this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0):!1}_put({type:e,color:n},r){if(w6.indexOf(e.toLowerCase())===-1||!(r in be))return!1;const i=be[r];if(e==zt&&!(this._kings[n]==Fn||this._kings[n]==i))return!1;const s=this._board[i];return s&&s.type===zt&&(this._kings[s.color]=Fn),this._board[i]={type:e,color:n},e===zt&&(this._kings[n]=i),!0}remove(e){const n=this.get(e);return delete this._board[be[e]],n&&n.type===zt&&(this._kings[n.color]=Fn),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),n}_updateCastlingRights(){var r,i,s,o,a,l,u,d,p,m,w,E;const e=((r=this._board[be.e1])==null?void 0:r.type)===zt&&((i=this._board[be.e1])==null?void 0:i.color)===fn,n=((s=this._board[be.e8])==null?void 0:s.type)===zt&&((o=this._board[be.e8])==null?void 0:o.color)===Sr;(!e||((a=this._board[be.a1])==null?void 0:a.type)!==uu||((l=this._board[be.a1])==null?void 0:l.color)!==fn)&&(this._castling.w&=~me.QSIDE_CASTLE),(!e||((u=this._board[be.h1])==null?void 0:u.type)!==uu||((d=this._board[be.h1])==null?void 0:d.color)!==fn)&&(this._castling.w&=~me.KSIDE_CASTLE),(!n||((p=this._board[be.a8])==null?void 0:p.type)!==uu||((m=this._board[be.a8])==null?void 0:m.color)!==Sr)&&(this._castling.b&=~me.QSIDE_CASTLE),(!n||((w=this._board[be.h8])==null?void 0:w.type)!==uu||((E=this._board[be.h8])==null?void 0:E.color)!==Sr)&&(this._castling.b&=~me.KSIDE_CASTLE)}_updateEnPassantSquare(){var s,o;if(this._epSquare===Fn)return;const e=this._epSquare+(this._turn===fn?-16:16),n=this._epSquare+(this._turn===fn?16:-16),r=[n+1,n-1];if(this._board[e]!==null||this._board[this._epSquare]!==null||((s=this._board[n])==null?void 0:s.color)!==Jc(this._turn)||((o=this._board[n])==null?void 0:o.type)!==Yt){this._epSquare=Fn;return}const i=a=>{var l,u;return!(a&136)&&((l=this._board[a])==null?void 0:l.color)===this._turn&&((u=this._board[a])==null?void 0:u.type)===Yt};r.some(i)||(this._epSquare=Fn)}_attacked(e,n){for(let r=be.a8;r<=be.h1;r++){if(r&136){r+=7;continue}if(this._board[r]===void 0||this._board[r].color!==e)continue;const i=this._board[r],s=r-n;if(s===0)continue;const o=s+119;if(v6[o]&_6[i.type]){if(i.type===Yt){if(s>0){if(i.color===fn)return!0}else if(i.color===Sr)return!0;continue}if(i.type==="n"||i.type==="k")return!0;const a=y6[o];let l=r+a,u=!1;for(;l!==n;){if(this._board[l]!=null){u=!0;break}l+=a}if(!u)return!0}}return!1}_isKingAttacked(e){const n=this._kings[e];return n===-1?!1:this._attacked(Jc(e),n)}isAttacked(e,n){return this._attacked(n,be[e])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const e={b:0,n:0,r:0,q:0,k:0,p:0},n=[];let r=0,i=0;for(let s=be.a8;s<=be.h1;s++){if(i=(i+1)%2,s&136){s+=7;continue}const o=this._board[s];o&&(e[o.type]=o.type in e?e[o.type]+1:1,o.type===nf&&n.push(i),r++)}if(r===2)return!0;if(r===3&&(e[nf]===1||e[Uv]===1))return!0;if(r===e[nf]+2){let s=0;const o=n.length;for(let a=0;a<o;a++)s+=n[a];if(s===0||s===o)return!0}return!1}isThreefoldRepetition(){return this._getPositionCount(this.fen())>=3}isDraw(){return this._halfMoves>=100||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:e=!1,square:n=void 0,piece:r=void 0}={}){const i=this._moves({square:n,piece:r});return e?i.map(s=>this._makePretty(s)):i.map(s=>this._moveToSan(s,i))}_moves({legal:e=!0,piece:n=void 0,square:r=void 0}={}){var w;const i=r?r.toLowerCase():void 0,s=n==null?void 0:n.toLowerCase(),o=[],a=this._turn,l=Jc(a);let u=be.a8,d=be.h1,p=!1;if(i)if(i in be)u=d=be[i],p=!0;else return[];for(let E=u;E<=d;E++){if(E&136){E+=7;continue}if(!this._board[E]||this._board[E].color===l)continue;const{type:x}=this._board[E];let D;if(x===Yt){if(s&&s!==x)continue;D=E+im[a][0],this._board[D]||(Ms(o,a,E,D,Yt),D=E+im[a][1],b6[a]===da(E)&&!this._board[D]&&Ms(o,a,E,D,Yt,void 0,me.BIG_PAWN));for(let A=2;A<4;A++)D=E+im[a][A],!(D&136)&&(((w=this._board[D])==null?void 0:w.color)===l?Ms(o,a,E,D,Yt,this._board[D].type,me.CAPTURE):D===this._epSquare&&Ms(o,a,E,D,Yt,Yt,me.EP_CAPTURE))}else{if(s&&s!==x)continue;for(let A=0,T=ET[x].length;A<T;A++){const S=ET[x][A];for(D=E;D+=S,!(D&136);){if(!this._board[D])Ms(o,a,E,D,x);else{if(this._board[D].color===a)break;Ms(o,a,E,D,x,this._board[D].type,me.CAPTURE);break}if(x===Uv||x===zt)break}}}}if((s===void 0||s===zt)&&(!p||d===this._kings[a])){if(this._castling[a]&me.KSIDE_CASTLE){const E=this._kings[a],x=E+2;!this._board[E+1]&&!this._board[x]&&!this._attacked(l,this._kings[a])&&!this._attacked(l,E+1)&&!this._attacked(l,x)&&Ms(o,a,this._kings[a],x,zt,void 0,me.KSIDE_CASTLE)}if(this._castling[a]&me.QSIDE_CASTLE){const E=this._kings[a],x=E-2;!this._board[E-1]&&!this._board[E-2]&&!this._board[E-3]&&!this._attacked(l,this._kings[a])&&!this._attacked(l,E-1)&&!this._attacked(l,x)&&Ms(o,a,this._kings[a],x,zt,void 0,me.QSIDE_CASTLE)}}if(!e||this._kings[a]===-1)return o;const m=[];for(let E=0,x=o.length;E<x;E++)this._makeMove(o[E]),this._isKingAttacked(a)||m.push(o[E]),this._undoMove();return m}move(e,{strict:n=!1}={}){let r=null;if(typeof e=="string")r=this._moveFromSan(e,n);else if(typeof e=="object"){const s=this._moves();for(let o=0,a=s.length;o<a;o++)if(e.from===Zn(s[o].from)&&e.to===Zn(s[o].to)&&(!("promotion"in s[o])||e.promotion===s[o].promotion)){r=s[o];break}}if(!r)throw typeof e=="string"?new Error(`Invalid move: ${e}`):new Error(`Invalid move: ${JSON.stringify(e)}`);const i=this._makePretty(r);return this._makeMove(r),this._incPositionCount(i.after),i}_push(e){this._history.push({move:e,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(e){const n=this._turn,r=Jc(n);if(this._push(e),this._board[e.to]=this._board[e.from],delete this._board[e.from],e.flags&me.EP_CAPTURE&&(this._turn===Sr?delete this._board[e.to-16]:delete this._board[e.to+16]),e.promotion&&(this._board[e.to]={type:e.promotion,color:n}),this._board[e.to].type===zt){if(this._kings[n]=e.to,e.flags&me.KSIDE_CASTLE){const i=e.to-1,s=e.to+1;this._board[i]=this._board[s],delete this._board[s]}else if(e.flags&me.QSIDE_CASTLE){const i=e.to+1,s=e.to-2;this._board[i]=this._board[s],delete this._board[s]}this._castling[n]=0}if(this._castling[n]){for(let i=0,s=Ls[n].length;i<s;i++)if(e.from===Ls[n][i].square&&this._castling[n]&Ls[n][i].flag){this._castling[n]^=Ls[n][i].flag;break}}if(this._castling[r]){for(let i=0,s=Ls[r].length;i<s;i++)if(e.to===Ls[r][i].square&&this._castling[r]&Ls[r][i].flag){this._castling[r]^=Ls[r][i].flag;break}}e.flags&me.BIG_PAWN?n===Sr?this._epSquare=e.to-16:this._epSquare=e.to+16:this._epSquare=Fn,e.piece===Yt?this._halfMoves=0:e.flags&(me.CAPTURE|me.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,n===Sr&&this._moveNumber++,this._turn=r}undo(){const e=this._undoMove();if(e){const n=this._makePretty(e);return this._decPositionCount(n.after),n}return null}_undoMove(){const e=this._history.pop();if(e===void 0)return null;const n=e.move;this._kings=e.kings,this._turn=e.turn,this._castling=e.castling,this._epSquare=e.epSquare,this._halfMoves=e.halfMoves,this._moveNumber=e.moveNumber;const r=this._turn,i=Jc(r);if(this._board[n.from]=this._board[n.to],this._board[n.from].type=n.piece,delete this._board[n.to],n.captured)if(n.flags&me.EP_CAPTURE){let s;r===Sr?s=n.to-16:s=n.to+16,this._board[s]={type:Yt,color:i}}else this._board[n.to]={type:n.captured,color:i};if(n.flags&(me.KSIDE_CASTLE|me.QSIDE_CASTLE)){let s,o;n.flags&me.KSIDE_CASTLE?(s=n.to+1,o=n.to-1):(s=n.to-2,o=n.to+1),this._board[s]=this._board[o],delete this._board[o]}return n}pgn({newline:e=`
`,maxWidth:n=0}={}){const r=[];let i=!1;for(const m in this._header)r.push("["+m+' "'+this._header[m]+'"]'+e),i=!0;i&&this._history.length&&r.push(e);const s=m=>{const w=this._comments[this.fen()];if(typeof w<"u"){const E=m.length>0?" ":"";m=`${m}${E}{${w}}`}return m},o=[];for(;this._history.length>0;)o.push(this._undoMove());const a=[];let l="";for(o.length===0&&a.push(s(""));o.length>0;){l=s(l);const m=o.pop();if(!m)break;if(!this._history.length&&m.color==="b"){const w=`${this._moveNumber}. ...`;l=l?`${l} ${w}`:w}else m.color==="w"&&(l.length&&a.push(l),l=this._moveNumber+".");l=l+" "+this._moveToSan(m,this._moves({legal:!0})),this._makeMove(m)}if(l.length&&a.push(s(l)),typeof this._header.Result<"u"&&a.push(this._header.Result),n===0)return r.join("")+a.join(" ");const u=function(){return r.length>0&&r[r.length-1]===" "?(r.pop(),!0):!1},d=function(m,w){for(const E of w.split(" "))if(E){if(m+E.length>n){for(;u();)m--;r.push(e),m=0}r.push(E),m+=E.length,r.push(" "),m++}return u()&&m--,m};let p=0;for(let m=0;m<a.length;m++){if(p+a[m].length>n&&a[m].includes("{")){p=d(p,a[m]);continue}p+a[m].length>n&&m!==0?(r[r.length-1]===" "&&r.pop(),r.push(e),p=0):m!==0&&(r.push(" "),p++),r.push(a[m]),p+=a[m].length}return r.join("")}header(...e){for(let n=0;n<e.length;n+=2)typeof e[n]=="string"&&typeof e[n+1]=="string"&&(this._header[e[n]]=e[n+1]);return this._header}loadPgn(e,{strict:n=!1,newlineChar:r=`\r?
`}={}){function i(S){return S.replace(/\\/g,"\\")}function s(S){const M={},q=S.split(new RegExp(i(r)));let W="",P="";for(let C=0;C<q.length;C++){const R=/^\s*\[\s*([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;W=q[C].replace(R,"$1"),P=q[C].replace(R,"$2"),W.trim().length>0&&(M[W]=P)}return M}e=e.trim();const a=new RegExp("^(\\[((?:"+i(r)+")|.)*\\])((?:\\s*"+i(r)+"){2}|(?:\\s*"+i(r)+")*$)").exec(e),l=a&&a.length>=2?a[1]:"";this.reset();const u=s(l);let d="";for(const S in u)S.toLowerCase()==="fen"&&(d=u[S]),this.header(S,u[S]);if(!n)d&&this.load(d,{preserveHeaders:!0});else if(u.SetUp==="1"){if(!("FEN"in u))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(u.FEN,{preserveHeaders:!0})}function p(S){return Array.from(S).map(function(M){return M.charCodeAt(0)<128?M.charCodeAt(0).toString(16):encodeURIComponent(M).replace(/%/g,"").toLowerCase()}).join("")}function m(S){return S.length==0?"":decodeURIComponent("%"+(S.match(/.{1,2}/g)||[]).join("%"))}const w=function(S){return S=S.replace(new RegExp(i(r),"g")," "),`{${p(S.slice(1,S.length-1))}}`},E=function(S){if(S.startsWith("{")&&S.endsWith("}"))return m(S.slice(1,S.length-1))};let x=e.replace(l,"").replace(new RegExp(`({[^}]*})+?|;([^${i(r)}]*)`,"g"),function(S,M,q){return M!==void 0?w(M):" "+w(`{${q.slice(1)}}`)}).replace(new RegExp(i(r),"g")," ");const D=/(\([^()]+\))+?/g;for(;D.test(x);)x=x.replace(D,"");x=x.replace(/\d+\.(\.\.)?/g,""),x=x.replace(/\.\.\./g,""),x=x.replace(/\$\d+/g,"");let A=x.trim().split(new RegExp(/\s+/));A=A.filter(S=>S!=="");let T="";for(let S=0;S<A.length;S++){const M=E(A[S]);if(M!==void 0){this._comments[this.fen()]=M;continue}const q=this._moveFromSan(A[S],n);if(q==null)if(C6.indexOf(A[S])>-1)T=A[S];else throw new Error(`Invalid move in PGN: ${A[S]}`);else T="",this._makeMove(q),this._incPositionCount(this.fen())}T&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",T)}_moveToSan(e,n){let r="";if(e.flags&me.KSIDE_CASTLE)r="O-O";else if(e.flags&me.QSIDE_CASTLE)r="O-O-O";else{if(e.piece!==Yt){const i=x6(e,n);r+=e.piece.toUpperCase()+i}e.flags&(me.CAPTURE|me.EP_CAPTURE)&&(e.piece===Yt&&(r+=Zn(e.from)[0]),r+="x"),r+=Zn(e.to),e.promotion&&(r+="="+e.promotion.toUpperCase())}return this._makeMove(e),this.isCheck()&&(this.isCheckmate()?r+="#":r+="+"),this._undoMove(),r}_moveFromSan(e,n=!1){const r=sm(e);let i=IT(r),s=this._moves({legal:!0,piece:i});for(let m=0,w=s.length;m<w;m++)if(r===sm(this._moveToSan(s[m],s)))return s[m];if(n)return null;let o,a,l,u,d,p=!1;if(a=r.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),a?(o=a[1],l=a[2],u=a[3],d=a[4],l.length==1&&(p=!0)):(a=r.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),a&&(o=a[1],l=a[2],u=a[3],d=a[4],l.length==1&&(p=!0))),i=IT(r),s=this._moves({legal:!0,piece:o||i}),!u)return null;for(let m=0,w=s.length;m<w;m++)if(l){if((!o||o.toLowerCase()==s[m].piece)&&be[l]==s[m].from&&be[u]==s[m].to&&(!d||d.toLowerCase()==s[m].promotion))return s[m];if(p){const E=Zn(s[m].from);if((!o||o.toLowerCase()==s[m].piece)&&be[u]==s[m].to&&(l==E[0]||l==E[1])&&(!d||d.toLowerCase()==s[m].promotion))return s[m]}}else if(r===sm(this._moveToSan(s[m],s)).replace("x",""))return s[m];return null}ascii(){let e=`   +------------------------+
`;for(let n=be.a8;n<=be.h1;n++){if(oh(n)===0&&(e+=" "+"87654321"[da(n)]+" |"),this._board[n]){const r=this._board[n].type,s=this._board[n].color===fn?r.toUpperCase():r.toLowerCase();e+=" "+s+" "}else e+=" . ";n+1&136&&(e+=`|
`,n+=8)}return e+=`   +------------------------+
`,e+="     a  b  c  d  e  f  g  h",e}perft(e){const n=this._moves({legal:!1});let r=0;const i=this._turn;for(let s=0,o=n.length;s<o;s++)this._makeMove(n[s]),this._isKingAttacked(i)||(e-1>0?r+=this.perft(e-1):r++),this._undoMove();return r}_makePretty(e){const{color:n,piece:r,from:i,to:s,flags:o,captured:a,promotion:l}=e;let u="";for(const w in me)me[w]&o&&(u+=m6[w]);const d=Zn(i),p=Zn(s),m={color:n,piece:r,from:d,to:p,san:this._moveToSan(e,this._moves({legal:!0})),flags:u,lan:d+p,before:this.fen(),after:""};return this._makeMove(e),m.after=this.fen(),this._undoMove(),a&&(m.captured=a),l&&(m.promotion=l,m.lan+=l),m}turn(){return this._turn}board(){const e=[];let n=[];for(let r=be.a8;r<=be.h1;r++)this._board[r]==null?n.push(null):n.push({square:Zn(r),type:this._board[r].type,color:this._board[r].color}),r+1&136&&(e.push(n),n=[],r+=8);return e}squareColor(e){if(e in be){const n=be[e];return(da(n)+oh(n))%2===0?"light":"dark"}return null}history({verbose:e=!1}={}){const n=[],r=[];for(;this._history.length>0;)n.push(this._undoMove());for(;;){const i=n.pop();if(!i)break;e?r.push(this._makePretty(i)):r.push(this._moveToSan(i,this._moves())),this._makeMove(i)}return r}_getPositionCount(e){const n=om(e);return this._positionCount[n]||0}_incPositionCount(e){const n=om(e);this._positionCount[n]===void 0&&(this._positionCount[n]=0),this._positionCount[n]+=1}_decPositionCount(e){const n=om(e);this._positionCount[n]===1?delete this._positionCount[n]:this._positionCount[n]-=1}_pruneComments(){const e=[],n={},r=i=>{i in this._comments&&(n[i]=this._comments[i])};for(;this._history.length>0;)e.push(this._undoMove());for(r(this.fen());;){const i=e.pop();if(!i)break;this._makeMove(i),r(this.fen())}this._comments=n}getComment(){return this._comments[this.fen()]}setComment(e){this._comments[this.fen()]=e.replace("{","[").replace("}","]")}deleteComment(){const e=this._comments[this.fen()];return delete this._comments[this.fen()],e}getComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>({fen:e,comment:this._comments[e]}))}deleteComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>{const n=this._comments[e];return delete this._comments[e],{fen:e,comment:n}})}setCastlingRights(e,n){for(const i of[zt,Us])n[i]!==void 0&&(n[i]?this._castling[e]|=Cd[i]:this._castling[e]&=~Cd[i]);this._updateCastlingRights();const r=this.getCastlingRights(e);return(n[zt]===void 0||n[zt]===r[zt])&&(n[Us]===void 0||n[Us]===r[Us])}getCastlingRights(e){return{[zt]:(this._castling[e]&Cd[zt])!==0,[Us]:(this._castling[e]&Cd[Us])!==0}}moveNumber(){return this._moveNumber}}const ep=({timeInMinutes:t,increment:e,isActive:n,color:r,onTimeout:i,onTimeUpdate:s,remainingTime:o})=>{const[a,l]=N.useState(o);N.useEffect(()=>{l(o)},[o]),N.useEffect(()=>{let p;return n&&a>0&&(p=setInterval(()=>{l(m=>{const w=m-1;return s(w),w<=0&&i(),w})},1e3)),()=>{p&&clearInterval(p)}},[n,a,i,s]);const u=()=>{const p=["game-clock"];return n&&p.push("active"),a<30&&p.push("warning"),p.join(" ")},d=p=>{const m=Math.floor(p/60),w=p%60;return`${m}:${w.toString().padStart(2,"0")}`};return y.jsx("div",{className:u(),children:d(a)})},hu=({isPuzzle:t=!1,timeControl:e})=>{const[n,r]=N.useState(null),[i,s]=N.useState(null),[o,a]=N.useState("Cargando puzzle..."),[l,u]=N.useState(0),[d,p]=N.useState("white");N.useEffect(()=>{let E=!0,x=!1;return t&&(async()=>{try{if(n||i||x)return;x=!0;const A=await fetch("https://lichess.org/api/puzzle/daily");if(!A.ok)throw new Error("Error al cargar el puzzle");const T=await A.json(),S=new Ui;try{S.loadPgn(T.game.pgn);const M=S.history();console.log("Movimientos totales:",M.length),console.log("Initial Ply:",T.puzzle.initialPly),console.log("Moves:",M),S.reset();for(let P=0;P<T.puzzle.initialPly;P++)S.move(M[P]);const q=S.fen(),W=M[T.puzzle.initialPly];if(console.log("Siguiente movimiento:",W),!W){console.error("No se encontr el siguiente movimiento"),E&&a("Error al cargar el puzzle. Intenta recargar la pgina.");return}E&&(s({fen:q,moves:T.puzzle.solution,rating:T.puzzle.rating,themes:T.puzzle.themes}),r(new Ui(q)),a("Observa el movimiento del oponente..."),setTimeout(()=>{if(!E)return;const P=new Ui(q);try{if(console.log("Intentando mover:",W),!P.move(W))throw new Error(`Movimiento invlido: ${W}`);r(P),a("Tu turno - Encuentra el mejor movimiento")}catch(C){console.error("Error al realizar el movimiento:",C),a("Error al cargar el puzzle. Intenta recargar la pgina.")}},1e3))}catch(M){console.error("Error al procesar el puzzle:",M),E&&a("Error al cargar el puzzle. Intenta recargar la pgina.")}}catch(A){console.error("Error al obtener el puzzle:",A),E&&a("Error al cargar el puzzle. Intenta recargar la pgina.")}})(),()=>{E=!1}},[t]);function m(E){return E.includes("O-O-O")?{from:"e1",to:"c1"}:E.includes("O-O")?{from:"e1",to:"g1"}:{from:E.slice(0,2),to:E.slice(2,4),promotion:E.length===5?E[4]:void 0}}function w(E){if(!n||!i)return!1;try{const x=new Ui(n.fen());if(x.move(E)){const A=i.moves[l],T=m(A),S=x.fen().split(" ")[0],M=new Ui(n.fen()),W=M.move(T)?M.fen().split(" ")[0]:"";if(S===W)return r(x),l===i.moves.length-1?(a("Felicidades!  Has resuelto el puzzle correctamente."),!0):(u(l+1),setTimeout(()=>{if(l+1<i.moves.length){const P=i.moves[l+1],C=P.slice(0,2),R=P.slice(2,4);x.move({from:C,to:R,promotion:P.length===5?P[4]:void 0})&&(r(new Ui(x.fen())),u(l+2),a("Tu turno"))}},500),!0)}return a("Movimiento incorrecto. Intenta de nuevo."),!1}catch(x){return console.error("Error en makeAMove:",x),!1}}return y.jsxs("div",{className:"board-container",children:[e&&y.jsx(ep,{timeInMinutes:e.time,increment:e.increment,isActive:d==="black",color:"black",onTimeout:async()=>{},onTimeUpdate:E=>{},remainingTime:e.time*60}),n&&y.jsx(zx,{position:n.fen(),boardOrientation:"white",onPieceDrop:(E,x)=>{const D=w({from:E,to:x,promotion:"q"});return D&&p(n.turn()==="w"?"white":"black"),D}}),e&&y.jsx(ep,{timeInMinutes:e.time,increment:e.increment,isActive:d==="white",color:"white",onTimeout:async()=>{},onTimeUpdate:E=>{},remainingTime:e.time*60}),o&&y.jsx("div",{className:"puzzle-message",style:{marginTop:"1rem",padding:"1rem",backgroundColor:i&&l===i.moves.length-1?"#e6ffe6":"#fff",border:"1px solid #ccc",borderRadius:"4px"},children:o})]})};class xl{constructor(){this.cache=new Map}static getInstance(){return xl.instance||(xl.instance=new xl),xl.instance}set(e,n,r=5*60*1e3){this.cache.set(e,{value:n,timestamp:Date.now(),expiresIn:r})}get(e){const n=this.cache.get(e);return n?Date.now()-n.timestamp>n.expiresIn?(this.cache.delete(e),null):n.value:null}clear(){this.cache.clear()}}const qx=N.createContext({currentUser:null,userData:null,loading:!0,refreshUserData:async()=>{}}),P6=()=>N.useContext(qx),k6=({children:t})=>{const[e,n]=N.useState(null),[r,i]=N.useState(null),[s,o]=N.useState(!0),a=xl.getInstance(),l=async p=>{const m=a.get(`userData_${p}`);if(m)return m;const w=await yi(dt(at,"users",p));if(w.exists()){const E=w.data();return a.set(`userData_${p}`,E,5*60*1e3),E}return null},u=async()=>{if(e){const p=await l(e.uid);i(p)}};N.useEffect(()=>{const p=lt.onAuthStateChanged(async m=>{if(n(m),m){const w=await l(m.uid);i(w)}else i(null),a.clear();o(!1)});return()=>p()},[]);const d={currentUser:e,userData:r,loading:s,refreshUserData:u};return y.jsx(qx.Provider,{value:d,children:!s&&t})},Sh=N.memo(()=>{console.log("Renderizando Header");const{currentUser:t}=P6(),e=async()=>{try{await SL(lt)}catch(n){console.error("Error al cerrar sesin:",n)}};return y.jsxs("header",{className:"main-header",children:[y.jsxs(sr,{to:"/",className:"logo",children:[y.jsx("i",{className:"fas fa-chess-knight logo-icon"}),y.jsxs("div",{className:"logo-text",children:[y.jsx("span",{className:"logo-chess",children:"CHESS"}),y.jsx("span",{className:"logo-match",children:"MATCH"})]})]}),y.jsx("div",{className:"auth-buttons",children:t?y.jsxs("button",{onClick:e,className:"btn-logout",children:[y.jsx("i",{className:"fas fa-sign-out-alt"}),"Cerrar sesin"]}):y.jsxs(y.Fragment,{children:[y.jsx(sr,{to:"/register",className:"btn-signup",children:"Registrarse"}),y.jsx(sr,{to:"/login",className:"btn-login",children:"Iniciar sesin"})]})})]})}),ST=()=>(N.useEffect(()=>{console.log("Home montado");const t=document.querySelectorAll(".game-button");console.log("Botones encontrados:",t.length)},[]),console.log("Renderizando componente Home"),console.log("Estilos cargados:",document.styleSheets),y.jsxs("div",{className:"page-container",children:[y.jsx(Sh,{}),y.jsx("div",{className:"home-container",children:y.jsxs("div",{className:"game-options",children:[y.jsx("h1",{children:"Play Chess Online on the #1 Site!"}),y.jsxs("div",{className:"stats",children:[y.jsx("span",{className:"games-today",children:"13,562,492 Games Today"}),y.jsx("span",{className:"playing-now",children:"118,172 Playing Now"})]}),y.jsxs("div",{className:"game-buttons",children:[y.jsxs(sr,{to:"/play/online",className:"game-button primary",children:[y.jsx("span",{className:"icon",children:""}),y.jsxs("div",{className:"button-content",children:[y.jsx("h3",{children:"Play Online"}),y.jsx("p",{children:"Play with someone at your level"})]})]}),y.jsxs(sr,{to:"/play/computer",className:"game-button",children:[y.jsx("span",{className:"icon",children:""}),y.jsxs("div",{className:"button-content",children:[y.jsx("h3",{children:"Play Computer"}),y.jsx("p",{children:"Play vs customizable training bots"})]})]})]}),y.jsxs("div",{className:"puzzle-section",children:[y.jsx("h2",{children:"Solve Chess Puzzles"}),y.jsx("div",{className:"mini-board",children:y.jsx(hu,{isPuzzle:!0})}),y.jsx("div",{className:"quote",children:y.jsxs("p",{children:['"En Ajedrez, el vencedor es quien hace la siguiente jugada al ltimo error." ',y.jsx("br",{})," GM S. Tartakower"]})}),y.jsx("button",{className:"game-button",children:"Solve Puzzles"})]}),y.jsx("button",{className:"game-button chess-today",children:"Chess Today"})]})})]}));let R6={data:""},D6=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||R6,O6=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,N6=/\/\*[^]*?\*\/|  +/g,bT=/\n+/g,Ks=(t,e)=>{let n="",r="",i="";for(let s in t){let o=t[s];s[0]=="@"?s[1]=="i"?n=s+" "+o+";":r+=s[1]=="f"?Ks(o,s):s+"{"+Ks(o,s[1]=="k"?"":e)+"}":typeof o=="object"?r+=Ks(o,e?e.replace(/([^,])+/g,a=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,a):a?a+" "+l:l)):s):o!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=Ks.p?Ks.p(s,o):s+":"+o+";")}return n+(e&&i?e+"{"+i+"}":i)+r},Vi={},Hx=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+Hx(t[n]);return e}return t},L6=(t,e,n,r,i)=>{let s=Hx(t),o=Vi[s]||(Vi[s]=(l=>{let u=0,d=11;for(;u<l.length;)d=101*d+l.charCodeAt(u++)>>>0;return"go"+d})(s));if(!Vi[o]){let l=s!==t?t:(u=>{let d,p,m=[{}];for(;d=O6.exec(u.replace(N6,""));)d[4]?m.shift():d[3]?(p=d[3].replace(bT," ").trim(),m.unshift(m[0][p]=m[0][p]||{})):m[0][d[1]]=d[2].replace(bT," ").trim();return m[0]})(t);Vi[o]=Ks(i?{["@keyframes "+o]:l}:l,n?"":"."+o)}let a=n&&Vi.g?Vi.g:null;return n&&(Vi.g=Vi[o]),((l,u,d,p)=>{p?u.data=u.data.replace(p,l):u.data.indexOf(l)===-1&&(u.data=d?l+u.data:u.data+l)})(Vi[o],e,r,a),o},M6=(t,e,n)=>t.reduce((r,i,s)=>{let o=e[s];if(o&&o.call){let a=o(n),l=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=l?"."+l:a&&typeof a=="object"?a.props?"":Ks(a,""):a===!1?"":a}return r+i+(o??"")},"");function Kp(t){let e=this||{},n=t.call?t(e.p):t;return L6(n.unshift?n.raw?M6(n,[].slice.call(arguments,1),e.p):n.reduce((r,i)=>Object.assign(r,i&&i.call?i(e.p):i),{}):n,D6(e.target),e.g,e.o,e.k)}let Wx,$v,zv;Kp.bind({g:1});let is=Kp.bind({k:1});function V6(t,e,n,r){Ks.p=e,Wx=t,$v=n,zv=r}function Ao(t,e){let n=this||{};return function(){let r=arguments;function i(s,o){let a=Object.assign({},s),l=a.className||i.className;n.p=Object.assign({theme:$v&&$v()},a),n.o=/ *go\d+/.test(l),a.className=Kp.apply(n,r)+(l?" "+l:"");let u=t;return t[0]&&(u=a.as||t,delete a.as),zv&&u[0]&&zv(a),Wx(u,a)}return i}}var j6=t=>typeof t=="function",Bv=(t,e)=>j6(t)?t(e):t,F6=(()=>{let t=0;return()=>(++t).toString()})(),U6=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),$6=20,rf=new Map,z6=1e3,CT=t=>{if(rf.has(t))return;let e=setTimeout(()=>{rf.delete(t),Gp({type:4,toastId:t})},z6);rf.set(t,e)},B6=t=>{let e=rf.get(t);e&&clearTimeout(e)},qv=(t,e)=>{switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,$6)};case 1:return e.toast.id&&B6(e.toast.id),{...t,toasts:t.toasts.map(s=>s.id===e.toast.id?{...s,...e.toast}:s)};case 2:let{toast:n}=e;return t.toasts.find(s=>s.id===n.id)?qv(t,{type:1,toast:n}):qv(t,{type:0,toast:n});case 3:let{toastId:r}=e;return r?CT(r):t.toasts.forEach(s=>{CT(s.id)}),{...t,toasts:t.toasts.map(s=>s.id===r||r===void 0?{...s,visible:!1}:s)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(s=>s.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+i}))}}},q6=[],am={toasts:[],pausedAt:void 0},Gp=t=>{am=qv(am,t),q6.forEach(e=>{e(am)})},H6=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||F6()}),bh=t=>(e,n)=>{let r=H6(e,t,n);return Gp({type:2,toast:r}),r.id},xe=(t,e)=>bh("blank")(t,e);xe.error=bh("error");xe.success=bh("success");xe.loading=bh("loading");xe.custom=bh("custom");xe.dismiss=t=>{Gp({type:3,toastId:t})};xe.remove=t=>Gp({type:4,toastId:t});xe.promise=(t,e,n)=>{let r=xe.loading(e.loading,{...n,...n==null?void 0:n.loading});return t.then(i=>(xe.success(Bv(e.success,i),{id:r,...n,...n==null?void 0:n.success}),i)).catch(i=>{xe.error(Bv(e.error,i),{id:r,...n,...n==null?void 0:n.error})}),t};var W6=is`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,K6=is`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,G6=is`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Q6=Ao("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${W6} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${K6} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${G6} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Y6=is`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,X6=Ao("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${Y6} 1s linear infinite;
`,J6=is`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Z6=is`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,e9=Ao("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${J6} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Z6} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,t9=Ao("div")`
  position: absolute;
`,n9=Ao("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,r9=is`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,i9=Ao("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${r9} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,s9=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?N.createElement(i9,null,e):e:n==="blank"?null:N.createElement(n9,null,N.createElement(X6,{...r}),n!=="loading"&&N.createElement(t9,null,n==="error"?N.createElement(Q6,{...r}):N.createElement(e9,{...r})))},o9=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,a9=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,l9="0%{opacity:0;} 100%{opacity:1;}",c9="0%{opacity:1;} 100%{opacity:0;}",u9=Ao("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,h9=Ao("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,d9=(t,e)=>{let n=t.includes("top")?1:-1,[r,i]=U6()?[l9,c9]:[o9(n),a9(n)];return{animation:e?`${is(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${is(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}};N.memo(({toast:t,position:e,style:n,children:r})=>{let i=t.height?d9(t.position||e||"top-center",t.visible):{opacity:0},s=N.createElement(s9,{toast:t}),o=N.createElement(h9,{...t.ariaProps},Bv(t.message,t));return N.createElement(u9,{className:t.className,style:{...i,...n,...t.style}},typeof r=="function"?r({icon:s,message:o}):N.createElement(N.Fragment,null,s,o))});V6(N.createElement);Kp`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`;const f9=()=>{var m;const t=Da(),e=Ra(),n=window.location.pathname.split("/challenge/")[1];console.log("URL actual:",window.location.pathname),console.log("ChallengeId extrado:",n);const r=n?`/challenge/${n}`:((m=e.state)==null?void 0:m.redirect)||"/lobby";console.log("Ruta de redireccin:",r);const[i,s]=N.useState(""),[o,a]=N.useState(""),[l,u]=N.useState(!1),d=async w=>{w.preventDefault();try{await wL(lt,i,o),t(r)}catch(E){console.error("Error al iniciar sesin:",E),E.code==="auth/invalid-credential"?xe.error("Email o contrasea incorrectos"):E.code==="auth/user-not-found"?xe.error("Usuario no encontrado"):E.code==="auth/wrong-password"?xe.error("Contrasea incorrecta"):xe.error("Error al iniciar sesin")}},p=async()=>{const w=new vi;try{console.log("Iniciando login con Google...");const E=await Gb(lt,w),x=await yi(dt(at,"users",E.user.uid));if(console.log("Usuario existe en Firestore:",x.exists()),!x.exists()){console.log("Redirigiendo a complete-profile con redirectTo:",r),t("/complete-profile",{state:{uid:E.user.uid,email:E.user.email,photoURL:E.user.photoURL,redirectTo:r}});return}console.log("Redirigiendo a:",r),t(r)}catch(E){console.error("Error con Google login:",E),xe.error("Error al iniciar sesin con Google")}};return y.jsxs("div",{className:"page-container",children:[y.jsx(Sh,{}),y.jsx("div",{className:"auth-container",children:y.jsxs("div",{className:"auth-card",children:[y.jsx(sr,{to:"/",className:"back-button",children:y.jsx("i",{className:"fas fa-arrow-left"})}),y.jsx("h2",{children:"Ingresa tu email y contrasea"}),y.jsx("p",{className:"auth-subtitle",children:"Esto te permite iniciar sesin en cualquier dispositivo"}),y.jsxs("form",{onSubmit:d,children:[y.jsx("div",{className:"form-group",children:y.jsxs("div",{className:"input-icon",children:[y.jsx("i",{className:"fas fa-envelope"}),y.jsx("input",{type:"email",placeholder:"Email",value:i,onChange:w=>s(w.target.value),required:!0})]})}),y.jsx("div",{className:"form-group",children:y.jsxs("div",{className:"input-icon",children:[y.jsx("i",{className:"fas fa-lock"}),y.jsx("input",{type:l?"text":"password",placeholder:"Contrasea",value:o,onChange:w=>a(w.target.value),required:!0}),y.jsx("button",{type:"button",className:"toggle-password",onClick:()=>u(!l),children:y.jsx("i",{className:`fas fa-eye${l?"-slash":""}`})})]})}),y.jsx("button",{type:"submit",className:"btn-continue",children:"Continuar"})]}),y.jsx("div",{className:"auth-divider",children:"O"}),y.jsxs("div",{className:"social-buttons",children:[y.jsxs("button",{className:"btn-social google",onClick:p,children:[y.jsx("i",{className:"fab fa-google"}),"Continuar con Google"]}),y.jsxs("button",{className:"btn-social apple",children:[y.jsx("i",{className:"fab fa-apple"}),"Continuar con Apple"]})]}),y.jsxs("div",{className:"auth-links",children:[y.jsx(sr,{to:"/forgot-password",children:"Olvidaste tu contrasea?"}),y.jsx(sr,{to:"/register",children:"No tienes una cuenta? Regstrate"})]})]})})]})},p9=()=>{const t=Da(),[e,n]=N.useState({username:"",email:"",password:""}),r=async a=>{if(!/^[a-zA-Z0-9_]{3,15}$/.test(a))return!1;const l=dt(at,"usernames",a.toLowerCase());return!(await yi(l)).exists()},i=async(a,l,u,d)=>{try{await Yf(dt(at,"usernames",l.toLowerCase()),{uid:a}),await Yf(dt(at,"users",a),{username:l,email:u,createdAt:new Date,rating:1200,photoURL:d||null}),await Mb(lt.currentUser,{displayName:l,photoURL:d||null})}catch(p){throw console.error("Error guardando datos de usuario:",p),p}},s=async a=>{a.preventDefault();try{if(!await r(e.username)){xe.error("Nombre de usuario no vlido o ya est en uso");return}const u=await _L(lt,e.email,e.password);await i(u.user.uid,e.username,e.email),xe.success("Cuenta creada exitosamente!"),t("/lobby")}catch(l){l.code==="auth/email-already-in-use"?xe.error("Este email ya est registrado"):xe.error("Error al crear la cuenta")}},o=async()=>{var a,l;try{const u=new vi,d=await Gb(lt,u);let p=((a=d.user.email)==null?void 0:a.split("@")[0])||"",m=await r(p),w=1;for(;!m&&w<100;)p=`${(l=d.user.email)==null?void 0:l.split("@")[0]}_${w}`,m=await r(p),w++;if(!m){xe.error("No se pudo generar un nombre de usuario nico");return}await i(d.user.uid,p,d.user.email,d.user.photoURL||void 0),xe.success("Cuenta creada exitosamente!"),t("/lobby")}catch(u){u.code==="auth/popup-closed-by-user"?xe.error("Registro cancelado"):xe.error("Error al registrarse con Google")}};return y.jsx("div",{className:"auth-container",children:y.jsxs("div",{className:"auth-card",children:[y.jsx(sr,{to:"/",className:"back-button",children:y.jsx("i",{className:"fas fa-arrow-left"})}),y.jsxs(sr,{to:"/",className:"logo",children:[y.jsx("i",{className:"fas fa-chess-knight logo-icon"}),y.jsxs("div",{className:"logo-text",children:[y.jsx("span",{className:"logo-chess",children:"CHESS"}),y.jsx("span",{className:"logo-match",children:"MATCH"})]})]}),y.jsx("h2",{children:"Crear cuenta"}),y.jsx("p",{className:"auth-subtitle",children:"Este es el nombre que vern tus amigos y otros jugadores"}),y.jsxs("form",{onSubmit:s,children:[y.jsx("div",{className:"form-group",children:y.jsxs("div",{className:"input-icon",children:[y.jsx("i",{className:"fas fa-user"}),y.jsx("input",{type:"text",placeholder:"Nombre de usuario",value:e.username,onChange:a=>n({...e,username:a.target.value}),required:!0,minLength:3,maxLength:15,pattern:"^[a-zA-Z0-9_]+$",title:"El nombre de usuario debe tener entre 3 y 15 caracteres y solo puede contener letras, nmeros y guiones bajos"})]})}),y.jsx("div",{className:"form-group",children:y.jsxs("div",{className:"input-icon",children:[y.jsx("i",{className:"fas fa-envelope"}),y.jsx("input",{type:"email",placeholder:"Email",value:e.email,onChange:a=>n({...e,email:a.target.value}),required:!0})]})}),y.jsx("div",{className:"form-group",children:y.jsxs("div",{className:"input-icon",children:[y.jsx("i",{className:"fas fa-lock"}),y.jsx("input",{type:"password",placeholder:"Contrasea",value:e.password,onChange:a=>n({...e,password:a.target.value}),required:!0})]})}),y.jsx("button",{type:"submit",className:"btn-continue",children:"Crear cuenta"})]}),y.jsx("div",{className:"auth-divider",children:"O"}),y.jsxs("div",{className:"social-buttons",children:[y.jsxs("button",{className:"btn-social google",onClick:o,children:[y.jsx("i",{className:"fab fa-google"}),"Continuar con Google"]}),y.jsxs("button",{className:"btn-social apple",children:[y.jsx("i",{className:"fab fa-apple"}),"Continuar con Apple"]})]}),y.jsx("div",{className:"auth-links",children:y.jsx(sr,{to:"/login",children:"Ya tienes una cuenta? Inicia sesin"})})]})})},g9=()=>{const[t,e]=N.useState(""),[n,r]=N.useState(!1),i=s=>{s.preventDefault(),console.log("Recuperar contrasea para:",t),r(!0)};return y.jsxs("div",{className:"page-container",children:[y.jsx(Sh,{}),y.jsx("div",{className:"auth-container",children:y.jsxs("div",{className:"auth-card",children:[y.jsx(sr,{to:"/login",className:"back-button",children:y.jsx("i",{className:"fas fa-arrow-left"})}),n?y.jsxs("div",{className:"success-message",children:[y.jsx("i",{className:"fas fa-check-circle"}),y.jsx("h2",{children:"Email enviado!"}),y.jsxs("p",{children:["Hemos enviado las instrucciones para restablecer tu contrasea a ",t]}),y.jsx("p",{className:"small",children:"Si no recibes el email en unos minutos, revisa tu carpeta de spam"}),y.jsx(sr,{to:"/login",className:"btn-continue",children:"Volver al inicio de sesin"})]}):y.jsxs(y.Fragment,{children:[y.jsx("h2",{children:"Recuperar contrasea"}),y.jsx("p",{className:"auth-subtitle",children:"Ingresa tu email y te enviaremos instrucciones para restablecer tu contrasea"}),y.jsxs("form",{onSubmit:i,children:[y.jsx("div",{className:"form-group",children:y.jsxs("div",{className:"input-icon",children:[y.jsx("i",{className:"fas fa-envelope"}),y.jsx("input",{type:"email",placeholder:"Email",value:t,onChange:s=>e(s.target.value),required:!0})]})}),y.jsx("button",{type:"submit",className:"btn-continue",children:"Enviar instrucciones"})]})]})]})})]})},Fl=[{name:"Bullet",time:1,increment:0},{name:"Bullet",time:1,increment:1},{name:"Blitz",time:3,increment:0},{name:"Blitz",time:3,increment:2},{name:"Blitz",time:5,increment:0},{name:"Blitz",time:5,increment:3},{name:"Rpida",time:10,increment:0},{name:"Rpida",time:15,increment:10},{name:"Clsica",time:30,increment:0}];Fl.find(t=>t.time===3&&t.increment===2)||Fl[0];const m9=({selectedOption:t,options:e,onChange:n})=>{const r=Array.from(new Set(e.map(i=>i.name)));return y.jsxs("div",{className:"time-control",children:[y.jsx("h3",{children:"Control de Tiempo"}),r.map(i=>y.jsxs("div",{className:"time-category",children:[y.jsx("span",{children:i}),y.jsx("div",{className:"time-category-options",children:e.filter(s=>s.name===i).map(s=>y.jsxs("button",{className:`time-option ${s.time===t.time&&s.increment===t.increment?"selected":""}`,onClick:()=>n(s),children:[y.jsx("span",{className:"time",children:`${s.time}+${s.increment}`}),y.jsx("span",{className:"name",children:s.name})]},`${s.time}-${s.increment}`))})]},i))]})},Kx=({selectedCount:t,onChange:e})=>{const n=[1,3,5,7,10];return y.jsxs("div",{className:"game-count-container",children:[y.jsx("h3",{children:"Nmero de partidas"}),y.jsx("div",{className:"game-count-options",children:n.map(r=>y.jsx("button",{className:`game-count-button ${t===r?"active":""}`,onClick:()=>e(r),children:r===1?"1 partida":`Al mejor de ${r}`},r))})]})},v9=({config:t,onChange:e})=>y.jsxs("div",{className:"match-settings",children:[y.jsx(m9,{selectedOption:t.timeControl,options:Fl,onChange:n=>e({...t,timeControl:n})}),y.jsx(Kx,{selectedCount:t.numberOfGames,onChange:n=>e({...t,numberOfGames:n})}),y.jsxs("div",{className:"setting-group",children:[y.jsx("h3",{children:"Tipo de Match"}),y.jsxs("div",{className:"toggle-group",children:[y.jsx("button",{className:t.rated?"selected":"",onClick:()=>e({...t,rated:!0}),children:"Clasificatorio"}),y.jsx("button",{className:t.rated?"":"selected",onClick:()=>e({...t,rated:!1}),children:"Amistoso"})]})]}),y.jsxs("div",{className:"setting-group",children:[y.jsx("h3",{children:"Color de Piezas"}),y.jsxs("div",{className:"color-selector",children:[y.jsxs("button",{className:t.color==="random"?"selected":"",onClick:()=>e({...t,color:"random"}),children:[y.jsx("i",{className:"fas fa-random"}),"Aleatorio"]}),y.jsxs("button",{className:t.color==="white"?"selected":"",onClick:()=>e({...t,color:"white"}),children:[y.jsx("i",{className:"fas fa-chess-pawn"}),"Blancas"]}),y.jsxs("button",{className:t.color==="black"?"selected":"",onClick:()=>e({...t,color:"black"}),children:[y.jsx("i",{className:"fas fa-chess-pawn chess-piece-black"}),"Negras"]})]})]})]}),y9=({options:t,selected:e,onSelect:n})=>{const r=["Bullet","Blitz","Rpida","Clsica"];return y.jsxs("div",{className:"time-control",children:[y.jsx("h3",{children:"Control de Tiempo"}),y.jsx("div",{className:"time-options",children:r.map(i=>y.jsxs(VT.Fragment,{children:[y.jsx("div",{className:"time-category",children:i}),y.jsx("div",{className:"time-category-options",children:t.filter(s=>s.name===i).map((s,o)=>y.jsx("button",{className:`time-option ${e===s?"selected":""}`,onClick:()=>n(s),children:y.jsxs("span",{className:"time",children:[s.time,"+",s.increment]})},`${s.time}-${s.increment}-${o}`))})]},i))})]})},_9=({challengeId:t,challenge:e})=>{const n=Da(),[r,i]=N.useState(null),[s,o]=N.useState({timeControl:Fl.find(u=>u.time===3&&u.increment===2)||Fl[0],numberOfGames:3,rated:!0,color:"random"});N.useEffect(()=>{const u=Vb(lt,p=>{p||n("/login")});return(async()=>{if(lt.currentUser){const p=await yi(dt(at,"users",lt.currentUser.uid));p.exists()&&i(p.data())}})(),()=>u()},[n]);const a=async()=>{try{if(!lt.currentUser||!(r!=null&&r.username)){xe.error("Debes iniciar sesin para crear un reto"),n("/login");return}const u=s.timeControl.time*60,d={createdBy:lt.currentUser.uid,creatorUsername:r.username,createdAt:Dv(),config:s,status:"waiting",currentGame:1,gameStarted:!1,timeLeft:{white:u,black:u},players:{white:null,black:null},currentTurn:"white",fen:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"},p=await rj(U3(at,"challenges"),d);xe.success("Reto creado!"),n(`/challenge/${p.id}`)}catch(u){console.error("Error al crear reto:",u),xe.error("Error al crear el reto")}},l=async()=>{if(!(!t||!lt.currentUser))try{const u=e!=null&&e.players.white?"black":"white";await Vs(dt(at,"challenges",t),{[`players.${u}`]:lt.currentUser.uid}),n(`/challenge/${t}`)}catch{xe.error("Error al unirse al juego")}};return N.useEffect(()=>{e&&(!e.players.white||!e.players.black)&&l()},[e,t]),y.jsx("div",{className:"lobby-container",children:t?y.jsxs("div",{className:"waiting-screen",children:[y.jsx("h2",{children:"Esperando jugadores..."}),y.jsx("div",{className:"spinner"})]}):y.jsxs("div",{className:"create-challenge",children:[y.jsx("h2",{children:"Crear nuevo reto"}),y.jsx(y9,{options:Fl,selected:s.timeControl,onSelect:u=>o({...s,timeControl:u})}),y.jsx(v9,{config:s,onChange:o}),y.jsx(Kx,{selectedCount:s.numberOfGames,onChange:u=>o({...s,numberOfGames:u})}),y.jsx("button",{className:"create-button",onClick:a,children:"Crear Reto"})]})})},w9=()=>{new Audio("/sounds/game-start.mp3").play().catch(e=>console.error("Error reproduciendo sonido:",e))},E9=({whitePlayer:t,blackPlayer:e,numberOfGames:n,results:r=[],currentGame:i})=>(console.log("MatchScoreTable props:",{whitePlayer:t,blackPlayer:e,numberOfGames:n,results:r,currentGame:i}),y.jsx("div",{className:"match-score-table table-responsive",children:y.jsxs("table",{className:"table table-dark table-bordered",children:[y.jsx("thead",{children:y.jsxs("tr",{children:[y.jsx("th",{scope:"col",className:"player-name",children:"Jugador"}),Array.from({length:n},(s,o)=>y.jsx("th",{scope:"col",className:`game-number text-center ${i===o+1?"current":""}`,children:o+1},o))]})}),y.jsxs("tbody",{children:[y.jsxs("tr",{children:[y.jsx("td",{className:"player-name",children:t||"Blancas"}),Array.from({length:n},(s,o)=>y.jsx("td",{className:`game-result text-center ${i===o+1?"current":""}`,children:r[o]||"-"},o))]}),y.jsxs("tr",{children:[y.jsx("td",{className:"player-name",children:e||"Negras"}),Array.from({length:n},(s,o)=>y.jsx("td",{className:`game-result text-center ${i===o+1?"current":""}`,children:r[o]||"-"},o))]})]})]})})),T9=()=>{var W,P,C,R,O,L,V;const[t,e]=N.useState(new Ui),[n,r]=N.useState(!1),[i,s]=N.useState(null),[o,a]=N.useState(!0),[l,u]=N.useState({isCreator:!1,gameStarted:!1,timeWhite:0,timeBlack:0,currentGame:1,totalGames:1,challenge:null,isWhiteTurn:!0,isLoading:!0,error:null,players:{white:null,black:null,whiteUsername:null,blackUsername:null}}),{challengeId:d}=vO(),p=Da(),[m,w]=N.useState(!1),[E,x]=N.useState(0);N.useEffect(()=>{if(console.log("Iniciando efecto con challengeId:",d),!d)return;(async()=>{try{const Te=dt(at,"challenges",d),Ie=await yi(Te);if(!Ie.exists()){xe.error("Reto no encontrado"),p("/");return}const Se=Ie.data();console.log("Datos del reto cargados:",Se);const X=(Se.config.timeControl.time||0)*60;if(x(X),u(ae=>({...ae,challenge:{id:d,...Se},timeWhite:X,timeBlack:X,isLoading:!1,gameStarted:Se.gameStarted||!1})),lt.currentUser){const ae=Se.players.white===lt.currentUser.uid,z=Se.players.black===lt.currentUser.uid;if(ae)s("white");else if(z)s("black");else if(!Se.players.white||!Se.players.black){const Le=Se.players.white?"black":"white";await D(Le)}}w(Se.gameStarted||!1),a(!1)}catch(Te){console.error("Error cargando el reto:",Te),a(!1)}})();const ge=q1(dt(at,"challenges",d),async Te=>{if(!Te.exists())return;const Ie=Te.data();if(Ie.players.white&&Ie.players.black&&!Ie.gameStarted&&(w9(),await Vs(dt(at,"challenges",d),{gameStarted:!0,startedAt:Dv()})),Ie.players.white&&Ie.players.white!==l.players.white){const ae=await yi(dt(at,"users",Ie.players.white));ae.exists()&&u(z=>({...z,players:{...z.players,white:Ie.players.white,whiteUsername:ae.data().username}}))}if(Ie.players.black&&Ie.players.black!==l.players.black){const ae=await yi(dt(at,"users",Ie.players.black));ae.exists()&&u(z=>({...z,players:{...z.players,black:Ie.players.black,blackUsername:ae.data().username}}))}w(Ie.gameStarted||!1)});return()=>ge()},[d]);const D=async k=>{if(!(!d||!lt.currentUser))try{const ge=dt(at,"challenges",d);await Vs(ge,{[`players.${k}`]:lt.currentUser.uid,...k==="black"?{gameStarted:!0}:{}}),s(k),xe.success("Te has unido al juego")}catch(ge){console.error("Error al unirse al juego:",ge),xe.error("Error al unirse al juego")}};if(N.useEffect(()=>{!l.gameStarted||l.challenge},[l.gameStarted,l.challenge]),N.useEffect(()=>{(async()=>{if(l.players.white){const ge=await yi(dt(at,"users",l.players.white));ge.exists()&&u(Te=>({...Te,players:{...Te.players,whiteUsername:ge.data().username}}))}if(l.players.black){const ge=await yi(dt(at,"users",l.players.black));ge.exists()&&u(Te=>({...Te,players:{...Te.players,blackUsername:ge.data().username}}))}})()},[l.players.white,l.players.black]),N.useEffect(()=>{console.log("Estado del challenge:",{isLoading:o,challengeState:l,playerColor:i,game:t==null?void 0:t.fen()})},[o,l,i,t]),N.useEffect(()=>{if(!d)return;const k=q1(dt(at,"challenges",d),ge=>{const Te=ge.data();if(!Te)return;const Ie=new Ui(Te.fen||t.fen());e(Ie);const Se=i==="white"&&Ie.turn()==="w"||i==="black"&&Ie.turn()==="b";r(Se),console.log("Estado actualizado:",{fen:Te.fen,playerColor:i,isCurrentPlayerTurn:Se,turn:Ie.turn()})});return()=>k()},[d,i]),N.useEffect(()=>{if(!l.challenge)return;const k=l.challenge.players.white&&l.challenge.players.black;w(!!k),console.log("Estado del juego:",{hasAllPlayers:k,players:l.challenge.players,gameStarted:m})},[l.challenge]),o)return y.jsx("div",{className:"loading",children:"Cargando reto..."});const A=(k,ge)=>{if(!n||!d||!lt.currentUser||t.move({from:k,to:ge,promotion:"q"})===null)return!1;const Ie=new Ui(t.fen()),Se=Ie.isGameOver()&&Ie.isCheckmate();return Vs(dt(at,"challenges",d),{fen:t.fen(),lastMove:{from:k,to:ge},currentTurn:i==="white"?"black":"white",...Se&&{status:"completed",winner:i,result:i==="white"?"1-0":"0-1",endReason:"checkmate",completedAt:Dv()}}).catch(console.error),Se&&xe.success("Jaque Mate! Has ganado la partida "),!0},T=async()=>{if(!(!d||!lt.currentUser))try{const k=dt(at,"challenges",d);await Vs(k,{drawOffer:{offeredBy:lt.currentUser.uid,offeredAt:Date.now()}}),xe.success("Oferta de tablas enviada")}catch{xe.error("Error al ofrecer tablas")}},S=async()=>{if(!(!d||!lt.currentUser))try{const k=dt(at,"challenges",d);await Vs(k,{status:"completed",winner:i==="white"?"black":"white",result:i==="white"?"0-1":"1-0",endReason:"resignation"}),xe.success("Has abandonado la partida")}catch{xe.error("Error al abandonar la partida")}},M=async(k,ge)=>{if(d)try{const Te=dt(at,"challenges",d);await Vs(Te,{[`timeLeft.${k}`]:ge})}catch(Te){console.error("Error al actualizar el tiempo:",Te)}},q=async k=>{if(d)try{const ge=dt(at,"challenges",d);await Vs(ge,{status:"completed",winner:k,result:k==="white"?"1-0":"0-1",endReason:"timeout"})}catch{xe.error("Error al finalizar la partida por tiempo")}};return y.jsxs("div",{className:"challenge-container",children:[y.jsx(Sh,{}),y.jsx("div",{className:"challenge-content container-fluid pt-5",children:y.jsxs("div",{className:"row",children:[y.jsxs("div",{className:"col-12 col-lg-8",children:[y.jsx("div",{className:"player-box black mb-3",children:y.jsxs("div",{className:"row align-items-center w-100",children:[y.jsx("div",{className:"col-auto",children:y.jsx("div",{className:"player-avatar",children:y.jsx("i",{className:"fas fa-user"})})}),y.jsx("div",{className:"col",children:y.jsxs("div",{className:"player-info",children:[y.jsx("span",{className:"player-name text-white",children:l.players.blackUsername||"Esperando..."}),y.jsxs("span",{className:"player-rating",children:[y.jsx("i",{className:"fas fa-star me-1"}),"1500"]})]})}),y.jsx("div",{className:"col-auto",children:y.jsx(ep,{timeInMinutes:((W=l.challenge)==null?void 0:W.config.timeControl.time)||0,increment:((P=l.challenge)==null?void 0:P.config.timeControl.increment)||0,isActive:m&&t.turn()==="b",color:"black",onTimeout:async()=>await q("white"),onTimeUpdate:k=>M("black",k),remainingTime:l.timeBlack})})]})}),y.jsx("div",{className:"board-wrapper mb-3",children:y.jsx("div",{className:"board-container",children:y.jsx(zx,{position:t.fen(),onPieceDrop:A,boardOrientation:i==="black"?"black":"white",customBoardStyle:{borderRadius:"4px",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.3)"}})})}),y.jsx("div",{className:"player-box white mb-3",children:y.jsxs("div",{className:"row align-items-center w-100",children:[y.jsx("div",{className:"col-auto order-3",children:y.jsx("div",{className:"player-avatar",children:y.jsx("i",{className:"fas fa-user"})})}),y.jsx("div",{className:"col order-2",children:y.jsxs("div",{className:"player-info text-end",children:[y.jsx("span",{className:"player-name text-white",children:l.players.whiteUsername||"Esperando..."}),y.jsxs("span",{className:"player-rating",children:[y.jsx("i",{className:"fas fa-star me-1"}),"1500"]})]})}),y.jsx("div",{className:"col-auto order-1",children:y.jsx(ep,{timeInMinutes:((C=l.challenge)==null?void 0:C.config.timeControl.time)||0,increment:((R=l.challenge)==null?void 0:R.config.timeControl.increment)||0,isActive:m&&t.turn()==="w",color:"white",onTimeout:async()=>await q("black"),onTimeUpdate:k=>M("white",k),remainingTime:l.timeWhite})})]})}),y.jsx("div",{className:"game-actions",children:y.jsxs("div",{className:"row g-2",children:[y.jsx("div",{className:"col",children:y.jsxs("button",{className:"btn btn-secondary w-100",onClick:T,disabled:!n,children:[y.jsx("i",{className:"fas fa-handshake me-2"}),"Tablas"]})}),y.jsx("div",{className:"col",children:y.jsxs("button",{className:"btn btn-danger w-100",onClick:S,children:[y.jsx("i",{className:"fas fa-flag me-2"}),"Abandonar"]})})]})})]}),y.jsx("div",{className:"col-12 col-lg-4",children:y.jsxs("div",{className:"card bg-dark text-light",children:[y.jsx("div",{className:"card-header",children:y.jsx("div",{className:"d-flex justify-content-between align-items-center",children:y.jsxs("div",{className:"game-info",children:[y.jsx("i",{className:"fas fa-chess me-2"}),y.jsxs("span",{children:["Partida ",l.currentGame," de ",(O=l.challenge)==null?void 0:O.config.numberOfGames]})]})})}),y.jsx("div",{className:"card-body",children:y.jsx(E9,{whitePlayer:l.players.whiteUsername,blackPlayer:l.players.blackUsername,numberOfGames:((L=l.challenge)==null?void 0:L.config.numberOfGames)||1,results:((V=l.challenge)==null?void 0:V.results)||[],currentGame:l.currentGame})})]})})]})})]})},I9=()=>{const t=Da(),e=Ra(),{uid:n,email:r,photoURL:i}=e.state||{},[s,o]=N.useState(""),a=async u=>{if(!/^[a-zA-Z0-9_]{3,15}$/.test(u))return!1;const d=dt(at,"usernames",u.toLowerCase());return!(await yi(d)).exists()},l=async u=>{u.preventDefault();try{if(!await a(s)){xe.error("Nombre de usuario no vlido o ya est en uso");return}await Yf(dt(at,"usernames",s.toLowerCase()),{uid:n}),await Yf(dt(at,"users",n),{username:s,email:r,createdAt:new Date,rating:1200,photoURL:i||null}),lt.currentUser&&await Mb(lt.currentUser,{displayName:s}),xe.success("Perfil completado!"),t("/lobby")}catch(d){console.error("Error al guardar el perfil:",d),xe.error("Error al guardar el perfil")}};return y.jsxs("div",{className:"page-container",children:[y.jsx(Sh,{}),y.jsx("div",{className:"auth-container",children:y.jsxs("div",{className:"auth-card",children:[y.jsx("h2",{children:"Completa tu perfil"}),y.jsx("p",{className:"auth-subtitle",children:"Solo necesitamos un nombre de usuario para continuar"}),y.jsxs("form",{onSubmit:l,children:[y.jsx("div",{className:"form-group",children:y.jsxs("div",{className:"input-icon",children:[y.jsx("i",{className:"fas fa-user"}),y.jsx("input",{type:"text",placeholder:"Nombre de usuario",value:s,onChange:u=>o(u.target.value),required:!0,minLength:3,maxLength:15,pattern:"^[a-zA-Z0-9_]+$",title:"El nombre de usuario debe tener entre 3 y 15 caracteres y solo puede contener letras, nmeros y guiones bajos"})]})}),y.jsx("div",{className:"form-info",children:y.jsxs("p",{children:["Email: ",r]})}),y.jsx("button",{type:"submit",className:"btn-continue",children:"Completar perfil"})]})]})})]})},Ad=({children:t})=>{const[e,n]=N.useState("loading");return N.useEffect(()=>{const r=Vb(lt,i=>{n(i?"authenticated":"unauthenticated")});return()=>r()},[]),e==="loading"?y.jsx("div",{children:"Cargando..."}):e==="unauthenticated"?y.jsx(YS,{to:"/login",replace:!0}):y.jsx(y.Fragment,{children:t})};function S9(){return y.jsx(k6,{children:y.jsx(UO,{children:y.jsx("div",{className:"app-container",children:y.jsxs(OO,{children:[y.jsx(Tn,{index:!0,element:y.jsx(ST,{})}),y.jsx(Tn,{path:"/",element:y.jsx(ST,{})}),y.jsx(Tn,{path:"/login",element:y.jsx(f9,{})}),y.jsx(Tn,{path:"/register",element:y.jsx(p9,{})}),y.jsx(Tn,{path:"/forgot-password",element:y.jsx(g9,{})}),y.jsx(Tn,{path:"/lobby",element:y.jsx(Ad,{children:y.jsx(_9,{})})}),y.jsx(Tn,{path:"/challenge/:challengeId",element:y.jsx(Ad,{children:y.jsx(T9,{})})}),y.jsxs(Tn,{path:"/play",children:[y.jsx(Tn,{path:"computer",element:y.jsx(hu,{})}),y.jsx(Tn,{path:"online",element:y.jsx(Ad,{children:y.jsx(hu,{})})}),y.jsx(Tn,{path:"friend",element:y.jsx(Ad,{children:y.jsx(hu,{})})}),y.jsx(Tn,{path:"puzzle",element:y.jsx(hu,{isPuzzle:!0})})]}),y.jsx(Tn,{path:"/complete-profile",element:y.jsx(I9,{})}),y.jsx(Tn,{path:"*",element:y.jsx(YS,{to:"/",replace:!0})})]})})})})}console.log("Iniciando aplicacin");const Gx=document.getElementById("root");console.log("Elemento root encontrado:",Gx);US(Gx).render(y.jsx(N.StrictMode,{children:y.jsx(S9,{})}));
