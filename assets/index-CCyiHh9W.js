var hk=Object.defineProperty;var dk=(t,e,n)=>e in t?hk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Tr=(t,e,n)=>dk(t,typeof e!="symbol"?e+"":e,n);function fk(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var pk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gk(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var PT={exports:{}},np={},kT={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lh=Symbol.for("react.element"),mk=Symbol.for("react.portal"),vk=Symbol.for("react.fragment"),yk=Symbol.for("react.strict_mode"),_k=Symbol.for("react.profiler"),wk=Symbol.for("react.provider"),Ek=Symbol.for("react.context"),Tk=Symbol.for("react.forward_ref"),Ik=Symbol.for("react.suspense"),Sk=Symbol.for("react.memo"),bk=Symbol.for("react.lazy"),B0=Symbol.iterator;function Ck(t){return t===null||typeof t!="object"?null:(t=B0&&t[B0]||t["@@iterator"],typeof t=="function"?t:null)}var RT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},DT=Object.assign,OT={};function ou(t,e,n){this.props=t,this.context=e,this.refs=OT,this.updater=n||RT}ou.prototype.isReactComponent={};ou.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ou.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function NT(){}NT.prototype=ou.prototype;function Wv(t,e,n){this.props=t,this.context=e,this.refs=OT,this.updater=n||RT}var Kv=Wv.prototype=new NT;Kv.constructor=Wv;DT(Kv,ou.prototype);Kv.isPureReactComponent=!0;var q0=Array.isArray,LT=Object.prototype.hasOwnProperty,Gv={current:null},MT={key:!0,ref:!0,__self:!0,__source:!0};function VT(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)LT.call(e,r)&&!MT.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),h=0;h<a;h++)l[h]=arguments[h+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:lh,type:t,key:s,ref:o,props:i,_owner:Gv.current}}function Ak(t,e){return{$$typeof:lh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Qv(t){return typeof t=="object"&&t!==null&&t.$$typeof===lh}function xk(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var H0=/\/+/g;function dg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?xk(""+t.key):e.toString(36)}function Pd(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case lh:case mk:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+dg(o,0):r,q0(i)?(n="",t!=null&&(n=t.replace(H0,"$&/")+"/"),Pd(i,e,n,"",function(h){return h})):i!=null&&(Qv(i)&&(i=Ak(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(H0,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",q0(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+dg(s,a);o+=Pd(s,e,n,l,i)}else if(l=Ck(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+dg(s,a++),o+=Pd(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ed(t,e,n){if(t==null)return t;var r=[],i=0;return Pd(t,r,"","",function(s){return e.call(n,s,i++)}),r}function Pk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Rn={current:null},kd={transition:null},kk={ReactCurrentDispatcher:Rn,ReactCurrentBatchConfig:kd,ReactCurrentOwner:Gv};function jT(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:ed,forEach:function(t,e,n){ed(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ed(t,function(){e++}),e},toArray:function(t){return ed(t,function(e){return e})||[]},only:function(t){if(!Qv(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ke.Component=ou;ke.Fragment=vk;ke.Profiler=_k;ke.PureComponent=Wv;ke.StrictMode=yk;ke.Suspense=Ik;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kk;ke.act=jT;ke.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=DT({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Gv.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)LT.call(e,l)&&!MT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var h=0;h<l;h++)a[h]=arguments[h+2];r.children=a}return{$$typeof:lh,type:t.type,key:i,ref:s,props:r,_owner:o}};ke.createContext=function(t){return t={$$typeof:Ek,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:wk,_context:t},t.Consumer=t};ke.createElement=VT;ke.createFactory=function(t){var e=VT.bind(null,t);return e.type=t,e};ke.createRef=function(){return{current:null}};ke.forwardRef=function(t){return{$$typeof:Tk,render:t}};ke.isValidElement=Qv;ke.lazy=function(t){return{$$typeof:bk,_payload:{_status:-1,_result:t},_init:Pk}};ke.memo=function(t,e){return{$$typeof:Sk,type:t,compare:e===void 0?null:e}};ke.startTransition=function(t){var e=kd.transition;kd.transition={};try{t()}finally{kd.transition=e}};ke.unstable_act=jT;ke.useCallback=function(t,e){return Rn.current.useCallback(t,e)};ke.useContext=function(t){return Rn.current.useContext(t)};ke.useDebugValue=function(){};ke.useDeferredValue=function(t){return Rn.current.useDeferredValue(t)};ke.useEffect=function(t,e){return Rn.current.useEffect(t,e)};ke.useId=function(){return Rn.current.useId()};ke.useImperativeHandle=function(t,e,n){return Rn.current.useImperativeHandle(t,e,n)};ke.useInsertionEffect=function(t,e){return Rn.current.useInsertionEffect(t,e)};ke.useLayoutEffect=function(t,e){return Rn.current.useLayoutEffect(t,e)};ke.useMemo=function(t,e){return Rn.current.useMemo(t,e)};ke.useReducer=function(t,e,n){return Rn.current.useReducer(t,e,n)};ke.useRef=function(t){return Rn.current.useRef(t)};ke.useState=function(t){return Rn.current.useState(t)};ke.useSyncExternalStore=function(t,e,n){return Rn.current.useSyncExternalStore(t,e,n)};ke.useTransition=function(){return Rn.current.useTransition()};ke.version="18.3.1";kT.exports=ke;var N=kT.exports;const FT=gk(N),Rk=fk({__proto__:null,default:FT},[N]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dk=N,Ok=Symbol.for("react.element"),Nk=Symbol.for("react.fragment"),Lk=Object.prototype.hasOwnProperty,Mk=Dk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Vk={key:!0,ref:!0,__self:!0,__source:!0};function UT(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Lk.call(e,r)&&!Vk.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Ok,type:t,key:s,ref:o,props:i,_owner:Mk.current}}np.Fragment=Nk;np.jsx=UT;np.jsxs=UT;PT.exports=np;var y=PT.exports,$T={exports:{}},ur={},zT={exports:{}},BT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(X,ue){var z=X.length;X.push(ue);e:for(;0<z;){var Ne=z-1>>>1,Le=X[Ne];if(0<i(Le,ue))X[Ne]=ue,X[z]=Le,z=Ne;else break e}}function n(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var ue=X[0],z=X.pop();if(z!==ue){X[0]=z;e:for(var Ne=0,Le=X.length,Be=Le>>>1;Ne<Be;){var lt=2*(Ne+1)-1,jt=X[lt],nt=lt+1,de=X[nt];if(0>i(jt,z))nt<Le&&0>i(de,jt)?(X[Ne]=de,X[nt]=z,Ne=nt):(X[Ne]=jt,X[lt]=z,Ne=lt);else if(nt<Le&&0>i(de,z))X[Ne]=de,X[nt]=z,Ne=nt;else break e}}return ue}function i(X,ue){var z=X.sortIndex-ue.sortIndex;return z!==0?z:X.id-ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],h=[],d=1,p=null,m=3,w=!1,E=!1,x=!1,D=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(X){for(var ue=n(h);ue!==null;){if(ue.callback===null)r(h);else if(ue.startTime<=X)r(h),ue.sortIndex=ue.expirationTime,e(l,ue);else break;ue=n(h)}}function M(X){if(x=!1,S(X),!E)if(n(l)!==null)E=!0,Fe(q);else{var ue=n(h);ue!==null&&Ce(M,ue.startTime-X)}}function q(X,ue){E=!1,x&&(x=!1,A(C),C=-1),w=!0;var z=m;try{for(S(ue),p=n(l);p!==null&&(!(p.expirationTime>ue)||X&&!L());){var Ne=p.callback;if(typeof Ne=="function"){p.callback=null,m=p.priorityLevel;var Le=Ne(p.expirationTime<=ue);ue=t.unstable_now(),typeof Le=="function"?p.callback=Le:p===n(l)&&r(l),S(ue)}else r(l);p=n(l)}if(p!==null)var Be=!0;else{var lt=n(h);lt!==null&&Ce(M,lt.startTime-ue),Be=!1}return Be}finally{p=null,m=z,w=!1}}var W=!1,P=null,C=-1,R=5,O=-1;function L(){return!(t.unstable_now()-O<R)}function V(){if(P!==null){var X=t.unstable_now();O=X;var ue=!0;try{ue=P(!0,X)}finally{ue?k():(W=!1,P=null)}}else W=!1}var k;if(typeof T=="function")k=function(){T(V)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,Ie=ve.port2;ve.port1.onmessage=V,k=function(){Ie.postMessage(null)}}else k=function(){D(V,0)};function Fe(X){P=X,W||(W=!0,k())}function Ce(X,ue){C=D(function(){X(t.unstable_now())},ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(X){X.callback=null},t.unstable_continueExecution=function(){E||w||(E=!0,Fe(q))},t.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<X?Math.floor(1e3/X):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(X){switch(m){case 1:case 2:case 3:var ue=3;break;default:ue=m}var z=m;m=ue;try{return X()}finally{m=z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(X,ue){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var z=m;m=X;try{return ue()}finally{m=z}},t.unstable_scheduleCallback=function(X,ue,z){var Ne=t.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?Ne+z:Ne):z=Ne,X){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=z+Le,X={id:d++,callback:ue,priorityLevel:X,startTime:z,expirationTime:Le,sortIndex:-1},z>Ne?(X.sortIndex=z,e(h,X),n(l)===null&&X===n(h)&&(x?(A(C),C=-1):x=!0,Ce(M,z-Ne))):(X.sortIndex=Le,e(l,X),E||w||(E=!0,Fe(q))),X},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(X){var ue=m;return function(){var z=m;m=ue;try{return X.apply(this,arguments)}finally{m=z}}}})(BT);zT.exports=BT;var jk=zT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fk=N,ar=jk;function Y(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var qT=new Set,Rc={};function Ra(t,e){zl(t,e),zl(t+"Capture",e)}function zl(t,e){for(Rc[t]=e,t=0;t<e.length;t++)qT.add(e[t])}var Gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cm=Object.prototype.hasOwnProperty,Uk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,W0={},K0={};function $k(t){return cm.call(K0,t)?!0:cm.call(W0,t)?!1:Uk.test(t)?K0[t]=!0:(W0[t]=!0,!1)}function zk(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Bk(t,e,n,r){if(e===null||typeof e>"u"||zk(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Dn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var sn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){sn[t]=new Dn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];sn[e]=new Dn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){sn[t]=new Dn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){sn[t]=new Dn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){sn[t]=new Dn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){sn[t]=new Dn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){sn[t]=new Dn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){sn[t]=new Dn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){sn[t]=new Dn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Yv=/[\-:]([a-z])/g;function Xv(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Yv,Xv);sn[e]=new Dn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Yv,Xv);sn[e]=new Dn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Yv,Xv);sn[e]=new Dn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){sn[t]=new Dn(t,1,!1,t.toLowerCase(),null,!1,!1)});sn.xlinkHref=new Dn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){sn[t]=new Dn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Jv(t,e,n,r){var i=sn.hasOwnProperty(e)?sn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Bk(e,n,i,r)&&(n=null),r||i===null?$k(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var rs=Fk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,td=Symbol.for("react.element"),_l=Symbol.for("react.portal"),wl=Symbol.for("react.fragment"),Zv=Symbol.for("react.strict_mode"),hm=Symbol.for("react.profiler"),HT=Symbol.for("react.provider"),WT=Symbol.for("react.context"),ey=Symbol.for("react.forward_ref"),dm=Symbol.for("react.suspense"),fm=Symbol.for("react.suspense_list"),ty=Symbol.for("react.memo"),Ls=Symbol.for("react.lazy"),KT=Symbol.for("react.offscreen"),G0=Symbol.iterator;function ju(t){return t===null||typeof t!="object"?null:(t=G0&&t[G0]||t["@@iterator"],typeof t=="function"?t:null)}var wt=Object.assign,fg;function Zu(t){if(fg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);fg=e&&e[1]||""}return`
`+fg+t}var pg=!1;function gg(t,e){if(!t||pg)return"";pg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{pg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Zu(t):""}function qk(t){switch(t.tag){case 5:return Zu(t.type);case 16:return Zu("Lazy");case 13:return Zu("Suspense");case 19:return Zu("SuspenseList");case 0:case 2:case 15:return t=gg(t.type,!1),t;case 11:return t=gg(t.type.render,!1),t;case 1:return t=gg(t.type,!0),t;default:return""}}function pm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case wl:return"Fragment";case _l:return"Portal";case hm:return"Profiler";case Zv:return"StrictMode";case dm:return"Suspense";case fm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case WT:return(t.displayName||"Context")+".Consumer";case HT:return(t._context.displayName||"Context")+".Provider";case ey:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ty:return e=t.displayName||null,e!==null?e:pm(t.type)||"Memo";case Ls:e=t._payload,t=t._init;try{return pm(t(e))}catch{}}return null}function Hk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pm(e);case 8:return e===Zv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ho(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function GT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Wk(t){var e=GT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function nd(t){t._valueTracker||(t._valueTracker=Wk(t))}function QT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=GT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function of(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gm(t,e){var n=e.checked;return wt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Q0(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ho(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function YT(t,e){e=e.checked,e!=null&&Jv(t,"checked",e,!1)}function mm(t,e){YT(t,e);var n=ho(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?vm(t,e.type,n):e.hasOwnProperty("defaultValue")&&vm(t,e.type,ho(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Y0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function vm(t,e,n){(e!=="number"||of(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ec=Array.isArray;function Dl(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ho(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function ym(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Y(91));return wt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function X0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Y(92));if(ec(n)){if(1<n.length)throw Error(Y(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ho(n)}}function XT(t,e){var n=ho(e.value),r=ho(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function J0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function JT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _m(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?JT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var rd,ZT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(rd=rd||document.createElement("div"),rd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=rd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Dc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var dc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Kk=["Webkit","ms","Moz","O"];Object.keys(dc).forEach(function(t){Kk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),dc[e]=dc[t]})});function eI(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||dc.hasOwnProperty(t)&&dc[t]?(""+e).trim():e+"px"}function tI(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=eI(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var Gk=wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wm(t,e){if(e){if(Gk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Y(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Y(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Y(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Y(62))}}function Em(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tm=null;function ny(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Im=null,Ol=null,Nl=null;function Z0(t){if(t=hh(t)){if(typeof Im!="function")throw Error(Y(280));var e=t.stateNode;e&&(e=ap(e),Im(t.stateNode,t.type,e))}}function nI(t){Ol?Nl?Nl.push(t):Nl=[t]:Ol=t}function rI(){if(Ol){var t=Ol,e=Nl;if(Nl=Ol=null,Z0(t),e)for(t=0;t<e.length;t++)Z0(e[t])}}function iI(t,e){return t(e)}function sI(){}var mg=!1;function oI(t,e,n){if(mg)return t(e,n);mg=!0;try{return iI(t,e,n)}finally{mg=!1,(Ol!==null||Nl!==null)&&(sI(),rI())}}function Oc(t,e){var n=t.stateNode;if(n===null)return null;var r=ap(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Y(231,e,typeof n));return n}var Sm=!1;if(Gi)try{var Fu={};Object.defineProperty(Fu,"passive",{get:function(){Sm=!0}}),window.addEventListener("test",Fu,Fu),window.removeEventListener("test",Fu,Fu)}catch{Sm=!1}function Qk(t,e,n,r,i,s,o,a,l){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(d){this.onError(d)}}var fc=!1,af=null,lf=!1,bm=null,Yk={onError:function(t){fc=!0,af=t}};function Xk(t,e,n,r,i,s,o,a,l){fc=!1,af=null,Qk.apply(Yk,arguments)}function Jk(t,e,n,r,i,s,o,a,l){if(Xk.apply(this,arguments),fc){if(fc){var h=af;fc=!1,af=null}else throw Error(Y(198));lf||(lf=!0,bm=h)}}function Da(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function aI(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ew(t){if(Da(t)!==t)throw Error(Y(188))}function Zk(t){var e=t.alternate;if(!e){if(e=Da(t),e===null)throw Error(Y(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return ew(i),t;if(s===r)return ew(i),e;s=s.sibling}throw Error(Y(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(Y(189))}}if(n.alternate!==r)throw Error(Y(190))}if(n.tag!==3)throw Error(Y(188));return n.stateNode.current===n?t:e}function lI(t){return t=Zk(t),t!==null?uI(t):null}function uI(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=uI(t);if(e!==null)return e;t=t.sibling}return null}var cI=ar.unstable_scheduleCallback,tw=ar.unstable_cancelCallback,eR=ar.unstable_shouldYield,tR=ar.unstable_requestPaint,Pt=ar.unstable_now,nR=ar.unstable_getCurrentPriorityLevel,ry=ar.unstable_ImmediatePriority,hI=ar.unstable_UserBlockingPriority,uf=ar.unstable_NormalPriority,rR=ar.unstable_LowPriority,dI=ar.unstable_IdlePriority,rp=null,wi=null;function iR(t){if(wi&&typeof wi.onCommitFiberRoot=="function")try{wi.onCommitFiberRoot(rp,t,void 0,(t.current.flags&128)===128)}catch{}}var Yr=Math.clz32?Math.clz32:aR,sR=Math.log,oR=Math.LN2;function aR(t){return t>>>=0,t===0?32:31-(sR(t)/oR|0)|0}var id=64,sd=4194304;function tc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function cf(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=tc(a):(s&=o,s!==0&&(r=tc(s)))}else o=n&~i,o!==0?r=tc(o):s!==0&&(r=tc(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Yr(e),i=1<<n,r|=t[n],e&=~i;return r}function lR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function uR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Yr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=lR(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Cm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function fI(){var t=id;return id<<=1,!(id&4194240)&&(id=64),t}function vg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function uh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Yr(e),t[e]=n}function cR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Yr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function iy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Yr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Qe=0;function pI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var gI,sy,mI,vI,yI,Am=!1,od=[],Ys=null,Xs=null,Js=null,Nc=new Map,Lc=new Map,Fs=[],hR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function nw(t,e){switch(t){case"focusin":case"focusout":Ys=null;break;case"dragenter":case"dragleave":Xs=null;break;case"mouseover":case"mouseout":Js=null;break;case"pointerover":case"pointerout":Nc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lc.delete(e.pointerId)}}function Uu(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=hh(e),e!==null&&sy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function dR(t,e,n,r,i){switch(e){case"focusin":return Ys=Uu(Ys,t,e,n,r,i),!0;case"dragenter":return Xs=Uu(Xs,t,e,n,r,i),!0;case"mouseover":return Js=Uu(Js,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Nc.set(s,Uu(Nc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Lc.set(s,Uu(Lc.get(s)||null,t,e,n,r,i)),!0}return!1}function _I(t){var e=na(t.target);if(e!==null){var n=Da(e);if(n!==null){if(e=n.tag,e===13){if(e=aI(n),e!==null){t.blockedOn=e,yI(t.priority,function(){mI(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Rd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=xm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Tm=r,n.target.dispatchEvent(r),Tm=null}else return e=hh(n),e!==null&&sy(e),t.blockedOn=n,!1;e.shift()}return!0}function rw(t,e,n){Rd(t)&&n.delete(e)}function fR(){Am=!1,Ys!==null&&Rd(Ys)&&(Ys=null),Xs!==null&&Rd(Xs)&&(Xs=null),Js!==null&&Rd(Js)&&(Js=null),Nc.forEach(rw),Lc.forEach(rw)}function $u(t,e){t.blockedOn===e&&(t.blockedOn=null,Am||(Am=!0,ar.unstable_scheduleCallback(ar.unstable_NormalPriority,fR)))}function Mc(t){function e(i){return $u(i,t)}if(0<od.length){$u(od[0],t);for(var n=1;n<od.length;n++){var r=od[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ys!==null&&$u(Ys,t),Xs!==null&&$u(Xs,t),Js!==null&&$u(Js,t),Nc.forEach(e),Lc.forEach(e),n=0;n<Fs.length;n++)r=Fs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Fs.length&&(n=Fs[0],n.blockedOn===null);)_I(n),n.blockedOn===null&&Fs.shift()}var Ll=rs.ReactCurrentBatchConfig,hf=!0;function pR(t,e,n,r){var i=Qe,s=Ll.transition;Ll.transition=null;try{Qe=1,oy(t,e,n,r)}finally{Qe=i,Ll.transition=s}}function gR(t,e,n,r){var i=Qe,s=Ll.transition;Ll.transition=null;try{Qe=4,oy(t,e,n,r)}finally{Qe=i,Ll.transition=s}}function oy(t,e,n,r){if(hf){var i=xm(t,e,n,r);if(i===null)Ag(t,e,r,df,n),nw(t,r);else if(dR(i,t,e,n,r))r.stopPropagation();else if(nw(t,r),e&4&&-1<hR.indexOf(t)){for(;i!==null;){var s=hh(i);if(s!==null&&gI(s),s=xm(t,e,n,r),s===null&&Ag(t,e,r,df,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Ag(t,e,r,null,n)}}var df=null;function xm(t,e,n,r){if(df=null,t=ny(r),t=na(t),t!==null)if(e=Da(t),e===null)t=null;else if(n=e.tag,n===13){if(t=aI(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return df=t,null}function wI(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nR()){case ry:return 1;case hI:return 4;case uf:case rR:return 16;case dI:return 536870912;default:return 16}default:return 16}}var Ws=null,ay=null,Dd=null;function EI(){if(Dd)return Dd;var t,e=ay,n=e.length,r,i="value"in Ws?Ws.value:Ws.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Dd=i.slice(t,1<r?1-r:void 0)}function Od(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ad(){return!0}function iw(){return!1}function cr(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ad:iw,this.isPropagationStopped=iw,this}return wt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ad)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ad)},persist:function(){},isPersistent:ad}),e}var au={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ly=cr(au),ch=wt({},au,{view:0,detail:0}),mR=cr(ch),yg,_g,zu,ip=wt({},ch,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==zu&&(zu&&t.type==="mousemove"?(yg=t.screenX-zu.screenX,_g=t.screenY-zu.screenY):_g=yg=0,zu=t),yg)},movementY:function(t){return"movementY"in t?t.movementY:_g}}),sw=cr(ip),vR=wt({},ip,{dataTransfer:0}),yR=cr(vR),_R=wt({},ch,{relatedTarget:0}),wg=cr(_R),wR=wt({},au,{animationName:0,elapsedTime:0,pseudoElement:0}),ER=cr(wR),TR=wt({},au,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),IR=cr(TR),SR=wt({},au,{data:0}),ow=cr(SR),bR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},CR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},AR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xR(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=AR[t])?!!e[t]:!1}function uy(){return xR}var PR=wt({},ch,{key:function(t){if(t.key){var e=bR[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Od(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?CR[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uy,charCode:function(t){return t.type==="keypress"?Od(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Od(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),kR=cr(PR),RR=wt({},ip,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),aw=cr(RR),DR=wt({},ch,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uy}),OR=cr(DR),NR=wt({},au,{propertyName:0,elapsedTime:0,pseudoElement:0}),LR=cr(NR),MR=wt({},ip,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),VR=cr(MR),jR=[9,13,27,32],cy=Gi&&"CompositionEvent"in window,pc=null;Gi&&"documentMode"in document&&(pc=document.documentMode);var FR=Gi&&"TextEvent"in window&&!pc,TI=Gi&&(!cy||pc&&8<pc&&11>=pc),lw=" ",uw=!1;function II(t,e){switch(t){case"keyup":return jR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function SI(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var El=!1;function UR(t,e){switch(t){case"compositionend":return SI(e);case"keypress":return e.which!==32?null:(uw=!0,lw);case"textInput":return t=e.data,t===lw&&uw?null:t;default:return null}}function $R(t,e){if(El)return t==="compositionend"||!cy&&II(t,e)?(t=EI(),Dd=ay=Ws=null,El=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return TI&&e.locale!=="ko"?null:e.data;default:return null}}var zR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!zR[t.type]:e==="textarea"}function bI(t,e,n,r){nI(r),e=ff(e,"onChange"),0<e.length&&(n=new ly("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var gc=null,Vc=null;function BR(t){MI(t,0)}function sp(t){var e=Sl(t);if(QT(e))return t}function qR(t,e){if(t==="change")return e}var CI=!1;if(Gi){var Eg;if(Gi){var Tg="oninput"in document;if(!Tg){var hw=document.createElement("div");hw.setAttribute("oninput","return;"),Tg=typeof hw.oninput=="function"}Eg=Tg}else Eg=!1;CI=Eg&&(!document.documentMode||9<document.documentMode)}function dw(){gc&&(gc.detachEvent("onpropertychange",AI),Vc=gc=null)}function AI(t){if(t.propertyName==="value"&&sp(Vc)){var e=[];bI(e,Vc,t,ny(t)),oI(BR,e)}}function HR(t,e,n){t==="focusin"?(dw(),gc=e,Vc=n,gc.attachEvent("onpropertychange",AI)):t==="focusout"&&dw()}function WR(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return sp(Vc)}function KR(t,e){if(t==="click")return sp(e)}function GR(t,e){if(t==="input"||t==="change")return sp(e)}function QR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ei=typeof Object.is=="function"?Object.is:QR;function jc(t,e){if(ei(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!cm.call(e,i)||!ei(t[i],e[i]))return!1}return!0}function fw(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function pw(t,e){var n=fw(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=fw(n)}}function xI(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?xI(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function PI(){for(var t=window,e=of();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=of(t.document)}return e}function hy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function YR(t){var e=PI(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&xI(n.ownerDocument.documentElement,n)){if(r!==null&&hy(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=pw(n,s);var o=pw(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var XR=Gi&&"documentMode"in document&&11>=document.documentMode,Tl=null,Pm=null,mc=null,km=!1;function gw(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;km||Tl==null||Tl!==of(r)||(r=Tl,"selectionStart"in r&&hy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),mc&&jc(mc,r)||(mc=r,r=ff(Pm,"onSelect"),0<r.length&&(e=new ly("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Tl)))}function ld(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Il={animationend:ld("Animation","AnimationEnd"),animationiteration:ld("Animation","AnimationIteration"),animationstart:ld("Animation","AnimationStart"),transitionend:ld("Transition","TransitionEnd")},Ig={},kI={};Gi&&(kI=document.createElement("div").style,"AnimationEvent"in window||(delete Il.animationend.animation,delete Il.animationiteration.animation,delete Il.animationstart.animation),"TransitionEvent"in window||delete Il.transitionend.transition);function op(t){if(Ig[t])return Ig[t];if(!Il[t])return t;var e=Il[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in kI)return Ig[t]=e[n];return t}var RI=op("animationend"),DI=op("animationiteration"),OI=op("animationstart"),NI=op("transitionend"),LI=new Map,mw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yo(t,e){LI.set(t,e),Ra(e,[t])}for(var Sg=0;Sg<mw.length;Sg++){var bg=mw[Sg],JR=bg.toLowerCase(),ZR=bg[0].toUpperCase()+bg.slice(1);yo(JR,"on"+ZR)}yo(RI,"onAnimationEnd");yo(DI,"onAnimationIteration");yo(OI,"onAnimationStart");yo("dblclick","onDoubleClick");yo("focusin","onFocus");yo("focusout","onBlur");yo(NI,"onTransitionEnd");zl("onMouseEnter",["mouseout","mouseover"]);zl("onMouseLeave",["mouseout","mouseover"]);zl("onPointerEnter",["pointerout","pointerover"]);zl("onPointerLeave",["pointerout","pointerover"]);Ra("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ra("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ra("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ra("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ra("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ra("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eD=new Set("cancel close invalid load scroll toggle".split(" ").concat(nc));function vw(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Jk(r,e,void 0,t),t.currentTarget=null}function MI(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,h=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;vw(i,a,h),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,h=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;vw(i,a,h),s=l}}}if(lf)throw t=bm,lf=!1,bm=null,t}function ut(t,e){var n=e[Lm];n===void 0&&(n=e[Lm]=new Set);var r=t+"__bubble";n.has(r)||(VI(e,t,2,!1),n.add(r))}function Cg(t,e,n){var r=0;e&&(r|=4),VI(n,t,r,e)}var ud="_reactListening"+Math.random().toString(36).slice(2);function Fc(t){if(!t[ud]){t[ud]=!0,qT.forEach(function(n){n!=="selectionchange"&&(eD.has(n)||Cg(n,!1,t),Cg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ud]||(e[ud]=!0,Cg("selectionchange",!1,e))}}function VI(t,e,n,r){switch(wI(e)){case 1:var i=pR;break;case 4:i=gR;break;default:i=oy}n=i.bind(null,e,n,t),i=void 0,!Sm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Ag(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=na(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}oI(function(){var h=s,d=ny(n),p=[];e:{var m=LI.get(t);if(m!==void 0){var w=ly,E=t;switch(t){case"keypress":if(Od(n)===0)break e;case"keydown":case"keyup":w=kR;break;case"focusin":E="focus",w=wg;break;case"focusout":E="blur",w=wg;break;case"beforeblur":case"afterblur":w=wg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=sw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=yR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=OR;break;case RI:case DI:case OI:w=ER;break;case NI:w=LR;break;case"scroll":w=mR;break;case"wheel":w=VR;break;case"copy":case"cut":case"paste":w=IR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=aw}var x=(e&4)!==0,D=!x&&t==="scroll",A=x?m!==null?m+"Capture":null:m;x=[];for(var T=h,S;T!==null;){S=T;var M=S.stateNode;if(S.tag===5&&M!==null&&(S=M,A!==null&&(M=Oc(T,A),M!=null&&x.push(Uc(T,M,S)))),D)break;T=T.return}0<x.length&&(m=new w(m,E,null,n,d),p.push({event:m,listeners:x}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",m&&n!==Tm&&(E=n.relatedTarget||n.fromElement)&&(na(E)||E[Qi]))break e;if((w||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,w?(E=n.relatedTarget||n.toElement,w=h,E=E?na(E):null,E!==null&&(D=Da(E),E!==D||E.tag!==5&&E.tag!==6)&&(E=null)):(w=null,E=h),w!==E)){if(x=sw,M="onMouseLeave",A="onMouseEnter",T="mouse",(t==="pointerout"||t==="pointerover")&&(x=aw,M="onPointerLeave",A="onPointerEnter",T="pointer"),D=w==null?m:Sl(w),S=E==null?m:Sl(E),m=new x(M,T+"leave",w,n,d),m.target=D,m.relatedTarget=S,M=null,na(d)===h&&(x=new x(A,T+"enter",E,n,d),x.target=S,x.relatedTarget=D,M=x),D=M,w&&E)t:{for(x=w,A=E,T=0,S=x;S;S=al(S))T++;for(S=0,M=A;M;M=al(M))S++;for(;0<T-S;)x=al(x),T--;for(;0<S-T;)A=al(A),S--;for(;T--;){if(x===A||A!==null&&x===A.alternate)break t;x=al(x),A=al(A)}x=null}else x=null;w!==null&&yw(p,m,w,x,!1),E!==null&&D!==null&&yw(p,D,E,x,!0)}}e:{if(m=h?Sl(h):window,w=m.nodeName&&m.nodeName.toLowerCase(),w==="select"||w==="input"&&m.type==="file")var q=qR;else if(cw(m))if(CI)q=GR;else{q=WR;var W=HR}else(w=m.nodeName)&&w.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(q=KR);if(q&&(q=q(t,h))){bI(p,q,n,d);break e}W&&W(t,m,h),t==="focusout"&&(W=m._wrapperState)&&W.controlled&&m.type==="number"&&vm(m,"number",m.value)}switch(W=h?Sl(h):window,t){case"focusin":(cw(W)||W.contentEditable==="true")&&(Tl=W,Pm=h,mc=null);break;case"focusout":mc=Pm=Tl=null;break;case"mousedown":km=!0;break;case"contextmenu":case"mouseup":case"dragend":km=!1,gw(p,n,d);break;case"selectionchange":if(XR)break;case"keydown":case"keyup":gw(p,n,d)}var P;if(cy)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else El?II(t,n)&&(C="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(TI&&n.locale!=="ko"&&(El||C!=="onCompositionStart"?C==="onCompositionEnd"&&El&&(P=EI()):(Ws=d,ay="value"in Ws?Ws.value:Ws.textContent,El=!0)),W=ff(h,C),0<W.length&&(C=new ow(C,t,null,n,d),p.push({event:C,listeners:W}),P?C.data=P:(P=SI(n),P!==null&&(C.data=P)))),(P=FR?UR(t,n):$R(t,n))&&(h=ff(h,"onBeforeInput"),0<h.length&&(d=new ow("onBeforeInput","beforeinput",null,n,d),p.push({event:d,listeners:h}),d.data=P))}MI(p,e)})}function Uc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ff(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Oc(t,n),s!=null&&r.unshift(Uc(t,s,i)),s=Oc(t,e),s!=null&&r.push(Uc(t,s,i))),t=t.return}return r}function al(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function yw(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,h=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&h!==null&&(a=h,i?(l=Oc(n,s),l!=null&&o.unshift(Uc(n,l,a))):i||(l=Oc(n,s),l!=null&&o.push(Uc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var tD=/\r\n?/g,nD=/\u0000|\uFFFD/g;function _w(t){return(typeof t=="string"?t:""+t).replace(tD,`
`).replace(nD,"")}function cd(t,e,n){if(e=_w(e),_w(t)!==e&&n)throw Error(Y(425))}function pf(){}var Rm=null,Dm=null;function Om(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Nm=typeof setTimeout=="function"?setTimeout:void 0,rD=typeof clearTimeout=="function"?clearTimeout:void 0,ww=typeof Promise=="function"?Promise:void 0,iD=typeof queueMicrotask=="function"?queueMicrotask:typeof ww<"u"?function(t){return ww.resolve(null).then(t).catch(sD)}:Nm;function sD(t){setTimeout(function(){throw t})}function xg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Mc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Mc(e)}function Zs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Ew(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var lu=Math.random().toString(36).slice(2),mi="__reactFiber$"+lu,$c="__reactProps$"+lu,Qi="__reactContainer$"+lu,Lm="__reactEvents$"+lu,oD="__reactListeners$"+lu,aD="__reactHandles$"+lu;function na(t){var e=t[mi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Qi]||n[mi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Ew(t);t!==null;){if(n=t[mi])return n;t=Ew(t)}return e}t=n,n=t.parentNode}return null}function hh(t){return t=t[mi]||t[Qi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Sl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Y(33))}function ap(t){return t[$c]||null}var Mm=[],bl=-1;function _o(t){return{current:t}}function ht(t){0>bl||(t.current=Mm[bl],Mm[bl]=null,bl--)}function at(t,e){bl++,Mm[bl]=t.current,t.current=e}var fo={},vn=_o(fo),zn=_o(!1),da=fo;function Bl(t,e){var n=t.type.contextTypes;if(!n)return fo;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Bn(t){return t=t.childContextTypes,t!=null}function gf(){ht(zn),ht(vn)}function Tw(t,e,n){if(vn.current!==fo)throw Error(Y(168));at(vn,e),at(zn,n)}function jI(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Y(108,Hk(t)||"Unknown",i));return wt({},n,r)}function mf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||fo,da=vn.current,at(vn,t),at(zn,zn.current),!0}function Iw(t,e,n){var r=t.stateNode;if(!r)throw Error(Y(169));n?(t=jI(t,e,da),r.__reactInternalMemoizedMergedChildContext=t,ht(zn),ht(vn),at(vn,t)):ht(zn),at(zn,n)}var ji=null,lp=!1,Pg=!1;function FI(t){ji===null?ji=[t]:ji.push(t)}function lD(t){lp=!0,FI(t)}function wo(){if(!Pg&&ji!==null){Pg=!0;var t=0,e=Qe;try{var n=ji;for(Qe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ji=null,lp=!1}catch(i){throw ji!==null&&(ji=ji.slice(t+1)),cI(ry,wo),i}finally{Qe=e,Pg=!1}}return null}var Cl=[],Al=0,vf=null,yf=0,br=[],Cr=0,fa=null,Fi=1,Ui="";function Go(t,e){Cl[Al++]=yf,Cl[Al++]=vf,vf=t,yf=e}function UI(t,e,n){br[Cr++]=Fi,br[Cr++]=Ui,br[Cr++]=fa,fa=t;var r=Fi;t=Ui;var i=32-Yr(r)-1;r&=~(1<<i),n+=1;var s=32-Yr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Fi=1<<32-Yr(e)+i|n<<i|r,Ui=s+t}else Fi=1<<s|n<<i|r,Ui=t}function dy(t){t.return!==null&&(Go(t,1),UI(t,1,0))}function fy(t){for(;t===vf;)vf=Cl[--Al],Cl[Al]=null,yf=Cl[--Al],Cl[Al]=null;for(;t===fa;)fa=br[--Cr],br[Cr]=null,Ui=br[--Cr],br[Cr]=null,Fi=br[--Cr],br[Cr]=null}var ir=null,tr=null,ft=!1,Gr=null;function $I(t,e){var n=xr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Sw(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ir=t,tr=Zs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ir=t,tr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=fa!==null?{id:Fi,overflow:Ui}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=xr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ir=t,tr=null,!0):!1;default:return!1}}function Vm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function jm(t){if(ft){var e=tr;if(e){var n=e;if(!Sw(t,e)){if(Vm(t))throw Error(Y(418));e=Zs(n.nextSibling);var r=ir;e&&Sw(t,e)?$I(r,n):(t.flags=t.flags&-4097|2,ft=!1,ir=t)}}else{if(Vm(t))throw Error(Y(418));t.flags=t.flags&-4097|2,ft=!1,ir=t}}}function bw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ir=t}function hd(t){if(t!==ir)return!1;if(!ft)return bw(t),ft=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Om(t.type,t.memoizedProps)),e&&(e=tr)){if(Vm(t))throw zI(),Error(Y(418));for(;e;)$I(t,e),e=Zs(e.nextSibling)}if(bw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Y(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){tr=Zs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}tr=null}}else tr=ir?Zs(t.stateNode.nextSibling):null;return!0}function zI(){for(var t=tr;t;)t=Zs(t.nextSibling)}function ql(){tr=ir=null,ft=!1}function py(t){Gr===null?Gr=[t]:Gr.push(t)}var uD=rs.ReactCurrentBatchConfig;function Bu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Y(309));var r=n.stateNode}if(!r)throw Error(Y(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Y(284));if(!n._owner)throw Error(Y(290,t))}return t}function dd(t,e){throw t=Object.prototype.toString.call(e),Error(Y(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Cw(t){var e=t._init;return e(t._payload)}function BI(t){function e(A,T){if(t){var S=A.deletions;S===null?(A.deletions=[T],A.flags|=16):S.push(T)}}function n(A,T){if(!t)return null;for(;T!==null;)e(A,T),T=T.sibling;return null}function r(A,T){for(A=new Map;T!==null;)T.key!==null?A.set(T.key,T):A.set(T.index,T),T=T.sibling;return A}function i(A,T){return A=ro(A,T),A.index=0,A.sibling=null,A}function s(A,T,S){return A.index=S,t?(S=A.alternate,S!==null?(S=S.index,S<T?(A.flags|=2,T):S):(A.flags|=2,T)):(A.flags|=1048576,T)}function o(A){return t&&A.alternate===null&&(A.flags|=2),A}function a(A,T,S,M){return T===null||T.tag!==6?(T=Mg(S,A.mode,M),T.return=A,T):(T=i(T,S),T.return=A,T)}function l(A,T,S,M){var q=S.type;return q===wl?d(A,T,S.props.children,M,S.key):T!==null&&(T.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===Ls&&Cw(q)===T.type)?(M=i(T,S.props),M.ref=Bu(A,T,S),M.return=A,M):(M=Ud(S.type,S.key,S.props,null,A.mode,M),M.ref=Bu(A,T,S),M.return=A,M)}function h(A,T,S,M){return T===null||T.tag!==4||T.stateNode.containerInfo!==S.containerInfo||T.stateNode.implementation!==S.implementation?(T=Vg(S,A.mode,M),T.return=A,T):(T=i(T,S.children||[]),T.return=A,T)}function d(A,T,S,M,q){return T===null||T.tag!==7?(T=la(S,A.mode,M,q),T.return=A,T):(T=i(T,S),T.return=A,T)}function p(A,T,S){if(typeof T=="string"&&T!==""||typeof T=="number")return T=Mg(""+T,A.mode,S),T.return=A,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case td:return S=Ud(T.type,T.key,T.props,null,A.mode,S),S.ref=Bu(A,null,T),S.return=A,S;case _l:return T=Vg(T,A.mode,S),T.return=A,T;case Ls:var M=T._init;return p(A,M(T._payload),S)}if(ec(T)||ju(T))return T=la(T,A.mode,S,null),T.return=A,T;dd(A,T)}return null}function m(A,T,S,M){var q=T!==null?T.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return q!==null?null:a(A,T,""+S,M);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case td:return S.key===q?l(A,T,S,M):null;case _l:return S.key===q?h(A,T,S,M):null;case Ls:return q=S._init,m(A,T,q(S._payload),M)}if(ec(S)||ju(S))return q!==null?null:d(A,T,S,M,null);dd(A,S)}return null}function w(A,T,S,M,q){if(typeof M=="string"&&M!==""||typeof M=="number")return A=A.get(S)||null,a(T,A,""+M,q);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case td:return A=A.get(M.key===null?S:M.key)||null,l(T,A,M,q);case _l:return A=A.get(M.key===null?S:M.key)||null,h(T,A,M,q);case Ls:var W=M._init;return w(A,T,S,W(M._payload),q)}if(ec(M)||ju(M))return A=A.get(S)||null,d(T,A,M,q,null);dd(T,M)}return null}function E(A,T,S,M){for(var q=null,W=null,P=T,C=T=0,R=null;P!==null&&C<S.length;C++){P.index>C?(R=P,P=null):R=P.sibling;var O=m(A,P,S[C],M);if(O===null){P===null&&(P=R);break}t&&P&&O.alternate===null&&e(A,P),T=s(O,T,C),W===null?q=O:W.sibling=O,W=O,P=R}if(C===S.length)return n(A,P),ft&&Go(A,C),q;if(P===null){for(;C<S.length;C++)P=p(A,S[C],M),P!==null&&(T=s(P,T,C),W===null?q=P:W.sibling=P,W=P);return ft&&Go(A,C),q}for(P=r(A,P);C<S.length;C++)R=w(P,A,C,S[C],M),R!==null&&(t&&R.alternate!==null&&P.delete(R.key===null?C:R.key),T=s(R,T,C),W===null?q=R:W.sibling=R,W=R);return t&&P.forEach(function(L){return e(A,L)}),ft&&Go(A,C),q}function x(A,T,S,M){var q=ju(S);if(typeof q!="function")throw Error(Y(150));if(S=q.call(S),S==null)throw Error(Y(151));for(var W=q=null,P=T,C=T=0,R=null,O=S.next();P!==null&&!O.done;C++,O=S.next()){P.index>C?(R=P,P=null):R=P.sibling;var L=m(A,P,O.value,M);if(L===null){P===null&&(P=R);break}t&&P&&L.alternate===null&&e(A,P),T=s(L,T,C),W===null?q=L:W.sibling=L,W=L,P=R}if(O.done)return n(A,P),ft&&Go(A,C),q;if(P===null){for(;!O.done;C++,O=S.next())O=p(A,O.value,M),O!==null&&(T=s(O,T,C),W===null?q=O:W.sibling=O,W=O);return ft&&Go(A,C),q}for(P=r(A,P);!O.done;C++,O=S.next())O=w(P,A,C,O.value,M),O!==null&&(t&&O.alternate!==null&&P.delete(O.key===null?C:O.key),T=s(O,T,C),W===null?q=O:W.sibling=O,W=O);return t&&P.forEach(function(V){return e(A,V)}),ft&&Go(A,C),q}function D(A,T,S,M){if(typeof S=="object"&&S!==null&&S.type===wl&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case td:e:{for(var q=S.key,W=T;W!==null;){if(W.key===q){if(q=S.type,q===wl){if(W.tag===7){n(A,W.sibling),T=i(W,S.props.children),T.return=A,A=T;break e}}else if(W.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===Ls&&Cw(q)===W.type){n(A,W.sibling),T=i(W,S.props),T.ref=Bu(A,W,S),T.return=A,A=T;break e}n(A,W);break}else e(A,W);W=W.sibling}S.type===wl?(T=la(S.props.children,A.mode,M,S.key),T.return=A,A=T):(M=Ud(S.type,S.key,S.props,null,A.mode,M),M.ref=Bu(A,T,S),M.return=A,A=M)}return o(A);case _l:e:{for(W=S.key;T!==null;){if(T.key===W)if(T.tag===4&&T.stateNode.containerInfo===S.containerInfo&&T.stateNode.implementation===S.implementation){n(A,T.sibling),T=i(T,S.children||[]),T.return=A,A=T;break e}else{n(A,T);break}else e(A,T);T=T.sibling}T=Vg(S,A.mode,M),T.return=A,A=T}return o(A);case Ls:return W=S._init,D(A,T,W(S._payload),M)}if(ec(S))return E(A,T,S,M);if(ju(S))return x(A,T,S,M);dd(A,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,T!==null&&T.tag===6?(n(A,T.sibling),T=i(T,S),T.return=A,A=T):(n(A,T),T=Mg(S,A.mode,M),T.return=A,A=T),o(A)):n(A,T)}return D}var Hl=BI(!0),qI=BI(!1),_f=_o(null),wf=null,xl=null,gy=null;function my(){gy=xl=wf=null}function vy(t){var e=_f.current;ht(_f),t._currentValue=e}function Fm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ml(t,e){wf=t,gy=xl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&($n=!0),t.firstContext=null)}function Or(t){var e=t._currentValue;if(gy!==t)if(t={context:t,memoizedValue:e,next:null},xl===null){if(wf===null)throw Error(Y(308));xl=t,wf.dependencies={lanes:0,firstContext:t}}else xl=xl.next=t;return e}var ra=null;function yy(t){ra===null?ra=[t]:ra.push(t)}function HI(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,yy(e)):(n.next=i.next,i.next=n),e.interleaved=n,Yi(t,r)}function Yi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ms=!1;function _y(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function WI(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Hi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function eo(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,je&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Yi(t,n)}return i=r.interleaved,i===null?(e.next=e,yy(r)):(e.next=i.next,i.next=e),r.interleaved=e,Yi(t,n)}function Nd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,iy(t,n)}}function Aw(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ef(t,e,n,r){var i=t.updateQueue;Ms=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,h=l.next;l.next=null,o===null?s=h:o.next=h,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=h:a.next=h,d.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;o=0,d=h=l=null,a=s;do{var m=a.lane,w=a.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:w,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=t,x=a;switch(m=e,w=n,x.tag){case 1:if(E=x.payload,typeof E=="function"){p=E.call(w,p,m);break e}p=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=x.payload,m=typeof E=="function"?E.call(w,p,m):E,m==null)break e;p=wt({},p,m);break e;case 2:Ms=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[a]:m.push(a))}else w={eventTime:w,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(h=d=w,l=p):d=d.next=w,o|=m;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;m=a,a=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(d===null&&(l=p),i.baseState=l,i.firstBaseUpdate=h,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ga|=o,t.lanes=o,t.memoizedState=p}}function xw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Y(191,i));i.call(r)}}}var dh={},Ei=_o(dh),zc=_o(dh),Bc=_o(dh);function ia(t){if(t===dh)throw Error(Y(174));return t}function wy(t,e){switch(at(Bc,e),at(zc,t),at(Ei,dh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:_m(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=_m(e,t)}ht(Ei),at(Ei,e)}function Wl(){ht(Ei),ht(zc),ht(Bc)}function KI(t){ia(Bc.current);var e=ia(Ei.current),n=_m(e,t.type);e!==n&&(at(zc,t),at(Ei,n))}function Ey(t){zc.current===t&&(ht(Ei),ht(zc))}var mt=_o(0);function Tf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var kg=[];function Ty(){for(var t=0;t<kg.length;t++)kg[t]._workInProgressVersionPrimary=null;kg.length=0}var Ld=rs.ReactCurrentDispatcher,Rg=rs.ReactCurrentBatchConfig,pa=0,yt=null,Bt=null,Jt=null,If=!1,vc=!1,qc=0,cD=0;function cn(){throw Error(Y(321))}function Iy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ei(t[n],e[n]))return!1;return!0}function Sy(t,e,n,r,i,s){if(pa=s,yt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ld.current=t===null||t.memoizedState===null?pD:gD,t=n(r,i),vc){s=0;do{if(vc=!1,qc=0,25<=s)throw Error(Y(301));s+=1,Jt=Bt=null,e.updateQueue=null,Ld.current=mD,t=n(r,i)}while(vc)}if(Ld.current=Sf,e=Bt!==null&&Bt.next!==null,pa=0,Jt=Bt=yt=null,If=!1,e)throw Error(Y(300));return t}function by(){var t=qc!==0;return qc=0,t}function gi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?yt.memoizedState=Jt=t:Jt=Jt.next=t,Jt}function Nr(){if(Bt===null){var t=yt.alternate;t=t!==null?t.memoizedState:null}else t=Bt.next;var e=Jt===null?yt.memoizedState:Jt.next;if(e!==null)Jt=e,Bt=t;else{if(t===null)throw Error(Y(310));Bt=t,t={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},Jt===null?yt.memoizedState=Jt=t:Jt=Jt.next=t}return Jt}function Hc(t,e){return typeof e=="function"?e(t):e}function Dg(t){var e=Nr(),n=e.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=t;var r=Bt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,h=s;do{var d=h.lane;if((pa&d)===d)l!==null&&(l=l.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var p={lane:d,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};l===null?(a=l=p,o=r):l=l.next=p,yt.lanes|=d,ga|=d}h=h.next}while(h!==null&&h!==s);l===null?o=r:l.next=a,ei(r,e.memoizedState)||($n=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,yt.lanes|=s,ga|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Og(t){var e=Nr(),n=e.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);ei(s,e.memoizedState)||($n=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function GI(){}function QI(t,e){var n=yt,r=Nr(),i=e(),s=!ei(r.memoizedState,i);if(s&&(r.memoizedState=i,$n=!0),r=r.queue,Cy(JI.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Jt!==null&&Jt.memoizedState.tag&1){if(n.flags|=2048,Wc(9,XI.bind(null,n,r,i,e),void 0,null),Zt===null)throw Error(Y(349));pa&30||YI(n,e,i)}return i}function YI(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function XI(t,e,n,r){e.value=n,e.getSnapshot=r,ZI(e)&&eS(t)}function JI(t,e,n){return n(function(){ZI(e)&&eS(t)})}function ZI(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ei(t,n)}catch{return!0}}function eS(t){var e=Yi(t,1);e!==null&&Xr(e,t,1,-1)}function Pw(t){var e=gi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hc,lastRenderedState:t},e.queue=t,t=t.dispatch=fD.bind(null,yt,t),[e.memoizedState,t]}function Wc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function tS(){return Nr().memoizedState}function Md(t,e,n,r){var i=gi();yt.flags|=t,i.memoizedState=Wc(1|e,n,void 0,r===void 0?null:r)}function up(t,e,n,r){var i=Nr();r=r===void 0?null:r;var s=void 0;if(Bt!==null){var o=Bt.memoizedState;if(s=o.destroy,r!==null&&Iy(r,o.deps)){i.memoizedState=Wc(e,n,s,r);return}}yt.flags|=t,i.memoizedState=Wc(1|e,n,s,r)}function kw(t,e){return Md(8390656,8,t,e)}function Cy(t,e){return up(2048,8,t,e)}function nS(t,e){return up(4,2,t,e)}function rS(t,e){return up(4,4,t,e)}function iS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function sS(t,e,n){return n=n!=null?n.concat([t]):null,up(4,4,iS.bind(null,e,t),n)}function Ay(){}function oS(t,e){var n=Nr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Iy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function aS(t,e){var n=Nr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Iy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function lS(t,e,n){return pa&21?(ei(n,e)||(n=fI(),yt.lanes|=n,ga|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,$n=!0),t.memoizedState=n)}function hD(t,e){var n=Qe;Qe=n!==0&&4>n?n:4,t(!0);var r=Rg.transition;Rg.transition={};try{t(!1),e()}finally{Qe=n,Rg.transition=r}}function uS(){return Nr().memoizedState}function dD(t,e,n){var r=no(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},cS(t))hS(e,n);else if(n=HI(t,e,n,r),n!==null){var i=xn();Xr(n,t,r,i),dS(n,e,r)}}function fD(t,e,n){var r=no(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(cS(t))hS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ei(a,o)){var l=e.interleaved;l===null?(i.next=i,yy(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=HI(t,e,i,r),n!==null&&(i=xn(),Xr(n,t,r,i),dS(n,e,r))}}function cS(t){var e=t.alternate;return t===yt||e!==null&&e===yt}function hS(t,e){vc=If=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function dS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,iy(t,n)}}var Sf={readContext:Or,useCallback:cn,useContext:cn,useEffect:cn,useImperativeHandle:cn,useInsertionEffect:cn,useLayoutEffect:cn,useMemo:cn,useReducer:cn,useRef:cn,useState:cn,useDebugValue:cn,useDeferredValue:cn,useTransition:cn,useMutableSource:cn,useSyncExternalStore:cn,useId:cn,unstable_isNewReconciler:!1},pD={readContext:Or,useCallback:function(t,e){return gi().memoizedState=[t,e===void 0?null:e],t},useContext:Or,useEffect:kw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Md(4194308,4,iS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Md(4194308,4,t,e)},useInsertionEffect:function(t,e){return Md(4,2,t,e)},useMemo:function(t,e){var n=gi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=gi();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=dD.bind(null,yt,t),[r.memoizedState,t]},useRef:function(t){var e=gi();return t={current:t},e.memoizedState=t},useState:Pw,useDebugValue:Ay,useDeferredValue:function(t){return gi().memoizedState=t},useTransition:function(){var t=Pw(!1),e=t[0];return t=hD.bind(null,t[1]),gi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=yt,i=gi();if(ft){if(n===void 0)throw Error(Y(407));n=n()}else{if(n=e(),Zt===null)throw Error(Y(349));pa&30||YI(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,kw(JI.bind(null,r,s,t),[t]),r.flags|=2048,Wc(9,XI.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=gi(),e=Zt.identifierPrefix;if(ft){var n=Ui,r=Fi;n=(r&~(1<<32-Yr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=qc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=cD++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},gD={readContext:Or,useCallback:oS,useContext:Or,useEffect:Cy,useImperativeHandle:sS,useInsertionEffect:nS,useLayoutEffect:rS,useMemo:aS,useReducer:Dg,useRef:tS,useState:function(){return Dg(Hc)},useDebugValue:Ay,useDeferredValue:function(t){var e=Nr();return lS(e,Bt.memoizedState,t)},useTransition:function(){var t=Dg(Hc)[0],e=Nr().memoizedState;return[t,e]},useMutableSource:GI,useSyncExternalStore:QI,useId:uS,unstable_isNewReconciler:!1},mD={readContext:Or,useCallback:oS,useContext:Or,useEffect:Cy,useImperativeHandle:sS,useInsertionEffect:nS,useLayoutEffect:rS,useMemo:aS,useReducer:Og,useRef:tS,useState:function(){return Og(Hc)},useDebugValue:Ay,useDeferredValue:function(t){var e=Nr();return Bt===null?e.memoizedState=t:lS(e,Bt.memoizedState,t)},useTransition:function(){var t=Og(Hc)[0],e=Nr().memoizedState;return[t,e]},useMutableSource:GI,useSyncExternalStore:QI,useId:uS,unstable_isNewReconciler:!1};function Wr(t,e){if(t&&t.defaultProps){e=wt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Um(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:wt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var cp={isMounted:function(t){return(t=t._reactInternals)?Da(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=xn(),i=no(t),s=Hi(r,i);s.payload=e,n!=null&&(s.callback=n),e=eo(t,s,i),e!==null&&(Xr(e,t,i,r),Nd(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=xn(),i=no(t),s=Hi(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=eo(t,s,i),e!==null&&(Xr(e,t,i,r),Nd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=xn(),r=no(t),i=Hi(n,r);i.tag=2,e!=null&&(i.callback=e),e=eo(t,i,r),e!==null&&(Xr(e,t,r,n),Nd(e,t,r))}};function Rw(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!jc(n,r)||!jc(i,s):!0}function fS(t,e,n){var r=!1,i=fo,s=e.contextType;return typeof s=="object"&&s!==null?s=Or(s):(i=Bn(e)?da:vn.current,r=e.contextTypes,s=(r=r!=null)?Bl(t,i):fo),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=cp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Dw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&cp.enqueueReplaceState(e,e.state,null)}function $m(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},_y(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Or(s):(s=Bn(e)?da:vn.current,i.context=Bl(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Um(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&cp.enqueueReplaceState(i,i.state,null),Ef(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Kl(t,e){try{var n="",r=e;do n+=qk(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Ng(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function zm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var vD=typeof WeakMap=="function"?WeakMap:Map;function pS(t,e,n){n=Hi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Cf||(Cf=!0,Jm=r),zm(t,e)},n}function gS(t,e,n){n=Hi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){zm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){zm(t,e),typeof r!="function"&&(to===null?to=new Set([this]):to.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Ow(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new vD;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=RD.bind(null,t,e,n),e.then(t,t))}function Nw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Lw(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Hi(-1,1),e.tag=2,eo(n,e,1))),n.lanes|=1),t)}var yD=rs.ReactCurrentOwner,$n=!1;function In(t,e,n,r){e.child=t===null?qI(e,null,n,r):Hl(e,t.child,n,r)}function Mw(t,e,n,r,i){n=n.render;var s=e.ref;return Ml(e,i),r=Sy(t,e,n,r,s,i),n=by(),t!==null&&!$n?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Xi(t,e,i)):(ft&&n&&dy(e),e.flags|=1,In(t,e,r,i),e.child)}function Vw(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Ly(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,mS(t,e,s,r,i)):(t=Ud(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:jc,n(o,r)&&t.ref===e.ref)return Xi(t,e,i)}return e.flags|=1,t=ro(s,r),t.ref=e.ref,t.return=e,e.child=t}function mS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(jc(s,r)&&t.ref===e.ref)if($n=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&($n=!0);else return e.lanes=t.lanes,Xi(t,e,i)}return Bm(t,e,n,r,i)}function vS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(kl,er),er|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,at(kl,er),er|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,at(kl,er),er|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,at(kl,er),er|=r;return In(t,e,i,n),e.child}function yS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Bm(t,e,n,r,i){var s=Bn(n)?da:vn.current;return s=Bl(e,s),Ml(e,i),n=Sy(t,e,n,r,s,i),r=by(),t!==null&&!$n?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Xi(t,e,i)):(ft&&r&&dy(e),e.flags|=1,In(t,e,n,i),e.child)}function jw(t,e,n,r,i){if(Bn(n)){var s=!0;mf(e)}else s=!1;if(Ml(e,i),e.stateNode===null)Vd(t,e),fS(e,n,r),$m(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=Or(h):(h=Bn(n)?da:vn.current,h=Bl(e,h));var d=n.getDerivedStateFromProps,p=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==h)&&Dw(e,o,r,h),Ms=!1;var m=e.memoizedState;o.state=m,Ef(e,r,o,i),l=e.memoizedState,a!==r||m!==l||zn.current||Ms?(typeof d=="function"&&(Um(e,n,d,r),l=e.memoizedState),(a=Ms||Rw(e,n,a,r,m,l,h))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=h,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,WI(t,e),a=e.memoizedProps,h=e.type===e.elementType?a:Wr(e.type,a),o.props=h,p=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Or(l):(l=Bn(n)?da:vn.current,l=Bl(e,l));var w=n.getDerivedStateFromProps;(d=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||m!==l)&&Dw(e,o,r,l),Ms=!1,m=e.memoizedState,o.state=m,Ef(e,r,o,i);var E=e.memoizedState;a!==p||m!==E||zn.current||Ms?(typeof w=="function"&&(Um(e,n,w,r),E=e.memoizedState),(h=Ms||Rw(e,n,h,r,m,E,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=l,r=h):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return qm(t,e,n,r,s,i)}function qm(t,e,n,r,i,s){yS(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Iw(e,n,!1),Xi(t,e,s);r=e.stateNode,yD.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Hl(e,t.child,null,s),e.child=Hl(e,null,a,s)):In(t,e,a,s),e.memoizedState=r.state,i&&Iw(e,n,!0),e.child}function _S(t){var e=t.stateNode;e.pendingContext?Tw(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Tw(t,e.context,!1),wy(t,e.containerInfo)}function Fw(t,e,n,r,i){return ql(),py(i),e.flags|=256,In(t,e,n,r),e.child}var Hm={dehydrated:null,treeContext:null,retryLane:0};function Wm(t){return{baseLanes:t,cachePool:null,transitions:null}}function wS(t,e,n){var r=e.pendingProps,i=mt.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),at(mt,i&1),t===null)return jm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=fp(o,r,0,null),t=la(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Wm(n),e.memoizedState=Hm,t):xy(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return _D(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ro(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=ro(a,s):(s=la(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Wm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Hm,r}return s=t.child,t=s.sibling,r=ro(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function xy(t,e){return e=fp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function fd(t,e,n,r){return r!==null&&py(r),Hl(e,t.child,null,n),t=xy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function _D(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Ng(Error(Y(422))),fd(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=fp({mode:"visible",children:r.children},i,0,null),s=la(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Hl(e,t.child,null,o),e.child.memoizedState=Wm(o),e.memoizedState=Hm,s);if(!(e.mode&1))return fd(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(Y(419)),r=Ng(s,r,void 0),fd(t,e,o,r)}if(a=(o&t.childLanes)!==0,$n||a){if(r=Zt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Yi(t,i),Xr(r,t,i,-1))}return Ny(),r=Ng(Error(Y(421))),fd(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=DD.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,tr=Zs(i.nextSibling),ir=e,ft=!0,Gr=null,t!==null&&(br[Cr++]=Fi,br[Cr++]=Ui,br[Cr++]=fa,Fi=t.id,Ui=t.overflow,fa=e),e=xy(e,r.children),e.flags|=4096,e)}function Uw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Fm(t.return,e,n)}function Lg(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function ES(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(In(t,e,r.children,n),r=mt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Uw(t,n,e);else if(t.tag===19)Uw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(at(mt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Tf(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Lg(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Tf(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Lg(e,!0,n,null,s);break;case"together":Lg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Vd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Xi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ga|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Y(153));if(e.child!==null){for(t=e.child,n=ro(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ro(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function wD(t,e,n){switch(e.tag){case 3:_S(e),ql();break;case 5:KI(e);break;case 1:Bn(e.type)&&mf(e);break;case 4:wy(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;at(_f,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(at(mt,mt.current&1),e.flags|=128,null):n&e.child.childLanes?wS(t,e,n):(at(mt,mt.current&1),t=Xi(t,e,n),t!==null?t.sibling:null);at(mt,mt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return ES(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),at(mt,mt.current),r)break;return null;case 22:case 23:return e.lanes=0,vS(t,e,n)}return Xi(t,e,n)}var TS,Km,IS,SS;TS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Km=function(){};IS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ia(Ei.current);var s=null;switch(n){case"input":i=gm(t,i),r=gm(t,r),s=[];break;case"select":i=wt({},i,{value:void 0}),r=wt({},r,{value:void 0}),s=[];break;case"textarea":i=ym(t,i),r=ym(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=pf)}wm(n,r);var o;n=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var a=i[h];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Rc.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in r){var l=r[h];if(a=i!=null?i[h]:void 0,r.hasOwnProperty(h)&&l!==a&&(l!=null||a!=null))if(h==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(h,n)),n=l;else h==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(h,l)):h==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(h,""+l):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Rc.hasOwnProperty(h)?(l!=null&&h==="onScroll"&&ut("scroll",t),s||a===l||(s=[])):(s=s||[]).push(h,l))}n&&(s=s||[]).push("style",n);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};SS=function(t,e,n,r){n!==r&&(e.flags|=4)};function qu(t,e){if(!ft)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function hn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function ED(t,e,n){var r=e.pendingProps;switch(fy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hn(e),null;case 1:return Bn(e.type)&&gf(),hn(e),null;case 3:return r=e.stateNode,Wl(),ht(zn),ht(vn),Ty(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(hd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Gr!==null&&(tv(Gr),Gr=null))),Km(t,e),hn(e),null;case 5:Ey(e);var i=ia(Bc.current);if(n=e.type,t!==null&&e.stateNode!=null)IS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Y(166));return hn(e),null}if(t=ia(Ei.current),hd(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[mi]=e,r[$c]=s,t=(e.mode&1)!==0,n){case"dialog":ut("cancel",r),ut("close",r);break;case"iframe":case"object":case"embed":ut("load",r);break;case"video":case"audio":for(i=0;i<nc.length;i++)ut(nc[i],r);break;case"source":ut("error",r);break;case"img":case"image":case"link":ut("error",r),ut("load",r);break;case"details":ut("toggle",r);break;case"input":Q0(r,s),ut("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ut("invalid",r);break;case"textarea":X0(r,s),ut("invalid",r)}wm(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&cd(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&cd(r.textContent,a,t),i=["children",""+a]):Rc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ut("scroll",r)}switch(n){case"input":nd(r),Y0(r,s,!0);break;case"textarea":nd(r),J0(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=pf)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=JT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[mi]=e,t[$c]=r,TS(t,e,!1,!1),e.stateNode=t;e:{switch(o=Em(n,r),n){case"dialog":ut("cancel",t),ut("close",t),i=r;break;case"iframe":case"object":case"embed":ut("load",t),i=r;break;case"video":case"audio":for(i=0;i<nc.length;i++)ut(nc[i],t);i=r;break;case"source":ut("error",t),i=r;break;case"img":case"image":case"link":ut("error",t),ut("load",t),i=r;break;case"details":ut("toggle",t),i=r;break;case"input":Q0(t,r),i=gm(t,r),ut("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=wt({},r,{value:void 0}),ut("invalid",t);break;case"textarea":X0(t,r),i=ym(t,r),ut("invalid",t);break;default:i=r}wm(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?tI(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&ZT(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Dc(t,l):typeof l=="number"&&Dc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Rc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ut("scroll",t):l!=null&&Jv(t,s,l,o))}switch(n){case"input":nd(t),Y0(t,r,!1);break;case"textarea":nd(t),J0(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ho(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Dl(t,!!r.multiple,s,!1):r.defaultValue!=null&&Dl(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=pf)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return hn(e),null;case 6:if(t&&e.stateNode!=null)SS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Y(166));if(n=ia(Bc.current),ia(Ei.current),hd(e)){if(r=e.stateNode,n=e.memoizedProps,r[mi]=e,(s=r.nodeValue!==n)&&(t=ir,t!==null))switch(t.tag){case 3:cd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&cd(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[mi]=e,e.stateNode=r}return hn(e),null;case 13:if(ht(mt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ft&&tr!==null&&e.mode&1&&!(e.flags&128))zI(),ql(),e.flags|=98560,s=!1;else if(s=hd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Y(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Y(317));s[mi]=e}else ql(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;hn(e),s=!1}else Gr!==null&&(tv(Gr),Gr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||mt.current&1?qt===0&&(qt=3):Ny())),e.updateQueue!==null&&(e.flags|=4),hn(e),null);case 4:return Wl(),Km(t,e),t===null&&Fc(e.stateNode.containerInfo),hn(e),null;case 10:return vy(e.type._context),hn(e),null;case 17:return Bn(e.type)&&gf(),hn(e),null;case 19:if(ht(mt),s=e.memoizedState,s===null)return hn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)qu(s,!1);else{if(qt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Tf(t),o!==null){for(e.flags|=128,qu(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return at(mt,mt.current&1|2),e.child}t=t.sibling}s.tail!==null&&Pt()>Gl&&(e.flags|=128,r=!0,qu(s,!1),e.lanes=4194304)}else{if(!r)if(t=Tf(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),qu(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ft)return hn(e),null}else 2*Pt()-s.renderingStartTime>Gl&&n!==1073741824&&(e.flags|=128,r=!0,qu(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Pt(),e.sibling=null,n=mt.current,at(mt,r?n&1|2:n&1),e):(hn(e),null);case 22:case 23:return Oy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?er&1073741824&&(hn(e),e.subtreeFlags&6&&(e.flags|=8192)):hn(e),null;case 24:return null;case 25:return null}throw Error(Y(156,e.tag))}function TD(t,e){switch(fy(e),e.tag){case 1:return Bn(e.type)&&gf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Wl(),ht(zn),ht(vn),Ty(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ey(e),null;case 13:if(ht(mt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Y(340));ql()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ht(mt),null;case 4:return Wl(),null;case 10:return vy(e.type._context),null;case 22:case 23:return Oy(),null;case 24:return null;default:return null}}var pd=!1,gn=!1,ID=typeof WeakSet=="function"?WeakSet:Set,ie=null;function Pl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){It(t,e,r)}else n.current=null}function Gm(t,e,n){try{n()}catch(r){It(t,e,r)}}var $w=!1;function SD(t,e){if(Rm=hf,t=PI(),hy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,h=0,d=0,p=t,m=null;t:for(;;){for(var w;p!==n||i!==0&&p.nodeType!==3||(a=o+i),p!==s||r!==0&&p.nodeType!==3||(l=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(w=p.firstChild)!==null;)m=p,p=w;for(;;){if(p===t)break t;if(m===n&&++h===i&&(a=o),m===s&&++d===r&&(l=o),(w=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=w}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Dm={focusedElem:t,selectionRange:n},hf=!1,ie=e;ie!==null;)if(e=ie,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ie=t;else for(;ie!==null;){e=ie;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var x=E.memoizedProps,D=E.memoizedState,A=e.stateNode,T=A.getSnapshotBeforeUpdate(e.elementType===e.type?x:Wr(e.type,x),D);A.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Y(163))}}catch(M){It(e,e.return,M)}if(t=e.sibling,t!==null){t.return=e.return,ie=t;break}ie=e.return}return E=$w,$w=!1,E}function yc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Gm(e,n,s)}i=i.next}while(i!==r)}}function hp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Qm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function bS(t){var e=t.alternate;e!==null&&(t.alternate=null,bS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[mi],delete e[$c],delete e[Lm],delete e[oD],delete e[aD])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function CS(t){return t.tag===5||t.tag===3||t.tag===4}function zw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||CS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ym(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=pf));else if(r!==4&&(t=t.child,t!==null))for(Ym(t,e,n),t=t.sibling;t!==null;)Ym(t,e,n),t=t.sibling}function Xm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Xm(t,e,n),t=t.sibling;t!==null;)Xm(t,e,n),t=t.sibling}var tn=null,Kr=!1;function Ps(t,e,n){for(n=n.child;n!==null;)AS(t,e,n),n=n.sibling}function AS(t,e,n){if(wi&&typeof wi.onCommitFiberUnmount=="function")try{wi.onCommitFiberUnmount(rp,n)}catch{}switch(n.tag){case 5:gn||Pl(n,e);case 6:var r=tn,i=Kr;tn=null,Ps(t,e,n),tn=r,Kr=i,tn!==null&&(Kr?(t=tn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):tn.removeChild(n.stateNode));break;case 18:tn!==null&&(Kr?(t=tn,n=n.stateNode,t.nodeType===8?xg(t.parentNode,n):t.nodeType===1&&xg(t,n),Mc(t)):xg(tn,n.stateNode));break;case 4:r=tn,i=Kr,tn=n.stateNode.containerInfo,Kr=!0,Ps(t,e,n),tn=r,Kr=i;break;case 0:case 11:case 14:case 15:if(!gn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Gm(n,e,o),i=i.next}while(i!==r)}Ps(t,e,n);break;case 1:if(!gn&&(Pl(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){It(n,e,a)}Ps(t,e,n);break;case 21:Ps(t,e,n);break;case 22:n.mode&1?(gn=(r=gn)||n.memoizedState!==null,Ps(t,e,n),gn=r):Ps(t,e,n);break;default:Ps(t,e,n)}}function Bw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new ID),e.forEach(function(r){var i=OD.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Hr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:tn=a.stateNode,Kr=!1;break e;case 3:tn=a.stateNode.containerInfo,Kr=!0;break e;case 4:tn=a.stateNode.containerInfo,Kr=!0;break e}a=a.return}if(tn===null)throw Error(Y(160));AS(s,o,i),tn=null,Kr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(h){It(i,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)xS(e,t),e=e.sibling}function xS(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Hr(e,t),pi(t),r&4){try{yc(3,t,t.return),hp(3,t)}catch(x){It(t,t.return,x)}try{yc(5,t,t.return)}catch(x){It(t,t.return,x)}}break;case 1:Hr(e,t),pi(t),r&512&&n!==null&&Pl(n,n.return);break;case 5:if(Hr(e,t),pi(t),r&512&&n!==null&&Pl(n,n.return),t.flags&32){var i=t.stateNode;try{Dc(i,"")}catch(x){It(t,t.return,x)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&YT(i,s),Em(a,o);var h=Em(a,s);for(o=0;o<l.length;o+=2){var d=l[o],p=l[o+1];d==="style"?tI(i,p):d==="dangerouslySetInnerHTML"?ZT(i,p):d==="children"?Dc(i,p):Jv(i,d,p,h)}switch(a){case"input":mm(i,s);break;case"textarea":XT(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var w=s.value;w!=null?Dl(i,!!s.multiple,w,!1):m!==!!s.multiple&&(s.defaultValue!=null?Dl(i,!!s.multiple,s.defaultValue,!0):Dl(i,!!s.multiple,s.multiple?[]:"",!1))}i[$c]=s}catch(x){It(t,t.return,x)}}break;case 6:if(Hr(e,t),pi(t),r&4){if(t.stateNode===null)throw Error(Y(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){It(t,t.return,x)}}break;case 3:if(Hr(e,t),pi(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Mc(e.containerInfo)}catch(x){It(t,t.return,x)}break;case 4:Hr(e,t),pi(t);break;case 13:Hr(e,t),pi(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Ry=Pt())),r&4&&Bw(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(gn=(h=gn)||d,Hr(e,t),gn=h):Hr(e,t),pi(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!d&&t.mode&1)for(ie=t,d=t.child;d!==null;){for(p=ie=d;ie!==null;){switch(m=ie,w=m.child,m.tag){case 0:case 11:case 14:case 15:yc(4,m,m.return);break;case 1:Pl(m,m.return);var E=m.stateNode;if(typeof E.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(x){It(r,n,x)}}break;case 5:Pl(m,m.return);break;case 22:if(m.memoizedState!==null){Hw(p);continue}}w!==null?(w.return=m,ie=w):Hw(p)}d=d.sibling}e:for(d=null,p=t;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,h?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=eI("display",o))}catch(x){It(t,t.return,x)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=h?"":p.memoizedProps}catch(x){It(t,t.return,x)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Hr(e,t),pi(t),r&4&&Bw(t);break;case 21:break;default:Hr(e,t),pi(t)}}function pi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(CS(n)){var r=n;break e}n=n.return}throw Error(Y(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Dc(i,""),r.flags&=-33);var s=zw(t);Xm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=zw(t);Ym(t,a,o);break;default:throw Error(Y(161))}}catch(l){It(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function bD(t,e,n){ie=t,PS(t)}function PS(t,e,n){for(var r=(t.mode&1)!==0;ie!==null;){var i=ie,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||pd;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||gn;a=pd;var h=gn;if(pd=o,(gn=l)&&!h)for(ie=i;ie!==null;)o=ie,l=o.child,o.tag===22&&o.memoizedState!==null?Ww(i):l!==null?(l.return=o,ie=l):Ww(i);for(;s!==null;)ie=s,PS(s),s=s.sibling;ie=i,pd=a,gn=h}qw(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ie=s):qw(t)}}function qw(t){for(;ie!==null;){var e=ie;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:gn||hp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!gn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Wr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&xw(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}xw(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var d=h.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&Mc(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Y(163))}gn||e.flags&512&&Qm(e)}catch(m){It(e,e.return,m)}}if(e===t){ie=null;break}if(n=e.sibling,n!==null){n.return=e.return,ie=n;break}ie=e.return}}function Hw(t){for(;ie!==null;){var e=ie;if(e===t){ie=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ie=n;break}ie=e.return}}function Ww(t){for(;ie!==null;){var e=ie;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{hp(4,e)}catch(l){It(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){It(e,i,l)}}var s=e.return;try{Qm(e)}catch(l){It(e,s,l)}break;case 5:var o=e.return;try{Qm(e)}catch(l){It(e,o,l)}}}catch(l){It(e,e.return,l)}if(e===t){ie=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ie=a;break}ie=e.return}}var CD=Math.ceil,bf=rs.ReactCurrentDispatcher,Py=rs.ReactCurrentOwner,kr=rs.ReactCurrentBatchConfig,je=0,Zt=null,Lt=null,rn=0,er=0,kl=_o(0),qt=0,Kc=null,ga=0,dp=0,ky=0,_c=null,Un=null,Ry=0,Gl=1/0,Vi=null,Cf=!1,Jm=null,to=null,gd=!1,Ks=null,Af=0,wc=0,Zm=null,jd=-1,Fd=0;function xn(){return je&6?Pt():jd!==-1?jd:jd=Pt()}function no(t){return t.mode&1?je&2&&rn!==0?rn&-rn:uD.transition!==null?(Fd===0&&(Fd=fI()),Fd):(t=Qe,t!==0||(t=window.event,t=t===void 0?16:wI(t.type)),t):1}function Xr(t,e,n,r){if(50<wc)throw wc=0,Zm=null,Error(Y(185));uh(t,n,r),(!(je&2)||t!==Zt)&&(t===Zt&&(!(je&2)&&(dp|=n),qt===4&&Us(t,rn)),qn(t,r),n===1&&je===0&&!(e.mode&1)&&(Gl=Pt()+500,lp&&wo()))}function qn(t,e){var n=t.callbackNode;uR(t,e);var r=cf(t,t===Zt?rn:0);if(r===0)n!==null&&tw(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&tw(n),e===1)t.tag===0?lD(Kw.bind(null,t)):FI(Kw.bind(null,t)),iD(function(){!(je&6)&&wo()}),n=null;else{switch(pI(r)){case 1:n=ry;break;case 4:n=hI;break;case 16:n=uf;break;case 536870912:n=dI;break;default:n=uf}n=VS(n,kS.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function kS(t,e){if(jd=-1,Fd=0,je&6)throw Error(Y(327));var n=t.callbackNode;if(Vl()&&t.callbackNode!==n)return null;var r=cf(t,t===Zt?rn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=xf(t,r);else{e=r;var i=je;je|=2;var s=DS();(Zt!==t||rn!==e)&&(Vi=null,Gl=Pt()+500,aa(t,e));do try{PD();break}catch(a){RS(t,a)}while(!0);my(),bf.current=s,je=i,Lt!==null?e=0:(Zt=null,rn=0,e=qt)}if(e!==0){if(e===2&&(i=Cm(t),i!==0&&(r=i,e=ev(t,i))),e===1)throw n=Kc,aa(t,0),Us(t,r),qn(t,Pt()),n;if(e===6)Us(t,r);else{if(i=t.current.alternate,!(r&30)&&!AD(i)&&(e=xf(t,r),e===2&&(s=Cm(t),s!==0&&(r=s,e=ev(t,s))),e===1))throw n=Kc,aa(t,0),Us(t,r),qn(t,Pt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Y(345));case 2:Qo(t,Un,Vi);break;case 3:if(Us(t,r),(r&130023424)===r&&(e=Ry+500-Pt(),10<e)){if(cf(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){xn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Nm(Qo.bind(null,t,Un,Vi),e);break}Qo(t,Un,Vi);break;case 4:if(Us(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Yr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Pt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*CD(r/1960))-r,10<r){t.timeoutHandle=Nm(Qo.bind(null,t,Un,Vi),r);break}Qo(t,Un,Vi);break;case 5:Qo(t,Un,Vi);break;default:throw Error(Y(329))}}}return qn(t,Pt()),t.callbackNode===n?kS.bind(null,t):null}function ev(t,e){var n=_c;return t.current.memoizedState.isDehydrated&&(aa(t,e).flags|=256),t=xf(t,e),t!==2&&(e=Un,Un=n,e!==null&&tv(e)),t}function tv(t){Un===null?Un=t:Un.push.apply(Un,t)}function AD(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ei(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Us(t,e){for(e&=~ky,e&=~dp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Yr(e),r=1<<n;t[n]=-1,e&=~r}}function Kw(t){if(je&6)throw Error(Y(327));Vl();var e=cf(t,0);if(!(e&1))return qn(t,Pt()),null;var n=xf(t,e);if(t.tag!==0&&n===2){var r=Cm(t);r!==0&&(e=r,n=ev(t,r))}if(n===1)throw n=Kc,aa(t,0),Us(t,e),qn(t,Pt()),n;if(n===6)throw Error(Y(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Qo(t,Un,Vi),qn(t,Pt()),null}function Dy(t,e){var n=je;je|=1;try{return t(e)}finally{je=n,je===0&&(Gl=Pt()+500,lp&&wo())}}function ma(t){Ks!==null&&Ks.tag===0&&!(je&6)&&Vl();var e=je;je|=1;var n=kr.transition,r=Qe;try{if(kr.transition=null,Qe=1,t)return t()}finally{Qe=r,kr.transition=n,je=e,!(je&6)&&wo()}}function Oy(){er=kl.current,ht(kl)}function aa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,rD(n)),Lt!==null)for(n=Lt.return;n!==null;){var r=n;switch(fy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&gf();break;case 3:Wl(),ht(zn),ht(vn),Ty();break;case 5:Ey(r);break;case 4:Wl();break;case 13:ht(mt);break;case 19:ht(mt);break;case 10:vy(r.type._context);break;case 22:case 23:Oy()}n=n.return}if(Zt=t,Lt=t=ro(t.current,null),rn=er=e,qt=0,Kc=null,ky=dp=ga=0,Un=_c=null,ra!==null){for(e=0;e<ra.length;e++)if(n=ra[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}ra=null}return t}function RS(t,e){do{var n=Lt;try{if(my(),Ld.current=Sf,If){for(var r=yt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}If=!1}if(pa=0,Jt=Bt=yt=null,vc=!1,qc=0,Py.current=null,n===null||n.return===null){qt=1,Kc=e,Lt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=rn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var h=l,d=a,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var w=Nw(o);if(w!==null){w.flags&=-257,Lw(w,o,a,s,e),w.mode&1&&Ow(s,h,e),e=w,l=h;var E=e.updateQueue;if(E===null){var x=new Set;x.add(l),e.updateQueue=x}else E.add(l);break e}else{if(!(e&1)){Ow(s,h,e),Ny();break e}l=Error(Y(426))}}else if(ft&&a.mode&1){var D=Nw(o);if(D!==null){!(D.flags&65536)&&(D.flags|=256),Lw(D,o,a,s,e),py(Kl(l,a));break e}}s=l=Kl(l,a),qt!==4&&(qt=2),_c===null?_c=[s]:_c.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var A=pS(s,l,e);Aw(s,A);break e;case 1:a=l;var T=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof T.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(to===null||!to.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var M=gS(s,a,e);Aw(s,M);break e}}s=s.return}while(s!==null)}NS(n)}catch(q){e=q,Lt===n&&n!==null&&(Lt=n=n.return);continue}break}while(!0)}function DS(){var t=bf.current;return bf.current=Sf,t===null?Sf:t}function Ny(){(qt===0||qt===3||qt===2)&&(qt=4),Zt===null||!(ga&268435455)&&!(dp&268435455)||Us(Zt,rn)}function xf(t,e){var n=je;je|=2;var r=DS();(Zt!==t||rn!==e)&&(Vi=null,aa(t,e));do try{xD();break}catch(i){RS(t,i)}while(!0);if(my(),je=n,bf.current=r,Lt!==null)throw Error(Y(261));return Zt=null,rn=0,qt}function xD(){for(;Lt!==null;)OS(Lt)}function PD(){for(;Lt!==null&&!eR();)OS(Lt)}function OS(t){var e=MS(t.alternate,t,er);t.memoizedProps=t.pendingProps,e===null?NS(t):Lt=e,Py.current=null}function NS(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=TD(n,e),n!==null){n.flags&=32767,Lt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{qt=6,Lt=null;return}}else if(n=ED(n,e,er),n!==null){Lt=n;return}if(e=e.sibling,e!==null){Lt=e;return}Lt=e=t}while(e!==null);qt===0&&(qt=5)}function Qo(t,e,n){var r=Qe,i=kr.transition;try{kr.transition=null,Qe=1,kD(t,e,n,r)}finally{kr.transition=i,Qe=r}return null}function kD(t,e,n,r){do Vl();while(Ks!==null);if(je&6)throw Error(Y(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Y(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(cR(t,s),t===Zt&&(Lt=Zt=null,rn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||gd||(gd=!0,VS(uf,function(){return Vl(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=kr.transition,kr.transition=null;var o=Qe;Qe=1;var a=je;je|=4,Py.current=null,SD(t,n),xS(n,t),YR(Dm),hf=!!Rm,Dm=Rm=null,t.current=n,bD(n),tR(),je=a,Qe=o,kr.transition=s}else t.current=n;if(gd&&(gd=!1,Ks=t,Af=i),s=t.pendingLanes,s===0&&(to=null),iR(n.stateNode),qn(t,Pt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Cf)throw Cf=!1,t=Jm,Jm=null,t;return Af&1&&t.tag!==0&&Vl(),s=t.pendingLanes,s&1?t===Zm?wc++:(wc=0,Zm=t):wc=0,wo(),null}function Vl(){if(Ks!==null){var t=pI(Af),e=kr.transition,n=Qe;try{if(kr.transition=null,Qe=16>t?16:t,Ks===null)var r=!1;else{if(t=Ks,Ks=null,Af=0,je&6)throw Error(Y(331));var i=je;for(je|=4,ie=t.current;ie!==null;){var s=ie,o=s.child;if(ie.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var h=a[l];for(ie=h;ie!==null;){var d=ie;switch(d.tag){case 0:case 11:case 15:yc(8,d,s)}var p=d.child;if(p!==null)p.return=d,ie=p;else for(;ie!==null;){d=ie;var m=d.sibling,w=d.return;if(bS(d),d===h){ie=null;break}if(m!==null){m.return=w,ie=m;break}ie=w}}}var E=s.alternate;if(E!==null){var x=E.child;if(x!==null){E.child=null;do{var D=x.sibling;x.sibling=null,x=D}while(x!==null)}}ie=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ie=o;else e:for(;ie!==null;){if(s=ie,s.flags&2048)switch(s.tag){case 0:case 11:case 15:yc(9,s,s.return)}var A=s.sibling;if(A!==null){A.return=s.return,ie=A;break e}ie=s.return}}var T=t.current;for(ie=T;ie!==null;){o=ie;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,ie=S;else e:for(o=T;ie!==null;){if(a=ie,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:hp(9,a)}}catch(q){It(a,a.return,q)}if(a===o){ie=null;break e}var M=a.sibling;if(M!==null){M.return=a.return,ie=M;break e}ie=a.return}}if(je=i,wo(),wi&&typeof wi.onPostCommitFiberRoot=="function")try{wi.onPostCommitFiberRoot(rp,t)}catch{}r=!0}return r}finally{Qe=n,kr.transition=e}}return!1}function Gw(t,e,n){e=Kl(n,e),e=pS(t,e,1),t=eo(t,e,1),e=xn(),t!==null&&(uh(t,1,e),qn(t,e))}function It(t,e,n){if(t.tag===3)Gw(t,t,n);else for(;e!==null;){if(e.tag===3){Gw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(to===null||!to.has(r))){t=Kl(n,t),t=gS(e,t,1),e=eo(e,t,1),t=xn(),e!==null&&(uh(e,1,t),qn(e,t));break}}e=e.return}}function RD(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=xn(),t.pingedLanes|=t.suspendedLanes&n,Zt===t&&(rn&n)===n&&(qt===4||qt===3&&(rn&130023424)===rn&&500>Pt()-Ry?aa(t,0):ky|=n),qn(t,e)}function LS(t,e){e===0&&(t.mode&1?(e=sd,sd<<=1,!(sd&130023424)&&(sd=4194304)):e=1);var n=xn();t=Yi(t,e),t!==null&&(uh(t,e,n),qn(t,n))}function DD(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),LS(t,n)}function OD(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Y(314))}r!==null&&r.delete(e),LS(t,n)}var MS;MS=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||zn.current)$n=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return $n=!1,wD(t,e,n);$n=!!(t.flags&131072)}else $n=!1,ft&&e.flags&1048576&&UI(e,yf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Vd(t,e),t=e.pendingProps;var i=Bl(e,vn.current);Ml(e,n),i=Sy(null,e,r,t,i,n);var s=by();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Bn(r)?(s=!0,mf(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,_y(e),i.updater=cp,e.stateNode=i,i._reactInternals=e,$m(e,r,t,n),e=qm(null,e,r,!0,s,n)):(e.tag=0,ft&&s&&dy(e),In(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Vd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=LD(r),t=Wr(r,t),i){case 0:e=Bm(null,e,r,t,n);break e;case 1:e=jw(null,e,r,t,n);break e;case 11:e=Mw(null,e,r,t,n);break e;case 14:e=Vw(null,e,r,Wr(r.type,t),n);break e}throw Error(Y(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wr(r,i),Bm(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wr(r,i),jw(t,e,r,i,n);case 3:e:{if(_S(e),t===null)throw Error(Y(387));r=e.pendingProps,s=e.memoizedState,i=s.element,WI(t,e),Ef(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Kl(Error(Y(423)),e),e=Fw(t,e,r,n,i);break e}else if(r!==i){i=Kl(Error(Y(424)),e),e=Fw(t,e,r,n,i);break e}else for(tr=Zs(e.stateNode.containerInfo.firstChild),ir=e,ft=!0,Gr=null,n=qI(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ql(),r===i){e=Xi(t,e,n);break e}In(t,e,r,n)}e=e.child}return e;case 5:return KI(e),t===null&&jm(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Om(r,i)?o=null:s!==null&&Om(r,s)&&(e.flags|=32),yS(t,e),In(t,e,o,n),e.child;case 6:return t===null&&jm(e),null;case 13:return wS(t,e,n);case 4:return wy(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Hl(e,null,r,n):In(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wr(r,i),Mw(t,e,r,i,n);case 7:return In(t,e,e.pendingProps,n),e.child;case 8:return In(t,e,e.pendingProps.children,n),e.child;case 12:return In(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,at(_f,r._currentValue),r._currentValue=o,s!==null)if(ei(s.value,o)){if(s.children===i.children&&!zn.current){e=Xi(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Hi(-1,n&-n),l.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var d=h.pending;d===null?l.next=l:(l.next=d.next,d.next=l),h.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Fm(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Y(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Fm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}In(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ml(e,n),i=Or(i),r=r(i),e.flags|=1,In(t,e,r,n),e.child;case 14:return r=e.type,i=Wr(r,e.pendingProps),i=Wr(r.type,i),Vw(t,e,r,i,n);case 15:return mS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wr(r,i),Vd(t,e),e.tag=1,Bn(r)?(t=!0,mf(e)):t=!1,Ml(e,n),fS(e,r,i),$m(e,r,i,n),qm(null,e,r,!0,t,n);case 19:return ES(t,e,n);case 22:return vS(t,e,n)}throw Error(Y(156,e.tag))};function VS(t,e){return cI(t,e)}function ND(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xr(t,e,n,r){return new ND(t,e,n,r)}function Ly(t){return t=t.prototype,!(!t||!t.isReactComponent)}function LD(t){if(typeof t=="function")return Ly(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ey)return 11;if(t===ty)return 14}return 2}function ro(t,e){var n=t.alternate;return n===null?(n=xr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ud(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Ly(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case wl:return la(n.children,i,s,e);case Zv:o=8,i|=8;break;case hm:return t=xr(12,n,e,i|2),t.elementType=hm,t.lanes=s,t;case dm:return t=xr(13,n,e,i),t.elementType=dm,t.lanes=s,t;case fm:return t=xr(19,n,e,i),t.elementType=fm,t.lanes=s,t;case KT:return fp(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case HT:o=10;break e;case WT:o=9;break e;case ey:o=11;break e;case ty:o=14;break e;case Ls:o=16,r=null;break e}throw Error(Y(130,t==null?t:typeof t,""))}return e=xr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function la(t,e,n,r){return t=xr(7,t,r,e),t.lanes=n,t}function fp(t,e,n,r){return t=xr(22,t,r,e),t.elementType=KT,t.lanes=n,t.stateNode={isHidden:!1},t}function Mg(t,e,n){return t=xr(6,t,null,e),t.lanes=n,t}function Vg(t,e,n){return e=xr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function MD(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vg(0),this.expirationTimes=vg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function My(t,e,n,r,i,s,o,a,l){return t=new MD(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=xr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},_y(s),t}function VD(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_l,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function jS(t){if(!t)return fo;t=t._reactInternals;e:{if(Da(t)!==t||t.tag!==1)throw Error(Y(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Bn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Y(171))}if(t.tag===1){var n=t.type;if(Bn(n))return jI(t,n,e)}return e}function FS(t,e,n,r,i,s,o,a,l){return t=My(n,r,!0,t,i,s,o,a,l),t.context=jS(null),n=t.current,r=xn(),i=no(n),s=Hi(r,i),s.callback=e??null,eo(n,s,i),t.current.lanes=i,uh(t,i,r),qn(t,r),t}function pp(t,e,n,r){var i=e.current,s=xn(),o=no(i);return n=jS(n),e.context===null?e.context=n:e.pendingContext=n,e=Hi(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=eo(i,e,o),t!==null&&(Xr(t,i,o,s),Nd(t,i,o)),o}function Pf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Qw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Vy(t,e){Qw(t,e),(t=t.alternate)&&Qw(t,e)}function jD(){return null}var US=typeof reportError=="function"?reportError:function(t){console.error(t)};function jy(t){this._internalRoot=t}gp.prototype.render=jy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Y(409));pp(t,e,null,null)};gp.prototype.unmount=jy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ma(function(){pp(null,t,null,null)}),e[Qi]=null}};function gp(t){this._internalRoot=t}gp.prototype.unstable_scheduleHydration=function(t){if(t){var e=vI();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Fs.length&&e!==0&&e<Fs[n].priority;n++);Fs.splice(n,0,t),n===0&&_I(t)}};function Fy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function mp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Yw(){}function FD(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var h=Pf(o);s.call(h)}}var o=FS(e,r,t,0,null,!1,!1,"",Yw);return t._reactRootContainer=o,t[Qi]=o.current,Fc(t.nodeType===8?t.parentNode:t),ma(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var h=Pf(l);a.call(h)}}var l=My(t,0,!1,null,null,!1,!1,"",Yw);return t._reactRootContainer=l,t[Qi]=l.current,Fc(t.nodeType===8?t.parentNode:t),ma(function(){pp(e,l,n,r)}),l}function vp(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Pf(o);a.call(l)}}pp(e,o,t,i)}else o=FD(n,e,t,i,r);return Pf(o)}gI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=tc(e.pendingLanes);n!==0&&(iy(e,n|1),qn(e,Pt()),!(je&6)&&(Gl=Pt()+500,wo()))}break;case 13:ma(function(){var r=Yi(t,1);if(r!==null){var i=xn();Xr(r,t,1,i)}}),Vy(t,1)}};sy=function(t){if(t.tag===13){var e=Yi(t,134217728);if(e!==null){var n=xn();Xr(e,t,134217728,n)}Vy(t,134217728)}};mI=function(t){if(t.tag===13){var e=no(t),n=Yi(t,e);if(n!==null){var r=xn();Xr(n,t,e,r)}Vy(t,e)}};vI=function(){return Qe};yI=function(t,e){var n=Qe;try{return Qe=t,e()}finally{Qe=n}};Im=function(t,e,n){switch(e){case"input":if(mm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=ap(r);if(!i)throw Error(Y(90));QT(r),mm(r,i)}}}break;case"textarea":XT(t,n);break;case"select":e=n.value,e!=null&&Dl(t,!!n.multiple,e,!1)}};iI=Dy;sI=ma;var UD={usingClientEntryPoint:!1,Events:[hh,Sl,ap,nI,rI,Dy]},Hu={findFiberByHostInstance:na,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$D={bundleType:Hu.bundleType,version:Hu.version,rendererPackageName:Hu.rendererPackageName,rendererConfig:Hu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:rs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=lI(t),t===null?null:t.stateNode},findFiberByHostInstance:Hu.findFiberByHostInstance||jD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var md=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!md.isDisabled&&md.supportsFiber)try{rp=md.inject($D),wi=md}catch{}}ur.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UD;ur.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fy(e))throw Error(Y(200));return VD(t,e,null,n)};ur.createRoot=function(t,e){if(!Fy(t))throw Error(Y(299));var n=!1,r="",i=US;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=My(t,1,!1,null,null,n,!1,r,i),t[Qi]=e.current,Fc(t.nodeType===8?t.parentNode:t),new jy(e)};ur.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Y(188)):(t=Object.keys(t).join(","),Error(Y(268,t)));return t=lI(e),t=t===null?null:t.stateNode,t};ur.flushSync=function(t){return ma(t)};ur.hydrate=function(t,e,n){if(!mp(e))throw Error(Y(200));return vp(null,t,e,!0,n)};ur.hydrateRoot=function(t,e,n){if(!Fy(t))throw Error(Y(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=US;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=FS(e,null,t,1,n??null,i,!1,s,o),t[Qi]=e.current,Fc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new gp(e)};ur.render=function(t,e,n){if(!mp(e))throw Error(Y(200));return vp(null,t,e,!1,n)};ur.unmountComponentAtNode=function(t){if(!mp(t))throw Error(Y(40));return t._reactRootContainer?(ma(function(){vp(null,null,t,!1,function(){t._reactRootContainer=null,t[Qi]=null})}),!0):!1};ur.unstable_batchedUpdates=Dy;ur.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!mp(n))throw Error(Y(200));if(t==null||t._reactInternals===void 0)throw Error(Y(38));return vp(t,e,n,!1,r)};ur.version="18.3.1-next-f1338f8080-20240426";function $S(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($S)}catch(t){console.error(t)}}$S(),$T.exports=ur;var zD=$T.exports,zS,Xw=zD;zS=Xw.createRoot,Xw.hydrateRoot;var BD={exports:{}};/*!
  * Bootstrap v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(t,e){(function(n,r){t.exports=r()})(pk,function(){const n=new Map,r={set(_,c,g){n.has(_)||n.set(_,new Map);const I=n.get(_);I.has(c)||I.size===0?I.set(c,g):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(I.keys())[0]}.`)},get:(_,c)=>n.has(_)&&n.get(_).get(c)||null,remove(_,c){if(!n.has(_))return;const g=n.get(_);g.delete(c),g.size===0&&n.delete(_)}},i="transitionend",s=_=>(_&&window.CSS&&window.CSS.escape&&(_=_.replace(/#([^\s"#']+)/g,(c,g)=>`#${CSS.escape(g)}`)),_),o=_=>{_.dispatchEvent(new Event(i))},a=_=>!(!_||typeof _!="object")&&(_.jquery!==void 0&&(_=_[0]),_.nodeType!==void 0),l=_=>a(_)?_.jquery?_[0]:_:typeof _=="string"&&_.length>0?document.querySelector(s(_)):null,h=_=>{if(!a(_)||_.getClientRects().length===0)return!1;const c=getComputedStyle(_).getPropertyValue("visibility")==="visible",g=_.closest("details:not([open])");if(!g)return c;if(g!==_){const I=_.closest("summary");if(I&&I.parentNode!==g||I===null)return!1}return c},d=_=>!_||_.nodeType!==Node.ELEMENT_NODE||!!_.classList.contains("disabled")||(_.disabled!==void 0?_.disabled:_.hasAttribute("disabled")&&_.getAttribute("disabled")!=="false"),p=_=>{if(!document.documentElement.attachShadow)return null;if(typeof _.getRootNode=="function"){const c=_.getRootNode();return c instanceof ShadowRoot?c:null}return _ instanceof ShadowRoot?_:_.parentNode?p(_.parentNode):null},m=()=>{},w=_=>{_.offsetHeight},E=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,x=[],D=()=>document.documentElement.dir==="rtl",A=_=>{var c;c=()=>{const g=E();if(g){const I=_.NAME,j=g.fn[I];g.fn[I]=_.jQueryInterface,g.fn[I].Constructor=_,g.fn[I].noConflict=()=>(g.fn[I]=j,_.jQueryInterface)}},document.readyState==="loading"?(x.length||document.addEventListener("DOMContentLoaded",()=>{for(const g of x)g()}),x.push(c)):c()},T=(_,c=[],g=_)=>typeof _=="function"?_(...c):g,S=(_,c,g=!0)=>{if(!g)return void T(_);const I=(H=>{if(!H)return 0;let{transitionDuration:G,transitionDelay:Z}=window.getComputedStyle(H);const re=Number.parseFloat(G),oe=Number.parseFloat(Z);return re||oe?(G=G.split(",")[0],Z=Z.split(",")[0],1e3*(Number.parseFloat(G)+Number.parseFloat(Z))):0})(c)+5;let j=!1;const F=({target:H})=>{H===c&&(j=!0,c.removeEventListener(i,F),T(_))};c.addEventListener(i,F),setTimeout(()=>{j||o(c)},I)},M=(_,c,g,I)=>{const j=_.length;let F=_.indexOf(c);return F===-1?!g&&I?_[j-1]:_[0]:(F+=g?1:-1,I&&(F=(F+j)%j),_[Math.max(0,Math.min(F,j-1))])},q=/[^.]*(?=\..*)\.|.*/,W=/\..*/,P=/::\d+$/,C={};let R=1;const O={mouseenter:"mouseover",mouseleave:"mouseout"},L=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function V(_,c){return c&&`${c}::${R++}`||_.uidEvent||R++}function k(_){const c=V(_);return _.uidEvent=c,C[c]=C[c]||{},C[c]}function ve(_,c,g=null){return Object.values(_).find(I=>I.callable===c&&I.delegationSelector===g)}function Ie(_,c,g){const I=typeof c=="string",j=I?g:c||g;let F=ue(_);return L.has(F)||(F=_),[I,j,F]}function Fe(_,c,g,I,j){if(typeof c!="string"||!_)return;let[F,H,G]=Ie(c,g,I);c in O&&(H=(ye=>function(pe){if(!pe.relatedTarget||pe.relatedTarget!==pe.delegateTarget&&!pe.delegateTarget.contains(pe.relatedTarget))return ye.call(this,pe)})(H));const Z=k(_),re=Z[G]||(Z[G]={}),oe=ve(re,H,F?g:null);if(oe)return void(oe.oneOff=oe.oneOff&&j);const ee=V(H,c.replace(q,"")),Se=F?function(he,ye,pe){return function _e(Ze){const ot=he.querySelectorAll(ye);for(let{target:Pe}=Ze;Pe&&Pe!==this;Pe=Pe.parentNode)for(const ze of ot)if(ze===Pe)return Ne(Ze,{delegateTarget:Pe}),_e.oneOff&&z.off(he,Ze.type,ye,pe),pe.apply(Pe,[Ze])}}(_,g,H):function(he,ye){return function pe(_e){return Ne(_e,{delegateTarget:he}),pe.oneOff&&z.off(he,_e.type,ye),ye.apply(he,[_e])}}(_,H);Se.delegationSelector=F?g:null,Se.callable=H,Se.oneOff=j,Se.uidEvent=ee,re[ee]=Se,_.addEventListener(G,Se,F)}function Ce(_,c,g,I,j){const F=ve(c[g],I,j);F&&(_.removeEventListener(g,F,!!j),delete c[g][F.uidEvent])}function X(_,c,g,I){const j=c[g]||{};for(const[F,H]of Object.entries(j))F.includes(I)&&Ce(_,c,g,H.callable,H.delegationSelector)}function ue(_){return _=_.replace(W,""),O[_]||_}const z={on(_,c,g,I){Fe(_,c,g,I,!1)},one(_,c,g,I){Fe(_,c,g,I,!0)},off(_,c,g,I){if(typeof c!="string"||!_)return;const[j,F,H]=Ie(c,g,I),G=H!==c,Z=k(_),re=Z[H]||{},oe=c.startsWith(".");if(F===void 0){if(oe)for(const ee of Object.keys(Z))X(_,Z,ee,c.slice(1));for(const[ee,Se]of Object.entries(re)){const he=ee.replace(P,"");G&&!c.includes(he)||Ce(_,Z,H,Se.callable,Se.delegationSelector)}}else{if(!Object.keys(re).length)return;Ce(_,Z,H,F,j?g:null)}},trigger(_,c,g){if(typeof c!="string"||!_)return null;const I=E();let j=null,F=!0,H=!0,G=!1;c!==ue(c)&&I&&(j=I.Event(c,g),I(_).trigger(j),F=!j.isPropagationStopped(),H=!j.isImmediatePropagationStopped(),G=j.isDefaultPrevented());const Z=Ne(new Event(c,{bubbles:F,cancelable:!0}),g);return G&&Z.preventDefault(),H&&_.dispatchEvent(Z),Z.defaultPrevented&&j&&j.preventDefault(),Z}};function Ne(_,c={}){for(const[g,I]of Object.entries(c))try{_[g]=I}catch{Object.defineProperty(_,g,{configurable:!0,get:()=>I})}return _}function Le(_){if(_==="true")return!0;if(_==="false")return!1;if(_===Number(_).toString())return Number(_);if(_===""||_==="null")return null;if(typeof _!="string")return _;try{return JSON.parse(decodeURIComponent(_))}catch{return _}}function Be(_){return _.replace(/[A-Z]/g,c=>`-${c.toLowerCase()}`)}const lt={setDataAttribute(_,c,g){_.setAttribute(`data-bs-${Be(c)}`,g)},removeDataAttribute(_,c){_.removeAttribute(`data-bs-${Be(c)}`)},getDataAttributes(_){if(!_)return{};const c={},g=Object.keys(_.dataset).filter(I=>I.startsWith("bs")&&!I.startsWith("bsConfig"));for(const I of g){let j=I.replace(/^bs/,"");j=j.charAt(0).toLowerCase()+j.slice(1,j.length),c[j]=Le(_.dataset[I])}return c},getDataAttribute:(_,c)=>Le(_.getAttribute(`data-bs-${Be(c)}`))};class jt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(c){return c=this._mergeConfigObj(c),c=this._configAfterMerge(c),this._typeCheckConfig(c),c}_configAfterMerge(c){return c}_mergeConfigObj(c,g){const I=a(g)?lt.getDataAttribute(g,"config"):{};return{...this.constructor.Default,...typeof I=="object"?I:{},...a(g)?lt.getDataAttributes(g):{},...typeof c=="object"?c:{}}}_typeCheckConfig(c,g=this.constructor.DefaultType){for(const[j,F]of Object.entries(g)){const H=c[j],G=a(H)?"element":(I=H)==null?`${I}`:Object.prototype.toString.call(I).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(F).test(G))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${j}" provided type "${G}" but expected type "${F}".`)}var I}}class nt extends jt{constructor(c,g){super(),(c=l(c))&&(this._element=c,this._config=this._getConfig(g),r.set(this._element,this.constructor.DATA_KEY,this))}dispose(){r.remove(this._element,this.constructor.DATA_KEY),z.off(this._element,this.constructor.EVENT_KEY);for(const c of Object.getOwnPropertyNames(this))this[c]=null}_queueCallback(c,g,I=!0){S(c,g,I)}_getConfig(c){return c=this._mergeConfigObj(c,this._element),c=this._configAfterMerge(c),this._typeCheckConfig(c),c}static getInstance(c){return r.get(l(c),this.DATA_KEY)}static getOrCreateInstance(c,g={}){return this.getInstance(c)||new this(c,typeof g=="object"?g:null)}static get VERSION(){return"5.3.3"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(c){return`${c}${this.EVENT_KEY}`}}const de=_=>{let c=_.getAttribute("data-bs-target");if(!c||c==="#"){let g=_.getAttribute("href");if(!g||!g.includes("#")&&!g.startsWith("."))return null;g.includes("#")&&!g.startsWith("#")&&(g=`#${g.split("#")[1]}`),c=g&&g!=="#"?g.trim():null}return c?c.split(",").map(g=>s(g)).join(","):null},se={find:(_,c=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(c,_)),findOne:(_,c=document.documentElement)=>Element.prototype.querySelector.call(c,_),children:(_,c)=>[].concat(..._.children).filter(g=>g.matches(c)),parents(_,c){const g=[];let I=_.parentNode.closest(c);for(;I;)g.push(I),I=I.parentNode.closest(c);return g},prev(_,c){let g=_.previousElementSibling;for(;g;){if(g.matches(c))return[g];g=g.previousElementSibling}return[]},next(_,c){let g=_.nextElementSibling;for(;g;){if(g.matches(c))return[g];g=g.nextElementSibling}return[]},focusableChildren(_){const c=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(g=>`${g}:not([tabindex^="-"])`).join(",");return this.find(c,_).filter(g=>!d(g)&&h(g))},getSelectorFromElement(_){const c=de(_);return c&&se.findOne(c)?c:null},getElementFromSelector(_){const c=de(_);return c?se.findOne(c):null},getMultipleElementsFromSelector(_){const c=de(_);return c?se.find(c):[]}},Wn=(_,c="hide")=>{const g=`click.dismiss${_.EVENT_KEY}`,I=_.NAME;z.on(document,g,`[data-bs-dismiss="${I}"]`,function(j){if(["A","AREA"].includes(this.tagName)&&j.preventDefault(),d(this))return;const F=se.getElementFromSelector(this)||this.closest(`.${I}`);_.getOrCreateInstance(F)[c]()})},Kn=".bs.alert",bt=`close${Kn}`,Kt=`closed${Kn}`;class On extends nt{static get NAME(){return"alert"}close(){if(z.trigger(this._element,bt).defaultPrevented)return;this._element.classList.remove("show");const c=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,c)}_destroyElement(){this._element.remove(),z.trigger(this._element,Kt),this.dispose()}static jQueryInterface(c){return this.each(function(){const g=On.getOrCreateInstance(this);if(typeof c=="string"){if(g[c]===void 0||c.startsWith("_")||c==="constructor")throw new TypeError(`No method named "${c}"`);g[c](this)}})}}Wn(On,"close"),A(On);const us='[data-bs-toggle="button"]';class Gn extends nt{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(c){return this.each(function(){const g=Gn.getOrCreateInstance(this);c==="toggle"&&g[c]()})}}z.on(document,"click.bs.button.data-api",us,_=>{_.preventDefault();const c=_.target.closest(us);Gn.getOrCreateInstance(c).toggle()}),A(Gn);const on=".bs.swipe",mu=`touchstart${on}`,Ao=`touchmove${on}`,Ua=`touchend${on}`,cs=`pointerdown${on}`,$a=`pointerup${on}`,xo={endCallback:null,leftCallback:null,rightCallback:null},hs={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class hr extends jt{constructor(c,g){super(),this._element=c,c&&hr.isSupported()&&(this._config=this._getConfig(g),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return xo}static get DefaultType(){return hs}static get NAME(){return"swipe"}dispose(){z.off(this._element,on)}_start(c){this._supportPointerEvents?this._eventIsPointerPenTouch(c)&&(this._deltaX=c.clientX):this._deltaX=c.touches[0].clientX}_end(c){this._eventIsPointerPenTouch(c)&&(this._deltaX=c.clientX-this._deltaX),this._handleSwipe(),T(this._config.endCallback)}_move(c){this._deltaX=c.touches&&c.touches.length>1?0:c.touches[0].clientX-this._deltaX}_handleSwipe(){const c=Math.abs(this._deltaX);if(c<=40)return;const g=c/this._deltaX;this._deltaX=0,g&&T(g>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(z.on(this._element,cs,c=>this._start(c)),z.on(this._element,$a,c=>this._end(c)),this._element.classList.add("pointer-event")):(z.on(this._element,mu,c=>this._start(c)),z.on(this._element,Ao,c=>this._move(c)),z.on(this._element,Ua,c=>this._end(c)))}_eventIsPointerPenTouch(c){return this._supportPointerEvents&&(c.pointerType==="pen"||c.pointerType==="touch")}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Rt=".bs.carousel",gt=".data-api",it="next",Qn="prev",Mr="left",bi="right",ds=`slide${Rt}`,Yn=`slid${Rt}`,za=`keydown${Rt}`,Ci=`mouseenter${Rt}`,ri=`mouseleave${Rt}`,vu=`dragstart${Rt}`,yu=`load${Rt}${gt}`,Po=`click${Rt}${gt}`,ko="carousel",Vr="active",ii=".active",fs=".carousel-item",Ro=ii+fs,jr={ArrowLeft:bi,ArrowRight:Mr},ps={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},gs={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Nn extends nt{constructor(c,g){super(c,g),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=se.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===ko&&this.cycle()}static get Default(){return ps}static get DefaultType(){return gs}static get NAME(){return"carousel"}next(){this._slide(it)}nextWhenVisible(){!document.hidden&&h(this._element)&&this.next()}prev(){this._slide(Qn)}pause(){this._isSliding&&o(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?z.one(this._element,Yn,()=>this.cycle()):this.cycle())}to(c){const g=this._getItems();if(c>g.length-1||c<0)return;if(this._isSliding)return void z.one(this._element,Yn,()=>this.to(c));const I=this._getItemIndex(this._getActive());if(I===c)return;const j=c>I?it:Qn;this._slide(j,g[c])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(c){return c.defaultInterval=c.interval,c}_addEventListeners(){this._config.keyboard&&z.on(this._element,za,c=>this._keydown(c)),this._config.pause==="hover"&&(z.on(this._element,Ci,()=>this.pause()),z.on(this._element,ri,()=>this._maybeEnableCycle())),this._config.touch&&hr.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const g of se.find(".carousel-item img",this._element))z.on(g,vu,I=>I.preventDefault());const c={leftCallback:()=>this._slide(this._directionToOrder(Mr)),rightCallback:()=>this._slide(this._directionToOrder(bi)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new hr(this._element,c)}_keydown(c){if(/input|textarea/i.test(c.target.tagName))return;const g=jr[c.key];g&&(c.preventDefault(),this._slide(this._directionToOrder(g)))}_getItemIndex(c){return this._getItems().indexOf(c)}_setActiveIndicatorElement(c){if(!this._indicatorsElement)return;const g=se.findOne(ii,this._indicatorsElement);g.classList.remove(Vr),g.removeAttribute("aria-current");const I=se.findOne(`[data-bs-slide-to="${c}"]`,this._indicatorsElement);I&&(I.classList.add(Vr),I.setAttribute("aria-current","true"))}_updateInterval(){const c=this._activeElement||this._getActive();if(!c)return;const g=Number.parseInt(c.getAttribute("data-bs-interval"),10);this._config.interval=g||this._config.defaultInterval}_slide(c,g=null){if(this._isSliding)return;const I=this._getActive(),j=c===it,F=g||M(this._getItems(),I,j,this._config.wrap);if(F===I)return;const H=this._getItemIndex(F),G=ee=>z.trigger(this._element,ee,{relatedTarget:F,direction:this._orderToDirection(c),from:this._getItemIndex(I),to:H});if(G(ds).defaultPrevented||!I||!F)return;const Z=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(H),this._activeElement=F;const re=j?"carousel-item-start":"carousel-item-end",oe=j?"carousel-item-next":"carousel-item-prev";F.classList.add(oe),w(F),I.classList.add(re),F.classList.add(re),this._queueCallback(()=>{F.classList.remove(re,oe),F.classList.add(Vr),I.classList.remove(Vr,oe,re),this._isSliding=!1,G(Yn)},I,this._isAnimated()),Z&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return se.findOne(Ro,this._element)}_getItems(){return se.find(fs,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(c){return D()?c===Mr?Qn:it:c===Mr?it:Qn}_orderToDirection(c){return D()?c===Qn?Mr:bi:c===Qn?bi:Mr}static jQueryInterface(c){return this.each(function(){const g=Nn.getOrCreateInstance(this,c);if(typeof c!="number"){if(typeof c=="string"){if(g[c]===void 0||c.startsWith("_")||c==="constructor")throw new TypeError(`No method named "${c}"`);g[c]()}}else g.to(c)})}}z.on(document,Po,"[data-bs-slide], [data-bs-slide-to]",function(_){const c=se.getElementFromSelector(this);if(!c||!c.classList.contains(ko))return;_.preventDefault();const g=Nn.getOrCreateInstance(c),I=this.getAttribute("data-bs-slide-to");return I?(g.to(I),void g._maybeEnableCycle()):lt.getDataAttribute(this,"slide")==="next"?(g.next(),void g._maybeEnableCycle()):(g.prev(),void g._maybeEnableCycle())}),z.on(window,yu,()=>{const _=se.find('[data-bs-ride="carousel"]');for(const c of _)Nn.getOrCreateInstance(c)}),A(Nn);const yn=".bs.collapse",Ba=`show${yn}`,Ft=`shown${yn}`,qa=`hide${yn}`,Ai=`hidden${yn}`,Ue=`click${yn}.data-api`,Xe="show",Ct="collapse",qe="collapsing",dr=`:scope .${Ct} .${Ct}`,en='[data-bs-toggle="collapse"]',ms={parent:null,toggle:!0},Ah={parent:"(null|element)",toggle:"boolean"};class si extends nt{constructor(c,g){super(c,g),this._isTransitioning=!1,this._triggerArray=[];const I=se.find(en);for(const j of I){const F=se.getSelectorFromElement(j),H=se.find(F).filter(G=>G===this._element);F!==null&&H.length&&this._triggerArray.push(j)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return ms}static get DefaultType(){return Ah}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let c=[];if(this._config.parent&&(c=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(j=>j!==this._element).map(j=>si.getOrCreateInstance(j,{toggle:!1}))),c.length&&c[0]._isTransitioning||z.trigger(this._element,Ba).defaultPrevented)return;for(const j of c)j.hide();const g=this._getDimension();this._element.classList.remove(Ct),this._element.classList.add(qe),this._element.style[g]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const I=`scroll${g[0].toUpperCase()+g.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(qe),this._element.classList.add(Ct,Xe),this._element.style[g]="",z.trigger(this._element,Ft)},this._element,!0),this._element.style[g]=`${this._element[I]}px`}hide(){if(this._isTransitioning||!this._isShown()||z.trigger(this._element,qa).defaultPrevented)return;const c=this._getDimension();this._element.style[c]=`${this._element.getBoundingClientRect()[c]}px`,w(this._element),this._element.classList.add(qe),this._element.classList.remove(Ct,Xe);for(const g of this._triggerArray){const I=se.getElementFromSelector(g);I&&!this._isShown(I)&&this._addAriaAndCollapsedClass([g],!1)}this._isTransitioning=!0,this._element.style[c]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(qe),this._element.classList.add(Ct),z.trigger(this._element,Ai)},this._element,!0)}_isShown(c=this._element){return c.classList.contains(Xe)}_configAfterMerge(c){return c.toggle=!!c.toggle,c.parent=l(c.parent),c}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const c=this._getFirstLevelChildren(en);for(const g of c){const I=se.getElementFromSelector(g);I&&this._addAriaAndCollapsedClass([g],this._isShown(I))}}_getFirstLevelChildren(c){const g=se.find(dr,this._config.parent);return se.find(c,this._config.parent).filter(I=>!g.includes(I))}_addAriaAndCollapsedClass(c,g){if(c.length)for(const I of c)I.classList.toggle("collapsed",!g),I.setAttribute("aria-expanded",g)}static jQueryInterface(c){const g={};return typeof c=="string"&&/show|hide/.test(c)&&(g.toggle=!1),this.each(function(){const I=si.getOrCreateInstance(this,g);if(typeof c=="string"){if(I[c]===void 0)throw new TypeError(`No method named "${c}"`);I[c]()}})}}z.on(document,Ue,en,function(_){(_.target.tagName==="A"||_.delegateTarget&&_.delegateTarget.tagName==="A")&&_.preventDefault();for(const c of se.getMultipleElementsFromSelector(this))si.getOrCreateInstance(c,{toggle:!1}).toggle()}),A(si);var Dt="top",Et="bottom",an="right",Gt="left",vs="auto",oi=[Dt,Et,an,Gt],ai="start",xi="end",xh="clippingParents",ys="viewport",Pi="popper",Ha="reference",ki=oi.reduce(function(_,c){return _.concat([c+"-"+ai,c+"-"+xi])},[]),Fr=[].concat(oi,[vs]).reduce(function(_,c){return _.concat([c,c+"-"+ai,c+"-"+xi])},[]),Wa="beforeRead",Ph="read",_u="afterRead",wu="beforeMain",Eu="main",Ka="afterMain",Ga="beforeWrite",Tu="write",Iu="afterWrite",kh=[Wa,Ph,_u,wu,Eu,Ka,Ga,Tu,Iu];function fr(_){return _?(_.nodeName||"").toLowerCase():null}function ln(_){if(_==null)return window;if(_.toString()!=="[object Window]"){var c=_.ownerDocument;return c&&c.defaultView||window}return _}function li(_){return _ instanceof ln(_).Element||_ instanceof Element}function Ln(_){return _ instanceof ln(_).HTMLElement||_ instanceof HTMLElement}function Ur(_){return typeof ShadowRoot<"u"&&(_ instanceof ln(_).ShadowRoot||_ instanceof ShadowRoot)}const Xn={name:"applyStyles",enabled:!0,phase:"write",fn:function(_){var c=_.state;Object.keys(c.elements).forEach(function(g){var I=c.styles[g]||{},j=c.attributes[g]||{},F=c.elements[g];Ln(F)&&fr(F)&&(Object.assign(F.style,I),Object.keys(j).forEach(function(H){var G=j[H];G===!1?F.removeAttribute(H):F.setAttribute(H,G===!0?"":G)}))})},effect:function(_){var c=_.state,g={popper:{position:c.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(c.elements.popper.style,g.popper),c.styles=g,c.elements.arrow&&Object.assign(c.elements.arrow.style,g.arrow),function(){Object.keys(c.elements).forEach(function(I){var j=c.elements[I],F=c.attributes[I]||{},H=Object.keys(c.styles.hasOwnProperty(I)?c.styles[I]:g[I]).reduce(function(G,Z){return G[Z]="",G},{});Ln(j)&&fr(j)&&(Object.assign(j.style,H),Object.keys(F).forEach(function(G){j.removeAttribute(G)}))})}},requires:["computeStyles"]};function _n(_){return _.split("-")[0]}var pr=Math.max,Do=Math.min,$e=Math.round;function _s(){var _=navigator.userAgentData;return _!=null&&_.brands&&Array.isArray(_.brands)?_.brands.map(function(c){return c.brand+"/"+c.version}).join(" "):navigator.userAgent}function ws(){return!/^((?!chrome|android).)*safari/i.test(_s())}function gr(_,c,g){c===void 0&&(c=!1),g===void 0&&(g=!1);var I=_.getBoundingClientRect(),j=1,F=1;c&&Ln(_)&&(j=_.offsetWidth>0&&$e(I.width)/_.offsetWidth||1,F=_.offsetHeight>0&&$e(I.height)/_.offsetHeight||1);var H=(li(_)?ln(_):window).visualViewport,G=!ws()&&g,Z=(I.left+(G&&H?H.offsetLeft:0))/j,re=(I.top+(G&&H?H.offsetTop:0))/F,oe=I.width/j,ee=I.height/F;return{width:oe,height:ee,top:re,right:Z+oe,bottom:re+ee,left:Z,x:Z,y:re}}function Su(_){var c=gr(_),g=_.offsetWidth,I=_.offsetHeight;return Math.abs(c.width-g)<=1&&(g=c.width),Math.abs(c.height-I)<=1&&(I=c.height),{x:_.offsetLeft,y:_.offsetTop,width:g,height:I}}function bu(_,c){var g=c.getRootNode&&c.getRootNode();if(_.contains(c))return!0;if(g&&Ur(g)){var I=c;do{if(I&&_.isSameNode(I))return!0;I=I.parentNode||I.host}while(I)}return!1}function $r(_){return ln(_).getComputedStyle(_)}function Xp(_){return["table","td","th"].indexOf(fr(_))>=0}function ui(_){return((li(_)?_.ownerDocument:_.document)||window.document).documentElement}function Qa(_){return fr(_)==="html"?_:_.assignedSlot||_.parentNode||(Ur(_)?_.host:null)||ui(_)}function Es(_){return Ln(_)&&$r(_).position!=="fixed"?_.offsetParent:null}function Mn(_){for(var c=ln(_),g=Es(_);g&&Xp(g)&&$r(g).position==="static";)g=Es(g);return g&&(fr(g)==="html"||fr(g)==="body"&&$r(g).position==="static")?c:g||function(I){var j=/firefox/i.test(_s());if(/Trident/i.test(_s())&&Ln(I)&&$r(I).position==="fixed")return null;var F=Qa(I);for(Ur(F)&&(F=F.host);Ln(F)&&["html","body"].indexOf(fr(F))<0;){var H=$r(F);if(H.transform!=="none"||H.perspective!=="none"||H.contain==="paint"||["transform","perspective"].indexOf(H.willChange)!==-1||j&&H.willChange==="filter"||j&&H.filter&&H.filter!=="none")return F;F=F.parentNode}return null}(_)||c}function Ya(_){return["top","bottom"].indexOf(_)>=0?"x":"y"}function Ts(_,c,g){return pr(_,Do(c,g))}function Cu(_){return Object.assign({},{top:0,right:0,bottom:0,left:0},_)}function Ri(_,c){return c.reduce(function(g,I){return g[I]=_,g},{})}const Rh={name:"arrow",enabled:!0,phase:"main",fn:function(_){var c,g=_.state,I=_.name,j=_.options,F=g.elements.arrow,H=g.modifiersData.popperOffsets,G=_n(g.placement),Z=Ya(G),re=[Gt,an].indexOf(G)>=0?"height":"width";if(F&&H){var oe=function(et,Ke){return Cu(typeof(et=typeof et=="function"?et(Object.assign({},Ke.rects,{placement:Ke.placement})):et)!="number"?et:Ri(et,oi))}(j.padding,g),ee=Su(F),Se=Z==="y"?Dt:Gt,he=Z==="y"?Et:an,ye=g.rects.reference[re]+g.rects.reference[Z]-H[Z]-g.rects.popper[re],pe=H[Z]-g.rects.reference[Z],_e=Mn(F),Ze=_e?Z==="y"?_e.clientHeight||0:_e.clientWidth||0:0,ot=ye/2-pe/2,Pe=oe[Se],ze=Ze-ee[re]-oe[he],Ae=Ze/2-ee[re]/2+ot,De=Ts(Pe,Ae,ze),We=Z;g.modifiersData[I]=((c={})[We]=De,c.centerOffset=De-Ae,c)}},effect:function(_){var c=_.state,g=_.options.element,I=g===void 0?"[data-popper-arrow]":g;I!=null&&(typeof I!="string"||(I=c.elements.popper.querySelector(I)))&&bu(c.elements.popper,I)&&(c.elements.arrow=I)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Is(_){return _.split("-")[1]}var Jp={top:"auto",right:"auto",bottom:"auto",left:"auto"};function zr(_){var c,g=_.popper,I=_.popperRect,j=_.placement,F=_.variation,H=_.offsets,G=_.position,Z=_.gpuAcceleration,re=_.adaptive,oe=_.roundOffsets,ee=_.isFixed,Se=H.x,he=Se===void 0?0:Se,ye=H.y,pe=ye===void 0?0:ye,_e=typeof oe=="function"?oe({x:he,y:pe}):{x:he,y:pe};he=_e.x,pe=_e.y;var Ze=H.hasOwnProperty("x"),ot=H.hasOwnProperty("y"),Pe=Gt,ze=Dt,Ae=window;if(re){var De=Mn(g),We="clientHeight",et="clientWidth";De===ln(g)&&$r(De=ui(g)).position!=="static"&&G==="absolute"&&(We="scrollHeight",et="scrollWidth"),(j===Dt||(j===Gt||j===an)&&F===xi)&&(ze=Et,pe-=(ee&&De===Ae&&Ae.visualViewport?Ae.visualViewport.height:De[We])-I.height,pe*=Z?1:-1),j!==Gt&&(j!==Dt&&j!==Et||F!==xi)||(Pe=an,he-=(ee&&De===Ae&&Ae.visualViewport?Ae.visualViewport.width:De[et])-I.width,he*=Z?1:-1)}var Ke,At=Object.assign({position:G},re&&Jp),Jn=oe===!0?function(qr,wn){var _r=qr.x,wr=qr.y,Tt=wn.devicePixelRatio||1;return{x:$e(_r*Tt)/Tt||0,y:$e(wr*Tt)/Tt||0}}({x:he,y:pe},ln(g)):{x:he,y:pe};return he=Jn.x,pe=Jn.y,Z?Object.assign({},At,((Ke={})[ze]=ot?"0":"",Ke[Pe]=Ze?"0":"",Ke.transform=(Ae.devicePixelRatio||1)<=1?"translate("+he+"px, "+pe+"px)":"translate3d("+he+"px, "+pe+"px, 0)",Ke)):Object.assign({},At,((c={})[ze]=ot?pe+"px":"",c[Pe]=Ze?he+"px":"",c.transform="",c))}const Au={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(_){var c=_.state,g=_.options,I=g.gpuAcceleration,j=I===void 0||I,F=g.adaptive,H=F===void 0||F,G=g.roundOffsets,Z=G===void 0||G,re={placement:_n(c.placement),variation:Is(c.placement),popper:c.elements.popper,popperRect:c.rects.popper,gpuAcceleration:j,isFixed:c.options.strategy==="fixed"};c.modifiersData.popperOffsets!=null&&(c.styles.popper=Object.assign({},c.styles.popper,zr(Object.assign({},re,{offsets:c.modifiersData.popperOffsets,position:c.options.strategy,adaptive:H,roundOffsets:Z})))),c.modifiersData.arrow!=null&&(c.styles.arrow=Object.assign({},c.styles.arrow,zr(Object.assign({},re,{offsets:c.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:Z})))),c.attributes.popper=Object.assign({},c.attributes.popper,{"data-popper-placement":c.placement})},data:{}};var Xa={passive:!0};const Ss={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(_){var c=_.state,g=_.instance,I=_.options,j=I.scroll,F=j===void 0||j,H=I.resize,G=H===void 0||H,Z=ln(c.elements.popper),re=[].concat(c.scrollParents.reference,c.scrollParents.popper);return F&&re.forEach(function(oe){oe.addEventListener("scroll",g.update,Xa)}),G&&Z.addEventListener("resize",g.update,Xa),function(){F&&re.forEach(function(oe){oe.removeEventListener("scroll",g.update,Xa)}),G&&Z.removeEventListener("resize",g.update,Xa)}},data:{}};var Ja={left:"right",right:"left",bottom:"top",top:"bottom"};function Oo(_){return _.replace(/left|right|bottom|top/g,function(c){return Ja[c]})}var No={start:"end",end:"start"};function bs(_){return _.replace(/start|end/g,function(c){return No[c]})}function Za(_){var c=ln(_);return{scrollLeft:c.pageXOffset,scrollTop:c.pageYOffset}}function Lo(_){return gr(ui(_)).left+Za(_).scrollLeft}function st(_){var c=$r(_),g=c.overflow,I=c.overflowX,j=c.overflowY;return/auto|scroll|overlay|hidden/.test(g+j+I)}function Dh(_){return["html","body","#document"].indexOf(fr(_))>=0?_.ownerDocument.body:Ln(_)&&st(_)?_:Dh(Qa(_))}function Mo(_,c){var g;c===void 0&&(c=[]);var I=Dh(_),j=I===((g=_.ownerDocument)==null?void 0:g.body),F=ln(I),H=j?[F].concat(F.visualViewport||[],st(I)?I:[]):I,G=c.concat(H);return j?G:G.concat(Mo(Qa(H)))}function el(_){return Object.assign({},_,{left:_.x,top:_.y,right:_.x+_.width,bottom:_.y+_.height})}function xu(_,c,g){return c===ys?el(function(I,j){var F=ln(I),H=ui(I),G=F.visualViewport,Z=H.clientWidth,re=H.clientHeight,oe=0,ee=0;if(G){Z=G.width,re=G.height;var Se=ws();(Se||!Se&&j==="fixed")&&(oe=G.offsetLeft,ee=G.offsetTop)}return{width:Z,height:re,x:oe+Lo(I),y:ee}}(_,g)):li(c)?function(I,j){var F=gr(I,!1,j==="fixed");return F.top=F.top+I.clientTop,F.left=F.left+I.clientLeft,F.bottom=F.top+I.clientHeight,F.right=F.left+I.clientWidth,F.width=I.clientWidth,F.height=I.clientHeight,F.x=F.left,F.y=F.top,F}(c,g):el(function(I){var j,F=ui(I),H=Za(I),G=(j=I.ownerDocument)==null?void 0:j.body,Z=pr(F.scrollWidth,F.clientWidth,G?G.scrollWidth:0,G?G.clientWidth:0),re=pr(F.scrollHeight,F.clientHeight,G?G.scrollHeight:0,G?G.clientHeight:0),oe=-H.scrollLeft+Lo(I),ee=-H.scrollTop;return $r(G||F).direction==="rtl"&&(oe+=pr(F.clientWidth,G?G.clientWidth:0)-Z),{width:Z,height:re,x:oe,y:ee}}(ui(_)))}function Pu(_){var c,g=_.reference,I=_.element,j=_.placement,F=j?_n(j):null,H=j?Is(j):null,G=g.x+g.width/2-I.width/2,Z=g.y+g.height/2-I.height/2;switch(F){case Dt:c={x:G,y:g.y-I.height};break;case Et:c={x:G,y:g.y+g.height};break;case an:c={x:g.x+g.width,y:Z};break;case Gt:c={x:g.x-I.width,y:Z};break;default:c={x:g.x,y:g.y}}var re=F?Ya(F):null;if(re!=null){var oe=re==="y"?"height":"width";switch(H){case ai:c[re]=c[re]-(g[oe]/2-I[oe]/2);break;case xi:c[re]=c[re]+(g[oe]/2-I[oe]/2)}}return c}function Br(_,c){c===void 0&&(c={});var g=c,I=g.placement,j=I===void 0?_.placement:I,F=g.strategy,H=F===void 0?_.strategy:F,G=g.boundary,Z=G===void 0?xh:G,re=g.rootBoundary,oe=re===void 0?ys:re,ee=g.elementContext,Se=ee===void 0?Pi:ee,he=g.altBoundary,ye=he!==void 0&&he,pe=g.padding,_e=pe===void 0?0:pe,Ze=Cu(typeof _e!="number"?_e:Ri(_e,oi)),ot=Se===Pi?Ha:Pi,Pe=_.rects.popper,ze=_.elements[ye?ot:Se],Ae=function(wn,_r,wr,Tt){var di=_r==="clippingParents"?function(rt){var En=Mo(Qa(rt)),Er=["absolute","fixed"].indexOf($r(rt).position)>=0&&Ln(rt)?Mn(rt):rt;return li(Er)?En.filter(function(xs){return li(xs)&&bu(xs,Er)&&fr(xs)!=="body"}):[]}(wn):[].concat(_r),fi=[].concat(di,[wr]),ol=fi[0],Qt=fi.reduce(function(rt,En){var Er=xu(wn,En,Tt);return rt.top=pr(Er.top,rt.top),rt.right=Do(Er.right,rt.right),rt.bottom=Do(Er.bottom,rt.bottom),rt.left=pr(Er.left,rt.left),rt},xu(wn,ol,Tt));return Qt.width=Qt.right-Qt.left,Qt.height=Qt.bottom-Qt.top,Qt.x=Qt.left,Qt.y=Qt.top,Qt}(li(ze)?ze:ze.contextElement||ui(_.elements.popper),Z,oe,H),De=gr(_.elements.reference),We=Pu({reference:De,element:Pe,placement:j}),et=el(Object.assign({},Pe,We)),Ke=Se===Pi?et:De,At={top:Ae.top-Ke.top+Ze.top,bottom:Ke.bottom-Ae.bottom+Ze.bottom,left:Ae.left-Ke.left+Ze.left,right:Ke.right-Ae.right+Ze.right},Jn=_.modifiersData.offset;if(Se===Pi&&Jn){var qr=Jn[j];Object.keys(At).forEach(function(wn){var _r=[an,Et].indexOf(wn)>=0?1:-1,wr=[Dt,Et].indexOf(wn)>=0?"y":"x";At[wn]+=qr[wr]*_r})}return At}function Oh(_,c){c===void 0&&(c={});var g=c,I=g.placement,j=g.boundary,F=g.rootBoundary,H=g.padding,G=g.flipVariations,Z=g.allowedAutoPlacements,re=Z===void 0?Fr:Z,oe=Is(I),ee=oe?G?ki:ki.filter(function(ye){return Is(ye)===oe}):oi,Se=ee.filter(function(ye){return re.indexOf(ye)>=0});Se.length===0&&(Se=ee);var he=Se.reduce(function(ye,pe){return ye[pe]=Br(_,{placement:pe,boundary:j,rootBoundary:F,padding:H})[_n(pe)],ye},{});return Object.keys(he).sort(function(ye,pe){return he[ye]-he[pe]})}const mr={name:"flip",enabled:!0,phase:"main",fn:function(_){var c=_.state,g=_.options,I=_.name;if(!c.modifiersData[I]._skip){for(var j=g.mainAxis,F=j===void 0||j,H=g.altAxis,G=H===void 0||H,Z=g.fallbackPlacements,re=g.padding,oe=g.boundary,ee=g.rootBoundary,Se=g.altBoundary,he=g.flipVariations,ye=he===void 0||he,pe=g.allowedAutoPlacements,_e=c.options.placement,Ze=_n(_e),ot=Z||(Ze!==_e&&ye?function(rt){if(_n(rt)===vs)return[];var En=Oo(rt);return[bs(rt),En,bs(En)]}(_e):[Oo(_e)]),Pe=[_e].concat(ot).reduce(function(rt,En){return rt.concat(_n(En)===vs?Oh(c,{placement:En,boundary:oe,rootBoundary:ee,padding:re,flipVariations:ye,allowedAutoPlacements:pe}):En)},[]),ze=c.rects.reference,Ae=c.rects.popper,De=new Map,We=!0,et=Pe[0],Ke=0;Ke<Pe.length;Ke++){var At=Pe[Ke],Jn=_n(At),qr=Is(At)===ai,wn=[Dt,Et].indexOf(Jn)>=0,_r=wn?"width":"height",wr=Br(c,{placement:At,boundary:oe,rootBoundary:ee,altBoundary:Se,padding:re}),Tt=wn?qr?an:Gt:qr?Et:Dt;ze[_r]>Ae[_r]&&(Tt=Oo(Tt));var di=Oo(Tt),fi=[];if(F&&fi.push(wr[Jn]<=0),G&&fi.push(wr[Tt]<=0,wr[di]<=0),fi.every(function(rt){return rt})){et=At,We=!1;break}De.set(At,fi)}if(We)for(var ol=function(rt){var En=Pe.find(function(Er){var xs=De.get(Er);if(xs)return xs.slice(0,rt).every(function(Xh){return Xh})});if(En)return et=En,"break"},Qt=ye?3:1;Qt>0&&ol(Qt)!=="break";Qt--);c.placement!==et&&(c.modifiersData[I]._skip=!0,c.placement=et,c.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function ku(_,c,g){return g===void 0&&(g={x:0,y:0}),{top:_.top-c.height-g.y,right:_.right-c.width+g.x,bottom:_.bottom-c.height+g.y,left:_.left-c.width-g.x}}function Nh(_){return[Dt,an,Et,Gt].some(function(c){return _[c]>=0})}const Cs={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(_){var c=_.state,g=_.name,I=c.rects.reference,j=c.rects.popper,F=c.modifiersData.preventOverflow,H=Br(c,{elementContext:"reference"}),G=Br(c,{altBoundary:!0}),Z=ku(H,I),re=ku(G,j,F),oe=Nh(Z),ee=Nh(re);c.modifiersData[g]={referenceClippingOffsets:Z,popperEscapeOffsets:re,isReferenceHidden:oe,hasPopperEscaped:ee},c.attributes.popper=Object.assign({},c.attributes.popper,{"data-popper-reference-hidden":oe,"data-popper-escaped":ee})}},Ru={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(_){var c=_.state,g=_.options,I=_.name,j=g.offset,F=j===void 0?[0,0]:j,H=Fr.reduce(function(oe,ee){return oe[ee]=function(Se,he,ye){var pe=_n(Se),_e=[Gt,Dt].indexOf(pe)>=0?-1:1,Ze=typeof ye=="function"?ye(Object.assign({},he,{placement:Se})):ye,ot=Ze[0],Pe=Ze[1];return ot=ot||0,Pe=(Pe||0)*_e,[Gt,an].indexOf(pe)>=0?{x:Pe,y:ot}:{x:ot,y:Pe}}(ee,c.rects,F),oe},{}),G=H[c.placement],Z=G.x,re=G.y;c.modifiersData.popperOffsets!=null&&(c.modifiersData.popperOffsets.x+=Z,c.modifiersData.popperOffsets.y+=re),c.modifiersData[I]=H}},Vo={name:"popperOffsets",enabled:!0,phase:"read",fn:function(_){var c=_.state,g=_.name;c.modifiersData[g]=Pu({reference:c.rects.reference,element:c.rects.popper,placement:c.placement})},data:{}},jo={name:"preventOverflow",enabled:!0,phase:"main",fn:function(_){var c=_.state,g=_.options,I=_.name,j=g.mainAxis,F=j===void 0||j,H=g.altAxis,G=H!==void 0&&H,Z=g.boundary,re=g.rootBoundary,oe=g.altBoundary,ee=g.padding,Se=g.tether,he=Se===void 0||Se,ye=g.tetherOffset,pe=ye===void 0?0:ye,_e=Br(c,{boundary:Z,rootBoundary:re,padding:ee,altBoundary:oe}),Ze=_n(c.placement),ot=Is(c.placement),Pe=!ot,ze=Ya(Ze),Ae=ze==="x"?"y":"x",De=c.modifiersData.popperOffsets,We=c.rects.reference,et=c.rects.popper,Ke=typeof pe=="function"?pe(Object.assign({},c.rects,{placement:c.placement})):pe,At=typeof Ke=="number"?{mainAxis:Ke,altAxis:Ke}:Object.assign({mainAxis:0,altAxis:0},Ke),Jn=c.modifiersData.offset?c.modifiersData.offset[c.placement]:null,qr={x:0,y:0};if(De){if(F){var wn,_r=ze==="y"?Dt:Gt,wr=ze==="y"?Et:an,Tt=ze==="y"?"height":"width",di=De[ze],fi=di+_e[_r],ol=di-_e[wr],Qt=he?-et[Tt]/2:0,rt=ot===ai?We[Tt]:et[Tt],En=ot===ai?-et[Tt]:-We[Tt],Er=c.elements.arrow,xs=he&&Er?Su(Er):{width:0,height:0},Xh=c.modifiersData["arrow#persistent"]?c.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},R0=Xh[_r],D0=Xh[wr],Jh=Ts(0,We[Tt],xs[Tt]),rk=Pe?We[Tt]/2-Qt-Jh-R0-At.mainAxis:rt-Jh-R0-At.mainAxis,ik=Pe?-We[Tt]/2+Qt+Jh+D0+At.mainAxis:En+Jh+D0+At.mainAxis,ug=c.elements.arrow&&Mn(c.elements.arrow),sk=ug?ze==="y"?ug.clientTop||0:ug.clientLeft||0:0,O0=(wn=Jn==null?void 0:Jn[ze])!=null?wn:0,ok=di+ik-O0,N0=Ts(he?Do(fi,di+rk-O0-sk):fi,di,he?pr(ol,ok):ol);De[ze]=N0,qr[ze]=N0-di}if(G){var L0,ak=ze==="x"?Dt:Gt,lk=ze==="x"?Et:an,Wo=De[Ae],Zh=Ae==="y"?"height":"width",M0=Wo+_e[ak],V0=Wo-_e[lk],cg=[Dt,Gt].indexOf(Ze)!==-1,j0=(L0=Jn==null?void 0:Jn[Ae])!=null?L0:0,F0=cg?M0:Wo-We[Zh]-et[Zh]-j0+At.altAxis,U0=cg?Wo+We[Zh]+et[Zh]-j0-At.altAxis:V0,$0=he&&cg?function(uk,ck,hg){var z0=Ts(uk,ck,hg);return z0>hg?hg:z0}(F0,Wo,U0):Ts(he?F0:M0,Wo,he?U0:V0);De[Ae]=$0,qr[Ae]=$0-Wo}c.modifiersData[I]=qr}},requiresIfExists:["offset"]};function Lh(_,c,g){g===void 0&&(g=!1);var I,j,F=Ln(c),H=Ln(c)&&function(ee){var Se=ee.getBoundingClientRect(),he=$e(Se.width)/ee.offsetWidth||1,ye=$e(Se.height)/ee.offsetHeight||1;return he!==1||ye!==1}(c),G=ui(c),Z=gr(_,H,g),re={scrollLeft:0,scrollTop:0},oe={x:0,y:0};return(F||!F&&!g)&&((fr(c)!=="body"||st(G))&&(re=(I=c)!==ln(I)&&Ln(I)?{scrollLeft:(j=I).scrollLeft,scrollTop:j.scrollTop}:Za(I)),Ln(c)?((oe=gr(c,!0)).x+=c.clientLeft,oe.y+=c.clientTop):G&&(oe.x=Lo(G))),{x:Z.left+re.scrollLeft-oe.x,y:Z.top+re.scrollTop-oe.y,width:Z.width,height:Z.height}}function tl(_){var c=new Map,g=new Set,I=[];function j(F){g.add(F.name),[].concat(F.requires||[],F.requiresIfExists||[]).forEach(function(H){if(!g.has(H)){var G=c.get(H);G&&j(G)}}),I.push(F)}return _.forEach(function(F){c.set(F.name,F)}),_.forEach(function(F){g.has(F.name)||j(F)}),I}var Mh={placement:"bottom",modifiers:[],strategy:"absolute"};function Du(){for(var _=arguments.length,c=new Array(_),g=0;g<_;g++)c[g]=arguments[g];return!c.some(function(I){return!(I&&typeof I.getBoundingClientRect=="function")})}function ci(_){_===void 0&&(_={});var c=_,g=c.defaultModifiers,I=g===void 0?[]:g,j=c.defaultOptions,F=j===void 0?Mh:j;return function(H,G,Z){Z===void 0&&(Z=F);var re,oe,ee={placement:"bottom",orderedModifiers:[],options:Object.assign({},Mh,F),modifiersData:{},elements:{reference:H,popper:G},attributes:{},styles:{}},Se=[],he=!1,ye={state:ee,setOptions:function(_e){var Ze=typeof _e=="function"?_e(ee.options):_e;pe(),ee.options=Object.assign({},F,ee.options,Ze),ee.scrollParents={reference:li(H)?Mo(H):H.contextElement?Mo(H.contextElement):[],popper:Mo(G)};var ot,Pe,ze=function(Ae){var De=tl(Ae);return kh.reduce(function(We,et){return We.concat(De.filter(function(Ke){return Ke.phase===et}))},[])}((ot=[].concat(I,ee.options.modifiers),Pe=ot.reduce(function(Ae,De){var We=Ae[De.name];return Ae[De.name]=We?Object.assign({},We,De,{options:Object.assign({},We.options,De.options),data:Object.assign({},We.data,De.data)}):De,Ae},{}),Object.keys(Pe).map(function(Ae){return Pe[Ae]})));return ee.orderedModifiers=ze.filter(function(Ae){return Ae.enabled}),ee.orderedModifiers.forEach(function(Ae){var De=Ae.name,We=Ae.options,et=We===void 0?{}:We,Ke=Ae.effect;if(typeof Ke=="function"){var At=Ke({state:ee,name:De,instance:ye,options:et});Se.push(At||function(){})}}),ye.update()},forceUpdate:function(){if(!he){var _e=ee.elements,Ze=_e.reference,ot=_e.popper;if(Du(Ze,ot)){ee.rects={reference:Lh(Ze,Mn(ot),ee.options.strategy==="fixed"),popper:Su(ot)},ee.reset=!1,ee.placement=ee.options.placement,ee.orderedModifiers.forEach(function(Ke){return ee.modifiersData[Ke.name]=Object.assign({},Ke.data)});for(var Pe=0;Pe<ee.orderedModifiers.length;Pe++)if(ee.reset!==!0){var ze=ee.orderedModifiers[Pe],Ae=ze.fn,De=ze.options,We=De===void 0?{}:De,et=ze.name;typeof Ae=="function"&&(ee=Ae({state:ee,options:We,name:et,instance:ye})||ee)}else ee.reset=!1,Pe=-1}}},update:(re=function(){return new Promise(function(_e){ye.forceUpdate(),_e(ee)})},function(){return oe||(oe=new Promise(function(_e){Promise.resolve().then(function(){oe=void 0,_e(re())})})),oe}),destroy:function(){pe(),he=!0}};if(!Du(H,G))return ye;function pe(){Se.forEach(function(_e){return _e()}),Se=[]}return ye.setOptions(Z).then(function(_e){!he&&Z.onFirstUpdate&&Z.onFirstUpdate(_e)}),ye}}var Vh=ci(),jh=ci({defaultModifiers:[Ss,Vo,Au,Xn]}),Fo=ci({defaultModifiers:[Ss,Vo,Au,Xn,Ru,mr,jo,Rh,Cs]});const nl=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Ka,afterRead:_u,afterWrite:Iu,applyStyles:Xn,arrow:Rh,auto:vs,basePlacements:oi,beforeMain:wu,beforeRead:Wa,beforeWrite:Ga,bottom:Et,clippingParents:xh,computeStyles:Au,createPopper:Fo,createPopperBase:Vh,createPopperLite:jh,detectOverflow:Br,end:xi,eventListeners:Ss,flip:mr,hide:Cs,left:Gt,main:Eu,modifierPhases:kh,offset:Ru,placements:Fr,popper:Pi,popperGenerator:ci,popperOffsets:Vo,preventOverflow:jo,read:Ph,reference:Ha,right:an,start:ai,top:Dt,variationPlacements:ki,viewport:ys,write:Tu},Symbol.toStringTag,{value:"Module"})),Ou="dropdown",vr=".bs.dropdown",rl=".data-api",Fh="ArrowUp",hi="ArrowDown",Uh=`hide${vr}`,$h=`hidden${vr}`,zh=`show${vr}`,Bh=`shown${vr}`,Uo=`click${vr}${rl}`,un=`keydown${vr}${rl}`,qh=`keyup${vr}${rl}`,Di="show",Vn='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',u=`${Vn}.${Di}`,f=".dropdown-menu",v=D()?"top-end":"top-start",b=D()?"top-start":"top-end",U=D()?"bottom-end":"bottom-start",B=D()?"bottom-start":"bottom-end",J=D()?"left-start":"right-start",He=D()?"right-start":"left-start",Ut={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Me={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Je extends nt{constructor(c,g){super(c,g),this._popper=null,this._parent=this._element.parentNode,this._menu=se.next(this._element,f)[0]||se.prev(this._element,f)[0]||se.findOne(f,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Ut}static get DefaultType(){return Me}static get NAME(){return Ou}toggle(){return this._isShown()?this.hide():this.show()}show(){if(d(this._element)||this._isShown())return;const c={relatedTarget:this._element};if(!z.trigger(this._element,zh,c).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const g of[].concat(...document.body.children))z.on(g,"mouseover",m);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Di),this._element.classList.add(Di),z.trigger(this._element,Bh,c)}}hide(){if(d(this._element)||!this._isShown())return;const c={relatedTarget:this._element};this._completeHide(c)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(c){if(!z.trigger(this._element,Uh,c).defaultPrevented){if("ontouchstart"in document.documentElement)for(const g of[].concat(...document.body.children))z.off(g,"mouseover",m);this._popper&&this._popper.destroy(),this._menu.classList.remove(Di),this._element.classList.remove(Di),this._element.setAttribute("aria-expanded","false"),lt.removeDataAttribute(this._menu,"popper"),z.trigger(this._element,$h,c)}}_getConfig(c){if(typeof(c=super._getConfig(c)).reference=="object"&&!a(c.reference)&&typeof c.reference.getBoundingClientRect!="function")throw new TypeError(`${Ou.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return c}_createPopper(){if(nl===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let c=this._element;this._config.reference==="parent"?c=this._parent:a(this._config.reference)?c=l(this._config.reference):typeof this._config.reference=="object"&&(c=this._config.reference);const g=this._getPopperConfig();this._popper=Fo(c,this._menu,g)}_isShown(){return this._menu.classList.contains(Di)}_getPlacement(){const c=this._parent;if(c.classList.contains("dropend"))return J;if(c.classList.contains("dropstart"))return He;if(c.classList.contains("dropup-center"))return"top";if(c.classList.contains("dropdown-center"))return"bottom";const g=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return c.classList.contains("dropup")?g?b:v:g?B:U}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:c}=this._config;return typeof c=="string"?c.split(",").map(g=>Number.parseInt(g,10)):typeof c=="function"?g=>c(g,this._element):c}_getPopperConfig(){const c={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(lt.setDataAttribute(this._menu,"popper","static"),c.modifiers=[{name:"applyStyles",enabled:!1}]),{...c,...T(this._config.popperConfig,[c])}}_selectMenuItem({key:c,target:g}){const I=se.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(j=>h(j));I.length&&M(I,g,c===hi,!I.includes(g)).focus()}static jQueryInterface(c){return this.each(function(){const g=Je.getOrCreateInstance(this,c);if(typeof c=="string"){if(g[c]===void 0)throw new TypeError(`No method named "${c}"`);g[c]()}})}static clearMenus(c){if(c.button===2||c.type==="keyup"&&c.key!=="Tab")return;const g=se.find(u);for(const I of g){const j=Je.getInstance(I);if(!j||j._config.autoClose===!1)continue;const F=c.composedPath(),H=F.includes(j._menu);if(F.includes(j._element)||j._config.autoClose==="inside"&&!H||j._config.autoClose==="outside"&&H||j._menu.contains(c.target)&&(c.type==="keyup"&&c.key==="Tab"||/input|select|option|textarea|form/i.test(c.target.tagName)))continue;const G={relatedTarget:j._element};c.type==="click"&&(G.clickEvent=c),j._completeHide(G)}}static dataApiKeydownHandler(c){const g=/input|textarea/i.test(c.target.tagName),I=c.key==="Escape",j=[Fh,hi].includes(c.key);if(!j&&!I||g&&!I)return;c.preventDefault();const F=this.matches(Vn)?this:se.prev(this,Vn)[0]||se.next(this,Vn)[0]||se.findOne(Vn,c.delegateTarget.parentNode),H=Je.getOrCreateInstance(F);if(j)return c.stopPropagation(),H.show(),void H._selectMenuItem(c);H._isShown()&&(c.stopPropagation(),H.hide(),F.focus())}}z.on(document,un,Vn,Je.dataApiKeydownHandler),z.on(document,un,f,Je.dataApiKeydownHandler),z.on(document,Uo,Je.clearMenus),z.on(document,qh,Je.clearMenus),z.on(document,Uo,Vn,function(_){_.preventDefault(),Je.getOrCreateInstance(this).toggle()}),A(Je);const $t="backdrop",Oi="show",jn=`mousedown.bs.${$t}`,il={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Nu={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class n0 extends jt{constructor(c){super(),this._config=this._getConfig(c),this._isAppended=!1,this._element=null}static get Default(){return il}static get DefaultType(){return Nu}static get NAME(){return $t}show(c){if(!this._config.isVisible)return void T(c);this._append();const g=this._getElement();this._config.isAnimated&&w(g),g.classList.add(Oi),this._emulateAnimation(()=>{T(c)})}hide(c){this._config.isVisible?(this._getElement().classList.remove(Oi),this._emulateAnimation(()=>{this.dispose(),T(c)})):T(c)}dispose(){this._isAppended&&(z.off(this._element,jn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const c=document.createElement("div");c.className=this._config.className,this._config.isAnimated&&c.classList.add("fade"),this._element=c}return this._element}_configAfterMerge(c){return c.rootElement=l(c.rootElement),c}_append(){if(this._isAppended)return;const c=this._getElement();this._config.rootElement.append(c),z.on(c,jn,()=>{T(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(c){S(c,this._getElement(),this._config.isAnimated)}}const Hh=".bs.focustrap",Yx=`focusin${Hh}`,Xx=`keydown.tab${Hh}`,r0="backward",Jx={autofocus:!0,trapElement:null},Zx={autofocus:"boolean",trapElement:"element"};class i0 extends jt{constructor(c){super(),this._config=this._getConfig(c),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Jx}static get DefaultType(){return Zx}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),z.off(document,Hh),z.on(document,Yx,c=>this._handleFocusin(c)),z.on(document,Xx,c=>this._handleKeydown(c)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,z.off(document,Hh))}_handleFocusin(c){const{trapElement:g}=this._config;if(c.target===document||c.target===g||g.contains(c.target))return;const I=se.focusableChildren(g);I.length===0?g.focus():this._lastTabNavDirection===r0?I[I.length-1].focus():I[0].focus()}_handleKeydown(c){c.key==="Tab"&&(this._lastTabNavDirection=c.shiftKey?r0:"forward")}}const s0=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",o0=".sticky-top",Wh="padding-right",a0="margin-right";class Zp{constructor(){this._element=document.body}getWidth(){const c=document.documentElement.clientWidth;return Math.abs(window.innerWidth-c)}hide(){const c=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Wh,g=>g+c),this._setElementAttributes(s0,Wh,g=>g+c),this._setElementAttributes(o0,a0,g=>g-c)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Wh),this._resetElementAttributes(s0,Wh),this._resetElementAttributes(o0,a0)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(c,g,I){const j=this.getWidth();this._applyManipulationCallback(c,F=>{if(F!==this._element&&window.innerWidth>F.clientWidth+j)return;this._saveInitialAttribute(F,g);const H=window.getComputedStyle(F).getPropertyValue(g);F.style.setProperty(g,`${I(Number.parseFloat(H))}px`)})}_saveInitialAttribute(c,g){const I=c.style.getPropertyValue(g);I&&lt.setDataAttribute(c,g,I)}_resetElementAttributes(c,g){this._applyManipulationCallback(c,I=>{const j=lt.getDataAttribute(I,g);j!==null?(lt.removeDataAttribute(I,g),I.style.setProperty(g,j)):I.style.removeProperty(g)})}_applyManipulationCallback(c,g){if(a(c))g(c);else for(const I of se.find(c,this._element))g(I)}}const yr=".bs.modal",eP=`hide${yr}`,tP=`hidePrevented${yr}`,l0=`hidden${yr}`,u0=`show${yr}`,nP=`shown${yr}`,rP=`resize${yr}`,iP=`click.dismiss${yr}`,sP=`mousedown.dismiss${yr}`,oP=`keydown.dismiss${yr}`,aP=`click${yr}.data-api`,c0="modal-open",h0="show",eg="modal-static",lP={backdrop:!0,focus:!0,keyboard:!0},uP={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class $o extends nt{constructor(c,g){super(c,g),this._dialog=se.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Zp,this._addEventListeners()}static get Default(){return lP}static get DefaultType(){return uP}static get NAME(){return"modal"}toggle(c){return this._isShown?this.hide():this.show(c)}show(c){this._isShown||this._isTransitioning||z.trigger(this._element,u0,{relatedTarget:c}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(c0),this._adjustDialog(),this._backdrop.show(()=>this._showElement(c)))}hide(){this._isShown&&!this._isTransitioning&&(z.trigger(this._element,eP).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(h0),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){z.off(window,yr),z.off(this._dialog,yr),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new n0({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new i0({trapElement:this._element})}_showElement(c){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const g=se.findOne(".modal-body",this._dialog);g&&(g.scrollTop=0),w(this._element),this._element.classList.add(h0),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,z.trigger(this._element,nP,{relatedTarget:c})},this._dialog,this._isAnimated())}_addEventListeners(){z.on(this._element,oP,c=>{c.key==="Escape"&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),z.on(window,rP,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),z.on(this._element,sP,c=>{z.one(this._element,iP,g=>{this._element===c.target&&this._element===g.target&&(this._config.backdrop!=="static"?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(c0),this._resetAdjustments(),this._scrollBar.reset(),z.trigger(this._element,l0)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(z.trigger(this._element,tP).defaultPrevented)return;const c=this._element.scrollHeight>document.documentElement.clientHeight,g=this._element.style.overflowY;g==="hidden"||this._element.classList.contains(eg)||(c||(this._element.style.overflowY="hidden"),this._element.classList.add(eg),this._queueCallback(()=>{this._element.classList.remove(eg),this._queueCallback(()=>{this._element.style.overflowY=g},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const c=this._element.scrollHeight>document.documentElement.clientHeight,g=this._scrollBar.getWidth(),I=g>0;if(I&&!c){const j=D()?"paddingLeft":"paddingRight";this._element.style[j]=`${g}px`}if(!I&&c){const j=D()?"paddingRight":"paddingLeft";this._element.style[j]=`${g}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(c,g){return this.each(function(){const I=$o.getOrCreateInstance(this,c);if(typeof c=="string"){if(I[c]===void 0)throw new TypeError(`No method named "${c}"`);I[c](g)}})}}z.on(document,aP,'[data-bs-toggle="modal"]',function(_){const c=se.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&_.preventDefault(),z.one(c,u0,I=>{I.defaultPrevented||z.one(c,l0,()=>{h(this)&&this.focus()})});const g=se.findOne(".modal.show");g&&$o.getInstance(g).hide(),$o.getOrCreateInstance(c).toggle(this)}),Wn($o),A($o);const Ni=".bs.offcanvas",d0=".data-api",cP=`load${Ni}${d0}`,f0="show",p0="showing",g0="hiding",m0=".offcanvas.show",hP=`show${Ni}`,dP=`shown${Ni}`,fP=`hide${Ni}`,v0=`hidePrevented${Ni}`,y0=`hidden${Ni}`,pP=`resize${Ni}`,gP=`click${Ni}${d0}`,mP=`keydown.dismiss${Ni}`,vP={backdrop:!0,keyboard:!0,scroll:!1},yP={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Li extends nt{constructor(c,g){super(c,g),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return vP}static get DefaultType(){return yP}static get NAME(){return"offcanvas"}toggle(c){return this._isShown?this.hide():this.show(c)}show(c){this._isShown||z.trigger(this._element,hP,{relatedTarget:c}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new Zp().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(p0),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(f0),this._element.classList.remove(p0),z.trigger(this._element,dP,{relatedTarget:c})},this._element,!0))}hide(){this._isShown&&(z.trigger(this._element,fP).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(g0),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(f0,g0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Zp().reset(),z.trigger(this._element,y0)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const c=!!this._config.backdrop;return new n0({className:"offcanvas-backdrop",isVisible:c,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:c?()=>{this._config.backdrop!=="static"?this.hide():z.trigger(this._element,v0)}:null})}_initializeFocusTrap(){return new i0({trapElement:this._element})}_addEventListeners(){z.on(this._element,mP,c=>{c.key==="Escape"&&(this._config.keyboard?this.hide():z.trigger(this._element,v0))})}static jQueryInterface(c){return this.each(function(){const g=Li.getOrCreateInstance(this,c);if(typeof c=="string"){if(g[c]===void 0||c.startsWith("_")||c==="constructor")throw new TypeError(`No method named "${c}"`);g[c](this)}})}}z.on(document,gP,'[data-bs-toggle="offcanvas"]',function(_){const c=se.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&_.preventDefault(),d(this))return;z.one(c,y0,()=>{h(this)&&this.focus()});const g=se.findOne(m0);g&&g!==c&&Li.getInstance(g).hide(),Li.getOrCreateInstance(c).toggle(this)}),z.on(window,cP,()=>{for(const _ of se.find(m0))Li.getOrCreateInstance(_).show()}),z.on(window,pP,()=>{for(const _ of se.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(_).position!=="fixed"&&Li.getOrCreateInstance(_).hide()}),Wn(Li),A(Li);const _0={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},_P=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),wP=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,EP=(_,c)=>{const g=_.nodeName.toLowerCase();return c.includes(g)?!_P.has(g)||!!wP.test(_.nodeValue):c.filter(I=>I instanceof RegExp).some(I=>I.test(g))},TP={allowList:_0,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},IP={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},SP={entry:"(string|element|function|null)",selector:"(string|element)"};class bP extends jt{constructor(c){super(),this._config=this._getConfig(c)}static get Default(){return TP}static get DefaultType(){return IP}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(c=>this._resolvePossibleFunction(c)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(c){return this._checkContent(c),this._config.content={...this._config.content,...c},this}toHtml(){const c=document.createElement("div");c.innerHTML=this._maybeSanitize(this._config.template);for(const[j,F]of Object.entries(this._config.content))this._setContent(c,F,j);const g=c.children[0],I=this._resolvePossibleFunction(this._config.extraClass);return I&&g.classList.add(...I.split(" ")),g}_typeCheckConfig(c){super._typeCheckConfig(c),this._checkContent(c.content)}_checkContent(c){for(const[g,I]of Object.entries(c))super._typeCheckConfig({selector:g,entry:I},SP)}_setContent(c,g,I){const j=se.findOne(I,c);j&&((g=this._resolvePossibleFunction(g))?a(g)?this._putElementInTemplate(l(g),j):this._config.html?j.innerHTML=this._maybeSanitize(g):j.textContent=g:j.remove())}_maybeSanitize(c){return this._config.sanitize?function(g,I,j){if(!g.length)return g;if(j&&typeof j=="function")return j(g);const F=new window.DOMParser().parseFromString(g,"text/html"),H=[].concat(...F.body.querySelectorAll("*"));for(const G of H){const Z=G.nodeName.toLowerCase();if(!Object.keys(I).includes(Z)){G.remove();continue}const re=[].concat(...G.attributes),oe=[].concat(I["*"]||[],I[Z]||[]);for(const ee of re)EP(ee,oe)||G.removeAttribute(ee.nodeName)}return F.body.innerHTML}(c,this._config.allowList,this._config.sanitizeFn):c}_resolvePossibleFunction(c){return T(c,[this])}_putElementInTemplate(c,g){if(this._config.html)return g.innerHTML="",void g.append(c);g.textContent=c.textContent}}const CP=new Set(["sanitize","allowList","sanitizeFn"]),tg="fade",Kh="show",w0=".modal",E0="hide.bs.modal",Lu="hover",ng="focus",AP={AUTO:"auto",TOP:"top",RIGHT:D()?"left":"right",BOTTOM:"bottom",LEFT:D()?"right":"left"},xP={allowList:_0,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},PP={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class zo extends nt{constructor(c,g){if(nl===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(c,g),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return xP}static get DefaultType(){return PP}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),z.off(this._element.closest(w0),E0,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const c=z.trigger(this._element,this.constructor.eventName("show")),g=(p(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(c.defaultPrevented||!g)return;this._disposePopper();const I=this._getTipElement();this._element.setAttribute("aria-describedby",I.getAttribute("id"));const{container:j}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(j.append(I),z.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(I),I.classList.add(Kh),"ontouchstart"in document.documentElement)for(const F of[].concat(...document.body.children))z.on(F,"mouseover",m);this._queueCallback(()=>{z.trigger(this._element,this.constructor.eventName("shown")),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!z.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(Kh),"ontouchstart"in document.documentElement)for(const c of[].concat(...document.body.children))z.off(c,"mouseover",m);this._activeTrigger.click=!1,this._activeTrigger[ng]=!1,this._activeTrigger[Lu]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),z.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(c){const g=this._getTemplateFactory(c).toHtml();if(!g)return null;g.classList.remove(tg,Kh),g.classList.add(`bs-${this.constructor.NAME}-auto`);const I=(j=>{do j+=Math.floor(1e6*Math.random());while(document.getElementById(j));return j})(this.constructor.NAME).toString();return g.setAttribute("id",I),this._isAnimated()&&g.classList.add(tg),g}setContent(c){this._newContent=c,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(c){return this._templateFactory?this._templateFactory.changeContent(c):this._templateFactory=new bP({...this._config,content:c,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(c){return this.constructor.getOrCreateInstance(c.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(tg)}_isShown(){return this.tip&&this.tip.classList.contains(Kh)}_createPopper(c){const g=T(this._config.placement,[this,c,this._element]),I=AP[g.toUpperCase()];return Fo(this._element,c,this._getPopperConfig(I))}_getOffset(){const{offset:c}=this._config;return typeof c=="string"?c.split(",").map(g=>Number.parseInt(g,10)):typeof c=="function"?g=>c(g,this._element):c}_resolvePossibleFunction(c){return T(c,[this._element])}_getPopperConfig(c){const g={placement:c,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:I=>{this._getTipElement().setAttribute("data-popper-placement",I.state.placement)}}]};return{...g,...T(this._config.popperConfig,[g])}}_setListeners(){const c=this._config.trigger.split(" ");for(const g of c)if(g==="click")z.on(this._element,this.constructor.eventName("click"),this._config.selector,I=>{this._initializeOnDelegatedTarget(I).toggle()});else if(g!=="manual"){const I=g===Lu?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),j=g===Lu?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");z.on(this._element,I,this._config.selector,F=>{const H=this._initializeOnDelegatedTarget(F);H._activeTrigger[F.type==="focusin"?ng:Lu]=!0,H._enter()}),z.on(this._element,j,this._config.selector,F=>{const H=this._initializeOnDelegatedTarget(F);H._activeTrigger[F.type==="focusout"?ng:Lu]=H._element.contains(F.relatedTarget),H._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},z.on(this._element.closest(w0),E0,this._hideModalHandler)}_fixTitle(){const c=this._element.getAttribute("title");c&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",c),this._element.setAttribute("data-bs-original-title",c),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(c,g){clearTimeout(this._timeout),this._timeout=setTimeout(c,g)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(c){const g=lt.getDataAttributes(this._element);for(const I of Object.keys(g))CP.has(I)&&delete g[I];return c={...g,...typeof c=="object"&&c?c:{}},c=this._mergeConfigObj(c),c=this._configAfterMerge(c),this._typeCheckConfig(c),c}_configAfterMerge(c){return c.container=c.container===!1?document.body:l(c.container),typeof c.delay=="number"&&(c.delay={show:c.delay,hide:c.delay}),typeof c.title=="number"&&(c.title=c.title.toString()),typeof c.content=="number"&&(c.content=c.content.toString()),c}_getDelegateConfig(){const c={};for(const[g,I]of Object.entries(this._config))this.constructor.Default[g]!==I&&(c[g]=I);return c.selector=!1,c.trigger="manual",c}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(c){return this.each(function(){const g=zo.getOrCreateInstance(this,c);if(typeof c=="string"){if(g[c]===void 0)throw new TypeError(`No method named "${c}"`);g[c]()}})}}A(zo);const kP={...zo.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},RP={...zo.DefaultType,content:"(null|string|element|function)"};class Gh extends zo{static get Default(){return kP}static get DefaultType(){return RP}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(c){return this.each(function(){const g=Gh.getOrCreateInstance(this,c);if(typeof c=="string"){if(g[c]===void 0)throw new TypeError(`No method named "${c}"`);g[c]()}})}}A(Gh);const rg=".bs.scrollspy",DP=`activate${rg}`,T0=`click${rg}`,OP=`load${rg}.data-api`,sl="active",ig="[href]",I0=".nav-link",NP=`${I0}, .nav-item > ${I0}, .list-group-item`,LP={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},MP={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Mu extends nt{constructor(c,g){super(c,g),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return LP}static get DefaultType(){return MP}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const c of this._observableSections.values())this._observer.observe(c)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(c){return c.target=l(c.target)||document.body,c.rootMargin=c.offset?`${c.offset}px 0px -30%`:c.rootMargin,typeof c.threshold=="string"&&(c.threshold=c.threshold.split(",").map(g=>Number.parseFloat(g))),c}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(z.off(this._config.target,T0),z.on(this._config.target,T0,ig,c=>{const g=this._observableSections.get(c.target.hash);if(g){c.preventDefault();const I=this._rootElement||window,j=g.offsetTop-this._element.offsetTop;if(I.scrollTo)return void I.scrollTo({top:j,behavior:"smooth"});I.scrollTop=j}}))}_getNewObserver(){const c={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(g=>this._observerCallback(g),c)}_observerCallback(c){const g=H=>this._targetLinks.get(`#${H.target.id}`),I=H=>{this._previousScrollData.visibleEntryTop=H.target.offsetTop,this._process(g(H))},j=(this._rootElement||document.documentElement).scrollTop,F=j>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=j;for(const H of c){if(!H.isIntersecting){this._activeTarget=null,this._clearActiveClass(g(H));continue}const G=H.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(F&&G){if(I(H),!j)return}else F||G||I(H)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const c=se.find(ig,this._config.target);for(const g of c){if(!g.hash||d(g))continue;const I=se.findOne(decodeURI(g.hash),this._element);h(I)&&(this._targetLinks.set(decodeURI(g.hash),g),this._observableSections.set(g.hash,I))}}_process(c){this._activeTarget!==c&&(this._clearActiveClass(this._config.target),this._activeTarget=c,c.classList.add(sl),this._activateParents(c),z.trigger(this._element,DP,{relatedTarget:c}))}_activateParents(c){if(c.classList.contains("dropdown-item"))se.findOne(".dropdown-toggle",c.closest(".dropdown")).classList.add(sl);else for(const g of se.parents(c,".nav, .list-group"))for(const I of se.prev(g,NP))I.classList.add(sl)}_clearActiveClass(c){c.classList.remove(sl);const g=se.find(`${ig}.${sl}`,c);for(const I of g)I.classList.remove(sl)}static jQueryInterface(c){return this.each(function(){const g=Mu.getOrCreateInstance(this,c);if(typeof c=="string"){if(g[c]===void 0||c.startsWith("_")||c==="constructor")throw new TypeError(`No method named "${c}"`);g[c]()}})}}z.on(window,OP,()=>{for(const _ of se.find('[data-bs-spy="scroll"]'))Mu.getOrCreateInstance(_)}),A(Mu);const Bo=".bs.tab",VP=`hide${Bo}`,jP=`hidden${Bo}`,FP=`show${Bo}`,UP=`shown${Bo}`,$P=`click${Bo}`,zP=`keydown${Bo}`,BP=`load${Bo}`,qP="ArrowLeft",S0="ArrowRight",HP="ArrowUp",b0="ArrowDown",sg="Home",C0="End",qo="active",A0="fade",og="show",x0=".dropdown-toggle",ag=`:not(${x0})`,P0='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',lg=`.nav-link${ag}, .list-group-item${ag}, [role="tab"]${ag}, ${P0}`,WP=`.${qo}[data-bs-toggle="tab"], .${qo}[data-bs-toggle="pill"], .${qo}[data-bs-toggle="list"]`;class Ho extends nt{constructor(c){super(c),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),z.on(this._element,zP,g=>this._keydown(g)))}static get NAME(){return"tab"}show(){const c=this._element;if(this._elemIsActive(c))return;const g=this._getActiveElem(),I=g?z.trigger(g,VP,{relatedTarget:c}):null;z.trigger(c,FP,{relatedTarget:g}).defaultPrevented||I&&I.defaultPrevented||(this._deactivate(g,c),this._activate(c,g))}_activate(c,g){c&&(c.classList.add(qo),this._activate(se.getElementFromSelector(c)),this._queueCallback(()=>{c.getAttribute("role")==="tab"?(c.removeAttribute("tabindex"),c.setAttribute("aria-selected",!0),this._toggleDropDown(c,!0),z.trigger(c,UP,{relatedTarget:g})):c.classList.add(og)},c,c.classList.contains(A0)))}_deactivate(c,g){c&&(c.classList.remove(qo),c.blur(),this._deactivate(se.getElementFromSelector(c)),this._queueCallback(()=>{c.getAttribute("role")==="tab"?(c.setAttribute("aria-selected",!1),c.setAttribute("tabindex","-1"),this._toggleDropDown(c,!1),z.trigger(c,jP,{relatedTarget:g})):c.classList.remove(og)},c,c.classList.contains(A0)))}_keydown(c){if(![qP,S0,HP,b0,sg,C0].includes(c.key))return;c.stopPropagation(),c.preventDefault();const g=this._getChildren().filter(j=>!d(j));let I;if([sg,C0].includes(c.key))I=g[c.key===sg?0:g.length-1];else{const j=[S0,b0].includes(c.key);I=M(g,c.target,j,!0)}I&&(I.focus({preventScroll:!0}),Ho.getOrCreateInstance(I).show())}_getChildren(){return se.find(lg,this._parent)}_getActiveElem(){return this._getChildren().find(c=>this._elemIsActive(c))||null}_setInitialAttributes(c,g){this._setAttributeIfNotExists(c,"role","tablist");for(const I of g)this._setInitialAttributesOnChild(I)}_setInitialAttributesOnChild(c){c=this._getInnerElement(c);const g=this._elemIsActive(c),I=this._getOuterElement(c);c.setAttribute("aria-selected",g),I!==c&&this._setAttributeIfNotExists(I,"role","presentation"),g||c.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(c,"role","tab"),this._setInitialAttributesOnTargetPanel(c)}_setInitialAttributesOnTargetPanel(c){const g=se.getElementFromSelector(c);g&&(this._setAttributeIfNotExists(g,"role","tabpanel"),c.id&&this._setAttributeIfNotExists(g,"aria-labelledby",`${c.id}`))}_toggleDropDown(c,g){const I=this._getOuterElement(c);if(!I.classList.contains("dropdown"))return;const j=(F,H)=>{const G=se.findOne(F,I);G&&G.classList.toggle(H,g)};j(x0,qo),j(".dropdown-menu",og),I.setAttribute("aria-expanded",g)}_setAttributeIfNotExists(c,g,I){c.hasAttribute(g)||c.setAttribute(g,I)}_elemIsActive(c){return c.classList.contains(qo)}_getInnerElement(c){return c.matches(lg)?c:se.findOne(lg,c)}_getOuterElement(c){return c.closest(".nav-item, .list-group-item")||c}static jQueryInterface(c){return this.each(function(){const g=Ho.getOrCreateInstance(this);if(typeof c=="string"){if(g[c]===void 0||c.startsWith("_")||c==="constructor")throw new TypeError(`No method named "${c}"`);g[c]()}})}}z.on(document,$P,P0,function(_){["A","AREA"].includes(this.tagName)&&_.preventDefault(),d(this)||Ho.getOrCreateInstance(this).show()}),z.on(window,BP,()=>{for(const _ of se.find(WP))Ho.getOrCreateInstance(_)}),A(Ho);const As=".bs.toast",KP=`mouseover${As}`,GP=`mouseout${As}`,QP=`focusin${As}`,YP=`focusout${As}`,XP=`hide${As}`,JP=`hidden${As}`,ZP=`show${As}`,ek=`shown${As}`,k0="hide",Qh="show",Yh="showing",tk={animation:"boolean",autohide:"boolean",delay:"number"},nk={animation:!0,autohide:!0,delay:5e3};class Vu extends nt{constructor(c,g){super(c,g),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return nk}static get DefaultType(){return tk}static get NAME(){return"toast"}show(){z.trigger(this._element,ZP).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(k0),w(this._element),this._element.classList.add(Qh,Yh),this._queueCallback(()=>{this._element.classList.remove(Yh),z.trigger(this._element,ek),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(z.trigger(this._element,XP).defaultPrevented||(this._element.classList.add(Yh),this._queueCallback(()=>{this._element.classList.add(k0),this._element.classList.remove(Yh,Qh),z.trigger(this._element,JP)},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Qh),super.dispose()}isShown(){return this._element.classList.contains(Qh)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(c,g){switch(c.type){case"mouseover":case"mouseout":this._hasMouseInteraction=g;break;case"focusin":case"focusout":this._hasKeyboardInteraction=g}if(g)return void this._clearTimeout();const I=c.relatedTarget;this._element===I||this._element.contains(I)||this._maybeScheduleHide()}_setListeners(){z.on(this._element,KP,c=>this._onInteraction(c,!0)),z.on(this._element,GP,c=>this._onInteraction(c,!1)),z.on(this._element,QP,c=>this._onInteraction(c,!0)),z.on(this._element,YP,c=>this._onInteraction(c,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(c){return this.each(function(){const g=Vu.getOrCreateInstance(this,c);if(typeof c=="string"){if(g[c]===void 0)throw new TypeError(`No method named "${c}"`);g[c](this)}})}}return Wn(Vu),A(Vu),{Alert:On,Button:Gn,Carousel:Nn,Collapse:si,Dropdown:Je,Modal:$o,Offcanvas:Li,Popover:Gh,ScrollSpy:Mu,Tab:Ho,Toast:Vu,Tooltip:zo}})})(BD);/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gc(){return Gc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Gc.apply(this,arguments)}var Gs;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Gs||(Gs={}));const Jw="popstate";function qD(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return nv("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:kf(i)}return WD(e,n,null,t)}function kt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function BS(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function HD(){return Math.random().toString(36).substr(2,8)}function Zw(t,e){return{usr:t.state,key:t.key,idx:e}}function nv(t,e,n,r){return n===void 0&&(n=null),Gc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?uu(e):e,{state:n,key:e&&e.key||r||HD()})}function kf(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function uu(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function WD(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=Gs.Pop,l=null,h=d();h==null&&(h=0,o.replaceState(Gc({},o.state,{idx:h}),""));function d(){return(o.state||{idx:null}).idx}function p(){a=Gs.Pop;let D=d(),A=D==null?null:D-h;h=D,l&&l({action:a,location:x.location,delta:A})}function m(D,A){a=Gs.Push;let T=nv(x.location,D,A);h=d()+1;let S=Zw(T,h),M=x.createHref(T);try{o.pushState(S,"",M)}catch(q){if(q instanceof DOMException&&q.name==="DataCloneError")throw q;i.location.assign(M)}s&&l&&l({action:a,location:x.location,delta:1})}function w(D,A){a=Gs.Replace;let T=nv(x.location,D,A);h=d();let S=Zw(T,h),M=x.createHref(T);o.replaceState(S,"",M),s&&l&&l({action:a,location:x.location,delta:0})}function E(D){let A=i.location.origin!=="null"?i.location.origin:i.location.href,T=typeof D=="string"?D:kf(D);return T=T.replace(/ $/,"%20"),kt(A,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,A)}let x={get action(){return a},get location(){return t(i,o)},listen(D){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(Jw,p),l=D,()=>{i.removeEventListener(Jw,p),l=null}},createHref(D){return e(i,D)},createURL:E,encodeLocation(D){let A=E(D);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:m,replace:w,go(D){return o.go(D)}};return x}var eE;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(eE||(eE={}));function KD(t,e,n){return n===void 0&&(n="/"),GD(t,e,n,!1)}function GD(t,e,n,r){let i=typeof e=="string"?uu(e):e,s=Uy(i.pathname||"/",n);if(s==null)return null;let o=qS(t);QD(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let h=oO(s);a=iO(o[l],h,r)}return a}function qS(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(kt(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let h=io([r,l.relativePath]),d=n.concat(l);s.children&&s.children.length>0&&(kt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),qS(s.children,e,d,h)),!(s.path==null&&!s.index)&&e.push({path:h,score:nO(h,s.index),routesMeta:d})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of HS(s.path))i(s,o,l)}),e}function HS(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=HS(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function QD(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:rO(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const YD=/^:[\w-]+$/,XD=3,JD=2,ZD=1,eO=10,tO=-2,tE=t=>t==="*";function nO(t,e){let n=t.split("/"),r=n.length;return n.some(tE)&&(r+=tO),e&&(r+=JD),n.filter(i=>!tE(i)).reduce((i,s)=>i+(YD.test(s)?XD:s===""?ZD:eO),r)}function rO(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function iO(t,e,n){let{routesMeta:r}=t,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],h=a===r.length-1,d=s==="/"?e:e.slice(s.length)||"/",p=nE({path:l.relativePath,caseSensitive:l.caseSensitive,end:h},d),m=l.route;if(!p&&h&&n&&!r[r.length-1].route.index&&(p=nE({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},d)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:io([s,p.pathname]),pathnameBase:cO(io([s,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(s=io([s,p.pathnameBase]))}return o}function nE(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=sO(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((h,d,p)=>{let{paramName:m,isOptional:w}=d;if(m==="*"){let x=a[p]||"";o=s.slice(0,s.length-x.length).replace(/(.)\/+$/,"$1")}const E=a[p];return w&&!E?h[m]=void 0:h[m]=(E||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:o,pattern:t}}function sO(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),BS(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function oO(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return BS(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Uy(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function aO(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?uu(t):t;return{pathname:n?n.startsWith("/")?n:lO(n,e):e,search:hO(r),hash:dO(i)}}function lO(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function jg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function uO(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function $y(t,e){let n=uO(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function zy(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=uu(t):(i=Gc({},t),kt(!i.pathname||!i.pathname.includes("?"),jg("?","pathname","search",i)),kt(!i.pathname||!i.pathname.includes("#"),jg("#","pathname","hash",i)),kt(!i.search||!i.search.includes("#"),jg("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}a=p>=0?e[p]:"/"}let l=aO(i,a),h=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(h||d)&&(l.pathname+="/"),l}const io=t=>t.join("/").replace(/\/\/+/g,"/"),cO=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),hO=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,dO=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function fO(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const WS=["post","put","patch","delete"];new Set(WS);const pO=["get",...WS];new Set(pO);/**
 * React Router v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qc(){return Qc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Qc.apply(this,arguments)}const By=N.createContext(null),gO=N.createContext(null),Eo=N.createContext(null),yp=N.createContext(null),is=N.createContext({outlet:null,matches:[],isDataRoute:!1}),KS=N.createContext(null);function mO(t,e){let{relative:n}=e===void 0?{}:e;cu()||kt(!1);let{basename:r,navigator:i}=N.useContext(Eo),{hash:s,pathname:o,search:a}=QS(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:io([r,o])),i.createHref({pathname:l,search:a,hash:s})}function cu(){return N.useContext(yp)!=null}function Oa(){return cu()||kt(!1),N.useContext(yp).location}function GS(t){N.useContext(Eo).static||N.useLayoutEffect(t)}function Na(){let{isDataRoute:t}=N.useContext(is);return t?kO():vO()}function vO(){cu()||kt(!1);let t=N.useContext(By),{basename:e,future:n,navigator:r}=N.useContext(Eo),{matches:i}=N.useContext(is),{pathname:s}=Oa(),o=JSON.stringify($y(i,n.v7_relativeSplatPath)),a=N.useRef(!1);return GS(()=>{a.current=!0}),N.useCallback(function(h,d){if(d===void 0&&(d={}),!a.current)return;if(typeof h=="number"){r.go(h);return}let p=zy(h,JSON.parse(o),s,d.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:io([e,p.pathname])),(d.replace?r.replace:r.push)(p,d.state,d)},[e,r,o,s,t])}function yO(){let{matches:t}=N.useContext(is),e=t[t.length-1];return e?e.params:{}}function QS(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=N.useContext(Eo),{matches:i}=N.useContext(is),{pathname:s}=Oa(),o=JSON.stringify($y(i,r.v7_relativeSplatPath));return N.useMemo(()=>zy(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function _O(t,e){return wO(t,e)}function wO(t,e,n,r){cu()||kt(!1);let{navigator:i}=N.useContext(Eo),{matches:s}=N.useContext(is),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let h=Oa(),d;if(e){var p;let D=typeof e=="string"?uu(e):e;l==="/"||(p=D.pathname)!=null&&p.startsWith(l)||kt(!1),d=D}else d=h;let m=d.pathname||"/",w=m;if(l!=="/"){let D=l.replace(/^\//,"").split("/");w="/"+m.replace(/^\//,"").split("/").slice(D.length).join("/")}let E=KD(t,{pathname:w}),x=bO(E&&E.map(D=>Object.assign({},D,{params:Object.assign({},a,D.params),pathname:io([l,i.encodeLocation?i.encodeLocation(D.pathname).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?l:io([l,i.encodeLocation?i.encodeLocation(D.pathnameBase).pathname:D.pathnameBase])})),s,n,r);return e&&x?N.createElement(yp.Provider,{value:{location:Qc({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Gs.Pop}},x):x}function EO(){let t=PO(),e=fO(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),n?N.createElement("pre",{style:i},n):null,null)}const TO=N.createElement(EO,null);class IO extends N.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?N.createElement(is.Provider,{value:this.props.routeContext},N.createElement(KS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function SO(t){let{routeContext:e,match:n,children:r}=t,i=N.useContext(By);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),N.createElement(is.Provider,{value:e},r)}function bO(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let d=o.findIndex(p=>p.route.id&&(a==null?void 0:a[p.route.id])!==void 0);d>=0||kt(!1),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,h=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let p=o[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=d),p.route.id){let{loaderData:m,errors:w}=n,E=p.route.loader&&m[p.route.id]===void 0&&(!w||w[p.route.id]===void 0);if(p.route.lazy||E){l=!0,h>=0?o=o.slice(0,h+1):o=[o[0]];break}}}return o.reduceRight((d,p,m)=>{let w,E=!1,x=null,D=null;n&&(w=a&&p.route.id?a[p.route.id]:void 0,x=p.route.errorElement||TO,l&&(h<0&&m===0?(E=!0,D=null):h===m&&(E=!0,D=p.route.hydrateFallbackElement||null)));let A=e.concat(o.slice(0,m+1)),T=()=>{let S;return w?S=x:E?S=D:p.route.Component?S=N.createElement(p.route.Component,null):p.route.element?S=p.route.element:S=d,N.createElement(SO,{match:p,routeContext:{outlet:d,matches:A,isDataRoute:n!=null},children:S})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?N.createElement(IO,{location:n.location,revalidation:n.revalidation,component:x,error:w,children:T(),routeContext:{outlet:null,matches:A,isDataRoute:!0}}):T()},null)}var YS=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(YS||{}),Rf=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Rf||{});function CO(t){let e=N.useContext(By);return e||kt(!1),e}function AO(t){let e=N.useContext(gO);return e||kt(!1),e}function xO(t){let e=N.useContext(is);return e||kt(!1),e}function XS(t){let e=xO(),n=e.matches[e.matches.length-1];return n.route.id||kt(!1),n.route.id}function PO(){var t;let e=N.useContext(KS),n=AO(Rf.UseRouteError),r=XS(Rf.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function kO(){let{router:t}=CO(YS.UseNavigateStable),e=XS(Rf.UseNavigateStable),n=N.useRef(!1);return GS(()=>{n.current=!0}),N.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Qc({fromRouteId:e},s)))},[t,e])}const rE={};function RO(t,e){rE[e]||(rE[e]=!0,console.warn(e))}const iE=(t,e,n)=>RO(t," React Router Future Flag Warning: "+e+". "+("You can use the `"+t+"` future flag to opt-in early. ")+("For more information, see "+n+"."));function DO(t,e){t!=null&&t.v7_startTransition||iE("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),!(t!=null&&t.v7_relativeSplatPath)&&!e&&iE("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function JS(t){let{to:e,replace:n,state:r,relative:i}=t;cu()||kt(!1);let{future:s,static:o}=N.useContext(Eo),{matches:a}=N.useContext(is),{pathname:l}=Oa(),h=Na(),d=zy(e,$y(a,s.v7_relativeSplatPath),l,i==="path"),p=JSON.stringify(d);return N.useEffect(()=>h(JSON.parse(p),{replace:n,state:r,relative:i}),[h,p,i,n,r]),null}function Tn(t){kt(!1)}function OO(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Gs.Pop,navigator:s,static:o=!1,future:a}=t;cu()&&kt(!1);let l=e.replace(/^\/*/,"/"),h=N.useMemo(()=>({basename:l,navigator:s,static:o,future:Qc({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof r=="string"&&(r=uu(r));let{pathname:d="/",search:p="",hash:m="",state:w=null,key:E="default"}=r,x=N.useMemo(()=>{let D=Uy(d,l);return D==null?null:{location:{pathname:D,search:p,hash:m,state:w,key:E},navigationType:i}},[l,d,p,m,w,E,i]);return x==null?null:N.createElement(Eo.Provider,{value:h},N.createElement(yp.Provider,{children:n,value:x}))}function NO(t){let{children:e,location:n}=t;return _O(rv(e),n)}new Promise(()=>{});function rv(t,e){e===void 0&&(e=[]);let n=[];return N.Children.forEach(t,(r,i)=>{if(!N.isValidElement(r))return;let s=[...e,i];if(r.type===N.Fragment){n.push.apply(n,rv(r.props.children,s));return}r.type!==Tn&&kt(!1),!r.props.index||!r.props.children||kt(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=rv(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function iv(){return iv=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},iv.apply(this,arguments)}function LO(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function MO(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function VO(t,e){return t.button===0&&(!e||e==="_self")&&!MO(t)}const jO=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],FO="6";try{window.__reactRouterVersion=FO}catch{}const UO="startTransition",sE=Rk[UO];function $O(t){let{basename:e,children:n,future:r,window:i}=t,s=N.useRef();s.current==null&&(s.current=qD({window:i,v5Compat:!0}));let o=s.current,[a,l]=N.useState({action:o.action,location:o.location}),{v7_startTransition:h}=r||{},d=N.useCallback(p=>{h&&sE?sE(()=>l(p)):l(p)},[l,h]);return N.useLayoutEffect(()=>o.listen(d),[o,d]),N.useEffect(()=>DO(r),[r]),N.createElement(OO,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const zO=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",BO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,sr=N.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:h,preventScrollReset:d,viewTransition:p}=e,m=LO(e,jO),{basename:w}=N.useContext(Eo),E,x=!1;if(typeof h=="string"&&BO.test(h)&&(E=h,zO))try{let S=new URL(window.location.href),M=h.startsWith("//")?new URL(S.protocol+h):new URL(h),q=Uy(M.pathname,w);M.origin===S.origin&&q!=null?h=q+M.search+M.hash:x=!0}catch{}let D=mO(h,{relative:i}),A=qO(h,{replace:o,state:a,target:l,preventScrollReset:d,relative:i,viewTransition:p});function T(S){r&&r(S),S.defaultPrevented||A(S)}return N.createElement("a",iv({},m,{href:E||D,onClick:x||s?r:T,ref:n,target:l}))});var oE;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(oE||(oE={}));var aE;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(aE||(aE={}));function qO(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=Na(),h=Oa(),d=QS(t,{relative:o});return N.useCallback(p=>{if(VO(p,n)){p.preventDefault();let m=r!==void 0?r:kf(h)===kf(d);l(t,{replace:m,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[h,l,d,r,i,n,t,s,o,a])}var lE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZS=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},HO=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},eb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,h=l?t[i+2]:0,d=s>>2,p=(s&3)<<4|a>>4;let m=(a&15)<<2|h>>6,w=h&63;l||(w=64,o||(m=64)),r.push(n[d],n[p],n[m],n[w])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ZS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):HO(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const h=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||h==null||p==null)throw new WO;const m=s<<2|a>>4;if(r.push(m),h!==64){const w=a<<4&240|h>>2;if(r.push(w),p!==64){const E=h<<6&192|p;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class WO extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const KO=function(t){const e=ZS(t);return eb.encodeByteArray(e,!0)},tb=function(t){return KO(t).replace(/\./g,"")},nb=function(t){try{return eb.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GO(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QO=()=>GO().__FIREBASE_DEFAULTS__,YO=()=>{if(typeof process>"u"||typeof lE>"u")return;const t=lE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},XO=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&nb(t[1]);return e&&JSON.parse(e)},_p=()=>{try{return QO()||YO()||XO()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},JO=t=>{var e,n;return(n=(e=_p())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},rb=()=>{var t;return(t=_p())===null||t===void 0?void 0:t.config},ib=t=>{var e;return(e=_p())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function e2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ht())}function t2(){var t;const e=(t=_p())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function n2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function sb(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function r2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function i2(){const t=Ht();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function ob(){return!t2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function qy(){try{return typeof indexedDB=="object"}catch{return!1}}function ab(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}function s2(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o2="FirebaseError";class ni extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=o2,Object.setPrototypeOf(this,ni.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,La.prototype.create)}}class La{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?a2(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ni(i,a,r)}}function a2(t,e){return t.replace(l2,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const l2=/\{\$([^}]+)}/g;function u2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function va(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(uE(s)&&uE(o)){if(!va(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function uE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fh(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function rc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function ic(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function c2(t,e){const n=new h2(t,e);return n.subscribe.bind(n)}class h2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");d2(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Fg),i.error===void 0&&(i.error=Fg),i.complete===void 0&&(i.complete=Fg);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function d2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Fg(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2=1e3,p2=2,g2=4*60*60*1e3,m2=.5;function cE(t,e=f2,n=p2){const r=e*Math.pow(n,t),i=Math.round(m2*r*(Math.random()-.5)*2);return Math.min(g2,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mt(t){return t&&t._delegate?t._delegate:t}class ti{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new ZO;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(_2(e))try{this.getOrInitializeService({instanceIdentifier:Yo})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Yo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yo){return this.instances.has(e)}getOptions(e=Yo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:y2(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Yo){return this.component?this.component.multipleInstances?e:Yo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function y2(t){return t===Yo?void 0:t}function _2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new v2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Re;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Re||(Re={}));const E2={debug:Re.DEBUG,verbose:Re.VERBOSE,info:Re.INFO,warn:Re.WARN,error:Re.ERROR,silent:Re.SILENT},T2=Re.INFO,I2={[Re.DEBUG]:"log",[Re.VERBOSE]:"log",[Re.INFO]:"info",[Re.WARN]:"warn",[Re.ERROR]:"error"},S2=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=I2[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class wp{constructor(e){this.name=e,this._logLevel=T2,this._logHandler=S2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Re))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?E2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Re.DEBUG,...e),this._logHandler(this,Re.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Re.VERBOSE,...e),this._logHandler(this,Re.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Re.INFO,...e),this._logHandler(this,Re.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Re.WARN,...e),this._logHandler(this,Re.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Re.ERROR,...e),this._logHandler(this,Re.ERROR,...e)}}const b2=(t,e)=>e.some(n=>t instanceof n);let hE,dE;function C2(){return hE||(hE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function A2(){return dE||(dE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const lb=new WeakMap,sv=new WeakMap,ub=new WeakMap,Ug=new WeakMap,Hy=new WeakMap;function x2(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(so(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&lb.set(n,t)}).catch(()=>{}),Hy.set(e,t),e}function P2(t){if(sv.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});sv.set(t,e)}let ov={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return sv.get(t);if(e==="objectStoreNames")return t.objectStoreNames||ub.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return so(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function k2(t){ov=t(ov)}function R2(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call($g(this),e,...n);return ub.set(r,e.sort?e.sort():[e]),so(r)}:A2().includes(t)?function(...e){return t.apply($g(this),e),so(lb.get(this))}:function(...e){return so(t.apply($g(this),e))}}function D2(t){return typeof t=="function"?R2(t):(t instanceof IDBTransaction&&P2(t),b2(t,C2())?new Proxy(t,ov):t)}function so(t){if(t instanceof IDBRequest)return x2(t);if(Ug.has(t))return Ug.get(t);const e=D2(t);return e!==t&&(Ug.set(t,e),Hy.set(e,t)),e}const $g=t=>Hy.get(t);function cb(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=so(o);return r&&o.addEventListener("upgradeneeded",l=>{r(so(o.result),l.oldVersion,l.newVersion,so(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const O2=["get","getKey","getAll","getAllKeys","count"],N2=["put","add","delete","clear"],zg=new Map;function fE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(zg.get(e))return zg.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=N2.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||O2.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let h=l.store;return r&&(h=h.index(a.shift())),(await Promise.all([h[n](...a),i&&l.done]))[0]};return zg.set(e,s),s}k2(t=>({...t,get:(e,n,r)=>fE(e,n)||t.get(e,n,r),has:(e,n)=>!!fE(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(M2(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function M2(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const av="@firebase/app",pE="0.10.16";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ji=new wp("@firebase/app"),V2="@firebase/app-compat",j2="@firebase/analytics-compat",F2="@firebase/analytics",U2="@firebase/app-check-compat",$2="@firebase/app-check",z2="@firebase/auth",B2="@firebase/auth-compat",q2="@firebase/database",H2="@firebase/data-connect",W2="@firebase/database-compat",K2="@firebase/functions",G2="@firebase/functions-compat",Q2="@firebase/installations",Y2="@firebase/installations-compat",X2="@firebase/messaging",J2="@firebase/messaging-compat",Z2="@firebase/performance",eN="@firebase/performance-compat",tN="@firebase/remote-config",nN="@firebase/remote-config-compat",rN="@firebase/storage",iN="@firebase/storage-compat",sN="@firebase/firestore",oN="@firebase/vertexai",aN="@firebase/firestore-compat",lN="firebase",uN="11.0.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lv="[DEFAULT]",cN={[av]:"fire-core",[V2]:"fire-core-compat",[F2]:"fire-analytics",[j2]:"fire-analytics-compat",[$2]:"fire-app-check",[U2]:"fire-app-check-compat",[z2]:"fire-auth",[B2]:"fire-auth-compat",[q2]:"fire-rtdb",[H2]:"fire-data-connect",[W2]:"fire-rtdb-compat",[K2]:"fire-fn",[G2]:"fire-fn-compat",[Q2]:"fire-iid",[Y2]:"fire-iid-compat",[X2]:"fire-fcm",[J2]:"fire-fcm-compat",[Z2]:"fire-perf",[eN]:"fire-perf-compat",[tN]:"fire-rc",[nN]:"fire-rc-compat",[rN]:"fire-gcs",[iN]:"fire-gcs-compat",[sN]:"fire-fst",[aN]:"fire-fst-compat",[oN]:"fire-vertex","fire-js":"fire-js",[lN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Df=new Map,hN=new Map,uv=new Map;function gE(t,e){try{t.container.addComponent(e)}catch(n){Ji.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ii(t){const e=t.name;if(uv.has(e))return Ji.debug(`There were multiple attempts to register component ${e}.`),!1;uv.set(e,t);for(const n of Df.values())gE(n,t);for(const n of hN.values())gE(n,t);return!0}function Ma(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Qr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},oo=new La("app","Firebase",dN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ti("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw oo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu=uN;function hb(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:lv,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw oo.create("bad-app-name",{appName:String(i)});if(n||(n=rb()),!n)throw oo.create("no-options");const s=Df.get(i);if(s){if(va(n,s.options)&&va(r,s.config))return s;throw oo.create("duplicate-app",{appName:i})}const o=new w2(i);for(const l of uv.values())o.addComponent(l);const a=new fN(n,r,o);return Df.set(i,a),a}function db(t=lv){const e=Df.get(t);if(!e&&t===lv&&rb())return hb();if(!e)throw oo.create("no-app",{appName:t});return e}function Rr(t,e,n){var r;let i=(r=cN[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ji.warn(a.join(" "));return}Ii(new ti(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN="firebase-heartbeat-database",gN=1,Yc="firebase-heartbeat-store";let Bg=null;function fb(){return Bg||(Bg=cb(pN,gN,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Yc)}catch(n){console.warn(n)}}}}).catch(t=>{throw oo.create("idb-open",{originalErrorMessage:t.message})})),Bg}async function mN(t){try{const n=(await fb()).transaction(Yc),r=await n.objectStore(Yc).get(pb(t));return await n.done,r}catch(e){if(e instanceof ni)Ji.warn(e.message);else{const n=oo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ji.warn(n.message)}}}async function mE(t,e){try{const r=(await fb()).transaction(Yc,"readwrite");await r.objectStore(Yc).put(e,pb(t)),await r.done}catch(n){if(n instanceof ni)Ji.warn(n.message);else{const r=oo.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ji.warn(r.message)}}}function pb(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vN=1024,yN=30*24*60*60*1e3;class _N{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new EN(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=vE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=yN}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Ji.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=vE(),{heartbeatsToSend:r,unsentEntries:i}=wN(this._heartbeatsCache.heartbeats),s=tb(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Ji.warn(n),""}}}function vE(){return new Date().toISOString().substring(0,10)}function wN(t,e=vN){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),yE(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),yE(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class EN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return qy()?ab().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await mN(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return mE(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return mE(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function yE(t){return tb(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TN(t){Ii(new ti("platform-logger",e=>new L2(e),"PRIVATE")),Ii(new ti("heartbeat",e=>new _N(e),"PRIVATE")),Rr(av,pE,t),Rr(av,pE,"esm2017"),Rr("fire-js","")}TN("");function Wy(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function gb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const IN=gb,mb=new La("auth","Firebase",gb());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Of=new wp("@firebase/auth");function SN(t,...e){Of.logLevel<=Re.WARN&&Of.warn(`Auth (${hu}): ${t}`,...e)}function $d(t,...e){Of.logLevel<=Re.ERROR&&Of.error(`Auth (${hu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lr(t,...e){throw Gy(t,...e)}function Jr(t,...e){return Gy(t,...e)}function Ky(t,e,n){const r=Object.assign(Object.assign({},IN()),{[e]:n});return new La("auth","Firebase",r).create(e,{appName:t.name})}function Wi(t){return Ky(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function bN(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Lr(t,"argument-error"),Ky(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Gy(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return mb.create(t,...e)}function fe(t,e,...n){if(!t)throw Gy(e,...n)}function $i(t){const e="INTERNAL ASSERTION FAILED: "+t;throw $d(e),new Error(e)}function Zi(t,e){t||$i(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function CN(){return _E()==="http:"||_E()==="https:"}function _E(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(CN()||sb()||"connection"in navigator)?navigator.onLine:!0}function xN(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(e,n){this.shortDelay=e,this.longDelay=n,Zi(n>e,"Short delay should be less than long delay!"),this.isMobile=e2()||r2()}get(){return AN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qy(t,e){Zi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vb{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$i("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$i("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$i("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kN=new ph(3e4,6e4);function To(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ss(t,e,n,r,i={}){return yb(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=fh(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const h=Object.assign({method:e,headers:l},s);return n2()||(h.referrerPolicy="no-referrer"),vb.fetch()(_b(t,t.config.apiHost,n,a),h)})}async function yb(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},PN),e);try{const i=new DN(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw vd(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,h]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw vd(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw vd(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw vd(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Ky(t,d,h);Lr(t,d)}}catch(i){if(i instanceof ni)throw i;Lr(t,"network-request-failed",{message:String(i)})}}async function gh(t,e,n,r,i={}){const s=await ss(t,e,n,r,i);return"mfaPendingCredential"in s&&Lr(t,"multi-factor-auth-required",{_serverResponse:s}),s}function _b(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?Qy(t.config,i):`${t.config.apiScheme}://${i}`}function RN(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class DN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Jr(this.auth,"network-request-failed")),kN.get())})}}function vd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Jr(t,e,r);return i.customData._tokenResponse=n,i}function wE(t){return t!==void 0&&t.enterprise!==void 0}class ON{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return RN(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function NN(t,e){return ss(t,"GET","/v2/recaptchaConfig",To(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LN(t,e){return ss(t,"POST","/v1/accounts:delete",e)}async function wb(t,e){return ss(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ec(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function MN(t,e=!1){const n=Mt(t),r=await n.getIdToken(e),i=Yy(r);fe(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Ec(qg(i.auth_time)),issuedAtTime:Ec(qg(i.iat)),expirationTime:Ec(qg(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function qg(t){return Number(t)*1e3}function Yy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return $d("JWT malformed, contained fewer than 3 sections"),null;try{const i=nb(n);return i?JSON.parse(i):($d("Failed to decode base64 JWT payload"),null)}catch(i){return $d("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function EE(t){const e=Yy(t);return fe(e,"internal-error"),fe(typeof e.exp<"u","internal-error"),fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ql(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ni&&VN(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function VN({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ec(this.lastLoginAt),this.creationTime=Ec(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nf(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Ql(t,wb(n,{idToken:r}));fe(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Eb(s.providerUserInfo):[],a=UN(t.providerData,o),l=t.isAnonymous,h=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),d=l?h:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new hv(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,p)}async function FN(t){const e=Mt(t);await Nf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function UN(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Eb(t){return t.map(e=>{var{providerId:n}=e,r=Wy(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $N(t,e){const n=await yb(t,{},async()=>{const r=fh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=_b(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",vb.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function zN(t,e){return ss(t,"POST","/v2/accounts:revokeToken",To(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){fe(e.idToken,"internal-error"),fe(typeof e.idToken<"u","internal-error"),fe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):EE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){fe(e.length!==0,"internal-error");const n=EE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await $N(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new jl;return r&&(fe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(fe(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(fe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jl,this.toJSON())}_performRefresh(){return $i("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(t,e){fe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class zi{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=Wy(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new jN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new hv(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Ql(this,this.stsTokenManager.getToken(this.auth,e));return fe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return MN(this,e)}reload(){return FN(this)}_assign(e){this!==e&&(fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new zi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Nf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qr(this.auth.app))return Promise.reject(Wi(this.auth));const e=await this.getIdToken();return await Ql(this,LN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,l,h,d;const p=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(i=n.email)!==null&&i!==void 0?i:void 0,w=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=n.photoURL)!==null&&o!==void 0?o:void 0,x=(a=n.tenantId)!==null&&a!==void 0?a:void 0,D=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,A=(h=n.createdAt)!==null&&h!==void 0?h:void 0,T=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:S,emailVerified:M,isAnonymous:q,providerData:W,stsTokenManager:P}=n;fe(S&&P,e,"internal-error");const C=jl.fromJSON(this.name,P);fe(typeof S=="string",e,"internal-error"),ks(p,e.name),ks(m,e.name),fe(typeof M=="boolean",e,"internal-error"),fe(typeof q=="boolean",e,"internal-error"),ks(w,e.name),ks(E,e.name),ks(x,e.name),ks(D,e.name),ks(A,e.name),ks(T,e.name);const R=new zi({uid:S,auth:e,email:m,emailVerified:M,displayName:p,isAnonymous:q,photoURL:E,phoneNumber:w,tenantId:x,stsTokenManager:C,createdAt:A,lastLoginAt:T});return W&&Array.isArray(W)&&(R.providerData=W.map(O=>Object.assign({},O))),D&&(R._redirectEventId=D),R}static async _fromIdTokenResponse(e,n,r=!1){const i=new jl;i.updateFromServerResponse(n);const s=new zi({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Nf(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];fe(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?Eb(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new jl;a.updateFromIdToken(r);const l=new zi({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new hv(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,h),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TE=new Map;function Bi(t){Zi(t instanceof Function,"Expected a class definition");let e=TE.get(t);return e?(Zi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,TE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Tb.type="NONE";const IE=Tb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zd(t,e,n){return`firebase:${t}:${e}:${n}`}class Fl{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=zd(this.userKey,i.apiKey,s),this.fullPersistenceKey=zd("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?zi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Fl(Bi(IE),e,r);const i=(await Promise.all(n.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=i[0]||Bi(IE);const o=zd(r,e.config.apiKey,e.name);let a=null;for(const h of n)try{const d=await h._get(o);if(d){const p=zi._fromJSON(e,d);h!==s&&(a=p),s=h;break}}catch{}const l=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Fl(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Fl(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Cb(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ib(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(xb(e))return"Blackberry";if(Pb(e))return"Webos";if(Sb(e))return"Safari";if((e.includes("chrome/")||bb(e))&&!e.includes("edge/"))return"Chrome";if(Ab(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Ib(t=Ht()){return/firefox\//i.test(t)}function Sb(t=Ht()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function bb(t=Ht()){return/crios\//i.test(t)}function Cb(t=Ht()){return/iemobile/i.test(t)}function Ab(t=Ht()){return/android/i.test(t)}function xb(t=Ht()){return/blackberry/i.test(t)}function Pb(t=Ht()){return/webos/i.test(t)}function Xy(t=Ht()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function BN(t=Ht()){var e;return Xy(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function qN(){return i2()&&document.documentMode===10}function kb(t=Ht()){return Xy(t)||Ab(t)||Pb(t)||xb(t)||/windows phone/i.test(t)||Cb(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rb(t,e=[]){let n;switch(t){case"Browser":n=SE(Ht());break;case"Worker":n=`${SE(Ht())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${hu}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WN(t,e={}){return ss(t,"GET","/v2/passwordPolicy",To(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KN=6;class GN{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:KN,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new bE(this),this.idTokenSubscription=new bE(this),this.beforeStateQueue=new HN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Bi(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Fl.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await wb(this,{idToken:e}),r=await zi._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Qr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Nf(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=xN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qr(this.app))return Promise.reject(Wi(this));const n=e?Mt(e):null;return n&&fe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qr(this.app)?Promise.reject(Wi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qr(this.app)?Promise.reject(Wi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Bi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await WN(this),n=new GN(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new La("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await zN(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Bi(e)||this._popupRedirectResolver;fe(n,this,"argument-error"),this.redirectPersistenceManager=await Fl.create(this,[Bi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(fe(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Rb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&SN(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Io(t){return Mt(t)}class bE{constructor(e){this.auth=e,this.observer=null,this.addObserver=c2(n=>this.observer=n)}get next(){return fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ep={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function YN(t){Ep=t}function Db(t){return Ep.loadJS(t)}function XN(){return Ep.recaptchaEnterpriseScript}function JN(){return Ep.gapiScript}function ZN(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class eL{constructor(){this.enterprise=new tL}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class tL{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const nL="recaptcha-enterprise",Ob="NO_RECAPTCHA";class rL{constructor(e){this.type=nL,this.auth=Io(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{NN(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const h=new ON(l);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,o(h.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;wE(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(h=>{o(h)}).catch(()=>{o(Ob)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new eL().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&wE(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=XN();l.length!==0&&(l+=a),Db(l).then(()=>{i(a,s,o)}).catch(h=>{o(h)})}}).catch(a=>{o(a)})})}}async function CE(t,e,n,r=!1,i=!1){const s=new rL(t);let o;if(i)o=Ob;else try{o=await s.verify(n)}catch{o=await s.verify(n,!0)}const a=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,h=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function dv(t,e,n,r,i){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await CE(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await CE(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iL(t,e){const n=Ma(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(va(s,e??{}))return i;Lr(i,"already-initialized")}return n.initialize({options:e})}function sL(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Bi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function oL(t,e,n){const r=Io(t);fe(r._canInitEmulator,r,"emulator-config-failed"),fe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=Nb(e),{host:o,port:a}=aL(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),lL()}function Nb(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function aL(t){const e=Nb(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:AE(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:AE(o)}}}function AE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function lL(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return $i("not implemented")}_getIdTokenResponse(e){return $i("not implemented")}_linkToIdToken(e,n){return $i("not implemented")}_getReauthenticationResolver(e){return $i("not implemented")}}async function uL(t,e){return ss(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cL(t,e){return gh(t,"POST","/v1/accounts:signInWithPassword",To(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hL(t,e){return gh(t,"POST","/v1/accounts:signInWithEmailLink",To(t,e))}async function dL(t,e){return gh(t,"POST","/v1/accounts:signInWithEmailLink",To(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc extends Jy{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Xc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Xc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dv(e,n,"signInWithPassword",cL);case"emailLink":return hL(e,{email:this._email,oobCode:this._password});default:Lr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dv(e,r,"signUpPassword",uL);case"emailLink":return dL(e,{idToken:n,email:this._email,oobCode:this._password});default:Lr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ul(t,e){return gh(t,"POST","/v1/accounts:signInWithIdp",To(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fL="http://localhost";class ya extends Jy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ya(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Lr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=Wy(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new ya(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ul(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ul(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ul(e,n)}buildRequest(){const e={requestUri:fL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=fh(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pL(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function gL(t){const e=rc(ic(t)).link,n=e?rc(ic(e)).deep_link_id:null,r=rc(ic(t)).deep_link_id;return(r?rc(ic(r)).link:null)||r||n||e||t}class Zy{constructor(e){var n,r,i,s,o,a;const l=rc(ic(e)),h=(n=l.apiKey)!==null&&n!==void 0?n:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,p=pL((i=l.mode)!==null&&i!==void 0?i:null);fe(h&&d&&p,"argument-error"),this.apiKey=h,this.operation=p,this.code=d,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=gL(e);try{return new Zy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(){this.providerId=du.PROVIDER_ID}static credential(e,n){return Xc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Zy.parseLink(n);return fe(r,"argument-error"),Xc._fromEmailAndCode(e,r.code,r.tenantId)}}du.PROVIDER_ID="password";du.EMAIL_PASSWORD_SIGN_IN_METHOD="password";du.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh extends e_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s extends mh{constructor(){super("facebook.com")}static credential(e){return ya._fromParams({providerId:$s.PROVIDER_ID,signInMethod:$s.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $s.credentialFromTaggedObject(e)}static credentialFromError(e){return $s.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $s.credential(e.oauthAccessToken)}catch{return null}}}$s.FACEBOOK_SIGN_IN_METHOD="facebook.com";$s.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi extends mh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ya._fromParams({providerId:vi.PROVIDER_ID,signInMethod:vi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return vi.credentialFromTaggedObject(e)}static credentialFromError(e){return vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return vi.credential(n,r)}catch{return null}}}vi.GOOGLE_SIGN_IN_METHOD="google.com";vi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs extends mh{constructor(){super("github.com")}static credential(e){return ya._fromParams({providerId:zs.PROVIDER_ID,signInMethod:zs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zs.credentialFromTaggedObject(e)}static credentialFromError(e){return zs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zs.credential(e.oauthAccessToken)}catch{return null}}}zs.GITHUB_SIGN_IN_METHOD="github.com";zs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs extends mh{constructor(){super("twitter.com")}static credential(e,n){return ya._fromParams({providerId:Bs.PROVIDER_ID,signInMethod:Bs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Bs.credentialFromTaggedObject(e)}static credentialFromError(e){return Bs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Bs.credential(n,r)}catch{return null}}}Bs.TWITTER_SIGN_IN_METHOD="twitter.com";Bs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mL(t,e){return gh(t,"POST","/v1/accounts:signUp",To(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await zi._fromIdTokenResponse(e,r,i),o=xE(r);return new _a({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=xE(r);return new _a({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function xE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf extends ni{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Lf.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Lf(e,n,r,i)}}function Lb(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Lf._fromErrorAndOperation(t,s,e,r):s})}async function vL(t,e,n=!1){const r=await Ql(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return _a._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yL(t,e,n=!1){const{auth:r}=t;if(Qr(r.app))return Promise.reject(Wi(r));const i="reauthenticate";try{const s=await Ql(t,Lb(r,i,e,t),n);fe(s.idToken,r,"internal-error");const o=Yy(s.idToken);fe(o,r,"internal-error");const{sub:a}=o;return fe(t.uid===a,r,"user-mismatch"),_a._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Lr(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mb(t,e,n=!1){if(Qr(t.app))return Promise.reject(Wi(t));const r="signIn",i=await Lb(t,r,e),s=await _a._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function _L(t,e){return Mb(Io(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vb(t){const e=Io(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function wL(t,e,n){if(Qr(t.app))return Promise.reject(Wi(t));const r=Io(t),o=await dv(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",mL).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&Vb(t),l}),a=await _a._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function EL(t,e,n){return Qr(t.app)?Promise.reject(Wi(t)):_L(Mt(t),du.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Vb(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TL(t,e){return ss(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jb(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Mt(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Ql(r,TL(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function IL(t,e,n,r){return Mt(t).onIdTokenChanged(e,n,r)}function SL(t,e,n){return Mt(t).beforeAuthStateChanged(e,n)}function Fb(t,e,n,r){return Mt(t).onAuthStateChanged(e,n,r)}function Ub(t){return Mt(t).signOut()}const Mf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Mf,"1"),this.storage.removeItem(Mf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bL=1e3,CL=10;class zb extends $b{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);qN()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,CL):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},bL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}zb.type="LOCAL";const AL=zb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb extends $b{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Bb.type="SESSION";const qb=Bb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xL(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Tp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async h=>h(n.origin,s)),l=await xL(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Tp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t_(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const h=t_("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===h)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(){return window}function kL(t){Ti().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hb(){return typeof Ti().WorkerGlobalScope<"u"&&typeof Ti().importScripts=="function"}async function RL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function DL(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function OL(){return Hb()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb="firebaseLocalStorageDb",NL=1,Vf="firebaseLocalStorage",Kb="fbase_key";class vh{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Ip(t,e){return t.transaction([Vf],e?"readwrite":"readonly").objectStore(Vf)}function LL(){const t=indexedDB.deleteDatabase(Wb);return new vh(t).toPromise()}function fv(){const t=indexedDB.open(Wb,NL);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Vf,{keyPath:Kb})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Vf)?e(r):(r.close(),await LL(),e(await fv()))})})}async function PE(t,e,n){const r=Ip(t,!0).put({[Kb]:e,value:n});return new vh(r).toPromise()}async function ML(t,e){const n=Ip(t,!1).get(e),r=await new vh(n).toPromise();return r===void 0?null:r.value}function kE(t,e){const n=Ip(t,!0).delete(e);return new vh(n).toPromise()}const VL=800,jL=3;class Gb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fv(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>jL)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Hb()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Tp._getInstance(OL()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await RL(),!this.activeServiceWorker)return;this.sender=new PL(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||DL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fv();return await PE(e,Mf,"1"),await kE(e,Mf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>PE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>ML(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>kE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Ip(i,!1).getAll();return new vh(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),VL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Gb.type="LOCAL";const FL=Gb;new ph(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qb(t,e){return e?Bi(e):(fe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_ extends Jy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ul(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ul(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ul(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function UL(t){return Mb(t.auth,new n_(t),t.bypassAuthState)}function $L(t){const{auth:e,user:n}=t;return fe(n,e,"internal-error"),yL(n,new n_(t),t.bypassAuthState)}async function zL(t){const{auth:e,user:n}=t;return fe(n,e,"internal-error"),vL(n,new n_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return UL;case"linkViaPopup":case"linkViaRedirect":return zL;case"reauthViaPopup":case"reauthViaRedirect":return $L;default:Lr(this.auth,"internal-error")}}resolve(e){Zi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BL=new ph(2e3,1e4);async function Xb(t,e,n){if(Qr(t.app))return Promise.reject(Jr(t,"operation-not-supported-in-this-environment"));const r=Io(t);bN(t,e,e_);const i=Qb(r,n);return new sa(r,"signInViaPopup",e,i).executeNotNull()}class sa extends Yb{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,sa.currentPopupAction&&sa.currentPopupAction.cancel(),sa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return fe(e,this.auth,"internal-error"),e}async onExecution(){Zi(this.filter.length===1,"Popup operations only handle one event");const e=t_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Jr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Jr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,sa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Jr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,BL.get())};e()}}sa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL="pendingRedirect",Bd=new Map;class HL extends Yb{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Bd.get(this.auth._key());if(!e){try{const r=await WL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Bd.set(this.auth._key(),e)}return this.bypassAuthState||Bd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function WL(t,e){const n=QL(e),r=GL(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function KL(t,e){Bd.set(t._key(),e)}function GL(t){return Bi(t._redirectPersistence)}function QL(t){return zd(qL,t.config.apiKey,t.name)}async function YL(t,e,n=!1){if(Qr(t.app))return Promise.reject(Wi(t));const r=Io(t),i=Qb(r,e),o=await new HL(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL=10*60*1e3;class JL{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!ZL(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Jb(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Jr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=XL&&this.cachedEventUids.clear(),this.cachedEventUids.has(RE(e))}saveEventToCache(e){this.cachedEventUids.add(RE(e)),this.lastProcessedEventTime=Date.now()}}function RE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Jb({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function ZL(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Jb(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eM(t,e={}){return ss(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,nM=/^https?/;async function rM(t){if(t.config.emulator)return;const{authorizedDomains:e}=await eM(t);for(const n of e)try{if(iM(n))return}catch{}Lr(t,"unauthorized-domain")}function iM(t){const e=cv(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!nM.test(n))return!1;if(tM.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sM=new ph(3e4,6e4);function DE(){const t=Ti().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function oM(t){return new Promise((e,n)=>{var r,i,s;function o(){DE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{DE(),n(Jr(t,"network-request-failed"))},timeout:sM.get()})}if(!((i=(r=Ti().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Ti().gapi)===null||s===void 0)&&s.load)o();else{const a=ZN("iframefcb");return Ti()[a]=()=>{gapi.load?o():n(Jr(t,"network-request-failed"))},Db(`${JN()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw qd=null,e})}let qd=null;function aM(t){return qd=qd||oM(t),qd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lM=new ph(5e3,15e3),uM="__/auth/iframe",cM="emulator/auth/iframe",hM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},dM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function fM(t){const e=t.config;fe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Qy(e,cM):`https://${t.config.authDomain}/${uM}`,r={apiKey:e.apiKey,appName:t.name,v:hu},i=dM.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${fh(r).slice(1)}`}async function pM(t){const e=await aM(t),n=Ti().gapi;return fe(n,t,"internal-error"),e.open({where:document.body,url:fM(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:hM,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Jr(t,"network-request-failed"),a=Ti().setTimeout(()=>{s(o)},lM.get());function l(){Ti().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},mM=500,vM=600,yM="_blank",_M="http://localhost";class OE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function wM(t,e,n,r=mM,i=vM){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},gM),{width:r.toString(),height:i.toString(),top:s,left:o}),h=Ht().toLowerCase();n&&(a=bb(h)?yM:n),Ib(h)&&(e=e||_M,l.scrollbars="yes");const d=Object.entries(l).reduce((m,[w,E])=>`${m}${w}=${E},`,"");if(BN(h)&&a!=="_self")return EM(e||"",a),new OE(null);const p=window.open(e||"",a,d);fe(p,t,"popup-blocked");try{p.focus()}catch{}return new OE(p)}function EM(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TM="__/auth/handler",IM="emulator/auth/handler",SM=encodeURIComponent("fac");async function NE(t,e,n,r,i,s){fe(t.config.authDomain,t,"auth-domain-config-required"),fe(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:hu,eventId:i};if(e instanceof e_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",u2(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,p]of Object.entries({}))o[d]=p}if(e instanceof mh){const d=e.getScopes().filter(p=>p!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),h=l?`#${SM}=${encodeURIComponent(l)}`:"";return`${bM(t)}?${fh(a).slice(1)}${h}`}function bM({config:t}){return t.emulator?Qy(t,IM):`https://${t.authDomain}/${TM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg="webStorageSupport";class CM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qb,this._completeRedirectFn=YL,this._overrideRedirectResult=KL}async _openPopup(e,n,r,i){var s;Zi((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await NE(e,n,r,cv(),i);return wM(e,o,t_())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await NE(e,n,r,cv(),i);return kL(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Zi(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await pM(e),r=new JL(e);return n.register("authEvent",i=>(fe(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Hg,{type:Hg},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Hg];o!==void 0&&n(!!o),Lr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=rM(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return kb()||Sb()||Xy()}}const AM=CM;var LE="@firebase/auth",ME="1.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PM(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function kM(t){Ii(new ti("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;fe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Rb(t)},h=new QN(r,i,s,l);return sL(h,n),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ii(new ti("auth-internal",e=>{const n=Io(e.getProvider("auth").getImmediate());return(r=>new xM(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Rr(LE,ME,PM(t)),Rr(LE,ME,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RM=5*60,DM=ib("authIdTokenMaxAge")||RM;let VE=null;const OM=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>DM)return;const i=n==null?void 0:n.token;VE!==i&&(VE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function NM(t=db()){const e=Ma(t,"auth");if(e.isInitialized())return e.getImmediate();const n=iL(t,{popupRedirectResolver:AM,persistence:[FL,AL,qb]}),r=ib("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=OM(s.toString());SL(n,o,()=>o(n.currentUser)),IL(n,a=>o(a))}}const i=JO("auth");return i&&oL(n,`http://${i}`),n}function LM(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}YN({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Jr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",LM().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});kM("Browser");var MM="firebase",VM="11.0.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rr(MM,VM,"app");var jE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ua,Zb;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(P,C){function R(){}R.prototype=C.prototype,P.D=C.prototype,P.prototype=new R,P.prototype.constructor=P,P.C=function(O,L,V){for(var k=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)k[ve-2]=arguments[ve];return C.prototype[L].apply(O,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(P,C,R){R||(R=0);var O=Array(16);if(typeof C=="string")for(var L=0;16>L;++L)O[L]=C.charCodeAt(R++)|C.charCodeAt(R++)<<8|C.charCodeAt(R++)<<16|C.charCodeAt(R++)<<24;else for(L=0;16>L;++L)O[L]=C[R++]|C[R++]<<8|C[R++]<<16|C[R++]<<24;C=P.g[0],R=P.g[1],L=P.g[2];var V=P.g[3],k=C+(V^R&(L^V))+O[0]+3614090360&4294967295;C=R+(k<<7&4294967295|k>>>25),k=V+(L^C&(R^L))+O[1]+3905402710&4294967295,V=C+(k<<12&4294967295|k>>>20),k=L+(R^V&(C^R))+O[2]+606105819&4294967295,L=V+(k<<17&4294967295|k>>>15),k=R+(C^L&(V^C))+O[3]+3250441966&4294967295,R=L+(k<<22&4294967295|k>>>10),k=C+(V^R&(L^V))+O[4]+4118548399&4294967295,C=R+(k<<7&4294967295|k>>>25),k=V+(L^C&(R^L))+O[5]+1200080426&4294967295,V=C+(k<<12&4294967295|k>>>20),k=L+(R^V&(C^R))+O[6]+2821735955&4294967295,L=V+(k<<17&4294967295|k>>>15),k=R+(C^L&(V^C))+O[7]+4249261313&4294967295,R=L+(k<<22&4294967295|k>>>10),k=C+(V^R&(L^V))+O[8]+1770035416&4294967295,C=R+(k<<7&4294967295|k>>>25),k=V+(L^C&(R^L))+O[9]+2336552879&4294967295,V=C+(k<<12&4294967295|k>>>20),k=L+(R^V&(C^R))+O[10]+4294925233&4294967295,L=V+(k<<17&4294967295|k>>>15),k=R+(C^L&(V^C))+O[11]+2304563134&4294967295,R=L+(k<<22&4294967295|k>>>10),k=C+(V^R&(L^V))+O[12]+1804603682&4294967295,C=R+(k<<7&4294967295|k>>>25),k=V+(L^C&(R^L))+O[13]+4254626195&4294967295,V=C+(k<<12&4294967295|k>>>20),k=L+(R^V&(C^R))+O[14]+2792965006&4294967295,L=V+(k<<17&4294967295|k>>>15),k=R+(C^L&(V^C))+O[15]+1236535329&4294967295,R=L+(k<<22&4294967295|k>>>10),k=C+(L^V&(R^L))+O[1]+4129170786&4294967295,C=R+(k<<5&4294967295|k>>>27),k=V+(R^L&(C^R))+O[6]+3225465664&4294967295,V=C+(k<<9&4294967295|k>>>23),k=L+(C^R&(V^C))+O[11]+643717713&4294967295,L=V+(k<<14&4294967295|k>>>18),k=R+(V^C&(L^V))+O[0]+3921069994&4294967295,R=L+(k<<20&4294967295|k>>>12),k=C+(L^V&(R^L))+O[5]+3593408605&4294967295,C=R+(k<<5&4294967295|k>>>27),k=V+(R^L&(C^R))+O[10]+38016083&4294967295,V=C+(k<<9&4294967295|k>>>23),k=L+(C^R&(V^C))+O[15]+3634488961&4294967295,L=V+(k<<14&4294967295|k>>>18),k=R+(V^C&(L^V))+O[4]+3889429448&4294967295,R=L+(k<<20&4294967295|k>>>12),k=C+(L^V&(R^L))+O[9]+568446438&4294967295,C=R+(k<<5&4294967295|k>>>27),k=V+(R^L&(C^R))+O[14]+3275163606&4294967295,V=C+(k<<9&4294967295|k>>>23),k=L+(C^R&(V^C))+O[3]+4107603335&4294967295,L=V+(k<<14&4294967295|k>>>18),k=R+(V^C&(L^V))+O[8]+1163531501&4294967295,R=L+(k<<20&4294967295|k>>>12),k=C+(L^V&(R^L))+O[13]+2850285829&4294967295,C=R+(k<<5&4294967295|k>>>27),k=V+(R^L&(C^R))+O[2]+4243563512&4294967295,V=C+(k<<9&4294967295|k>>>23),k=L+(C^R&(V^C))+O[7]+1735328473&4294967295,L=V+(k<<14&4294967295|k>>>18),k=R+(V^C&(L^V))+O[12]+2368359562&4294967295,R=L+(k<<20&4294967295|k>>>12),k=C+(R^L^V)+O[5]+4294588738&4294967295,C=R+(k<<4&4294967295|k>>>28),k=V+(C^R^L)+O[8]+2272392833&4294967295,V=C+(k<<11&4294967295|k>>>21),k=L+(V^C^R)+O[11]+1839030562&4294967295,L=V+(k<<16&4294967295|k>>>16),k=R+(L^V^C)+O[14]+4259657740&4294967295,R=L+(k<<23&4294967295|k>>>9),k=C+(R^L^V)+O[1]+2763975236&4294967295,C=R+(k<<4&4294967295|k>>>28),k=V+(C^R^L)+O[4]+1272893353&4294967295,V=C+(k<<11&4294967295|k>>>21),k=L+(V^C^R)+O[7]+4139469664&4294967295,L=V+(k<<16&4294967295|k>>>16),k=R+(L^V^C)+O[10]+3200236656&4294967295,R=L+(k<<23&4294967295|k>>>9),k=C+(R^L^V)+O[13]+681279174&4294967295,C=R+(k<<4&4294967295|k>>>28),k=V+(C^R^L)+O[0]+3936430074&4294967295,V=C+(k<<11&4294967295|k>>>21),k=L+(V^C^R)+O[3]+3572445317&4294967295,L=V+(k<<16&4294967295|k>>>16),k=R+(L^V^C)+O[6]+76029189&4294967295,R=L+(k<<23&4294967295|k>>>9),k=C+(R^L^V)+O[9]+3654602809&4294967295,C=R+(k<<4&4294967295|k>>>28),k=V+(C^R^L)+O[12]+3873151461&4294967295,V=C+(k<<11&4294967295|k>>>21),k=L+(V^C^R)+O[15]+530742520&4294967295,L=V+(k<<16&4294967295|k>>>16),k=R+(L^V^C)+O[2]+3299628645&4294967295,R=L+(k<<23&4294967295|k>>>9),k=C+(L^(R|~V))+O[0]+4096336452&4294967295,C=R+(k<<6&4294967295|k>>>26),k=V+(R^(C|~L))+O[7]+1126891415&4294967295,V=C+(k<<10&4294967295|k>>>22),k=L+(C^(V|~R))+O[14]+2878612391&4294967295,L=V+(k<<15&4294967295|k>>>17),k=R+(V^(L|~C))+O[5]+4237533241&4294967295,R=L+(k<<21&4294967295|k>>>11),k=C+(L^(R|~V))+O[12]+1700485571&4294967295,C=R+(k<<6&4294967295|k>>>26),k=V+(R^(C|~L))+O[3]+2399980690&4294967295,V=C+(k<<10&4294967295|k>>>22),k=L+(C^(V|~R))+O[10]+4293915773&4294967295,L=V+(k<<15&4294967295|k>>>17),k=R+(V^(L|~C))+O[1]+2240044497&4294967295,R=L+(k<<21&4294967295|k>>>11),k=C+(L^(R|~V))+O[8]+1873313359&4294967295,C=R+(k<<6&4294967295|k>>>26),k=V+(R^(C|~L))+O[15]+4264355552&4294967295,V=C+(k<<10&4294967295|k>>>22),k=L+(C^(V|~R))+O[6]+2734768916&4294967295,L=V+(k<<15&4294967295|k>>>17),k=R+(V^(L|~C))+O[13]+1309151649&4294967295,R=L+(k<<21&4294967295|k>>>11),k=C+(L^(R|~V))+O[4]+4149444226&4294967295,C=R+(k<<6&4294967295|k>>>26),k=V+(R^(C|~L))+O[11]+3174756917&4294967295,V=C+(k<<10&4294967295|k>>>22),k=L+(C^(V|~R))+O[2]+718787259&4294967295,L=V+(k<<15&4294967295|k>>>17),k=R+(V^(L|~C))+O[9]+3951481745&4294967295,P.g[0]=P.g[0]+C&4294967295,P.g[1]=P.g[1]+(L+(k<<21&4294967295|k>>>11))&4294967295,P.g[2]=P.g[2]+L&4294967295,P.g[3]=P.g[3]+V&4294967295}r.prototype.u=function(P,C){C===void 0&&(C=P.length);for(var R=C-this.blockSize,O=this.B,L=this.h,V=0;V<C;){if(L==0)for(;V<=R;)i(this,P,V),V+=this.blockSize;if(typeof P=="string"){for(;V<C;)if(O[L++]=P.charCodeAt(V++),L==this.blockSize){i(this,O),L=0;break}}else for(;V<C;)if(O[L++]=P[V++],L==this.blockSize){i(this,O),L=0;break}}this.h=L,this.o+=C},r.prototype.v=function(){var P=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);P[0]=128;for(var C=1;C<P.length-8;++C)P[C]=0;var R=8*this.o;for(C=P.length-8;C<P.length;++C)P[C]=R&255,R/=256;for(this.u(P),P=Array(16),C=R=0;4>C;++C)for(var O=0;32>O;O+=8)P[R++]=this.g[C]>>>O&255;return P};function s(P,C){var R=a;return Object.prototype.hasOwnProperty.call(R,P)?R[P]:R[P]=C(P)}function o(P,C){this.h=C;for(var R=[],O=!0,L=P.length-1;0<=L;L--){var V=P[L]|0;O&&V==C||(R[L]=V,O=!1)}this.g=R}var a={};function l(P){return-128<=P&&128>P?s(P,function(C){return new o([C|0],0>C?-1:0)}):new o([P|0],0>P?-1:0)}function h(P){if(isNaN(P)||!isFinite(P))return p;if(0>P)return D(h(-P));for(var C=[],R=1,O=0;P>=R;O++)C[O]=P/R|0,R*=4294967296;return new o(C,0)}function d(P,C){if(P.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(P.charAt(0)=="-")return D(d(P.substring(1),C));if(0<=P.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=h(Math.pow(C,8)),O=p,L=0;L<P.length;L+=8){var V=Math.min(8,P.length-L),k=parseInt(P.substring(L,L+V),C);8>V?(V=h(Math.pow(C,V)),O=O.j(V).add(h(k))):(O=O.j(R),O=O.add(h(k)))}return O}var p=l(0),m=l(1),w=l(16777216);t=o.prototype,t.m=function(){if(x(this))return-D(this).m();for(var P=0,C=1,R=0;R<this.g.length;R++){var O=this.i(R);P+=(0<=O?O:4294967296+O)*C,C*=4294967296}return P},t.toString=function(P){if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(E(this))return"0";if(x(this))return"-"+D(this).toString(P);for(var C=h(Math.pow(P,6)),R=this,O="";;){var L=M(R,C).g;R=A(R,L.j(C));var V=((0<R.g.length?R.g[0]:R.h)>>>0).toString(P);if(R=L,E(R))return V+O;for(;6>V.length;)V="0"+V;O=V+O}},t.i=function(P){return 0>P?0:P<this.g.length?this.g[P]:this.h};function E(P){if(P.h!=0)return!1;for(var C=0;C<P.g.length;C++)if(P.g[C]!=0)return!1;return!0}function x(P){return P.h==-1}t.l=function(P){return P=A(this,P),x(P)?-1:E(P)?0:1};function D(P){for(var C=P.g.length,R=[],O=0;O<C;O++)R[O]=~P.g[O];return new o(R,~P.h).add(m)}t.abs=function(){return x(this)?D(this):this},t.add=function(P){for(var C=Math.max(this.g.length,P.g.length),R=[],O=0,L=0;L<=C;L++){var V=O+(this.i(L)&65535)+(P.i(L)&65535),k=(V>>>16)+(this.i(L)>>>16)+(P.i(L)>>>16);O=k>>>16,V&=65535,k&=65535,R[L]=k<<16|V}return new o(R,R[R.length-1]&-2147483648?-1:0)};function A(P,C){return P.add(D(C))}t.j=function(P){if(E(this)||E(P))return p;if(x(this))return x(P)?D(this).j(D(P)):D(D(this).j(P));if(x(P))return D(this.j(D(P)));if(0>this.l(w)&&0>P.l(w))return h(this.m()*P.m());for(var C=this.g.length+P.g.length,R=[],O=0;O<2*C;O++)R[O]=0;for(O=0;O<this.g.length;O++)for(var L=0;L<P.g.length;L++){var V=this.i(O)>>>16,k=this.i(O)&65535,ve=P.i(L)>>>16,Ie=P.i(L)&65535;R[2*O+2*L]+=k*Ie,T(R,2*O+2*L),R[2*O+2*L+1]+=V*Ie,T(R,2*O+2*L+1),R[2*O+2*L+1]+=k*ve,T(R,2*O+2*L+1),R[2*O+2*L+2]+=V*ve,T(R,2*O+2*L+2)}for(O=0;O<C;O++)R[O]=R[2*O+1]<<16|R[2*O];for(O=C;O<2*C;O++)R[O]=0;return new o(R,0)};function T(P,C){for(;(P[C]&65535)!=P[C];)P[C+1]+=P[C]>>>16,P[C]&=65535,C++}function S(P,C){this.g=P,this.h=C}function M(P,C){if(E(C))throw Error("division by zero");if(E(P))return new S(p,p);if(x(P))return C=M(D(P),C),new S(D(C.g),D(C.h));if(x(C))return C=M(P,D(C)),new S(D(C.g),C.h);if(30<P.g.length){if(x(P)||x(C))throw Error("slowDivide_ only works with positive integers.");for(var R=m,O=C;0>=O.l(P);)R=q(R),O=q(O);var L=W(R,1),V=W(O,1);for(O=W(O,2),R=W(R,2);!E(O);){var k=V.add(O);0>=k.l(P)&&(L=L.add(R),V=k),O=W(O,1),R=W(R,1)}return C=A(P,L.j(C)),new S(L,C)}for(L=p;0<=P.l(C);){for(R=Math.max(1,Math.floor(P.m()/C.m())),O=Math.ceil(Math.log(R)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),V=h(R),k=V.j(C);x(k)||0<k.l(P);)R-=O,V=h(R),k=V.j(C);E(V)&&(V=m),L=L.add(V),P=A(P,k)}return new S(L,P)}t.A=function(P){return M(this,P).h},t.and=function(P){for(var C=Math.max(this.g.length,P.g.length),R=[],O=0;O<C;O++)R[O]=this.i(O)&P.i(O);return new o(R,this.h&P.h)},t.or=function(P){for(var C=Math.max(this.g.length,P.g.length),R=[],O=0;O<C;O++)R[O]=this.i(O)|P.i(O);return new o(R,this.h|P.h)},t.xor=function(P){for(var C=Math.max(this.g.length,P.g.length),R=[],O=0;O<C;O++)R[O]=this.i(O)^P.i(O);return new o(R,this.h^P.h)};function q(P){for(var C=P.g.length+1,R=[],O=0;O<C;O++)R[O]=P.i(O)<<1|P.i(O-1)>>>31;return new o(R,P.h)}function W(P,C){var R=C>>5;C%=32;for(var O=P.g.length-R,L=[],V=0;V<O;V++)L[V]=0<C?P.i(V+R)>>>C|P.i(V+R+1)<<32-C:P.i(V+R);return new o(L,P.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Zb=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,ua=o}).apply(typeof jE<"u"?jE:typeof self<"u"?self:typeof window<"u"?window:{});var yd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var eC,sc,tC,Hd,pv,nC,rC,iC;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,f,v){return u==Array.prototype||u==Object.prototype||(u[f]=v.value),u};function n(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof yd=="object"&&yd];for(var f=0;f<u.length;++f){var v=u[f];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var r=n(this);function i(u,f){if(f)e:{var v=r;u=u.split(".");for(var b=0;b<u.length-1;b++){var U=u[b];if(!(U in v))break e;v=v[U]}u=u[u.length-1],b=v[u],f=f(b),f!=b&&f!=null&&e(v,u,{configurable:!0,writable:!0,value:f})}}function s(u,f){u instanceof String&&(u+="");var v=0,b=!1,U={next:function(){if(!b&&v<u.length){var B=v++;return{value:f(B,u[B]),done:!1}}return b=!0,{done:!0,value:void 0}}};return U[Symbol.iterator]=function(){return U},U}i("Array.prototype.values",function(u){return u||function(){return s(this,function(f,v){return v})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var f=typeof u;return f=f!="object"?f:u?Array.isArray(u)?"array":f:"null",f=="array"||f=="object"&&typeof u.length=="number"}function h(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function d(u,f,v){return u.call.apply(u.bind,arguments)}function p(u,f,v){if(!u)throw Error();if(2<arguments.length){var b=Array.prototype.slice.call(arguments,2);return function(){var U=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(U,b),u.apply(f,U)}}return function(){return u.apply(f,arguments)}}function m(u,f,v){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:p,m.apply(null,arguments)}function w(u,f){var v=Array.prototype.slice.call(arguments,1);return function(){var b=v.slice();return b.push.apply(b,arguments),u.apply(this,b)}}function E(u,f){function v(){}v.prototype=f.prototype,u.aa=f.prototype,u.prototype=new v,u.prototype.constructor=u,u.Qb=function(b,U,B){for(var J=Array(arguments.length-2),He=2;He<arguments.length;He++)J[He-2]=arguments[He];return f.prototype[U].apply(b,J)}}function x(u){const f=u.length;if(0<f){const v=Array(f);for(let b=0;b<f;b++)v[b]=u[b];return v}return[]}function D(u,f){for(let v=1;v<arguments.length;v++){const b=arguments[v];if(l(b)){const U=u.length||0,B=b.length||0;u.length=U+B;for(let J=0;J<B;J++)u[U+J]=b[J]}else u.push(b)}}class A{constructor(f,v){this.i=f,this.j=v,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function T(u){return/^[\s\xa0]*$/.test(u)}function S(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function M(u){return M[" "](u),u}M[" "]=function(){};var q=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function W(u,f,v){for(const b in u)f.call(v,u[b],b,u)}function P(u,f){for(const v in u)f.call(void 0,u[v],v,u)}function C(u){const f={};for(const v in u)f[v]=u[v];return f}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(u,f){let v,b;for(let U=1;U<arguments.length;U++){b=arguments[U];for(v in b)u[v]=b[v];for(let B=0;B<R.length;B++)v=R[B],Object.prototype.hasOwnProperty.call(b,v)&&(u[v]=b[v])}}function L(u){var f=1;u=u.split(":");const v=[];for(;0<f&&u.length;)v.push(u.shift()),f--;return u.length&&v.push(u.join(":")),v}function V(u){a.setTimeout(()=>{throw u},0)}function k(){var u=ue;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class ve{constructor(){this.h=this.g=null}add(f,v){const b=Ie.get();b.set(f,v),this.h?this.h.next=b:this.g=b,this.h=b}}var Ie=new A(()=>new Fe,u=>u.reset());class Fe{constructor(){this.next=this.g=this.h=null}set(f,v){this.h=f,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let Ce,X=!1,ue=new ve,z=()=>{const u=a.Promise.resolve(void 0);Ce=()=>{u.then(Ne)}};var Ne=()=>{for(var u;u=k();){try{u.h.call(u.g)}catch(v){V(v)}var f=Ie;f.j(u),100>f.h&&(f.h++,u.next=f.g,f.g=u)}X=!1};function Le(){this.s=this.s,this.C=this.C}Le.prototype.s=!1,Le.prototype.ma=function(){this.s||(this.s=!0,this.N())},Le.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Be(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}Be.prototype.h=function(){this.defaultPrevented=!0};var lt=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const v=()=>{};a.addEventListener("test",v,f),a.removeEventListener("test",v,f)}catch{}return u}();function jt(u,f){if(Be.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var v=this.type=u.type,b=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget){if(q){e:{try{M(f.nodeName);var U=!0;break e}catch{}U=!1}U||(f=null)}}else v=="mouseover"?f=u.fromElement:v=="mouseout"&&(f=u.toElement);this.relatedTarget=f,b?(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:nt[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&jt.aa.h.call(this)}}E(jt,Be);var nt={2:"touch",3:"pen",4:"mouse"};jt.prototype.h=function(){jt.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),se=0;function Wn(u,f,v,b,U){this.listener=u,this.proxy=null,this.src=f,this.type=v,this.capture=!!b,this.ha=U,this.key=++se,this.da=this.fa=!1}function Kn(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function bt(u){this.src=u,this.g={},this.h=0}bt.prototype.add=function(u,f,v,b,U){var B=u.toString();u=this.g[B],u||(u=this.g[B]=[],this.h++);var J=On(u,f,b,U);return-1<J?(f=u[J],v||(f.fa=!1)):(f=new Wn(f,this.src,B,!!b,U),f.fa=v,u.push(f)),f};function Kt(u,f){var v=f.type;if(v in u.g){var b=u.g[v],U=Array.prototype.indexOf.call(b,f,void 0),B;(B=0<=U)&&Array.prototype.splice.call(b,U,1),B&&(Kn(f),u.g[v].length==0&&(delete u.g[v],u.h--))}}function On(u,f,v,b){for(var U=0;U<u.length;++U){var B=u[U];if(!B.da&&B.listener==f&&B.capture==!!v&&B.ha==b)return U}return-1}var us="closure_lm_"+(1e6*Math.random()|0),Gn={};function on(u,f,v,b,U){if(Array.isArray(f)){for(var B=0;B<f.length;B++)on(u,f[B],v,b,U);return null}return v=Rt(v),u&&u[de]?u.K(f,v,h(b)?!!b.capture:!!b,U):mu(u,f,v,!1,b,U)}function mu(u,f,v,b,U,B){if(!f)throw Error("Invalid event type");var J=h(U)?!!U.capture:!!U,He=hs(u);if(He||(u[us]=He=new bt(u)),v=He.add(f,v,b,J,B),v.proxy)return v;if(b=Ao(),v.proxy=b,b.src=u,b.listener=v,u.addEventListener)lt||(U=J),U===void 0&&(U=!1),u.addEventListener(f.toString(),b,U);else if(u.attachEvent)u.attachEvent($a(f.toString()),b);else if(u.addListener&&u.removeListener)u.addListener(b);else throw Error("addEventListener and attachEvent are unavailable.");return v}function Ao(){function u(v){return f.call(u.src,u.listener,v)}const f=xo;return u}function Ua(u,f,v,b,U){if(Array.isArray(f))for(var B=0;B<f.length;B++)Ua(u,f[B],v,b,U);else b=h(b)?!!b.capture:!!b,v=Rt(v),u&&u[de]?(u=u.i,f=String(f).toString(),f in u.g&&(B=u.g[f],v=On(B,v,b,U),-1<v&&(Kn(B[v]),Array.prototype.splice.call(B,v,1),B.length==0&&(delete u.g[f],u.h--)))):u&&(u=hs(u))&&(f=u.g[f.toString()],u=-1,f&&(u=On(f,v,b,U)),(v=-1<u?f[u]:null)&&cs(v))}function cs(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[de])Kt(f.i,u);else{var v=u.type,b=u.proxy;f.removeEventListener?f.removeEventListener(v,b,u.capture):f.detachEvent?f.detachEvent($a(v),b):f.addListener&&f.removeListener&&f.removeListener(b),(v=hs(f))?(Kt(v,u),v.h==0&&(v.src=null,f[us]=null)):Kn(u)}}}function $a(u){return u in Gn?Gn[u]:Gn[u]="on"+u}function xo(u,f){if(u.da)u=!0;else{f=new jt(f,this);var v=u.listener,b=u.ha||u.src;u.fa&&cs(u),u=v.call(b,f)}return u}function hs(u){return u=u[us],u instanceof bt?u:null}var hr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Rt(u){return typeof u=="function"?u:(u[hr]||(u[hr]=function(f){return u.handleEvent(f)}),u[hr])}function gt(){Le.call(this),this.i=new bt(this),this.M=this,this.F=null}E(gt,Le),gt.prototype[de]=!0,gt.prototype.removeEventListener=function(u,f,v,b){Ua(this,u,f,v,b)};function it(u,f){var v,b=u.F;if(b)for(v=[];b;b=b.F)v.push(b);if(u=u.M,b=f.type||f,typeof f=="string")f=new Be(f,u);else if(f instanceof Be)f.target=f.target||u;else{var U=f;f=new Be(b,u),O(f,U)}if(U=!0,v)for(var B=v.length-1;0<=B;B--){var J=f.g=v[B];U=Qn(J,b,!0,f)&&U}if(J=f.g=u,U=Qn(J,b,!0,f)&&U,U=Qn(J,b,!1,f)&&U,v)for(B=0;B<v.length;B++)J=f.g=v[B],U=Qn(J,b,!1,f)&&U}gt.prototype.N=function(){if(gt.aa.N.call(this),this.i){var u=this.i,f;for(f in u.g){for(var v=u.g[f],b=0;b<v.length;b++)Kn(v[b]);delete u.g[f],u.h--}}this.F=null},gt.prototype.K=function(u,f,v,b){return this.i.add(String(u),f,!1,v,b)},gt.prototype.L=function(u,f,v,b){return this.i.add(String(u),f,!0,v,b)};function Qn(u,f,v,b){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();for(var U=!0,B=0;B<f.length;++B){var J=f[B];if(J&&!J.da&&J.capture==v){var He=J.listener,Ut=J.ha||J.src;J.fa&&Kt(u.i,J),U=He.call(Ut,b)!==!1&&U}}return U&&!b.defaultPrevented}function Mr(u,f,v){if(typeof u=="function")v&&(u=m(u,v));else if(u&&typeof u.handleEvent=="function")u=m(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(u,f||0)}function bi(u){u.g=Mr(()=>{u.g=null,u.i&&(u.i=!1,bi(u))},u.l);const f=u.h;u.h=null,u.m.apply(null,f)}class ds extends Le{constructor(f,v){super(),this.m=f,this.l=v,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:bi(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Yn(u){Le.call(this),this.h=u,this.g={}}E(Yn,Le);var za=[];function Ci(u){W(u.g,function(f,v){this.g.hasOwnProperty(v)&&cs(f)},u),u.g={}}Yn.prototype.N=function(){Yn.aa.N.call(this),Ci(this)},Yn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ri=a.JSON.stringify,vu=a.JSON.parse,yu=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Po(){}Po.prototype.h=null;function ko(u){return u.h||(u.h=u.i())}function Vr(){}var ii={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function fs(){Be.call(this,"d")}E(fs,Be);function Ro(){Be.call(this,"c")}E(Ro,Be);var jr={},ps=null;function gs(){return ps=ps||new gt}jr.La="serverreachability";function Nn(u){Be.call(this,jr.La,u)}E(Nn,Be);function yn(u){const f=gs();it(f,new Nn(f))}jr.STAT_EVENT="statevent";function Ba(u,f){Be.call(this,jr.STAT_EVENT,u),this.stat=f}E(Ba,Be);function Ft(u){const f=gs();it(f,new Ba(f,u))}jr.Ma="timingevent";function qa(u,f){Be.call(this,jr.Ma,u),this.size=f}E(qa,Be);function Ai(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},f)}function Ue(){this.g=!0}Ue.prototype.xa=function(){this.g=!1};function Xe(u,f,v,b,U,B){u.info(function(){if(u.g)if(B)for(var J="",He=B.split("&"),Ut=0;Ut<He.length;Ut++){var Me=He[Ut].split("=");if(1<Me.length){var Je=Me[0];Me=Me[1];var $t=Je.split("_");J=2<=$t.length&&$t[1]=="type"?J+(Je+"="+Me+"&"):J+(Je+"=redacted&")}}else J=null;else J=B;return"XMLHTTP REQ ("+b+") [attempt "+U+"]: "+f+`
`+v+`
`+J})}function Ct(u,f,v,b,U,B,J){u.info(function(){return"XMLHTTP RESP ("+b+") [ attempt "+U+"]: "+f+`
`+v+`
`+B+" "+J})}function qe(u,f,v,b){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+en(u,v)+(b?" "+b:"")})}function dr(u,f){u.info(function(){return"TIMEOUT: "+f})}Ue.prototype.info=function(){};function en(u,f){if(!u.g)return f;if(!f)return null;try{var v=JSON.parse(f);if(v){for(u=0;u<v.length;u++)if(Array.isArray(v[u])){var b=v[u];if(!(2>b.length)){var U=b[1];if(Array.isArray(U)&&!(1>U.length)){var B=U[0];if(B!="noop"&&B!="stop"&&B!="close")for(var J=1;J<U.length;J++)U[J]=""}}}}return ri(v)}catch{return f}}var ms={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ah={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},si;function Dt(){}E(Dt,Po),Dt.prototype.g=function(){return new XMLHttpRequest},Dt.prototype.i=function(){return{}},si=new Dt;function Et(u,f,v,b){this.j=u,this.i=f,this.l=v,this.R=b||1,this.U=new Yn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new an}function an(){this.i=null,this.g="",this.h=!1}var Gt={},vs={};function oi(u,f,v){u.L=1,u.v=_s(Xn(f)),u.m=v,u.P=!0,ai(u,null)}function ai(u,f){u.F=Date.now(),ys(u),u.A=Xn(u.v);var v=u.A,b=u.R;Array.isArray(b)||(b=[String(b)]),Cu(v.i,"t",b),u.C=0,v=u.j.J,u.h=new an,u.g=zh(u.j,v?f:null,!u.m),0<u.O&&(u.M=new ds(m(u.Y,u,u.g),u.O)),f=u.U,v=u.g,b=u.ca;var U="readystatechange";Array.isArray(U)||(U&&(za[0]=U.toString()),U=za);for(var B=0;B<U.length;B++){var J=on(v,U[B],b||f.handleEvent,!1,f.h||f);if(!J)break;f.g[J.key]=J}f=u.H?C(u.H):{},u.m?(u.u||(u.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,f)):(u.u="GET",u.g.ea(u.A,u.u,null,f)),yn(),Xe(u.i,u.u,u.A,u.l,u.R,u.m)}Et.prototype.ca=function(u){u=u.target;const f=this.M;f&&mr(u)==3?f.j():this.Y(u)},Et.prototype.Y=function(u){try{if(u==this.g)e:{const $t=mr(this.g);var f=this.g.Ba();const Oi=this.g.Z();if(!(3>$t)&&($t!=3||this.g&&(this.h.h||this.g.oa()||ku(this.g)))){this.J||$t!=4||f==7||(f==8||0>=Oi?yn(3):yn(2)),Ha(this);var v=this.g.Z();this.X=v;t:if(xi(this)){var b=ku(this.g);u="";var U=b.length,B=mr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Fr(this),ki(this);var J="";break t}this.h.i=new a.TextDecoder}for(f=0;f<U;f++)this.h.h=!0,u+=this.h.i.decode(b[f],{stream:!(B&&f==U-1)});b.length=0,this.h.g+=u,this.C=0,J=this.h.g}else J=this.g.oa();if(this.o=v==200,Ct(this.i,this.u,this.A,this.l,this.R,$t,v),this.o){if(this.T&&!this.K){t:{if(this.g){var He,Ut=this.g;if((He=Ut.g?Ut.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(He)){var Me=He;break t}}Me=null}if(v=Me)qe(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Wa(this,v);else{this.o=!1,this.s=3,Ft(12),Fr(this),ki(this);break e}}if(this.P){v=!0;let jn;for(;!this.J&&this.C<J.length;)if(jn=xh(this,J),jn==vs){$t==4&&(this.s=4,Ft(14),v=!1),qe(this.i,this.l,null,"[Incomplete Response]");break}else if(jn==Gt){this.s=4,Ft(15),qe(this.i,this.l,J,"[Invalid Chunk]"),v=!1;break}else qe(this.i,this.l,jn,null),Wa(this,jn);if(xi(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),$t!=4||J.length!=0||this.h.h||(this.s=1,Ft(16),v=!1),this.o=this.o&&v,!v)qe(this.i,this.l,J,"[Invalid Chunked Response]"),Fr(this),ki(this);else if(0<J.length&&!this.W){this.W=!0;var Je=this.j;Je.g==this&&Je.ba&&!Je.M&&(Je.j.info("Great, no buffering proxy detected. Bytes received: "+J.length),nl(Je),Je.M=!0,Ft(11))}}else qe(this.i,this.l,J,null),Wa(this,J);$t==4&&Fr(this),this.o&&!this.J&&($t==4?rl(this.j,this):(this.o=!1,ys(this)))}else Nh(this.g),v==400&&0<J.indexOf("Unknown SID")?(this.s=3,Ft(12)):(this.s=0,Ft(13)),Fr(this),ki(this)}}}catch{}finally{}};function xi(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function xh(u,f){var v=u.C,b=f.indexOf(`
`,v);return b==-1?vs:(v=Number(f.substring(v,b)),isNaN(v)?Gt:(b+=1,b+v>f.length?vs:(f=f.slice(b,b+v),u.C=b+v,f)))}Et.prototype.cancel=function(){this.J=!0,Fr(this)};function ys(u){u.S=Date.now()+u.I,Pi(u,u.I)}function Pi(u,f){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Ai(m(u.ba,u),f)}function Ha(u){u.B&&(a.clearTimeout(u.B),u.B=null)}Et.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(dr(this.i,this.A),this.L!=2&&(yn(),Ft(17)),Fr(this),this.s=2,ki(this)):Pi(this,this.S-u)};function ki(u){u.j.G==0||u.J||rl(u.j,u)}function Fr(u){Ha(u);var f=u.M;f&&typeof f.ma=="function"&&f.ma(),u.M=null,Ci(u.U),u.g&&(f=u.g,u.g=null,f.abort(),f.ma())}function Wa(u,f){try{var v=u.j;if(v.G!=0&&(v.g==u||Ka(v.h,u))){if(!u.K&&Ka(v.h,u)&&v.G==3){try{var b=v.Da.g.parse(f)}catch{b=null}if(Array.isArray(b)&&b.length==3){var U=b;if(U[0]==0){e:if(!v.u){if(v.g)if(v.g.F+3e3<u.F)vr(v),jo(v);else break e;Fo(v),Ft(18)}}else v.za=U[1],0<v.za-v.T&&37500>U[2]&&v.F&&v.v==0&&!v.C&&(v.C=Ai(m(v.Za,v),6e3));if(1>=Eu(v.h)&&v.ca){try{v.ca()}catch{}v.ca=void 0}}else hi(v,11)}else if((u.K||v.g==u)&&vr(v),!T(f))for(U=v.Da.g.parse(f),f=0;f<U.length;f++){let Me=U[f];if(v.T=Me[0],Me=Me[1],v.G==2)if(Me[0]=="c"){v.K=Me[1],v.ia=Me[2];const Je=Me[3];Je!=null&&(v.la=Je,v.j.info("VER="+v.la));const $t=Me[4];$t!=null&&(v.Aa=$t,v.j.info("SVER="+v.Aa));const Oi=Me[5];Oi!=null&&typeof Oi=="number"&&0<Oi&&(b=1.5*Oi,v.L=b,v.j.info("backChannelRequestTimeoutMs_="+b)),b=v;const jn=u.g;if(jn){const il=jn.g?jn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(il){var B=b.h;B.g||il.indexOf("spdy")==-1&&il.indexOf("quic")==-1&&il.indexOf("h2")==-1||(B.j=B.l,B.g=new Set,B.h&&(Ga(B,B.h),B.h=null))}if(b.D){const Nu=jn.g?jn.g.getResponseHeader("X-HTTP-Session-Id"):null;Nu&&(b.ya=Nu,$e(b.I,b.D,Nu))}}v.G=3,v.l&&v.l.ua(),v.ba&&(v.R=Date.now()-u.F,v.j.info("Handshake RTT: "+v.R+"ms")),b=v;var J=u;if(b.qa=$h(b,b.J?b.ia:null,b.W),J.K){Tu(b.h,J);var He=J,Ut=b.L;Ut&&(He.I=Ut),He.B&&(Ha(He),ys(He)),b.g=J}else jh(b);0<v.i.length&&tl(v)}else Me[0]!="stop"&&Me[0]!="close"||hi(v,7);else v.G==3&&(Me[0]=="stop"||Me[0]=="close"?Me[0]=="stop"?hi(v,7):Vo(v):Me[0]!="noop"&&v.l&&v.l.ta(Me),v.v=0)}}yn(4)}catch{}}var Ph=class{constructor(u,f){this.g=u,this.map=f}};function _u(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function wu(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Eu(u){return u.h?1:u.g?u.g.size:0}function Ka(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function Ga(u,f){u.g?u.g.add(f):u.h=f}function Tu(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}_u.prototype.cancel=function(){if(this.i=Iu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Iu(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let f=u.i;for(const v of u.g.values())f=f.concat(v.D);return f}return x(u.i)}function kh(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var f=[],v=u.length,b=0;b<v;b++)f.push(u[b]);return f}f=[],v=0;for(b in u)f[v++]=u[b];return f}function fr(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var f=[];u=u.length;for(var v=0;v<u;v++)f.push(v);return f}f=[],v=0;for(const b in u)f[v++]=b;return f}}}function ln(u,f){if(u.forEach&&typeof u.forEach=="function")u.forEach(f,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,f,void 0);else for(var v=fr(u),b=kh(u),U=b.length,B=0;B<U;B++)f.call(void 0,b[B],v&&v[B],u)}var li=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ln(u,f){if(u){u=u.split("&");for(var v=0;v<u.length;v++){var b=u[v].indexOf("="),U=null;if(0<=b){var B=u[v].substring(0,b);U=u[v].substring(b+1)}else B=u[v];f(B,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function Ur(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Ur){this.h=u.h,_n(this,u.j),this.o=u.o,this.g=u.g,pr(this,u.s),this.l=u.l;var f=u.i,v=new Es;v.i=f.i,f.g&&(v.g=new Map(f.g),v.h=f.h),Do(this,v),this.m=u.m}else u&&(f=String(u).match(li))?(this.h=!1,_n(this,f[1]||"",!0),this.o=ws(f[2]||""),this.g=ws(f[3]||"",!0),pr(this,f[4]),this.l=ws(f[5]||"",!0),Do(this,f[6]||"",!0),this.m=ws(f[7]||"")):(this.h=!1,this.i=new Es(null,this.h))}Ur.prototype.toString=function(){var u=[],f=this.j;f&&u.push(gr(f,bu,!0),":");var v=this.g;return(v||f=="file")&&(u.push("//"),(f=this.o)&&u.push(gr(f,bu,!0),"@"),u.push(encodeURIComponent(String(v)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.s,v!=null&&u.push(":",String(v))),(v=this.l)&&(this.g&&v.charAt(0)!="/"&&u.push("/"),u.push(gr(v,v.charAt(0)=="/"?Xp:$r,!0))),(v=this.i.toString())&&u.push("?",v),(v=this.m)&&u.push("#",gr(v,Qa)),u.join("")};function Xn(u){return new Ur(u)}function _n(u,f,v){u.j=v?ws(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function pr(u,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);u.s=f}else u.s=null}function Do(u,f,v){f instanceof Es?(u.i=f,Rh(u.i,u.h)):(v||(f=gr(f,ui)),u.i=new Es(f,u.h))}function $e(u,f,v){u.i.set(f,v)}function _s(u){return $e(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function ws(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function gr(u,f,v){return typeof u=="string"?(u=encodeURI(u).replace(f,Su),v&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Su(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var bu=/[#\/\?@]/g,$r=/[#\?:]/g,Xp=/[#\?]/g,ui=/[#\?@]/g,Qa=/#/g;function Es(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function Mn(u){u.g||(u.g=new Map,u.h=0,u.i&&Ln(u.i,function(f,v){u.add(decodeURIComponent(f.replace(/\+/g," ")),v)}))}t=Es.prototype,t.add=function(u,f){Mn(this),this.i=null,u=Ri(this,u);var v=this.g.get(u);return v||this.g.set(u,v=[]),v.push(f),this.h+=1,this};function Ya(u,f){Mn(u),f=Ri(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function Ts(u,f){return Mn(u),f=Ri(u,f),u.g.has(f)}t.forEach=function(u,f){Mn(this),this.g.forEach(function(v,b){v.forEach(function(U){u.call(f,U,b,this)},this)},this)},t.na=function(){Mn(this);const u=Array.from(this.g.values()),f=Array.from(this.g.keys()),v=[];for(let b=0;b<f.length;b++){const U=u[b];for(let B=0;B<U.length;B++)v.push(f[b])}return v},t.V=function(u){Mn(this);let f=[];if(typeof u=="string")Ts(this,u)&&(f=f.concat(this.g.get(Ri(this,u))));else{u=Array.from(this.g.values());for(let v=0;v<u.length;v++)f=f.concat(u[v])}return f},t.set=function(u,f){return Mn(this),this.i=null,u=Ri(this,u),Ts(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},t.get=function(u,f){return u?(u=this.V(u),0<u.length?String(u[0]):f):f};function Cu(u,f,v){Ya(u,f),0<v.length&&(u.i=null,u.g.set(Ri(u,f),x(v)),u.h+=v.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],f=Array.from(this.g.keys());for(var v=0;v<f.length;v++){var b=f[v];const B=encodeURIComponent(String(b)),J=this.V(b);for(b=0;b<J.length;b++){var U=B;J[b]!==""&&(U+="="+encodeURIComponent(String(J[b]))),u.push(U)}}return this.i=u.join("&")};function Ri(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function Rh(u,f){f&&!u.j&&(Mn(u),u.i=null,u.g.forEach(function(v,b){var U=b.toLowerCase();b!=U&&(Ya(this,b),Cu(this,U,v))},u)),u.j=f}function Is(u,f){const v=new Ue;if(a.Image){const b=new Image;b.onload=w(zr,v,"TestLoadImage: loaded",!0,f,b),b.onerror=w(zr,v,"TestLoadImage: error",!1,f,b),b.onabort=w(zr,v,"TestLoadImage: abort",!1,f,b),b.ontimeout=w(zr,v,"TestLoadImage: timeout",!1,f,b),a.setTimeout(function(){b.ontimeout&&b.ontimeout()},1e4),b.src=u}else f(!1)}function Jp(u,f){const v=new Ue,b=new AbortController,U=setTimeout(()=>{b.abort(),zr(v,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:b.signal}).then(B=>{clearTimeout(U),B.ok?zr(v,"TestPingServer: ok",!0,f):zr(v,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(U),zr(v,"TestPingServer: error",!1,f)})}function zr(u,f,v,b,U){try{U&&(U.onload=null,U.onerror=null,U.onabort=null,U.ontimeout=null),b(v)}catch{}}function Au(){this.g=new yu}function Xa(u,f,v){const b=v||"";try{ln(u,function(U,B){let J=U;h(U)&&(J=ri(U)),f.push(b+B+"="+encodeURIComponent(J))})}catch(U){throw f.push(b+"type="+encodeURIComponent("_badmap")),U}}function Ss(u){this.l=u.Ub||null,this.j=u.eb||!1}E(Ss,Po),Ss.prototype.g=function(){return new Ja(this.l,this.j)},Ss.prototype.i=function(u){return function(){return u}}({});function Ja(u,f){gt.call(this),this.D=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(Ja,gt),t=Ja.prototype,t.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=f,this.readyState=1,bs(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(f.body=u),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,No(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,bs(this)),this.g&&(this.readyState=3,bs(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Oo(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Oo(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?No(this):bs(this),this.readyState==3&&Oo(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,No(this))},t.Qa=function(u){this.g&&(this.response=u,No(this))},t.ga=function(){this.g&&No(this)};function No(u){u.readyState=4,u.l=null,u.j=null,u.v=null,bs(u)}t.setRequestHeader=function(u,f){this.u.append(u,f)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],f=this.h.entries();for(var v=f.next();!v.done;)v=v.value,u.push(v[0]+": "+v[1]),v=f.next();return u.join(`\r
`)};function bs(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Ja.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Za(u){let f="";return W(u,function(v,b){f+=b,f+=":",f+=v,f+=`\r
`}),f}function Lo(u,f,v){e:{for(b in v){var b=!1;break e}b=!0}b||(v=Za(v),typeof u=="string"?v!=null&&encodeURIComponent(String(v)):$e(u,f,v))}function st(u){gt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(st,gt);var Dh=/^https?$/i,Mo=["POST","PUT"];t=st.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,f,v,b){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():si.g(),this.v=this.o?ko(this.o):ko(si),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(B){el(this,B);return}if(u=v||"",v=new Map(this.headers),b)if(Object.getPrototypeOf(b)===Object.prototype)for(var U in b)v.set(U,b[U]);else if(typeof b.keys=="function"&&typeof b.get=="function")for(const B of b.keys())v.set(B,b.get(B));else throw Error("Unknown input type for opt_headers: "+String(b));b=Array.from(v.keys()).find(B=>B.toLowerCase()=="content-type"),U=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Mo,f,void 0))||b||U||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[B,J]of v)this.g.setRequestHeader(B,J);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Oh(this),this.u=!0,this.g.send(u),this.u=!1}catch(B){el(this,B)}};function el(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.m=5,xu(u),Br(u)}function xu(u){u.A||(u.A=!0,it(u,"complete"),it(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,it(this,"complete"),it(this,"abort"),Br(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Br(this,!0)),st.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Pu(this):this.bb())},t.bb=function(){Pu(this)};function Pu(u){if(u.h&&typeof o<"u"&&(!u.v[1]||mr(u)!=4||u.Z()!=2)){if(u.u&&mr(u)==4)Mr(u.Ea,0,u);else if(it(u,"readystatechange"),mr(u)==4){u.h=!1;try{const J=u.Z();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var v;if(!(v=f)){var b;if(b=J===0){var U=String(u.D).match(li)[1]||null;!U&&a.self&&a.self.location&&(U=a.self.location.protocol.slice(0,-1)),b=!Dh.test(U?U.toLowerCase():"")}v=b}if(v)it(u,"complete"),it(u,"success");else{u.m=6;try{var B=2<mr(u)?u.g.statusText:""}catch{B=""}u.l=B+" ["+u.Z()+"]",xu(u)}}finally{Br(u)}}}}function Br(u,f){if(u.g){Oh(u);const v=u.g,b=u.v[0]?()=>{}:null;u.g=null,u.v=null,f||it(u,"ready");try{v.onreadystatechange=b}catch{}}}function Oh(u){u.I&&(a.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function mr(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<mr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),vu(f)}};function ku(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Nh(u){const f={};u=(u.g&&2<=mr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let b=0;b<u.length;b++){if(T(u[b]))continue;var v=L(u[b]);const U=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const B=f[U]||[];f[U]=B,B.push(v)}P(f,function(b){return b.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Cs(u,f,v){return v&&v.internalChannelParams&&v.internalChannelParams[u]||f}function Ru(u){this.Aa=0,this.i=[],this.j=new Ue,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Cs("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Cs("baseRetryDelayMs",5e3,u),this.cb=Cs("retryDelaySeedMs",1e4,u),this.Wa=Cs("forwardChannelMaxRetries",2,u),this.wa=Cs("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new _u(u&&u.concurrentRequestLimit),this.Da=new Au,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ru.prototype,t.la=8,t.G=1,t.connect=function(u,f,v,b){Ft(0),this.W=u,this.H=f||{},v&&b!==void 0&&(this.H.OSID=v,this.H.OAID=b),this.F=this.X,this.I=$h(this,null,this.W),tl(this)};function Vo(u){if(Lh(u),u.G==3){var f=u.U++,v=Xn(u.I);if($e(v,"SID",u.K),$e(v,"RID",f),$e(v,"TYPE","terminate"),ci(u,v),f=new Et(u,u.j,f),f.L=2,f.v=_s(Xn(v)),v=!1,a.navigator&&a.navigator.sendBeacon)try{v=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!v&&a.Image&&(new Image().src=f.v,v=!0),v||(f.g=zh(f.j,null),f.g.ea(f.v)),f.F=Date.now(),ys(f)}Uh(u)}function jo(u){u.g&&(nl(u),u.g.cancel(),u.g=null)}function Lh(u){jo(u),u.u&&(a.clearTimeout(u.u),u.u=null),vr(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function tl(u){if(!wu(u.h)&&!u.s){u.s=!0;var f=u.Ga;Ce||z(),X||(Ce(),X=!0),ue.add(f,u),u.B=0}}function Mh(u,f){return Eu(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=f.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Ai(m(u.Ga,u,f),Fh(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const U=new Et(this,this.j,u);let B=this.o;if(this.S&&(B?(B=C(B),O(B,this.S)):B=this.S),this.m!==null||this.O||(U.H=B,B=null),this.P)e:{for(var f=0,v=0;v<this.i.length;v++){t:{var b=this.i[v];if("__data__"in b.map&&(b=b.map.__data__,typeof b=="string")){b=b.length;break t}b=void 0}if(b===void 0)break;if(f+=b,4096<f){f=v;break e}if(f===4096||v===this.i.length-1){f=v+1;break e}}f=1e3}else f=1e3;f=Vh(this,U,f),v=Xn(this.I),$e(v,"RID",u),$e(v,"CVER",22),this.D&&$e(v,"X-HTTP-Session-Id",this.D),ci(this,v),B&&(this.O?f="headers="+encodeURIComponent(String(Za(B)))+"&"+f:this.m&&Lo(v,this.m,B)),Ga(this.h,U),this.Ua&&$e(v,"TYPE","init"),this.P?($e(v,"$req",f),$e(v,"SID","null"),U.T=!0,oi(U,v,null)):oi(U,v,f),this.G=2}}else this.G==3&&(u?Du(this,u):this.i.length==0||wu(this.h)||Du(this))};function Du(u,f){var v;f?v=f.l:v=u.U++;const b=Xn(u.I);$e(b,"SID",u.K),$e(b,"RID",v),$e(b,"AID",u.T),ci(u,b),u.m&&u.o&&Lo(b,u.m,u.o),v=new Et(u,u.j,v,u.B+1),u.m===null&&(v.H=u.o),f&&(u.i=f.D.concat(u.i)),f=Vh(u,v,1e3),v.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Ga(u.h,v),oi(v,b,f)}function ci(u,f){u.H&&W(u.H,function(v,b){$e(f,b,v)}),u.l&&ln({},function(v,b){$e(f,b,v)})}function Vh(u,f,v){v=Math.min(u.i.length,v);var b=u.l?m(u.l.Na,u.l,u):null;e:{var U=u.i;let B=-1;for(;;){const J=["count="+v];B==-1?0<v?(B=U[0].g,J.push("ofs="+B)):B=0:J.push("ofs="+B);let He=!0;for(let Ut=0;Ut<v;Ut++){let Me=U[Ut].g;const Je=U[Ut].map;if(Me-=B,0>Me)B=Math.max(0,U[Ut].g-100),He=!1;else try{Xa(Je,J,"req"+Me+"_")}catch{b&&b(Je)}}if(He){b=J.join("&");break e}}}return u=u.i.splice(0,v),f.D=u,b}function jh(u){if(!u.g&&!u.u){u.Y=1;var f=u.Fa;Ce||z(),X||(Ce(),X=!0),ue.add(f,u),u.v=0}}function Fo(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Ai(m(u.Fa,u),Fh(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,Ou(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Ai(m(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ft(10),jo(this),Ou(this))};function nl(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Ou(u){u.g=new Et(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var f=Xn(u.qa);$e(f,"RID","rpc"),$e(f,"SID",u.K),$e(f,"AID",u.T),$e(f,"CI",u.F?"0":"1"),!u.F&&u.ja&&$e(f,"TO",u.ja),$e(f,"TYPE","xmlhttp"),ci(u,f),u.m&&u.o&&Lo(f,u.m,u.o),u.L&&(u.g.I=u.L);var v=u.g;u=u.ia,v.L=1,v.v=_s(Xn(f)),v.m=null,v.P=!0,ai(v,u)}t.Za=function(){this.C!=null&&(this.C=null,jo(this),Fo(this),Ft(19))};function vr(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function rl(u,f){var v=null;if(u.g==f){vr(u),nl(u),u.g=null;var b=2}else if(Ka(u.h,f))v=f.D,Tu(u.h,f),b=1;else return;if(u.G!=0){if(f.o)if(b==1){v=f.m?f.m.length:0,f=Date.now()-f.F;var U=u.B;b=gs(),it(b,new qa(b,v)),tl(u)}else jh(u);else if(U=f.s,U==3||U==0&&0<f.X||!(b==1&&Mh(u,f)||b==2&&Fo(u)))switch(v&&0<v.length&&(f=u.h,f.i=f.i.concat(v)),U){case 1:hi(u,5);break;case 4:hi(u,10);break;case 3:hi(u,6);break;default:hi(u,2)}}}function Fh(u,f){let v=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(v*=2),v*f}function hi(u,f){if(u.j.info("Error code "+f),f==2){var v=m(u.fb,u),b=u.Xa;const U=!b;b=new Ur(b||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||_n(b,"https"),_s(b),U?Is(b.toString(),v):Jp(b.toString(),v)}else Ft(2);u.G=0,u.l&&u.l.sa(f),Uh(u),Lh(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Ft(2)):(this.j.info("Failed to ping google.com"),Ft(1))};function Uh(u){if(u.G=0,u.ka=[],u.l){const f=Iu(u.h);(f.length!=0||u.i.length!=0)&&(D(u.ka,f),D(u.ka,u.i),u.h.i.length=0,x(u.i),u.i.length=0),u.l.ra()}}function $h(u,f,v){var b=v instanceof Ur?Xn(v):new Ur(v);if(b.g!="")f&&(b.g=f+"."+b.g),pr(b,b.s);else{var U=a.location;b=U.protocol,f=f?f+"."+U.hostname:U.hostname,U=+U.port;var B=new Ur(null);b&&_n(B,b),f&&(B.g=f),U&&pr(B,U),v&&(B.l=v),b=B}return v=u.D,f=u.ya,v&&f&&$e(b,v,f),$e(b,"VER",u.la),ci(u,b),b}function zh(u,f,v){if(f&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Ca&&!u.pa?new st(new Ss({eb:v})):new st(u.pa),f.Ha(u.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Bh(){}t=Bh.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Uo(){}Uo.prototype.g=function(u,f){return new un(u,f)};function un(u,f){gt.call(this),this.g=new Ru(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(u?u["X-WebChannel-Client-Profile"]=f.va:u={"X-WebChannel-Client-Profile":f.va}),this.g.S=u,(u=f&&f.Sb)&&!T(u)&&(this.g.m=u),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!T(f)&&(this.g.D=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new Vn(this)}E(un,gt),un.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},un.prototype.close=function(){Vo(this.g)},un.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var v={};v.__data__=u,u=v}else this.u&&(v={},v.__data__=ri(u),u=v);f.i.push(new Ph(f.Ya++,u)),f.G==3&&tl(f)},un.prototype.N=function(){this.g.l=null,delete this.j,Vo(this.g),delete this.g,un.aa.N.call(this)};function qh(u){fs.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){e:{for(const v in f){u=v;break e}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}E(qh,fs);function Di(){Ro.call(this),this.status=1}E(Di,Ro);function Vn(u){this.g=u}E(Vn,Bh),Vn.prototype.ua=function(){it(this.g,"a")},Vn.prototype.ta=function(u){it(this.g,new qh(u))},Vn.prototype.sa=function(u){it(this.g,new Di)},Vn.prototype.ra=function(){it(this.g,"b")},Uo.prototype.createWebChannel=Uo.prototype.g,un.prototype.send=un.prototype.o,un.prototype.open=un.prototype.m,un.prototype.close=un.prototype.close,iC=function(){return new Uo},rC=function(){return gs()},nC=jr,pv={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ms.NO_ERROR=0,ms.TIMEOUT=8,ms.HTTP_ERROR=6,Hd=ms,Ah.COMPLETE="complete",tC=Ah,Vr.EventType=ii,ii.OPEN="a",ii.CLOSE="b",ii.ERROR="c",ii.MESSAGE="d",gt.prototype.listen=gt.prototype.K,sc=Vr,st.prototype.listenOnce=st.prototype.L,st.prototype.getLastError=st.prototype.Ka,st.prototype.getLastErrorCode=st.prototype.Ba,st.prototype.getStatus=st.prototype.Z,st.prototype.getResponseJson=st.prototype.Oa,st.prototype.getResponseText=st.prototype.oa,st.prototype.send=st.prototype.ea,st.prototype.setWithCredentials=st.prototype.Ha,eC=st}).apply(typeof yd<"u"?yd:typeof self<"u"?self:typeof window<"u"?window:{});const FE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Sn.UNAUTHENTICATED=new Sn(null),Sn.GOOGLE_CREDENTIALS=new Sn("google-credentials-uid"),Sn.FIRST_PARTY=new Sn("first-party-uid"),Sn.MOCK_USER=new Sn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fu="11.0.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa=new wp("@firebase/firestore");function pl(){return wa.logLevel}function Q(t,...e){if(wa.logLevel<=Re.DEBUG){const n=e.map(r_);wa.debug(`Firestore (${fu}): ${t}`,...n)}}function bn(t,...e){if(wa.logLevel<=Re.ERROR){const n=e.map(r_);wa.error(`Firestore (${fu}): ${t}`,...n)}}function Yl(t,...e){if(wa.logLevel<=Re.WARN){const n=e.map(r_);wa.warn(`Firestore (${fu}): ${t}`,...n)}}function r_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ae(t="Unexpected state"){const e=`FIRESTORE (${fu}) INTERNAL ASSERTION FAILED: `+t;throw bn(e),new Error(e)}function le(t,e){t||ae()}function me(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ne extends ni{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class FM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Sn.UNAUTHENTICATED))}shutdown(){}}class UM{constructor(e){this.t=e,this.currentUser=Sn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){le(this.o===void 0);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Ki;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ki,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{Q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Q("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ki)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(le(typeof r.accessToken=="string"),new jM(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return le(e===null||typeof e=="string"),new Sn(e)}}class $M{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Sn.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class zM{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new $M(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Sn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class BM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qM{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){le(this.o===void 0);const r=s=>{s.error!=null&&Q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(le(typeof n.token=="string"),this.R=n.token,new BM(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HM(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=HM(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function we(t,e){return t<e?-1:t>e?1:0}function Xl(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function oC(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{static now(){return _t.fromMillis(Date.now())}static fromDate(e){return _t.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new _t(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ne(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ne(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ne(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ne(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?we(this.nanoseconds,e.nanoseconds):we(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{static fromTimestamp(e){return new ce(e)}static min(){return new ce(new _t(0,0))}static max(){return new ce(new _t(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,n,r){n===void 0?n=0:n>e.length&&ae(),r===void 0?r=e.length-n:r>e.length-n&&ae(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Jc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Jc?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ge extends Jc{construct(e,n,r){return new Ge(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ne(K.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Ge(n)}static emptyPath(){return new Ge([])}}const WM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class vt extends Jc{construct(e,n,r){return new vt(e,n,r)}static isValidIdentifier(e){return WM.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new vt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ne(K.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new ne(K.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ne(K.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new ne(K.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new vt(n)}static emptyPath(){return new vt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.path=e}static fromPath(e){return new te(Ge.fromString(e))}static fromName(e){return new te(Ge.fromString(e).popFirst(5))}static empty(){return new te(Ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ge.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new te(new Ge(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function gv(t){return t.fields.find(e=>e.kind===2)}function Xo(t){return t.fields.filter(e=>e.kind!==2)}jf.UNKNOWN_ID=-1;class Wd{constructor(e,n){this.fieldPath=e,this.kind=n}}class Zc{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Zc(0,lr.min())}}function KM(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ce.fromTimestamp(r===1e9?new _t(n+1,0):new _t(n,r));return new lr(i,te.empty(),e)}function aC(t){return new lr(t.readTime,t.key,-1)}class lr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new lr(ce.min(),te.empty(),-1)}static max(){return new lr(ce.max(),te.empty(),-1)}}function i_(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=te.comparator(t.documentKey,e.documentKey),n!==0?n:we(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class uC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Va(t){if(t.code!==K.FAILED_PRECONDITION||t.message!==lC)throw t;Q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new $((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof $?n:$.resolve(n)}catch(n){return $.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):$.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):$.reject(n)}static resolve(e){return new $((n,r)=>{n(e)})}static reject(e){return new $((n,r)=>{r(e)})}static waitFor(e){return new $((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=$.resolve(!1);for(const r of e)n=n.next(i=>i?$.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new $((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const h=l;n(e[h]).next(d=>{o[h]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new $((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{static open(e,n,r,i){try{return new Sp(n,e.transaction(i,r))}catch(s){throw new Tc(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Ki,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Tc(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=s_(r.target.error);this.V.reject(new Tc(e,i))}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Q("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new QM(n)}}class ao{static delete(e){return Q("SimpleDb","Removing database:",e),Jo(window.indexedDB.deleteDatabase(e)).toPromise()}static p(){if(!qy())return!1;if(ao.S())return!0;const e=Ht(),n=ao.D(e),r=0<n&&n<10,i=cC(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static S(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static C(e,n){return e.store(n)}static D(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.F=r,ao.D(Ht())===12.2&&bn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async M(e){return this.db||(Q("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Tc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new ne(K.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new ne(K.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Tc(e,o))},i.onupgradeneeded=s=>{Q("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.F.O(o,i.transaction,s.oldVersion,this.version).next(()=>{Q("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Sp.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(h=>(a.g(),h)).catch(h=>(a.abort(h),$.reject(h))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,h=l.name!=="FirebaseError"&&o<3;if(Q("SimpleDb","Transaction failed with error:",l.message,"Retrying:",h),this.close(),!h)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function cC(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class GM{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Jo(this.B.delete())}}class Tc extends ne{constructor(e,n){super(K.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function So(t){return t.name==="IndexedDbTransactionError"}class QM{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(Q("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(Q("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Jo(r)}add(e){return Q("SimpleDb","ADD",this.store.name,e,e),Jo(this.store.add(e))}get(e){return Jo(this.store.get(e)).next(n=>(n===void 0&&(n=null),Q("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return Q("SimpleDb","DELETE",this.store.name,e),Jo(this.store.delete(e))}count(){return Q("SimpleDb","COUNT",this.store.name),Jo(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new $((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new $((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,n){Q("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new $((r,i)=>{n.onerror=s=>{const o=s_(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){const r=[];return new $((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new GM(a),h=n(a.primaryKey,a.value,l);if(h instanceof $){const d=h.catch(p=>(l.done(),$.reject(p)));r.push(d)}l.isDone?i():l.K===null?a.continue():a.continue(l.K)}}).next(()=>$.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Jo(t){return new $((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=s_(r.target.error);n(i)}})}let UE=!1;function s_(t){const e=ao.D(Ht());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new ne("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return UE||(UE=!0,setTimeout(()=>{throw r},0)),r}}return t}class YM{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){Q("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Q("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){So(n)?Q("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await Va(n)}await this.X(6e4)})}}class XM{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,s=!0;return $.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return Q("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(Q("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=aC(s);i_(o,r)>0&&(r=o)}),new lr(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Pr.oe=-1;function bp(t){return t==null}function eh(t){return t===0&&1/t==-1/0}function JM(t){return typeof t=="number"&&Number.isInteger(t)&&!eh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=$E(e)),e=ZM(t.get(n),e);return $E(e)}function ZM(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function $E(t){return t+""}function yi(t){const e=t.length;if(le(e>=2),e===2)return le(t.charAt(0)===""&&t.charAt(1)===""),Ge.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&ae(),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:ae()}s=o+2}return new Ge(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kd(t,e){return[t,mn(e)]}function hC(t,e,n){return[t,mn(e),n]}const eV={},tV=["prefixPath","collectionGroup","readTime","documentId"],nV=["prefixPath","collectionGroup","documentId"],rV=["collectionGroup","readTime","prefixPath","documentId"],iV=["canonicalId","targetId"],sV=["targetId","path"],oV=["path","targetId"],aV=["collectionId","parent"],lV=["indexId","uid"],uV=["uid","sequenceNumber"],cV=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],hV=["indexId","uid","orderedDocumentKey"],dV=["userId","collectionPath","documentId"],fV=["userId","collectionPath","largestBatchId"],pV=["userId","collectionGroup","largestBatchId"],dC=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],gV=[...dC,"documentOverlays"],fC=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],pC=fC,o_=[...pC,"indexConfiguration","indexState","indexEntries"],mV=o_,vV=[...o_,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv extends uC{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function Wt(t,e){const n=me(t);return ao.C(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function bo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function gC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e,n){this.comparator=e,this.root=n||nn.EMPTY}insert(e,n){return new pt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,nn.BLACK,null,null))}remove(e){return new pt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,nn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new _d(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new _d(this.root,e,this.comparator,!1)}getReverseIterator(){return new _d(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new _d(this.root,e,this.comparator,!0)}}class _d{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class nn{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??nn.RED,this.left=i??nn.EMPTY,this.right=s??nn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new nn(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return nn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return nn.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ae();const e=this.left.check();if(e!==this.right.check())throw ae();return e+(this.isRed()?0:1)}}nn.EMPTY=null,nn.RED=!0,nn.BLACK=!1;nn.EMPTY=new class{constructor(){this.size=0}get key(){throw ae()}get value(){throw ae()}get color(){throw ae()}get left(){throw ae()}get right(){throw ae()}copy(e,n,r,i,s){return this}insert(e,n,r){return new nn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.comparator=e,this.data=new pt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new qE(this.data.getIterator())}getIteratorFrom(e){return new qE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ye)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ye(this.comparator);return n.data=e,n}}class qE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ll(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e){this.fields=e,e.sort(vt.comparator)}static empty(){return new nr([])}unionWith(e){let n=new Ye(vt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new nr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Xl(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new mC("Invalid base64 string: "+s):s}}(e);return new Vt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Vt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return we(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Vt.EMPTY_BYTE_STRING=new Vt("");const yV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function es(t){if(le(!!t),typeof t=="string"){let e=0;const n=yV.exec(t);if(le(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:dt(t.seconds),nanos:dt(t.nanos)}}function dt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ts(t){return typeof t=="string"?Vt.fromBase64String(t):Vt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a_(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Cp(t){const e=t.mapValue.fields.__previous_value__;return a_(e)?Cp(e):e}function th(t){const e=es(t.mapValue.fields.__local_write_time__.timestampValue);return new _t(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _V{constructor(e,n,r,i,s,o,a,l,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=h}}class Ea{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Ea("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ea&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Gd={nullValue:"NULL_VALUE"};function po(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?a_(t)?4:vC(t)?9007199254740991:Ap(t)?10:11:ae()}function Si(t,e){if(t===e)return!0;const n=po(t);if(n!==po(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return th(t).isEqual(th(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=es(i.timestampValue),a=es(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ts(i.bytesValue).isEqual(ts(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return dt(i.geoPointValue.latitude)===dt(s.geoPointValue.latitude)&&dt(i.geoPointValue.longitude)===dt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return dt(i.integerValue)===dt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=dt(i.doubleValue),a=dt(s.doubleValue);return o===a?eh(o)===eh(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Xl(t.arrayValue.values||[],e.arrayValue.values||[],Si);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(BE(o)!==BE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Si(o[l],a[l])))return!1;return!0}(t,e);default:return ae()}}function nh(t,e){return(t.values||[]).find(n=>Si(n,e))!==void 0}function go(t,e){if(t===e)return 0;const n=po(t),r=po(e);if(n!==r)return we(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return we(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=dt(s.integerValue||s.doubleValue),l=dt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return HE(t.timestampValue,e.timestampValue);case 4:return HE(th(t),th(e));case 5:return we(t.stringValue,e.stringValue);case 6:return function(s,o){const a=ts(s),l=ts(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let h=0;h<a.length&&h<l.length;h++){const d=we(a[h],l[h]);if(d!==0)return d}return we(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=we(dt(s.latitude),dt(o.latitude));return a!==0?a:we(dt(s.longitude),dt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return WE(t.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,h,d;const p=s.fields||{},m=o.fields||{},w=(a=p.value)===null||a===void 0?void 0:a.arrayValue,E=(l=m.value)===null||l===void 0?void 0:l.arrayValue,x=we(((h=w==null?void 0:w.values)===null||h===void 0?void 0:h.length)||0,((d=E==null?void 0:E.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:WE(w,E)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Qs.mapValue&&o===Qs.mapValue)return 0;if(s===Qs.mapValue)return 1;if(o===Qs.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),h=o.fields||{},d=Object.keys(h);l.sort(),d.sort();for(let p=0;p<l.length&&p<d.length;++p){const m=we(l[p],d[p]);if(m!==0)return m;const w=go(a[l[p]],h[d[p]]);if(w!==0)return w}return we(l.length,d.length)}(t.mapValue,e.mapValue);default:throw ae()}}function HE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return we(t,e);const n=es(t),r=es(e),i=we(n.seconds,r.seconds);return i!==0?i:we(n.nanos,r.nanos)}function WE(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=go(n[i],r[i]);if(s)return s}return we(n.length,r.length)}function Jl(t){return vv(t)}function vv(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=es(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ts(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return te.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=vv(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${vv(n.fields[o])}`;return i+"}"}(t.mapValue):ae()}function Qd(t){switch(po(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Cp(t);return e?16+Qd(e):16;case 5:return 2*t.stringValue.length;case 6:return ts(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Qd(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return bo(r.fields,(s,o)=>{i+=s.length+Qd(o)}),i}(t.mapValue);default:throw ae()}}function l_(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function yv(t){return!!t&&"integerValue"in t}function rh(t){return!!t&&"arrayValue"in t}function KE(t){return!!t&&"nullValue"in t}function GE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yd(t){return!!t&&"mapValue"in t}function Ap(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Ic(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return bo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ic(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ic(t.arrayValue.values[n]);return e}return Object.assign({},t)}function vC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const yC={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function wV(t){return"nullValue"in t?Gd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?l_(Ea.empty(),te.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Ap(t)?yC:{mapValue:{}}:ae()}function EV(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?l_(Ea.empty(),te.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?yC:"mapValue"in t?Ap(t)?{mapValue:{}}:Qs:ae()}function QE(t,e){const n=go(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function YE(t,e){const n=go(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.value=e}static empty(){return new Cn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Yd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ic(n)}setAll(e){let n=vt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Ic(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Yd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Si(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Yd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){bo(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Cn(Ic(this.value))}}function _C(t){const e=[];return bo(t.fields,(n,r)=>{const i=new vt([n]);if(Yd(r)){const s=_C(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new nr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new St(e,0,ce.min(),ce.min(),ce.min(),Cn.empty(),0)}static newFoundDocument(e,n,r,i){return new St(e,1,n,ce.min(),r,i,0)}static newNoDocument(e,n){return new St(e,2,n,ce.min(),ce.min(),Cn.empty(),0)}static newUnknownDocument(e,n){return new St(e,3,n,ce.min(),ce.min(),Cn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ce.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Cn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Cn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof St&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new St(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e,n){this.position=e,this.inclusive=n}}function XE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=te.comparator(te.fromName(o.referenceValue),n.key):r=go(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function JE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Si(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e,n="asc"){this.field=e,this.dir=n}}function TV(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{}class Oe extends wC{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new IV(e,n,r):n==="array-contains"?new CV(e,r):n==="in"?new CC(e,r):n==="not-in"?new AV(e,r):n==="array-contains-any"?new xV(e,r):new Oe(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new SV(e,r):new bV(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(go(n,this.value)):n!==null&&po(this.value)===po(n)&&this.matchesComparison(go(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ae()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class tt extends wC{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new tt(e,n)}matches(e){return eu(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function eu(t){return t.op==="and"}function _v(t){return t.op==="or"}function u_(t){return EC(t)&&eu(t)}function EC(t){for(const e of t.filters)if(e instanceof tt)return!1;return!0}function wv(t){if(t instanceof Oe)return t.field.canonicalString()+t.op.toString()+Jl(t.value);if(u_(t))return t.filters.map(e=>wv(e)).join(",");{const e=t.filters.map(n=>wv(n)).join(",");return`${t.op}(${e})`}}function TC(t,e){return t instanceof Oe?function(r,i){return i instanceof Oe&&r.op===i.op&&r.field.isEqual(i.field)&&Si(r.value,i.value)}(t,e):t instanceof tt?function(r,i){return i instanceof tt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&TC(o,i.filters[a]),!0):!1}(t,e):void ae()}function IC(t,e){const n=t.filters.concat(e);return tt.create(n,t.op)}function SC(t){return t instanceof Oe?function(n){return`${n.field.canonicalString()} ${n.op} ${Jl(n.value)}`}(t):t instanceof tt?function(n){return n.op.toString()+" {"+n.getFilters().map(SC).join(" ,")+"}"}(t):"Filter"}class IV extends Oe{constructor(e,n,r){super(e,n,r),this.key=te.fromName(r.referenceValue)}matches(e){const n=te.comparator(e.key,this.key);return this.matchesComparison(n)}}class SV extends Oe{constructor(e,n){super(e,"in",n),this.keys=bC("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class bV extends Oe{constructor(e,n){super(e,"not-in",n),this.keys=bC("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function bC(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>te.fromName(r.referenceValue))}class CV extends Oe{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return rh(n)&&nh(n.arrayValue,this.value)}}class CC extends Oe{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&nh(this.value.arrayValue,n)}}class AV extends Oe{constructor(e,n){super(e,"not-in",n)}matches(e){if(nh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!nh(this.value.arrayValue,n)}}class xV extends Oe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!rh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>nh(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PV{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function Ev(t,e=null,n=[],r=[],i=null,s=null,o=null){return new PV(t,e,n,r,i,s,o)}function Ta(t){const e=me(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>wv(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),bp(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Jl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Jl(r)).join(",")),e.ue=n}return e.ue}function yh(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!TV(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!TC(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!JE(t.startAt,e.startAt)&&JE(t.endAt,e.endAt)}function Uf(t){return te.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function $f(t,e){return t.filters.filter(n=>n instanceof Oe&&n.field.isEqual(e))}function ZE(t,e,n){let r=Gd,i=!0;for(const s of $f(t,e)){let o=Gd,a=!0;switch(s.op){case"<":case"<=":o=wV(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Gd}QE({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];QE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function e1(t,e,n){let r=Qs,i=!0;for(const s of $f(t,e)){let o=Qs,a=!0;switch(s.op){case">=":case">":o=EV(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Qs}YE({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];YE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function kV(t,e,n,r,i,s,o,a){return new xp(t,e,n,r,i,s,o,a)}function _h(t){return new xp(t)}function t1(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function RV(t){return t.collectionGroup!==null}function Sc(t){const e=me(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ye(vt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(h=>{h.isInequality()&&(a=a.add(h.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Ff(s,r))}),n.has(vt.keyField().canonicalString())||e.ce.push(new Ff(vt.keyField(),r))}return e.ce}function Dr(t){const e=me(t);return e.le||(e.le=DV(e,Sc(t))),e.le}function DV(t,e){if(t.limitType==="F")return Ev(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Ff(i.field,s)});const n=t.endAt?new Zl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Zl(t.startAt.position,t.startAt.inclusive):null;return Ev(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Tv(t,e,n){return new xp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Pp(t,e){return yh(Dr(t),Dr(e))&&t.limitType===e.limitType}function AC(t){return`${Ta(Dr(t))}|lt:${t.limitType}`}function gl(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>SC(i)).join(", ")}]`),bp(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Jl(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Jl(i)).join(",")),`Target(${r})`}(Dr(t))}; limitType=${t.limitType})`}function wh(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):te.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Sc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const h=XE(o,a,l);return o.inclusive?h<=0:h<0}(r.startAt,Sc(r),i)||r.endAt&&!function(o,a,l){const h=XE(o,a,l);return o.inclusive?h>=0:h>0}(r.endAt,Sc(r),i))}(t,e)}function OV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function xC(t){return(e,n)=>{let r=!1;for(const i of Sc(t)){const s=NV(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function NV(t,e,n){const r=t.field.isKeyField()?te.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),h=a.data.field(s);return l!==null&&h!==null?go(l,h):ae()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ae()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){bo(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return gC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LV=new pt(te.comparator);function rr(){return LV}const PC=new pt(te.comparator);function oc(...t){let e=PC;for(const n of t)e=e.insert(n.key,n);return e}function kC(t){let e=PC;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function _i(){return bc()}function RC(){return bc()}function bc(){return new os(t=>t.toString(),(t,e)=>t.isEqual(e))}const MV=new pt(te.comparator),VV=new Ye(te.comparator);function xe(...t){let e=VV;for(const n of t)e=e.add(n);return e}const jV=new Ye(we);function FV(){return jV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:eh(e)?"-0":e}}function DC(t){return{integerValue:""+t}}function UV(t,e){return JM(e)?DC(e):c_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp{constructor(){this._=void 0}}function $V(t,e,n){return t instanceof tu?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&a_(s)&&(s=Cp(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Ia?NC(t,e):t instanceof nu?LC(t,e):function(i,s){const o=OC(i,s),a=n1(o)+n1(i.Pe);return yv(o)&&yv(i.Pe)?DC(a):c_(i.serializer,a)}(t,e)}function zV(t,e,n){return t instanceof Ia?NC(t,e):t instanceof nu?LC(t,e):n}function OC(t,e){return t instanceof ih?function(r){return yv(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class tu extends kp{}class Ia extends kp{constructor(e){super(),this.elements=e}}function NC(t,e){const n=MC(e);for(const r of t.elements)n.some(i=>Si(i,r))||n.push(r);return{arrayValue:{values:n}}}class nu extends kp{constructor(e){super(),this.elements=e}}function LC(t,e){let n=MC(e);for(const r of t.elements)n=n.filter(i=>!Si(i,r));return{arrayValue:{values:n}}}class ih extends kp{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function n1(t){return dt(t.integerValue||t.doubleValue)}function MC(t){return rh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e,n){this.field=e,this.transform=n}}function BV(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ia&&i instanceof Ia||r instanceof nu&&i instanceof nu?Xl(r.elements,i.elements,Si):r instanceof ih&&i instanceof ih?Si(r.Pe,i.Pe):r instanceof tu&&i instanceof tu}(t.transform,e.transform)}class qV{constructor(e,n){this.version=e,this.transformResults=n}}class An{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new An}static exists(e){return new An(void 0,e)}static updateTime(e){return new An(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Xd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Rp{}function VC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new d_(t.key,An.none()):new pu(t.key,t.data,An.none());{const n=t.data,r=Cn.empty();let i=new Ye(vt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new as(t.key,r,new nr(i.toArray()),An.none())}}function HV(t,e,n){t instanceof pu?function(i,s,o){const a=i.value.clone(),l=i1(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof as?function(i,s,o){if(!Xd(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=i1(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(jC(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Cc(t,e,n,r){return t instanceof pu?function(s,o,a,l){if(!Xd(s.precondition,o))return a;const h=s.value.clone(),d=s1(s.fieldTransforms,l,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof as?function(s,o,a,l){if(!Xd(s.precondition,o))return a;const h=s1(s.fieldTransforms,l,o),d=o.data;return d.setAll(jC(s)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(s,o,a){return Xd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function WV(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=OC(r.transform,i||null);s!=null&&(n===null&&(n=Cn.empty()),n.set(r.field,s))}return n||null}function r1(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Xl(r,i,(s,o)=>BV(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class pu extends Rp{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class as extends Rp{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function jC(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function i1(t,e,n){const r=new Map;le(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,zV(o,a,n[i]))}return r}function s1(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,$V(s,o,e))}return r}class d_ extends Rp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class FC extends Rp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&HV(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Cc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Cc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=RC();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=VC(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(ce.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),xe())}isEqual(e){return this.batchId===e.batchId&&Xl(this.mutations,e.mutations,(n,r)=>r1(n,r))&&Xl(this.baseMutations,e.baseMutations,(n,r)=>r1(n,r))}}class p_{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){le(e.mutations.length===r.length);let i=function(){return MV}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new p_(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ot,Ve;function GV(t){switch(t){default:return ae();case K.CANCELLED:case K.UNKNOWN:case K.DEADLINE_EXCEEDED:case K.RESOURCE_EXHAUSTED:case K.INTERNAL:case K.UNAVAILABLE:case K.UNAUTHENTICATED:return!1;case K.INVALID_ARGUMENT:case K.NOT_FOUND:case K.ALREADY_EXISTS:case K.PERMISSION_DENIED:case K.FAILED_PRECONDITION:case K.ABORTED:case K.OUT_OF_RANGE:case K.UNIMPLEMENTED:case K.DATA_LOSS:return!0}}function UC(t){if(t===void 0)return bn("GRPC error has no .code"),K.UNKNOWN;switch(t){case Ot.OK:return K.OK;case Ot.CANCELLED:return K.CANCELLED;case Ot.UNKNOWN:return K.UNKNOWN;case Ot.DEADLINE_EXCEEDED:return K.DEADLINE_EXCEEDED;case Ot.RESOURCE_EXHAUSTED:return K.RESOURCE_EXHAUSTED;case Ot.INTERNAL:return K.INTERNAL;case Ot.UNAVAILABLE:return K.UNAVAILABLE;case Ot.UNAUTHENTICATED:return K.UNAUTHENTICATED;case Ot.INVALID_ARGUMENT:return K.INVALID_ARGUMENT;case Ot.NOT_FOUND:return K.NOT_FOUND;case Ot.ALREADY_EXISTS:return K.ALREADY_EXISTS;case Ot.PERMISSION_DENIED:return K.PERMISSION_DENIED;case Ot.FAILED_PRECONDITION:return K.FAILED_PRECONDITION;case Ot.ABORTED:return K.ABORTED;case Ot.OUT_OF_RANGE:return K.OUT_OF_RANGE;case Ot.UNIMPLEMENTED:return K.UNIMPLEMENTED;case Ot.DATA_LOSS:return K.DATA_LOSS;default:return ae()}}(Ve=Ot||(Ot={}))[Ve.OK=0]="OK",Ve[Ve.CANCELLED=1]="CANCELLED",Ve[Ve.UNKNOWN=2]="UNKNOWN",Ve[Ve.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ve[Ve.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ve[Ve.NOT_FOUND=5]="NOT_FOUND",Ve[Ve.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ve[Ve.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ve[Ve.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ve[Ve.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ve[Ve.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ve[Ve.ABORTED=10]="ABORTED",Ve[Ve.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ve[Ve.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ve[Ve.INTERNAL=13]="INTERNAL",Ve[Ve.UNAVAILABLE=14]="UNAVAILABLE",Ve[Ve.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YV=new ua([4294967295,4294967295],0);function o1(t){const e=QV().encode(t),n=new Zb;return n.update(e),new Uint8Array(n.digest())}function a1(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ua([n,r],0),new ua([i,s],0)]}class m_{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ac(`Invalid padding: ${n}`);if(r<0)throw new ac(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ac(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ac(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ie=ua.fromNumber(this.Te)}Ee(e,n,r){let i=e.add(n.multiply(ua.fromNumber(r)));return i.compare(YV)===1&&(i=new ua([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ie).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const n=o1(e),[r,i]=a1(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new m_(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;const n=o1(e),[r,i]=a1(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ac extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Eh.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Dp(ce.min(),i,new pt(we),rr(),xe())}}class Eh{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Eh(r,n,xe(),xe(),xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class $C{constructor(e,n){this.targetId=e,this.me=n}}class zC{constructor(e,n,r=Vt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class l1{constructor(){this.fe=0,this.ge=u1(),this.pe=Vt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=xe(),n=xe(),r=xe();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ae()}}),new Eh(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=u1()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,le(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class XV{constructor(e){this.Le=e,this.Be=new Map,this.ke=rr(),this.qe=wd(),this.Qe=wd(),this.Ke=new pt(we)}$e(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(n,e.Ve):this.We(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.We(n,e.key,e.Ve)}Ge(e){this.forEachTarget(e,n=>{const r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.je(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.De(e.resumeToken));break;default:ae()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){const n=e.targetId,r=e.me.count,i=this.Ye(n);if(i){const s=i.target;if(Uf(s))if(r===0){const o=new te(s.path);this.We(n,o,St.newNoDocument(o,ce.min()))}else le(r===1);else{const o=this.Ze(n);if(o!==r){const a=this.Xe(e),l=a?this.et(a,e,o):1;if(l!==0){this.He(n);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,h)}}}}}Xe(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=ts(r).toUint8Array()}catch(l){if(l instanceof mC)return Yl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new m_(o,i,s)}catch(l){return Yl(l instanceof ac?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Te===0?null:a}et(e,n,r){return n.me.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){const n=new Map;this.Be.forEach((s,o)=>{const a=this.Ye(o);if(a){if(s.current&&Uf(a.target)){const l=new te(a.target.path);this.st(l).has(o)||this.ot(o,l)||this.We(o,l,St.newNoDocument(l,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=xe();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const h=this.Ye(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Dp(e,n,this.Ke,this.ke,r);return this.ke=rr(),this.qe=wd(),this.Qe=wd(),this.Ke=new pt(we),i}Ue(e,n){if(!this.je(e))return;const r=this.ot(e,n.key)?2:0;this.ze(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e)),this.Qe=this.Qe.insert(n.key,this._t(n.key).add(e))}We(e,n,r){if(!this.je(e))return;const i=this.ze(e);this.ot(e,n)?i.Fe(n,1):i.Me(n),this.Qe=this.Qe.insert(n,this._t(n).delete(e)),this.Qe=this.Qe.insert(n,this._t(n).add(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let n=this.Be.get(e);return n||(n=new l1,this.Be.set(e,n)),n}_t(e){let n=this.Qe.get(e);return n||(n=new Ye(we),this.Qe=this.Qe.insert(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Ye(we),this.qe=this.qe.insert(e,n)),n}je(e){const n=this.Ye(e)!==null;return n||Q("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ut(e)}He(e){this.Be.set(e,new l1),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}ot(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function wd(){return new pt(te.comparator)}function u1(){return new pt(te.comparator)}const JV={asc:"ASCENDING",desc:"DESCENDING"},ZV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},e5={and:"AND",or:"OR"};class t5{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Iv(t,e){return t.useProto3Json||bp(e)?e:{value:e}}function ru(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function BC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function n5(t,e){return ru(t,e.toTimestamp())}function Pn(t){return le(!!t),ce.fromTimestamp(function(n){const r=es(n);return new _t(r.seconds,r.nanos)}(t))}function v_(t,e){return Sv(t,e).canonicalString()}function Sv(t,e){const n=function(i){return new Ge(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function qC(t){const e=Ge.fromString(t);return le(ZC(e)),e}function zf(t,e){return v_(t.databaseId,e.path)}function ca(t,e){const n=qC(e);if(n.get(1)!==t.databaseId.projectId)throw new ne(K.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ne(K.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new te(KC(n))}function HC(t,e){return v_(t.databaseId,e)}function WC(t){const e=qC(t);return e.length===4?Ge.emptyPath():KC(e)}function bv(t){return new Ge(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function KC(t){return le(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function c1(t,e,n){return{name:zf(t,e),fields:n.value.mapValue.fields}}function r5(t,e,n){const r=ca(t,e.name),i=Pn(e.updateTime),s=e.createTime?Pn(e.createTime):ce.min(),o=new Cn({mapValue:{fields:e.fields}}),a=St.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function i5(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ae()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,d){return h.useProto3Json?(le(d===void 0||typeof d=="string"),Vt.fromBase64String(d||"")):(le(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Vt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(h){const d=h.code===void 0?K.UNKNOWN:UC(h.code);return new ne(d,h.message||"")}(o);n=new zC(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=ca(t,r.document.name),s=Pn(r.document.updateTime),o=r.document.createTime?Pn(r.document.createTime):ce.min(),a=new Cn({mapValue:{fields:r.document.fields}}),l=St.newFoundDocument(i,s,o,a),h=r.targetIds||[],d=r.removedTargetIds||[];n=new Jd(h,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=ca(t,r.document),s=r.readTime?Pn(r.readTime):ce.min(),o=St.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Jd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=ca(t,r.document),s=r.removedTargetIds||[];n=new Jd([],s,i,null)}else{if(!("filter"in e))return ae();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new KV(i,s),a=r.targetId;n=new $C(a,o)}}return n}function Bf(t,e){let n;if(e instanceof pu)n={update:c1(t,e.key,e.value)};else if(e instanceof d_)n={delete:zf(t,e.key)};else if(e instanceof as)n={update:c1(t,e.key,e.data),updateMask:c5(e.fieldMask)};else{if(!(e instanceof FC))return ae();n={verify:zf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof tu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ia)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof nu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ih)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw ae()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:n5(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ae()}(t,e.precondition)),n}function Cv(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?An.updateTime(Pn(s.updateTime)):s.exists!==void 0?An.exists(s.exists):An.none()}(e.currentDocument):An.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)le(a.setToServerValue==="REQUEST_TIME"),l=new tu;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];l=new Ia(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];l=new nu(d)}else"increment"in a?l=new ih(o,a.increment):ae();const h=vt.fromServerFormat(a.fieldPath);return new h_(h,l)}(t,i)):[];if(e.update){e.update.name;const i=ca(t,e.update.name),s=new Cn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const h=l.fieldPaths||[];return new nr(h.map(d=>vt.fromServerFormat(d)))}(e.updateMask);return new as(i,s,o,n,r)}return new pu(i,s,n,r)}if(e.delete){const i=ca(t,e.delete);return new d_(i,n)}if(e.verify){const i=ca(t,e.verify);return new FC(i,n)}return ae()}function s5(t,e){return t&&t.length>0?(le(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Pn(i.updateTime):Pn(s);return o.isEqual(ce.min())&&(o=Pn(s)),new qV(o,i.transformResults||[])}(n,e))):[]}function GC(t,e){return{documents:[HC(t,e.path)]}}function QC(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=HC(t,i);const s=function(h){if(h.length!==0)return JC(tt.create(h,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(h){if(h.length!==0)return h.map(d=>function(m){return{field:ml(m.field),direction:a5(m.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Iv(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ct:n,parent:i}}function YC(t){let e=WC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){le(r===1);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(p){const m=XC(p);return m instanceof tt&&u_(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(m=>function(E){return new Ff(vl(E.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,bp(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(p){const m=!!p.before,w=p.values||[];return new Zl(w,m)}(n.startAt));let h=null;return n.endAt&&(h=function(p){const m=!p.before,w=p.values||[];return new Zl(w,m)}(n.endAt)),kV(e,i,o,s,a,"F",l,h)}function o5(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ae()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function XC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=vl(n.unaryFilter.field);return Oe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=vl(n.unaryFilter.field);return Oe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=vl(n.unaryFilter.field);return Oe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=vl(n.unaryFilter.field);return Oe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ae()}}(t):t.fieldFilter!==void 0?function(n){return Oe.create(vl(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ae()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return tt.create(n.compositeFilter.filters.map(r=>XC(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ae()}}(n.compositeFilter.op))}(t):ae()}function a5(t){return JV[t]}function l5(t){return ZV[t]}function u5(t){return e5[t]}function ml(t){return{fieldPath:t.canonicalString()}}function vl(t){return vt.fromServerFormat(t.fieldPath)}function JC(t){return t instanceof Oe?function(n){if(n.op==="=="){if(GE(n.value))return{unaryFilter:{field:ml(n.field),op:"IS_NAN"}};if(KE(n.value))return{unaryFilter:{field:ml(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(GE(n.value))return{unaryFilter:{field:ml(n.field),op:"IS_NOT_NAN"}};if(KE(n.value))return{unaryFilter:{field:ml(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ml(n.field),op:l5(n.op),value:n.value}}}(t):t instanceof tt?function(n){const r=n.getFilters().map(i=>JC(i));return r.length===1?r[0]:{compositeFilter:{op:u5(n.op),filters:r}}}(t):ae()}function c5(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function ZC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e,n,r,i,s=ce.min(),o=ce.min(),a=Vt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new qi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new qi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(e){this.ht=e}}function h5(t,e){let n;if(e.document)n=r5(t.ht,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=te.fromSegments(e.noDocument.path),i=ba(e.noDocument.readTime);n=St.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return ae();{const r=te.fromSegments(e.unknownDocument.path),i=ba(e.unknownDocument.version);n=St.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new _t(i[0],i[1]);return ce.fromTimestamp(s)}(e.readTime)),n}function h1(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:qf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:zf(s,o.key),fields:o.data.value.mapValue.fields,updateTime:ru(s,o.version.toTimestamp()),createTime:ru(s,o.createTime.toTimestamp())}}(t.ht,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Sa(e.version)};else{if(!e.isUnknownDocument())return ae();r.unknownDocument={path:n.path.toArray(),version:Sa(e.version)}}return r}function qf(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Sa(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ba(t){const e=new _t(t.seconds,t.nanoseconds);return ce.fromTimestamp(e)}function Zo(t,e){const n=(e.baseMutations||[]).map(s=>Cv(t.ht,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Cv(t.ht,s)),i=_t.fromMillis(e.localWriteTimeMs);return new f_(e.batchId,i,n,r)}function lc(t){const e=ba(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?ba(t.lastLimboFreeSnapshotVersion):ce.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return le(s.documents.length===1),Dr(_h(WC(s.documents[0])))}(t.query):function(s){return Dr(YC(s))}(t.query),new qi(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Vt.fromBase64String(t.resumeToken))}function tA(t,e){const n=Sa(e.snapshotVersion),r=Sa(e.lastLimboFreeSnapshotVersion);let i;i=Uf(e.target)?GC(t.ht,e.target):QC(t.ht,e.target).ct;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ta(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function nA(t){const e=YC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Tv(e,e.limit,"L"):e}function Wg(t,e){return new g_(e.largestBatchId,Cv(t.ht,e.overlayMutation))}function d1(t,e){const n=e.path.lastSegment();return[t,mn(e.path.popLast()),n]}function f1(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Sa(r.readTime),documentKey:mn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d5{getBundleMetadata(e,n){return p1(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:ba(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return p1(e).put(function(i){return{bundleId:i.id,createTime:Sa(Pn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return g1(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:nA(s.bundledQuery),readTime:ba(s.readTime)}}(r)})}saveNamedQuery(e,n){return g1(e).put(function(i){return{name:i.name,readTime:Sa(Pn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function p1(t){return Wt(t,"bundles")}function g1(t){return Wt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(e,n){this.serializer=e,this.userId=n}static Pt(e,n){const r=n.uid||"";return new Op(e,r)}getOverlay(e,n){return Wu(e).get(d1(this.userId,n)).next(r=>r?Wg(this.serializer,r):null)}getOverlays(e,n){const r=_i();return $.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new g_(n,o);i.push(this.Tt(e,a))}),$.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(mn(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Wu(e).j("collectionPathOverlayIndex",a))}),$.waitFor(s)}getOverlaysForCollection(e,n,r){const i=_i(),s=mn(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Wu(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const h=Wg(this.serializer,l);i.set(h.getKey(),h)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=_i();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Wu(e).J({index:"collectionGroupOverlayIndex",range:a},(l,h,d)=>{const p=Wg(this.serializer,h);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):d.done()}).next(()=>s)}Tt(e,n){return Wu(e).put(function(i,s,o){const[a,l,h]=d1(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Bf(i.ht,o.mutation)}}(this.serializer,this.userId,n))}}function Wu(t){return Wt(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f5{It(e){return Wt(e,"globals")}getSessionToken(e){return this.It(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Vt.fromUint8Array(r):Vt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.It(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(){}Et(e,n){this.dt(e,n),n.At()}dt(e,n){if("nullValue"in e)this.Rt(n,5);else if("booleanValue"in e)this.Rt(n,10),n.Vt(e.booleanValue?1:0);else if("integerValue"in e)this.Rt(n,15),n.Vt(dt(e.integerValue));else if("doubleValue"in e){const r=dt(e.doubleValue);isNaN(r)?this.Rt(n,13):(this.Rt(n,15),eh(r)?n.Vt(0):n.Vt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Rt(n,20),typeof r=="string"&&(r=es(r)),n.ft(`${r.seconds||""}`),n.Vt(r.nanos||0)}else if("stringValue"in e)this.gt(e.stringValue,n),this.yt(n);else if("bytesValue"in e)this.Rt(n,30),n.wt(ts(e.bytesValue)),this.yt(n);else if("referenceValue"in e)this.St(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Rt(n,45),n.Vt(r.latitude||0),n.Vt(r.longitude||0)}else"mapValue"in e?vC(e)?this.Rt(n,Number.MAX_SAFE_INTEGER):Ap(e)?this.bt(e.mapValue,n):(this.Dt(e.mapValue,n),this.yt(n)):"arrayValue"in e?(this.vt(e.arrayValue,n),this.yt(n)):ae()}gt(e,n){this.Rt(n,25),this.Ct(e,n)}Ct(e,n){n.ft(e)}Dt(e,n){const r=e.fields||{};this.Rt(n,55);for(const i of Object.keys(r))this.gt(i,n),this.dt(r[i],n)}bt(e,n){var r,i;const s=e.fields||{};this.Rt(n,53);const o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Rt(n,15),n.Vt(dt(a)),this.gt(o,n),this.dt(s[o],n)}vt(e,n){const r=e.values||[];this.Rt(n,50);for(const i of r)this.dt(i,n)}St(e,n){this.Rt(n,37),te.fromName(e).path.forEach(r=>{this.Rt(n,60),this.Ct(r,n)})}Rt(e,n){e.Vt(n)}yt(e){e.Vt(2)}}ea.Ft=new ea;function p5(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function m1(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=p5(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class g5{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Mt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.xt(r.value),r=n.next();this.Ot()}Nt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Lt(r.value),r=n.next();this.Bt()}kt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.xt(r);else if(r<2048)this.xt(960|r>>>6),this.xt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.xt(480|r>>>12),this.xt(128|63&r>>>6),this.xt(128|63&r);else{const i=n.codePointAt(0);this.xt(240|i>>>18),this.xt(128|63&i>>>12),this.xt(128|63&i>>>6),this.xt(128|63&i)}}this.Ot()}qt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Lt(r);else if(r<2048)this.Lt(960|r>>>6),this.Lt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Lt(480|r>>>12),this.Lt(128|63&r>>>6),this.Lt(128|63&r);else{const i=n.codePointAt(0);this.Lt(240|i>>>18),this.Lt(128|63&i>>>12),this.Lt(128|63&i>>>6),this.Lt(128|63&i)}}this.Bt()}Qt(e){const n=this.Kt(e),r=m1(n);this.$t(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Ut(e){const n=this.Kt(e),r=m1(n);this.$t(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Wt(){this.Gt(255),this.Gt(255)}zt(){this.jt(255),this.jt(255)}reset(){this.position=0}seed(e){this.$t(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ht(){return this.buffer.slice(0,this.position)}Kt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}xt(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(n)}Lt(e){const n=255&e;n===0?(this.jt(0),this.jt(255)):n===255?(this.jt(255),this.jt(0)):this.jt(e)}Ot(){this.Gt(0),this.Gt(1)}Bt(){this.jt(0),this.jt(1)}Gt(e){this.$t(1),this.buffer[this.position++]=e}jt(e){this.$t(1),this.buffer[this.position++]=~e}$t(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class m5{constructor(e){this.Jt=e}wt(e){this.Jt.Mt(e)}ft(e){this.Jt.kt(e)}Vt(e){this.Jt.Qt(e)}At(){this.Jt.Wt()}}class v5{constructor(e){this.Jt=e}wt(e){this.Jt.Nt(e)}ft(e){this.Jt.qt(e)}Vt(e){this.Jt.Ut(e)}At(){this.Jt.zt()}}class Ku{constructor(){this.Jt=new g5,this.Yt=new m5(this.Jt),this.Zt=new v5(this.Jt)}seed(e){this.Jt.seed(e)}Xt(e){return e===0?this.Yt:this.Zt}Ht(){return this.Jt.Ht()}reset(){this.Jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}en(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new ta(this.indexId,this.documentKey,this.arrayValue,r)}}function Rs(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=v1(t.arrayValue,e.arrayValue),n!==0?n:(n=v1(t.directionalValue,e.directionalValue),n!==0?n:te.comparator(t.documentKey,e.documentKey)))}function v1(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e){this.tn=new Ye((n,r)=>vt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.nn=e.orderBy,this.rn=[];for(const n of e.filters){const r=n;r.isInequality()?this.tn=this.tn.add(r):this.rn.push(r)}}get sn(){return this.tn.size>1}on(e){if(le(e.collectionGroup===this.collectionId),this.sn)return!1;const n=gv(e);if(n!==void 0&&!this._n(n))return!1;const r=Xo(e);let i=new Set,s=0,o=0;for(;s<r.length&&this._n(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.tn.size>0){const a=this.tn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.an(a,l)||!this.un(this.nn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.nn.length||!this.un(this.nn[o++],a))return!1}return!0}cn(){if(this.sn)return null;let e=new Ye(vt.comparator);const n=[];for(const r of this.rn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Wd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Wd(r.field,0))}for(const r of this.nn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Wd(r.field,r.dir==="asc"?0:1)));return new jf(jf.UNKNOWN_ID,this.collectionId,n,Zc.empty())}_n(e){for(const n of this.rn)if(this.an(n,e))return!0;return!1}an(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}un(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rA(t){var e,n;if(le(t instanceof Oe||t instanceof tt),t instanceof Oe){if(t instanceof CC){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>Oe.create(t.field,"==",s)))||[];return tt.create(i,"or")}return t}const r=t.filters.map(i=>rA(i));return tt.create(r,t.op)}function y5(t){if(t.getFilters().length===0)return[];const e=Pv(rA(t));return le(iA(e)),Av(e)||xv(e)?[e]:e.getFilters()}function Av(t){return t instanceof Oe}function xv(t){return t instanceof tt&&u_(t)}function iA(t){return Av(t)||xv(t)||function(n){if(n instanceof tt&&_v(n)){for(const r of n.getFilters())if(!Av(r)&&!xv(r))return!1;return!0}return!1}(t)}function Pv(t){if(le(t instanceof Oe||t instanceof tt),t instanceof Oe)return t;if(t.filters.length===1)return Pv(t.filters[0]);const e=t.filters.map(r=>Pv(r));let n=tt.create(e,t.op);return n=Hf(n),iA(n)?n:(le(n instanceof tt),le(eu(n)),le(n.filters.length>1),n.filters.reduce((r,i)=>y_(r,i)))}function y_(t,e){let n;return le(t instanceof Oe||t instanceof tt),le(e instanceof Oe||e instanceof tt),n=t instanceof Oe?e instanceof Oe?function(i,s){return tt.create([i,s],"and")}(t,e):_1(t,e):e instanceof Oe?_1(e,t):function(i,s){if(le(i.filters.length>0&&s.filters.length>0),eu(i)&&eu(s))return IC(i,s.getFilters());const o=_v(i)?i:s,a=_v(i)?s:i,l=o.filters.map(h=>y_(h,a));return tt.create(l,"or")}(t,e),Hf(n)}function _1(t,e){if(eu(e))return IC(e,t.getFilters());{const n=e.filters.map(r=>y_(t,r));return tt.create(n,"or")}}function Hf(t){if(le(t instanceof Oe||t instanceof tt),t instanceof Oe)return t;const e=t.getFilters();if(e.length===1)return Hf(e[0]);if(EC(t))return t;const n=e.map(i=>Hf(i)),r=[];return n.forEach(i=>{i instanceof Oe?r.push(i):i instanceof tt&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:tt.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _5{constructor(){this.ln=new __}addToCollectionParentIndex(e,n){return this.ln.add(n),$.resolve()}getCollectionParents(e,n){return $.resolve(this.ln.getEntries(n))}addFieldIndex(e,n){return $.resolve()}deleteFieldIndex(e,n){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,n){return $.resolve()}getDocumentsMatchingTarget(e,n){return $.resolve(null)}getIndexType(e,n){return $.resolve(0)}getFieldIndexes(e,n){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,n){return $.resolve(lr.min())}getMinOffsetFromCollectionGroup(e,n){return $.resolve(lr.min())}updateCollectionGroup(e,n,r){return $.resolve()}updateIndexEntries(e,n){return $.resolve()}}class __{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ye(Ge.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ye(Ge.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ed=new Uint8Array(0);class w5{constructor(e,n){this.databaseId=n,this.hn=new __,this.Pn=new os(r=>Ta(r),(r,i)=>yh(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.hn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.hn.add(n)});const s={collectionId:r,parent:mn(i)};return w1(e).put(s)}return $.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[oC(n),""],!1,!0);return w1(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(yi(o.parent))}return r})}addFieldIndex(e,n){const r=Gu(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=cl(e);return s.next(a=>{o.put(f1(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Gu(e),i=cl(e),s=ul(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Gu(e),r=ul(e),i=cl(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return $.forEach(this.Tn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new y1(r).cn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=ul(e);let i=!0;const s=new Map;return $.forEach(this.Tn(n),o=>this.In(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=xe();const a=[];return $.forEach(s,(l,h)=>{Q("IndexedDbIndexManager",`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(M=>`${M.fieldPath}:${M.kind}`).join(",")}`}(l)} to execute ${Ta(n)}`);const d=function(S,M){const q=gv(M);if(q===void 0)return null;for(const W of $f(S,q.fieldPath))switch(W.op){case"array-contains-any":return W.value.arrayValue.values||[];case"array-contains":return[W.value]}return null}(h,l),p=function(S,M){const q=new Map;for(const W of Xo(M))for(const P of $f(S,W.fieldPath))switch(P.op){case"==":case"in":q.set(W.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return q.set(W.fieldPath.canonicalString(),P.value),Array.from(q.values())}return null}(h,l),m=function(S,M){const q=[];let W=!0;for(const P of Xo(M)){const C=P.kind===0?ZE(S,P.fieldPath,S.startAt):e1(S,P.fieldPath,S.startAt);q.push(C.value),W&&(W=C.inclusive)}return new Zl(q,W)}(h,l),w=function(S,M){const q=[];let W=!0;for(const P of Xo(M)){const C=P.kind===0?e1(S,P.fieldPath,S.endAt):ZE(S,P.fieldPath,S.endAt);q.push(C.value),W&&(W=C.inclusive)}return new Zl(q,W)}(h,l),E=this.En(l,h,m),x=this.En(l,h,w),D=this.dn(l,h,p),A=this.An(l.indexId,d,E,m.inclusive,x,w.inclusive,D);return $.forEach(A,T=>r.G(T,n.limit).next(S=>{S.forEach(M=>{const q=te.fromSegments(M.documentKey);o.has(q)||(o=o.add(q),a.push(q))})}))}).next(()=>a)}return $.resolve(null)})}Tn(e){let n=this.Pn.get(e);return n||(e.filters.length===0?n=[e]:n=y5(tt.create(e.filters,"and")).map(r=>Ev(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Pn.set(e,n),n)}An(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),h=l/(n!=null?n.length:1),d=[];for(let p=0;p<l;++p){const m=n?this.Rn(n[p/h]):Ed,w=this.Vn(e,m,r[p%h],i),E=this.mn(e,m,s[p%h],o),x=a.map(D=>this.Vn(e,m,D,!0));d.push(...this.createRange(w,E,x))}return d}Vn(e,n,r,i){const s=new ta(e,te.empty(),n,r);return i?s:s.en()}mn(e,n,r,i){const s=new ta(e,te.empty(),n,r);return i?s.en():s}In(e,n){const r=new y1(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.on(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Tn(n);return $.forEach(i,s=>this.In(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let h=new Ye(vt.comparator),d=!1;for(const p of l.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:h=h.add(m.field));for(const p of l.orderBy)p.field.isKeyField()||(h=h.add(p.field));return h.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}fn(e,n){const r=new Ku;for(const i of Xo(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Xt(i.kind);ea.Ft.Et(s,o)}return r.Ht()}Rn(e){const n=new Ku;return ea.Ft.Et(e,n.Xt(0)),n.Ht()}gn(e,n){const r=new Ku;return ea.Ft.Et(l_(this.databaseId,n),r.Xt(function(s){const o=Xo(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Ht()}dn(e,n,r){if(r===null)return[];let i=[];i.push(new Ku);let s=0;for(const o of Xo(e)){const a=r[s++];for(const l of i)if(this.pn(n,o.fieldPath)&&rh(a))i=this.yn(i,o,a);else{const h=l.Xt(o.kind);ea.Ft.Et(a,h)}}return this.wn(i)}En(e,n,r){return this.dn(e,n,r.position)}wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Ht();return n}yn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new Ku;l.seed(a.Ht()),ea.Ft.Et(o,l.Xt(n.kind)),s.push(l)}return s}pn(e,n){return!!e.filters.find(r=>r instanceof Oe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Gu(e),i=cl(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{const o=[];return $.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(d,p){const m=p?new Zc(p.sequenceNumber,new lr(ba(p.readTime),new te(yi(p.documentKey)),p.largestBatchId)):Zc.empty(),w=d.fields.map(([E,x])=>new Wd(vt.fromServerFormat(E),x));return new jf(d.indexId,d.collectionGroup,w,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:we(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Gu(e),s=cl(e);return this.Sn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>$.forEach(a,l=>s.put(f1(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return $.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?$.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),$.forEach(a,l=>this.bn(e,i,l).next(h=>{const d=this.Dn(s,l);return h.isEqual(d)?$.resolve():this.vn(e,s,l,h,d)}))))})}Cn(e,n,r,i){return ul(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.gn(r,n.key),documentKey:n.key.path.toArray()})}Fn(e,n,r,i){return ul(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.gn(r,n.key),n.key.path.toArray()])}bn(e,n,r){const i=ul(e);let s=new Ye(Rs);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.gn(r,n)])},(o,a)=>{s=s.add(new ta(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}Dn(e,n){let r=new Ye(Rs);const i=this.fn(n,e);if(i==null)return r;const s=gv(n);if(s!=null){const o=e.data.field(s.fieldPath);if(rh(o))for(const a of o.arrayValue.values||[])r=r.add(new ta(n.indexId,e.key,this.Rn(a),i))}else r=r.add(new ta(n.indexId,e.key,Ed,i));return r}vn(e,n,r,i,s){Q("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(l,h,d,p,m){const w=l.getIterator(),E=h.getIterator();let x=ll(w),D=ll(E);for(;x||D;){let A=!1,T=!1;if(x&&D){const S=d(x,D);S<0?T=!0:S>0&&(A=!0)}else x!=null?T=!0:A=!0;A?(p(D),D=ll(E)):T?(m(x),x=ll(w)):(x=ll(w),D=ll(E))}}(i,s,Rs,a=>{o.push(this.Cn(e,n,r,a))},a=>{o.push(this.Fn(e,n,r,a))}),$.waitFor(o)}Sn(e){let n=1;return cl(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Rs(o,a)).filter((o,a,l)=>!a||Rs(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Rs(o,e),l=Rs(o,n);if(a===0)i[0]=e.en();else if(a>0&&l<0)i.push(o),i.push(o.en());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Mn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Ed,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Ed,[]];s.push(IDBKeyRange.bound(a,l))}return s}Mn(e,n){return Rs(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(E1)}getMinOffset(e,n){return $.mapArray(this.Tn(n),r=>this.In(e,r).next(i=>i||ae())).next(E1)}}function w1(t){return Wt(t,"collectionParents")}function ul(t){return Wt(t,"indexEntries")}function Gu(t){return Wt(t,"indexConfiguration")}function cl(t){return Wt(t,"indexState")}function E1(t){le(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;i_(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new lr(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class pn{static withCacheSize(e){return new pn(e,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sA(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.J({range:o},(d,p,m)=>(a++,m.delete()));s.push(l.next(()=>{le(a===1)}));const h=[];for(const d of n.mutations){const p=hC(e,d.key.path,n.batchId);s.push(i.delete(p)),h.push(d.key)}return $.waitFor(s).next(()=>h)}function Wf(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ae();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pn.DEFAULT_COLLECTION_PERCENTILE=10,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pn.DEFAULT=new pn(41943040,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pn.DISABLED=new pn(-1,0,0);class Np{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.xn={}}static Pt(e,n,r,i){le(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Np(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ds(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=yl(e),o=Ds(e);return o.add({}).next(a=>{le(typeof a=="number");const l=new f_(a,n,r,i),h=function(w,E,x){const D=x.baseMutations.map(T=>Bf(w.ht,T)),A=x.mutations.map(T=>Bf(w.ht,T));return{userId:E,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:D,mutations:A}}(this.serializer,this.userId,l),d=[];let p=new Ye((m,w)=>we(m.canonicalString(),w.canonicalString()));for(const m of i){const w=hC(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),d.push(o.put(h)),d.push(s.put(w,eV))}return p.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.xn[a]=l.keys()}),$.waitFor(d).next(()=>l)})}lookupMutationBatch(e,n){return Ds(e).get(n).next(r=>r?(le(r.userId===this.userId),Zo(this.serializer,r)):null)}On(e,n){return this.xn[n]?$.resolve(this.xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ds(e).J({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(le(a.batchId>=r),s=Zo(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ds(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ds(e).U("userMutationsIndex",n).next(r=>r.map(i=>Zo(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Kd(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return yl(e).J({range:i},(o,a,l)=>{const[h,d,p]=o,m=yi(d);if(h===this.userId&&n.path.isEqual(m))return Ds(e).get(p).next(w=>{if(!w)throw ae();le(w.userId===this.userId),s.push(Zo(this.serializer,w))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ye(we);const i=[];return n.forEach(s=>{const o=Kd(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=yl(e).J({range:a},(h,d,p)=>{const[m,w,E]=h,x=yi(w);m===this.userId&&s.path.isEqual(x)?r=r.add(E):p.done()});i.push(l)}),$.waitFor(i).next(()=>this.Nn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Kd(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ye(we);return yl(e).J({range:o},(l,h,d)=>{const[p,m,w]=l,E=yi(m);p===this.userId&&r.isPrefixOf(E)?E.length===i&&(a=a.add(w)):d.done()}).next(()=>this.Nn(e,a))}Nn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Ds(e).get(s).next(o=>{if(o===null)throw ae();le(o.userId===this.userId),r.push(Zo(this.serializer,o))}))}),$.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return sA(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Ln(n.batchId)}),$.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Ln(e){delete this.xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return $.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return yl(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=yi(s[1]);i.push(l)}else a.done()}).next(()=>{le(i.length===0)})})}containsKey(e,n){return oA(e,this.userId,n)}Bn(e){return aA(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function oA(t,e,n){const r=Kd(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return yl(t).J({range:s,H:!0},(a,l,h)=>{const[d,p,m]=a;d===e&&p===i&&(o=!0),h.done()}).next(()=>o)}function Ds(t){return Wt(t,"mutations")}function yl(t){return Wt(t,"documentMutations")}function aA(t){return Wt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new Ca(0)}static Qn(){return new Ca(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Kn(e).next(n=>{const r=new Ca(n.highestTargetId);return n.highestTargetId=r.next(),this.$n(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Kn(e).next(n=>ce.fromTimestamp(new _t(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Kn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Kn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.$n(e,i)))}addTargetData(e,n){return this.Un(e,n).next(()=>this.Kn(e).next(r=>(r.targetCount+=1,this.Wn(n,r),this.$n(e,r))))}updateTargetData(e,n){return this.Un(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>hl(e).delete(n.targetId)).next(()=>this.Kn(e)).next(r=>(le(r.targetCount>0),r.targetCount-=1,this.$n(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return hl(e).J((o,a)=>{const l=lc(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>$.waitFor(s)).next(()=>i)}forEachTarget(e,n){return hl(e).J((r,i)=>{const s=lc(i);n(s)})}Kn(e){return I1(e).get("targetGlobalKey").next(n=>(le(n!==null),n))}$n(e,n){return I1(e).put("targetGlobalKey",n)}Un(e,n){return hl(e).put(tA(this.serializer,n))}Wn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Kn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Ta(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return hl(e).J({range:i,index:"queryTargetsIndex"},(o,a,l)=>{const h=lc(a);yh(n,h.target)&&(s=h,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=qs(e);return n.forEach(o=>{const a=mn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),$.waitFor(i)}removeMatchingKeys(e,n,r){const i=qs(e);return $.forEach(n,s=>{const o=mn(s.path);return $.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=qs(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=qs(e);let s=xe();return i.J({range:r,H:!0},(o,a,l)=>{const h=yi(o[1]),d=new te(h);s=s.add(d)}).next(()=>s)}containsKey(e,n){const r=mn(n.path),i=IDBKeyRange.bound([r],[oC(r)],!1,!0);let s=0;return qs(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],l,h)=>{o!==0&&(s++,h.done())}).next(()=>s>0)}ut(e,n){return hl(e).get(n).next(r=>r?lc(r):null)}}function hl(t){return Wt(t,"targets")}function I1(t){return Wt(t,"targetGlobal")}function qs(t){return Wt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S1([t,e],[n,r]){const i=we(t,n);return i===0?we(e,r):i}class T5{constructor(e){this.Gn=e,this.buffer=new Ye(S1),this.zn=0}jn(){return++this.zn}Hn(e){const n=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();S1(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class lA{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){Q("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){So(n)?Q("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Va(n)}await this.Yn(3e5)})}}class I5{constructor(e,n){this.Zn=e,this.params=n}calculateTargetCount(e,n){return this.Zn.Xn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return $.resolve(Pr.oe);const r=new T5(n);return this.Zn.forEachTarget(e,i=>r.Hn(i.sequenceNumber)).next(()=>this.Zn.er(e,i=>r.Hn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Zn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Q("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(T1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),T1):this.tr(e,n))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,n){let r,i,s,o,a,l,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(Q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,n))).next(p=>(s=p,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(h=Date.now(),pl()<=Re.DEBUG&&Q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${p} documents in `+(h-l)+`ms
Total Duration: ${h-d}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}function uA(t,e){return new I5(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(e,n){this.db=e,this.garbageCollector=uA(this,n)}Xn(e){const n=this.nr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}nr(e){let n=0;return this.er(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}er(e,n){return this.rr(e,(r,i)=>n(i))}addReference(e,n,r){return Td(e,r)}removeReference(e,n,r){return Td(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Td(e,n)}ir(e,n){return function(i,s){let o=!1;return aA(i).Y(a=>oA(i,a,s).next(l=>(l&&(o=!0),$.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.rr(e,(o,a)=>{if(a<=n){const l=this.ir(e,o).next(h=>{if(!h)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ce.min()),qs(e).delete(function(p){return[0,mn(p.path)]}(o))))});i.push(l)}}).next(()=>$.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Td(e,n)}rr(e,n){const r=qs(e);let i,s=Pr.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:h})=>{o===0?(s!==Pr.oe&&n(new te(yi(i)),s),s=h,i=l):s=Pr.oe}).next(()=>{s!==Pr.oe&&n(new te(yi(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Td(t,e){return qs(t).put(function(r,i){return{targetId:0,path:mn(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(){this.changes=new os(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,St.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?$.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b5{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ko(e).put(r)}removeEntry(e,n,r){return Ko(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],qf(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.sr(e,r)))}getEntry(e,n){let r=St.newInvalidDocument(n);return Ko(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Qu(n))},(i,s)=>{r=this._r(n,s)}).next(()=>r)}ar(e,n){let r={size:0,document:St.newInvalidDocument(n)};return Ko(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Qu(n))},(i,s)=>{r={document:this._r(n,s),size:Wf(s)}}).next(()=>r)}getEntries(e,n){let r=rr();return this.ur(e,n,(i,s)=>{const o=this._r(i,s);r=r.insert(i,o)}).next(()=>r)}cr(e,n){let r=rr(),i=new pt(te.comparator);return this.ur(e,n,(s,o)=>{const a=this._r(s,o);r=r.insert(s,a),i=i.insert(s,Wf(o))}).next(()=>({documents:r,lr:i}))}ur(e,n,r){if(n.isEmpty())return $.resolve();let i=new Ye(A1);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(Qu(i.first()),Qu(i.last())),o=i.getIterator();let a=o.getNext();return Ko(e).J({index:"documentKeyIndex",range:s},(l,h,d)=>{const p=te.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;a&&A1(a,p)<0;)r(a,null),a=o.getNext();a&&a.isEqual(p)&&(r(a,h),a=o.hasNext()?o.getNext():null),a?d.$(Qu(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),qf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ko(e).U(IDBKeyRange.bound(a,l,!0)).next(h=>{s==null||s.incrementDocumentReadCount(h.length);let d=rr();for(const p of h){const m=this._r(te.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(wh(n,m)||i.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,n,r,i){let s=rr();const o=C1(n,r),a=C1(n,lr.max());return Ko(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,h,d)=>{const p=this._r(te.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(p.key,p),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new C5(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return b1(e).get("remoteDocumentGlobalKey").next(n=>(le(!!n),n))}sr(e,n){return b1(e).put("remoteDocumentGlobalKey",n)}_r(e,n){if(n){const r=h5(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(ce.min())))return r}return St.newInvalidDocument(e)}}function hA(t){return new b5(t)}class C5 extends cA{constructor(e,n){super(),this.hr=e,this.trackRemovals=n,this.Pr=new os(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ye((s,o)=>we(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Pr.get(s);if(n.push(this.hr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=h1(this.hr.serializer,o);i=i.add(s.path.popLast());const h=Wf(l);r+=h-a.size,n.push(this.hr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=h1(this.hr.serializer,o.convertToNoDocument(ce.min()));n.push(this.hr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.hr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.hr.updateMetadata(e,r)),$.waitFor(n)}getFromCache(e,n){return this.hr.ar(e,n).next(r=>(this.Pr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.hr.cr(e,n).next(({documents:r,lr:i})=>(i.forEach((s,o)=>{this.Pr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function b1(t){return Wt(t,"remoteDocumentGlobal")}function Ko(t){return Wt(t,"remoteDocumentsV14")}function Qu(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function C1(t,e){const n=e.documentKey.path.toArray();return[t,qf(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function A1(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=we(n[s],r[s]),i)return i;return i=we(n.length,r.length),i||(i=we(n[n.length-2],r[r.length-2]),i||we(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A5{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Cc(r.mutation,i,nr.empty(),_t.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,xe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=xe()){const i=_i();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=oc();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=_i();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,xe()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=rr();const o=bc(),a=function(){return bc()}();return n.forEach((l,h)=>{const d=r.get(h.key);i.has(h.key)&&(d===void 0||d.mutation instanceof as)?s=s.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),Cc(d.mutation,h,d.mutation.getFieldMask(),_t.now())):o.set(h.key,nr.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((h,d)=>o.set(h,d)),n.forEach((h,d)=>{var p;return a.set(h,new A5(d,(p=o.get(h))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,n){const r=bc();let i=new pt((o,a)=>o-a),s=xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const h=n.get(l);if(h===null)return;let d=r.get(l)||nr.empty();d=a.applyToLocalView(h,d),r.set(l,d);const p=(i.get(a.batchId)||xe()).add(l);i=i.insert(a.batchId,p)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),h=l.key,d=l.value,p=RC();d.forEach(m=>{if(!s.has(m)){const w=VC(n.get(m),r.get(m));w!==null&&p.set(m,w),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,p))}return $.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return te.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):RV(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):$.resolve(_i());let a=-1,l=s;return o.next(h=>$.forEach(h,(d,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(d)?$.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{l=l.insert(d,m)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,l,h,xe())).next(d=>({batchId:a,changes:kC(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new te(n)).next(r=>{let i=oc();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=oc();return this.indexManager.getCollectionParents(e,s).next(a=>$.forEach(a,l=>{const h=function(p,m){return new xp(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(d=>{d.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,St.newInvalidDocument(d)))});let a=oc();return o.forEach((l,h)=>{const d=s.get(l);d!==void 0&&Cc(d.mutation,h,nr.empty(),_t.now()),wh(n,h)&&(a=a.insert(l,h))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,n){return $.resolve(this.Tr.get(n))}saveBundleMetadata(e,n){return this.Tr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Pn(i.createTime)}}(n)),$.resolve()}getNamedQuery(e,n){return $.resolve(this.Ir.get(n))}saveNamedQuery(e,n){return this.Ir.set(n.name,function(i){return{name:i.name,query:nA(i.bundledQuery),readTime:Pn(i.readTime)}}(n)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P5{constructor(){this.overlays=new pt(te.comparator),this.Er=new Map}getOverlay(e,n){return $.resolve(this.overlays.get(n))}getOverlays(e,n){const r=_i();return $.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.Tt(e,n,s)}),$.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Er.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Er.delete(r)),$.resolve()}getOverlaysForCollection(e,n,r){const i=_i(),s=n.length+1,o=new te(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,h=l.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return $.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new pt((h,d)=>h-d);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let d=s.get(h.largestBatchId);d===null&&(d=_i(),s=s.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const a=_i(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((h,d)=>a.set(h,d)),!(a.size()>=i)););return $.resolve(a)}Tt(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Er.get(i.largestBatchId).delete(r.key);this.Er.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new g_(n,r));let s=this.Er.get(n);s===void 0&&(s=xe(),this.Er.set(n,s)),this.Er.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k5{constructor(){this.sessionToken=Vt.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(){this.dr=new Ye(Xt.Ar),this.Rr=new Ye(Xt.Vr)}isEmpty(){return this.dr.isEmpty()}addReference(e,n){const r=new Xt(e,n);this.dr=this.dr.add(r),this.Rr=this.Rr.add(r)}mr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.gr(new Xt(e,n))}pr(e,n){e.forEach(r=>this.removeReference(r,n))}yr(e){const n=new te(new Ge([])),r=new Xt(n,e),i=new Xt(n,e+1),s=[];return this.Rr.forEachInRange([r,i],o=>{this.gr(o),s.push(o.key)}),s}wr(){this.dr.forEach(e=>this.gr(e))}gr(e){this.dr=this.dr.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){const n=new te(new Ge([])),r=new Xt(n,e),i=new Xt(n,e+1);let s=xe();return this.Rr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Xt(e,0),r=this.dr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Xt{constructor(e,n){this.key=e,this.br=n}static Ar(e,n){return te.comparator(e.key,n.key)||we(e.br,n.br)}static Vr(e,n){return we(e.br,n.br)||te.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R5{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Dr=1,this.vr=new Ye(Xt.Ar)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new f_(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.vr=this.vr.add(new Xt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return $.resolve(o)}lookupMutationBatch(e,n){return $.resolve(this.Cr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.Fr(r),s=i<0?0:i;return $.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Xt(n,0),i=new Xt(n,Number.POSITIVE_INFINITY),s=[];return this.vr.forEachInRange([r,i],o=>{const a=this.Cr(o.br);s.push(a)}),$.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ye(we);return n.forEach(i=>{const s=new Xt(i,0),o=new Xt(i,Number.POSITIVE_INFINITY);this.vr.forEachInRange([s,o],a=>{r=r.add(a.br)})}),$.resolve(this.Mr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;te.isDocumentKey(s)||(s=s.child(""));const o=new Xt(new te(s),0);let a=new Ye(we);return this.vr.forEachWhile(l=>{const h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(a=a.add(l.br)),!0)},o),$.resolve(this.Mr(a))}Mr(e){const n=[];return e.forEach(r=>{const i=this.Cr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){le(this.Or(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.vr;return $.forEach(n.mutations,i=>{const s=new Xt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.vr=r})}Ln(e){}containsKey(e,n){const r=new Xt(n,0),i=this.vr.firstAfterOrEqual(r);return $.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}Or(e,n){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){const n=this.Fr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D5{constructor(e){this.Nr=e,this.docs=function(){return new pt(te.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Nr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return $.resolve(r?r.document.mutableCopy():St.newInvalidDocument(n))}getEntries(e,n){let r=rr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():St.newInvalidDocument(i))}),$.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=rr();const o=n.path,a=new te(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:h,value:{document:d}}=l.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||i_(aC(d),r)<=0||(i.has(d.key)||wh(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return $.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ae()}Lr(e,n){return $.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new O5(this)}getSize(e){return $.resolve(this.size)}}class O5 extends cA{constructor(e){super(),this.hr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.hr.addEntry(e,i)):this.hr.removeEntry(r)}),$.waitFor(n)}getFromCache(e,n){return this.hr.getEntry(e,n)}getAllFromCache(e,n){return this.hr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N5{constructor(e){this.persistence=e,this.Br=new os(n=>Ta(n),yh),this.lastRemoteSnapshotVersion=ce.min(),this.highestTargetId=0,this.kr=0,this.qr=new w_,this.targetCount=0,this.Qr=Ca.qn()}forEachTarget(e,n){return this.Br.forEach((r,i)=>n(i)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.kr&&(this.kr=n),$.resolve()}Un(e){this.Br.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Qr=new Ca(n),this.highestTargetId=n),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,n){return this.Un(n),this.targetCount+=1,$.resolve()}updateTargetData(e,n){return this.Un(n),$.resolve()}removeTargetData(e,n){return this.Br.delete(n.target),this.qr.yr(n.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Br.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Br.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),$.waitFor(s).next(()=>i)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,n){const r=this.Br.get(n)||null;return $.resolve(r)}addMatchingKeys(e,n,r){return this.qr.mr(n,r),$.resolve()}removeMatchingKeys(e,n,r){this.qr.pr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),$.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.qr.yr(n),$.resolve()}getMatchingKeysForTargetId(e,n){const r=this.qr.Sr(n);return $.resolve(r)}containsKey(e,n){return $.resolve(this.qr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(e,n){this.Kr={},this.overlays={},this.$r=new Pr(0),this.Ur=!1,this.Ur=!0,this.Wr=new k5,this.referenceDelegate=e(this),this.Gr=new N5(this),this.indexManager=new _5,this.remoteDocumentCache=function(i){return new D5(i)}(r=>this.referenceDelegate.zr(r)),this.serializer=new eA(n),this.jr=new x5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new P5,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Kr[e.toKey()];return r||(r=new R5(n,this.referenceDelegate),this.Kr[e.toKey()]=r),r}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,n,r){Q("MemoryPersistence","Starting transaction:",e);const i=new L5(this.$r.next());return this.referenceDelegate.Hr(),r(i).next(s=>this.referenceDelegate.Jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Yr(e,n){return $.or(Object.values(this.Kr).map(r=>()=>r.containsKey(e,n)))}}class L5 extends uC{constructor(e){super(),this.currentSequenceNumber=e}}class Lp{constructor(e){this.persistence=e,this.Zr=new w_,this.Xr=null}static ei(e){return new Lp(e)}get ti(){if(this.Xr)return this.Xr;throw ae()}addReference(e,n,r){return this.Zr.addReference(r,n),this.ti.delete(r.toString()),$.resolve()}removeReference(e,n,r){return this.Zr.removeReference(r,n),this.ti.add(r.toString()),$.resolve()}markPotentiallyOrphaned(e,n){return this.ti.add(n.toString()),$.resolve()}removeTarget(e,n){this.Zr.yr(n.targetId).forEach(i=>this.ti.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.ti.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Hr(){this.Xr=new Set}Jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.ti,r=>{const i=te.fromPath(r);return this.ni(e,i).next(s=>{s||n.removeEntry(i,ce.min())})}).next(()=>(this.Xr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ni(e,n).next(r=>{r?this.ti.delete(n.toString()):this.ti.add(n.toString())})}zr(e){return 0}ni(e,n){return $.or([()=>$.resolve(this.Zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Yr(e,n)])}}class Kf{constructor(e,n){this.persistence=e,this.ri=new os(r=>mn(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=uA(this,n)}static ei(e,n){return new Kf(e,n)}Hr(){}Jr(e){return $.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}Xn(e){const n=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}nr(e){let n=0;return this.er(e,r=>{n++}).next(()=>n)}er(e,n){return $.forEach(this.ri,(r,i)=>this.ir(e,r,i).next(s=>s?$.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.Lr(e,o=>this.ir(e,o,n).next(a=>{a||(r++,s.removeEntry(o,ce.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.ri.set(n,e.currentSequenceNumber),$.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.ri.set(r,e.currentSequenceNumber),$.resolve()}removeReference(e,n,r){return this.ri.set(r,e.currentSequenceNumber),$.resolve()}updateLimboDocument(e,n){return this.ri.set(n,e.currentSequenceNumber),$.resolve()}zr(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Qd(e.data.value)),n}ir(e,n,r){return $.or([()=>this.persistence.Yr(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.ri.get(n);return $.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M5{constructor(e){this.serializer=e}O(e,n,r,i){const s=new Sp("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",zE,{unique:!0}),l.createObjectStore("documentMutations")}(e),x1(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=$.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),x1(e)),o=o.next(()=>function(l){const h=l.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ce.min().toTimestamp(),targetCount:0};return h.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,h){return h.store("mutations").U().next(d=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",zE,{unique:!0});const p=h.store("mutations"),m=d.map(w=>p.put(w));return $.waitFor(m)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ii(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.si(s)))),r<7&&i>=7&&(o=o.next(()=>this.oi(s))),r<8&&i>=8&&(o=o.next(()=>this._i(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ai(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const h=l.createObjectStore("documentOverlays",{keyPath:dV});h.createIndex("collectionPathOverlayIndex",fV,{unique:!1}),h.createIndex("collectionGroupOverlayIndex",pV,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const h=l.createObjectStore("remoteDocumentsV14",{keyPath:tV});h.createIndex("documentKeyIndex",nV),h.createIndex("collectionGroupIndex",rV)}(e)).next(()=>this.ui(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ci(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:lV}).createIndex("sequenceNumberIndex",uV,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:cV}).createIndex("documentKeyIndex",hV,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}si(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=Wf(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ii(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>$.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>$.forEach(a,l=>{le(l.userId===s.userId);const h=Zo(this.serializer,l);return sA(e,s.userId,h).next(()=>{})}))}))}oi(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,a)=>{const l=new Ge(o),h=function(p){return[0,mn(p)]}(l);s.push(n.get(h).next(d=>d?$.resolve():(p=>n.put({targetId:0,path:mn(p),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>$.waitFor(s))})}_i(e,n){e.createObjectStore("collectionParents",{keyPath:aV});const r=n.store("collectionParents"),i=new __,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:mn(l)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new Ge(o);return s(l.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,l],h)=>{const d=yi(a);return s(d.popLast())}))}ai(e){const n=e.store("targets");return n.J((r,i)=>{const s=lc(i),o=tA(this.serializer,s);return n.put(o)})}ui(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{const a=n.store("remoteDocumentsV14"),l=function(p){return p.document?new te(Ge.fromString(p.document.name).popFirst(5)):p.noDocument?te.fromSegments(p.noDocument.path):p.unknownDocument?te.fromSegments(p.unknownDocument.path):ae()}(o).path.toArray(),h={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(h))}).next(()=>$.waitFor(i))}ci(e,n){const r=n.store("mutations"),i=hA(this.serializer),s=new E_(Lp.ei,this.serializer.ht);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var h;let d=(h=a.get(l.userId))!==null&&h!==void 0?h:xe();Zo(this.serializer,l).keys().forEach(p=>d=d.add(p)),a.set(l.userId,d)}),$.forEach(a,(l,h)=>{const d=new Sn(h),p=Op.Pt(this.serializer,d),m=s.getIndexManager(d),w=Np.Pt(d,this.serializer,m,s.referenceDelegate);return new dA(i,w,p,m).recalculateAndSaveOverlaysForDocumentKeys(new mv(n,Pr.oe),l).next()})})}}function x1(t){t.createObjectStore("targetDocuments",{keyPath:sV}).createIndex("documentTargetsIndex",oV,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",iV,{unique:!0}),t.createObjectStore("targetGlobal")}const Kg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class T_{constructor(e,n,r,i,s,o,a,l,h,d,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.li=s,this.window=o,this.document=a,this.hi=h,this.Pi=d,this.Ti=p,this.$r=null,this.Ur=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ii=null,this.inForeground=!1,this.Ei=null,this.di=null,this.Ai=Number.NEGATIVE_INFINITY,this.Ri=m=>Promise.resolve(),!T_.p())throw new ne(K.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new S5(this,i),this.Vi=n+"main",this.serializer=new eA(l),this.mi=new ao(this.Vi,this.Ti,new M5(this.serializer)),this.Wr=new f5,this.Gr=new E5(this.referenceDelegate,this.serializer),this.remoteDocumentCache=hA(this.serializer),this.jr=new d5,this.window&&this.window.localStorage?this.fi=this.window.localStorage:(this.fi=null,d===!1&&bn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ne(K.FAILED_PRECONDITION,Kg);return this.pi(),this.yi(),this.wi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Gr.getHighestSequenceNumber(e))}).then(e=>{this.$r=new Pr(e,this.hi)}).then(()=>{this.Ur=!0}).catch(e=>(this.mi&&this.mi.close(),Promise.reject(e)))}Si(e){return this.Ri=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.mi.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.li.enqueueAndForget(async()=>{this.started&&await this.gi()}))}gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Id(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.bi(e).next(n=>{n||(this.isPrimary=!1,this.li.enqueueRetryable(()=>this.Ri(!1)))})}).next(()=>this.Di(e)).next(n=>this.isPrimary&&!n?this.vi(e).next(()=>!1):!!n&&this.Ci(e).next(()=>!0))).catch(e=>{if(So(e))return Q("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Q("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.li.enqueueRetryable(()=>this.Ri(e)),this.isPrimary=e})}bi(e){return Yu(e).get("owner").next(n=>$.resolve(this.Fi(n)))}Mi(e){return Id(e).delete(this.clientId)}async xi(){if(this.isPrimary&&!this.Oi(this.Ai,18e5)){this.Ai=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Wt(n,"clientMetadata");return r.U().next(i=>{const s=this.Ni(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return $.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.fi)for(const n of e)this.fi.removeItem(this.Li(n.clientId))}}wi(){this.di=this.li.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.gi().then(()=>this.xi()).then(()=>this.wi()))}Fi(e){return!!e&&e.ownerId===this.clientId}Di(e){return this.Pi?$.resolve(!0):Yu(e).get("owner").next(n=>{if(n!==null&&this.Oi(n.leaseTimestampMs,5e3)&&!this.Bi(n.ownerId)){if(this.Fi(n)&&this.networkEnabled)return!0;if(!this.Fi(n)){if(!n.allowTabSynchronization)throw new ne(K.FAILED_PRECONDITION,Kg);return!1}}return!(!this.networkEnabled||!this.inForeground)||Id(e).U().next(r=>this.Ni(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&Q("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Ur=!1,this.ki(),this.di&&(this.di.cancel(),this.di=null),this.qi(),this.Qi(),await this.mi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new mv(e,Pr.oe);return this.vi(n).next(()=>this.Mi(n))}),this.mi.close(),this.Ki()}Ni(e,n){return e.filter(r=>this.Oi(r.updateTimeMs,n)&&!this.Bi(r.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>Id(e).U().next(n=>this.Ni(n,18e5).map(r=>r.clientId)))}get started(){return this.Ur}getGlobalsCache(){return this.Wr}getMutationQueue(e,n){return Np.Pt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new w5(e,this.serializer.ht.databaseId)}getDocumentOverlayCache(e){return Op.Pt(this.serializer,e)}getBundleCache(){return this.jr}runTransaction(e,n,r){Q("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===17?vV:l===16?mV:l===15?o_:l===14?pC:l===13?fC:l===12?gV:l===11?dC:void ae()}(this.Ti);let o;return this.mi.runTransaction(e,i,s,a=>(o=new mv(a,this.$r?this.$r.next():Pr.oe),n==="readwrite-primary"?this.bi(o).next(l=>!!l||this.Di(o)).next(l=>{if(!l)throw bn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.li.enqueueRetryable(()=>this.Ri(!1)),new ne(K.FAILED_PRECONDITION,lC);return r(o)}).next(l=>this.Ci(o).next(()=>l)):this.Ui(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ui(e){return Yu(e).get("owner").next(n=>{if(n!==null&&this.Oi(n.leaseTimestampMs,5e3)&&!this.Bi(n.ownerId)&&!this.Fi(n)&&!(this.Pi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ne(K.FAILED_PRECONDITION,Kg)})}Ci(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Yu(e).put("owner",n)}static p(){return ao.p()}vi(e){const n=Yu(e);return n.get("owner").next(r=>this.Fi(r)?(Q("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):$.resolve())}Oi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(bn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}pi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ei=()=>{this.li.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.gi()))},this.document.addEventListener("visibilitychange",this.Ei),this.inForeground=this.document.visibilityState==="visible")}qi(){this.Ei&&(this.document.removeEventListener("visibilitychange",this.Ei),this.Ei=null)}yi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ii=()=>{this.ki();const n=/(?:Version|Mobile)\/1[456]/;ob()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.li.enterRestrictedMode(!0),this.li.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ii))}Qi(){this.Ii&&(this.window.removeEventListener("pagehide",this.Ii),this.Ii=null)}Bi(e){var n;try{const r=((n=this.fi)===null||n===void 0?void 0:n.getItem(this.Li(e)))!==null;return Q("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return bn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}ki(){if(this.fi)try{this.fi.setItem(this.Li(this.clientId),String(Date.now()))}catch(e){bn("Failed to set zombie client id.",e)}}Ki(){if(this.fi)try{this.fi.removeItem(this.Li(this.clientId))}catch{}}Li(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Yu(t){return Wt(t,"owner")}function Id(t){return Wt(t,"clientMetadata")}function V5(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Wi=r,this.Gi=i}static zi(e,n){let r=xe(),i=xe();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new I_(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return ob()?8:cC(Ht())>0?6:4}()}initialize(e,n){this.Zi=e,this.indexManager=n,this.ji=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Xi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.es(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new j5;return this.ts(e,n,o).next(a=>{if(s.result=a,this.Hi)return this.ns(e,n,o,a.size)})}).next(()=>s.result)}ns(e,n,r,i){return r.documentReadCount<this.Ji?(pl()<=Re.DEBUG&&Q("QueryEngine","SDK will not create cache indexes for query:",gl(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),$.resolve()):(pl()<=Re.DEBUG&&Q("QueryEngine","Query:",gl(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Yi*i?(pl()<=Re.DEBUG&&Q("QueryEngine","The SDK decides to create cache indexes for query:",gl(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Dr(n))):$.resolve())}Xi(e,n){if(t1(n))return $.resolve(null);let r=Dr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Tv(n,null,"F"),r=Dr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=xe(...s);return this.Zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const h=this.rs(n,a);return this.ss(n,h,o,l.readTime)?this.Xi(e,Tv(n,null,"F")):this.os(e,h,n,l)}))})))}es(e,n,r,i){return t1(n)||i.isEqual(ce.min())?$.resolve(null):this.Zi.getDocuments(e,r).next(s=>{const o=this.rs(n,s);return this.ss(n,o,r,i)?$.resolve(null):(pl()<=Re.DEBUG&&Q("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),gl(n)),this.os(e,o,n,KM(i,-1)).next(a=>a))})}rs(e,n){let r=new Ye(xC(e));return n.forEach((i,s)=>{wh(e,s)&&(r=r.add(s))}),r}ss(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ts(e,n,r){return pl()<=Re.DEBUG&&Q("QueryEngine","Using full collection scan to execute query:",gl(n)),this.Zi.getDocumentsMatchingQuery(e,n,lr.min(),r)}os(e,n,r,i){return this.Zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F5{constructor(e,n,r,i){this.persistence=e,this._s=n,this.serializer=i,this.us=new pt(we),this.cs=new os(s=>Ta(s),yh),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(r)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new dA(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.us))}}function pA(t,e,n,r){return new F5(t,e,n,r)}async function gA(t,e){const n=me(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Ps(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=xe();for(const h of i){o.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}for(const h of s){a.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(h=>({Ts:h,removedBatchIds:o,addedBatchIds:a}))})})}function U5(t,e){const n=me(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.hs.newChangeBuffer({trackRemovals:!0});return function(a,l,h,d){const p=h.batch,m=p.keys();let w=$.resolve();return m.forEach(E=>{w=w.next(()=>d.getEntry(l,E)).next(x=>{const D=h.docVersions.get(E);le(D!==null),x.version.compareTo(D)<0&&(p.applyToRemoteDocument(x,h),x.isValidDocument()&&(x.setReadTime(h.commitVersion),d.addEntry(x)))})}),w.next(()=>a.mutationQueue.removeMutationBatch(l,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=xe();for(let h=0;h<a.mutationResults.length;++h)a.mutationResults[h].transformResults.length>0&&(l=l.add(a.batch.mutations[h].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function mA(t){const e=me(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Gr.getLastRemoteSnapshotVersion(n))}function $5(t,e){const n=me(t),r=e.snapshotVersion;let i=n.us;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.hs.newChangeBuffer({trackRemovals:!0});i=n.us;const a=[];e.targetChanges.forEach((d,p)=>{const m=i.get(p);if(!m)return;a.push(n.Gr.removeMatchingKeys(s,d.removedDocuments,p).next(()=>n.Gr.addMatchingKeys(s,d.addedDocuments,p)));let w=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?w=w.withResumeToken(Vt.EMPTY_BYTE_STRING,ce.min()).withLastLimboFreeSnapshotVersion(ce.min()):d.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(d.resumeToken,r)),i=i.insert(p,w),function(x,D,A){return x.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(m,w,d)&&a.push(n.Gr.updateTargetData(s,w))});let l=rr(),h=xe();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(z5(s,o,e.documentUpdates).next(d=>{l=d.Is,h=d.Es})),!r.isEqual(ce.min())){const d=n.Gr.getLastRemoteSnapshotVersion(s).next(p=>n.Gr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return $.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,h)).next(()=>l)}).then(s=>(n.us=i,s))}function z5(t,e,n){let r=xe(),i=xe();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=rr();return n.forEach((a,l)=>{const h=s.get(a);l.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(ce.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Q("LocalStore","Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",l.version)}),{Is:o,Es:i}})}function B5(t,e){const n=me(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function q5(t,e){const n=me(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Gr.getTargetData(r,e).next(s=>s?(i=s,$.resolve(i)):n.Gr.allocateTargetId(r).next(o=>(i=new qi(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Gr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.us.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.us=n.us.insert(r.targetId,r),n.cs.set(e,r.targetId)),r})}async function kv(t,e,n){const r=me(t),i=r.us.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!So(o))throw o;Q("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.us=r.us.remove(e),r.cs.delete(i.target)}function P1(t,e,n){const r=me(t);let i=ce.min(),s=xe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,h,d){const p=me(l),m=p.cs.get(d);return m!==void 0?$.resolve(p.us.get(m)):p.Gr.getTargetData(h,d)}(r,o,Dr(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Gr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r._s.getDocumentsMatchingQuery(o,e,n?i:ce.min(),n?s:xe())).next(a=>(H5(r,OV(e),a),{documents:a,ds:s})))}function H5(t,e,n){let r=t.ls.get(e)||ce.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ls.set(e,r)}class k1{constructor(){this.activeTargetIds=FV()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vA{constructor(){this._o=new k1,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,n,r){this.ao[e]=n}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new k1,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W5{uo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){Q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.To)e(0)}Po(){Q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sd=null;function Gg(){return Sd===null?Sd=function(){return 268435456+Math.round(2147483648*Math.random())}():Sd++,"0x"+Sd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G5{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dn="WebChannelConnection";class Q5 extends class{get Co(){return!1}constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Fo=r+"://"+n.host,this.Mo=`projects/${i}/databases/${s}`,this.xo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Oo(n,r,i,s,o){const a=Gg(),l=this.No(n,r.toUriEncodedString());Q("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);const h={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Lo(h,s,o),this.Bo(n,l,h,i).then(d=>(Q("RestConnection",`Received RPC '${n}' ${a}: `,d),d),d=>{throw Yl("RestConnection",`RPC '${n}' ${a} failed with error: `,d,"url: ",l,"request:",i),d})}ko(n,r,i,s,o,a){return this.Oo(n,r,i,s,o)}Lo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+fu}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}No(n,r){const i=K5[n];return`${this.Fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Bo(e,n,r,i){const s=Gg();return new Promise((o,a)=>{const l=new eC;l.setWithCredentials(!0),l.listenOnce(tC.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Hd.NO_ERROR:const d=l.getResponseJson();Q(dn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Hd.TIMEOUT:Q(dn,`RPC '${e}' ${s} timed out`),a(new ne(K.DEADLINE_EXCEEDED,"Request time out"));break;case Hd.HTTP_ERROR:const p=l.getStatus();if(Q(dn,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const w=m==null?void 0:m.error;if(w&&w.status&&w.message){const E=function(D){const A=D.toLowerCase().replace(/_/g,"-");return Object.values(K).indexOf(A)>=0?A:K.UNKNOWN}(w.status);a(new ne(E,w.message))}else a(new ne(K.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new ne(K.UNAVAILABLE,"Connection failed."));break;default:ae()}}finally{Q(dn,`RPC '${e}' ${s} completed.`)}});const h=JSON.stringify(i);Q(dn,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",h,r,15)})}qo(e,n,r){const i=Gg(),s=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=iC(),a=rC(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Lo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=s.join("");Q(dn,`Creating RPC '${e}' stream ${i}: ${d}`,l);const p=o.createWebChannel(d,l);let m=!1,w=!1;const E=new G5({Eo:D=>{w?Q(dn,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(m||(Q(dn,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),Q(dn,`RPC '${e}' stream ${i} sending:`,D),p.send(D))},Ao:()=>p.close()}),x=(D,A,T)=>{D.listen(A,S=>{try{T(S)}catch(M){setTimeout(()=>{throw M},0)}})};return x(p,sc.EventType.OPEN,()=>{w||(Q(dn,`RPC '${e}' stream ${i} transport opened.`),E.So())}),x(p,sc.EventType.CLOSE,()=>{w||(w=!0,Q(dn,`RPC '${e}' stream ${i} transport closed`),E.Do())}),x(p,sc.EventType.ERROR,D=>{w||(w=!0,Yl(dn,`RPC '${e}' stream ${i} transport errored:`,D),E.Do(new ne(K.UNAVAILABLE,"The operation could not be completed")))}),x(p,sc.EventType.MESSAGE,D=>{var A;if(!w){const T=D.data[0];le(!!T);const S=T,M=(S==null?void 0:S.error)||((A=S[0])===null||A===void 0?void 0:A.error);if(M){Q(dn,`RPC '${e}' stream ${i} received error:`,M);const q=M.status;let W=function(R){const O=Ot[R];if(O!==void 0)return UC(O)}(q),P=M.message;W===void 0&&(W=K.INTERNAL,P="Unknown error status: "+q+" with message "+M.message),w=!0,E.Do(new ne(W,P)),p.close()}else Q(dn,`RPC '${e}' stream ${i} received:`,T),E.vo(T)}}),x(a,nC.STAT_EVENT,D=>{D.stat===pv.PROXY?Q(dn,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===pv.NOPROXY&&Q(dn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.bo()},0),E}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y5(){return typeof window<"u"?window:null}function Zd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mp(t){return new t5(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(e,n,r=1e3,i=1.5,s=6e4){this.li=e,this.timerId=n,this.Qo=r,this.Ko=i,this.$o=s,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();const n=Math.floor(this.Uo+this.Ho()),r=Math.max(0,Date.now()-this.Go),i=Math.max(0,n-r);i>0&&Q("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Uo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,i,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(e,n,r,i,s,o,a,l){this.li=e,this.Yo=r,this.Zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new yA(e,n)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}async stop(){this.i_()&&await this.close(0)}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}async u_(){if(this.s_())return this.close(0)}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}async close(e,n){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():n&&n.code===K.RESOURCE_EXHAUSTED?(bn(n.toString()),bn("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):n&&n.code===K.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.po(n)}P_(){}auth(){this.state=1;const e=this.T_(this.Xo),n=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Xo===n&&this.I_(r,i)},r=>{e(()=>{const i=new ne(K.UNKNOWN,"Fetching auth token failed: "+r.message);return this.E_(i)})})}I_(e,n){const r=this.T_(this.Xo);this.stream=this.d_(e,n),this.stream.Ro(()=>{r(()=>this.listener.Ro())}),this.stream.mo(()=>{r(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(i=>{r(()=>this.E_(i))}),this.stream.onMessage(i=>{r(()=>++this.n_==1?this.A_(i):this.onNext(i))})}o_(){this.state=5,this.r_.jo(async()=>{this.state=0,this.start()})}E_(e){return Q("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return n=>{this.li.enqueueAndForget(()=>this.Xo===e?n():(Q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class X5 extends _A{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}d_(e,n){return this.connection.qo("Listen",e,n)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();const n=i5(this.serializer,e),r=function(s){if(!("targetChange"in s))return ce.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ce.min():o.readTime?Pn(o.readTime):ce.min()}(e);return this.listener.R_(n,r)}V_(e){const n={};n.database=bv(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Uf(l)?{documents:GC(s,l)}:{query:QC(s,l).ct},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=BC(s,o.resumeToken);const h=Iv(s,o.expectedCount);h!==null&&(a.expectedCount=h)}else if(o.snapshotVersion.compareTo(ce.min())>0){a.readTime=ru(s,o.snapshotVersion.toTimestamp());const h=Iv(s,o.expectedCount);h!==null&&(a.expectedCount=h)}return a}(this.serializer,e);const r=o5(this.serializer,e);r&&(n.labels=r),this.c_(n)}m_(e){const n={};n.database=bv(this.serializer),n.removeTarget=e,this.c_(n)}}class J5 extends _A{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}d_(e,n){return this.connection.qo("Write",e,n)}A_(e){return le(!!e.streamToken),this.lastStreamToken=e.streamToken,le(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){le(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();const n=s5(e.writeResults,e.commitTime),r=Pn(e.commitTime);return this.listener.y_(r,n)}w_(){const e={};e.database=bv(this.serializer),this.c_(e)}g_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Bf(this.serializer,r))};this.c_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z5 extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.S_=!1}b_(){if(this.S_)throw new ne(K.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,n,r,i){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Oo(e,Sv(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ne(K.UNKNOWN,s.toString())})}ko(e,n,r,i,s){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.ko(e,Sv(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ne(K.UNKNOWN,o.toString())})}terminate(){this.S_=!0,this.connection.terminate()}}class e3{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(bn(n),this.C_=!1):Q("OnlineStateTracker",n)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t3{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.L_=[],this.B_=new Map,this.k_=new Set,this.q_=[],this.Q_=s,this.Q_.uo(o=>{r.enqueueAndForget(async()=>{ja(this)&&(Q("RemoteStore","Restarting streams for network reachability change."),await async function(l){const h=me(l);h.k_.add(4),await Th(h),h.K_.set("Unknown"),h.k_.delete(4),await Vp(h)}(this))})}),this.K_=new e3(r,i)}}async function Vp(t){if(ja(t))for(const e of t.q_)await e(!0)}async function Th(t){for(const e of t.q_)await e(!1)}function wA(t,e){const n=me(t);n.B_.has(e.targetId)||(n.B_.set(e.targetId,e),A_(n)?C_(n):gu(n).s_()&&b_(n,e))}function S_(t,e){const n=me(t),r=gu(n);n.B_.delete(e),r.s_()&&EA(n,e),n.B_.size===0&&(r.s_()?r.a_():ja(n)&&n.K_.set("Unknown"))}function b_(t,e){if(t.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ce.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}gu(t).V_(e)}function EA(t,e){t.U_.xe(e),gu(t).m_(e)}function C_(t){t.U_=new XV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>t.B_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),gu(t).start(),t.K_.F_()}function A_(t){return ja(t)&&!gu(t).i_()&&t.B_.size>0}function ja(t){return me(t).k_.size===0}function TA(t){t.U_=void 0}async function n3(t){t.K_.set("Online")}async function r3(t){t.B_.forEach((e,n)=>{b_(t,e)})}async function i3(t,e){TA(t),A_(t)?(t.K_.O_(e),C_(t)):t.K_.set("Unknown")}async function s3(t,e,n){if(t.K_.set("Online"),e instanceof zC&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.B_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.B_.delete(a),i.U_.removeTarget(a))}(t,e)}catch(r){Q("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Gf(t,r)}else if(e instanceof Jd?t.U_.$e(e):e instanceof $C?t.U_.Je(e):t.U_.Ge(e),!n.isEqual(ce.min()))try{const r=await mA(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.U_.it(o);return a.targetChanges.forEach((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.B_.get(h);d&&s.B_.set(h,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,h)=>{const d=s.B_.get(l);if(!d)return;s.B_.set(l,d.withResumeToken(Vt.EMPTY_BYTE_STRING,d.snapshotVersion)),EA(s,l);const p=new qi(d.target,l,h,d.sequenceNumber);b_(s,p)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){Q("RemoteStore","Failed to raise snapshot:",r),await Gf(t,r)}}async function Gf(t,e,n){if(!So(e))throw e;t.k_.add(1),await Th(t),t.K_.set("Offline"),n||(n=()=>mA(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Q("RemoteStore","Retrying IndexedDB access"),await n(),t.k_.delete(1),await Vp(t)})}function IA(t,e){return e().catch(n=>Gf(t,n,e))}async function Ih(t){const e=me(t),n=mo(e);let r=e.L_.length>0?e.L_[e.L_.length-1].batchId:-1;for(;o3(e);)try{const i=await B5(e.localStore,r);if(i===null){e.L_.length===0&&n.a_();break}r=i.batchId,a3(e,i)}catch(i){await Gf(e,i)}SA(e)&&bA(e)}function o3(t){return ja(t)&&t.L_.length<10}function a3(t,e){t.L_.push(e);const n=mo(t);n.s_()&&n.f_&&n.g_(e.mutations)}function SA(t){return ja(t)&&!mo(t).i_()&&t.L_.length>0}function bA(t){mo(t).start()}async function l3(t){mo(t).w_()}async function u3(t){const e=mo(t);for(const n of t.L_)e.g_(n.mutations)}async function c3(t,e,n){const r=t.L_.shift(),i=p_.from(r,e,n);await IA(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ih(t)}async function h3(t,e){e&&mo(t).f_&&await async function(r,i){if(function(o){return GV(o)&&o!==K.ABORTED}(i.code)){const s=r.L_.shift();mo(r).__(),await IA(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Ih(r)}}(t,e),SA(t)&&bA(t)}async function D1(t,e){const n=me(t);n.asyncQueue.verifyOperationInProgress(),Q("RemoteStore","RemoteStore received new credentials");const r=ja(n);n.k_.add(3),await Th(n),r&&n.K_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.k_.delete(3),await Vp(n)}async function d3(t,e){const n=me(t);e?(n.k_.delete(2),await Vp(n)):e||(n.k_.add(2),await Th(n),n.K_.set("Unknown"))}function gu(t){return t.W_||(t.W_=function(n,r,i){const s=me(n);return s.b_(),new X5(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Ro:n3.bind(null,t),mo:r3.bind(null,t),po:i3.bind(null,t),R_:s3.bind(null,t)}),t.q_.push(async e=>{e?(t.W_.__(),A_(t)?C_(t):t.K_.set("Unknown")):(await t.W_.stop(),TA(t))})),t.W_}function mo(t){return t.G_||(t.G_=function(n,r,i){const s=me(n);return s.b_(),new J5(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Ro:()=>Promise.resolve(),mo:l3.bind(null,t),po:h3.bind(null,t),p_:u3.bind(null,t),y_:c3.bind(null,t)}),t.q_.push(async e=>{e?(t.G_.__(),await Ih(t)):(await t.G_.stop(),t.L_.length>0&&(Q("RemoteStore",`Stopping write stream with ${t.L_.length} pending writes`),t.L_=[]))})),t.G_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Ki,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new x_(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ne(K.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function P_(t,e){if(bn("AsyncQueue",`${e}: ${t}`),So(t))return new ne(K.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{static emptySet(e){return new $l(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||te.comparator(n.key,r.key):(n,r)=>te.comparator(n.key,r.key),this.keyedMap=oc(),this.sortedSet=new pt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof $l)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new $l;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(){this.z_=new pt(te.comparator)}track(e){const n=e.doc.key,r=this.z_.get(n);r?e.type!==0&&r.type===3?this.z_=this.z_.insert(n,e):e.type===3&&r.type!==1?this.z_=this.z_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.z_=this.z_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.z_=this.z_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.z_=this.z_.remove(n):e.type===1&&r.type===2?this.z_=this.z_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.z_=this.z_.insert(n,{type:2,doc:e.doc}):ae():this.z_=this.z_.insert(n,e)}j_(){const e=[];return this.z_.inorderTraversal((n,r)=>{e.push(r)}),e}}class iu{constructor(e,n,r,i,s,o,a,l,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new iu(e,n,$l.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Pp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f3{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}}class p3{constructor(){this.queries=N1(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(n,r){const i=me(n),s=i.queries;i.queries=N1(),s.forEach((o,a)=>{for(const l of a.J_)l.onError(r)})})(this,new ne(K.ABORTED,"Firestore shutting down"))}}function N1(){return new os(t=>AC(t),Pp)}async function CA(t,e){const n=me(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.Y_()&&e.Z_()&&(r=2):(s=new f3,r=e.Z_()?0:1);try{switch(r){case 0:s.H_=await n.onListen(i,!0);break;case 1:s.H_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=P_(o,`Initialization of query '${gl(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.J_.push(e),e.ea(n.onlineState),s.H_&&e.ta(s.H_)&&k_(n)}async function AA(t,e){const n=me(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.J_.indexOf(e);o>=0&&(s.J_.splice(o,1),s.J_.length===0?i=e.Z_()?0:1:!s.Y_()&&e.Z_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function g3(t,e){const n=me(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.J_)a.ta(i)&&(r=!0);o.H_=i}}r&&k_(n)}function m3(t,e,n){const r=me(t),i=r.queries.get(e);if(i)for(const s of i.J_)s.onError(n);r.queries.delete(e)}function k_(t){t.X_.forEach(e=>{e.next()})}var Rv,L1;(L1=Rv||(Rv={})).na="default",L1.Cache="cache";class xA{constructor(e,n,r){this.query=e,this.ra=n,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=r||{}}ta(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new iu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.ia?this.oa(e)&&(this.ra.next(e),n=!0):this._a(e,this.onlineState)&&(this.aa(e),n=!0),this.sa=e,n}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let n=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),n=!0),n}_a(e,n){if(!e.fromCache||!this.Z_())return!0;const r=n!=="Offline";return(!this.options.ua||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}oa(e){if(e.docChanges.length>0)return!0;const n=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}aa(e){e=iu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==Rv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(e){this.key=e}}class kA{constructor(e){this.key=e}}class v3{constructor(e,n){this.query=e,this.da=n,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=xe(),this.mutatedKeys=xe(),this.Va=xC(e),this.ma=new $l(this.Va)}get fa(){return this.da}ga(e,n){const r=n?n.pa:new O1,i=n?n.ma:this.ma;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,p)=>{const m=i.get(d),w=wh(this.query,p)?p:null,E=!!m&&this.mutatedKeys.has(m.key),x=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let D=!1;m&&w?m.data.isEqual(w.data)?E!==x&&(r.track({type:3,doc:w}),D=!0):this.ya(m,w)||(r.track({type:2,doc:w}),D=!0,(l&&this.Va(w,l)>0||h&&this.Va(w,h)<0)&&(a=!0)):!m&&w?(r.track({type:0,doc:w}),D=!0):m&&!w&&(r.track({type:1,doc:m}),D=!0,(l||h)&&(a=!0)),D&&(w?(o=o.add(w),s=x?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{ma:o,pa:r,ss:a,mutatedKeys:s}}ya(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;const o=e.pa.j_();o.sort((d,p)=>function(w,E){const x=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae()}};return x(w)-x(E)}(d.type,p.type)||this.Va(d.doc,p.doc)),this.wa(r),i=i!=null&&i;const a=n&&!i?this.Sa():[],l=this.Ra.size===0&&this.current&&!i?1:0,h=l!==this.Aa;return this.Aa=l,o.length!==0||h?{snapshot:new iu(this.query,e.ma,s,o,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),ba:a}:{ba:a}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new O1,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.da.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(n=>this.da=this.da.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.da=this.da.delete(n)),this.current=e.current)}Sa(){if(!this.current)return[];const e=this.Ra;this.Ra=xe(),this.ma.forEach(r=>{this.Da(r.key)&&(this.Ra=this.Ra.add(r.key))});const n=[];return e.forEach(r=>{this.Ra.has(r)||n.push(new kA(r))}),this.Ra.forEach(r=>{e.has(r)||n.push(new PA(r))}),n}va(e){this.da=e.ds,this.Ra=xe();const n=this.ga(e.documents);return this.applyChanges(n,!0)}Ca(){return iu.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}}class y3{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class _3{constructor(e){this.key=e,this.Fa=!1}}class w3{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ma={},this.xa=new os(a=>AC(a),Pp),this.Oa=new Map,this.Na=new Set,this.La=new pt(te.comparator),this.Ba=new Map,this.ka=new w_,this.qa={},this.Qa=new Map,this.Ka=Ca.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}}async function E3(t,e,n=!0){const r=MA(t);let i;const s=r.xa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Ca()):i=await RA(r,e,n,!0),i}async function T3(t,e){const n=MA(t);await RA(n,e,!0,!1)}async function RA(t,e,n,r){const i=await q5(t.localStore,Dr(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await I3(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&wA(t.remoteStore,i),a}async function I3(t,e,n,r,i){t.Ua=(p,m,w)=>async function(x,D,A,T){let S=D.view.ga(A);S.ss&&(S=await P1(x.localStore,D.query,!1).then(({documents:P})=>D.view.ga(P,S)));const M=T&&T.targetChanges.get(D.targetId),q=T&&T.targetMismatches.get(D.targetId)!=null,W=D.view.applyChanges(S,x.isPrimaryClient,M,q);return V1(x,D.targetId,W.ba),W.snapshot}(t,p,m,w);const s=await P1(t.localStore,e,!0),o=new v3(e,s.ds),a=o.ga(s.documents),l=Eh.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),h=o.applyChanges(a,t.isPrimaryClient,l);V1(t,n,h.ba);const d=new y3(e,n,o);return t.xa.set(e,d),t.Oa.has(n)?t.Oa.get(n).push(e):t.Oa.set(n,[e]),h.snapshot}async function S3(t,e,n){const r=me(t),i=r.xa.get(e),s=r.Oa.get(i.targetId);if(s.length>1)return r.Oa.set(i.targetId,s.filter(o=>!Pp(o,e))),void r.xa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await kv(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&S_(r.remoteStore,i.targetId),Dv(r,i.targetId)}).catch(Va)):(Dv(r,i.targetId),await kv(r.localStore,i.targetId,!0))}async function b3(t,e){const n=me(t),r=n.xa.get(e),i=n.Oa.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),S_(n.remoteStore,r.targetId))}async function C3(t,e,n){const r=VA(t);try{const i=await function(o,a){const l=me(o),h=_t.now(),d=a.reduce((w,E)=>w.add(E.key),xe());let p,m;return l.persistence.runTransaction("Locally write mutations","readwrite",w=>{let E=rr(),x=xe();return l.hs.getEntries(w,d).next(D=>{E=D,E.forEach((A,T)=>{T.isValidDocument()||(x=x.add(A))})}).next(()=>l.localDocuments.getOverlayedDocuments(w,E)).next(D=>{p=D;const A=[];for(const T of a){const S=WV(T,p.get(T.key).overlayedDocument);S!=null&&A.push(new as(T.key,S,_C(S.value.mapValue),An.exists(!0)))}return l.mutationQueue.addMutationBatch(w,h,A,a)}).next(D=>{m=D;const A=D.applyToLocalDocumentSet(p,x);return l.documentOverlayCache.saveOverlays(w,D.batchId,A)})}).then(()=>({batchId:m.batchId,changes:kC(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let h=o.qa[o.currentUser.toKey()];h||(h=new pt(we)),h=h.insert(a,l),o.qa[o.currentUser.toKey()]=h}(r,i.batchId,n),await Sh(r,i.changes),await Ih(r.remoteStore)}catch(i){const s=P_(i,"Failed to persist write");n.reject(s)}}async function DA(t,e){const n=me(t);try{const r=await $5(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Ba.get(s);o&&(le(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Fa=!0:i.modifiedDocuments.size>0?le(o.Fa):i.removedDocuments.size>0&&(le(o.Fa),o.Fa=!1))}),await Sh(n,r,e)}catch(r){await Va(r)}}function M1(t,e,n){const r=me(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.xa.forEach((s,o)=>{const a=o.view.ea(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=me(o);l.onlineState=a;let h=!1;l.queries.forEach((d,p)=>{for(const m of p.J_)m.ea(a)&&(h=!0)}),h&&k_(l)}(r.eventManager,e),i.length&&r.Ma.R_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function A3(t,e,n){const r=me(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Ba.get(e),s=i&&i.key;if(s){let o=new pt(te.comparator);o=o.insert(s,St.newNoDocument(s,ce.min()));const a=xe().add(s),l=new Dp(ce.min(),new Map,new pt(we),o,a);await DA(r,l),r.La=r.La.remove(s),r.Ba.delete(e),R_(r)}else await kv(r.localStore,e,!1).then(()=>Dv(r,e,n)).catch(Va)}async function x3(t,e){const n=me(t),r=e.batch.batchId;try{const i=await U5(n.localStore,e);NA(n,r,null),OA(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Sh(n,i)}catch(i){await Va(i)}}async function P3(t,e,n){const r=me(t);try{const i=await function(o,a){const l=me(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let d;return l.mutationQueue.lookupMutationBatch(h,a).next(p=>(le(p!==null),d=p.keys(),l.mutationQueue.removeMutationBatch(h,p))).next(()=>l.mutationQueue.performConsistencyCheck(h)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(h,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d)).next(()=>l.localDocuments.getDocuments(h,d))})}(r.localStore,e);NA(r,e,n),OA(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Sh(r,i)}catch(i){await Va(i)}}function OA(t,e){(t.Qa.get(e)||[]).forEach(n=>{n.resolve()}),t.Qa.delete(e)}function NA(t,e,n){const r=me(t);let i=r.qa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.qa[r.currentUser.toKey()]=i}}function Dv(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Oa.get(e))t.xa.delete(r),n&&t.Ma.Wa(r,n);t.Oa.delete(e),t.isPrimaryClient&&t.ka.yr(e).forEach(r=>{t.ka.containsKey(r)||LA(t,r)})}function LA(t,e){t.Na.delete(e.path.canonicalString());const n=t.La.get(e);n!==null&&(S_(t.remoteStore,n),t.La=t.La.remove(e),t.Ba.delete(n),R_(t))}function V1(t,e,n){for(const r of n)r instanceof PA?(t.ka.addReference(r.key,e),k3(t,r)):r instanceof kA?(Q("SyncEngine","Document no longer in limbo: "+r.key),t.ka.removeReference(r.key,e),t.ka.containsKey(r.key)||LA(t,r.key)):ae()}function k3(t,e){const n=e.key,r=n.path.canonicalString();t.La.get(n)||t.Na.has(r)||(Q("SyncEngine","New document in limbo: "+n),t.Na.add(r),R_(t))}function R_(t){for(;t.Na.size>0&&t.La.size<t.maxConcurrentLimboResolutions;){const e=t.Na.values().next().value;t.Na.delete(e);const n=new te(Ge.fromString(e)),r=t.Ka.next();t.Ba.set(r,new _3(n)),t.La=t.La.insert(n,r),wA(t.remoteStore,new qi(Dr(_h(n.path)),r,"TargetPurposeLimboResolution",Pr.oe))}}async function Sh(t,e,n){const r=me(t),i=[],s=[],o=[];r.xa.isEmpty()||(r.xa.forEach((a,l)=>{o.push(r.Ua(l,e,n).then(h=>{var d;if((h||n)&&r.isPrimaryClient){const p=h?!h.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(h){i.push(h);const p=I_.zi(l.targetId,h);s.push(p)}}))}),await Promise.all(o),r.Ma.R_(i),await async function(l,h){const d=me(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>$.forEach(h,m=>$.forEach(m.Wi,w=>d.persistence.referenceDelegate.addReference(p,m.targetId,w)).next(()=>$.forEach(m.Gi,w=>d.persistence.referenceDelegate.removeReference(p,m.targetId,w)))))}catch(p){if(!So(p))throw p;Q("LocalStore","Failed to update sequence numbers: "+p)}for(const p of h){const m=p.targetId;if(!p.fromCache){const w=d.us.get(m),E=w.snapshotVersion,x=w.withLastLimboFreeSnapshotVersion(E);d.us=d.us.insert(m,x)}}}(r.localStore,s))}async function R3(t,e){const n=me(t);if(!n.currentUser.isEqual(e)){Q("SyncEngine","User change. New user:",e.toKey());const r=await gA(n.localStore,e);n.currentUser=e,function(s,o){s.Qa.forEach(a=>{a.forEach(l=>{l.reject(new ne(K.CANCELLED,o))})}),s.Qa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Sh(n,r.Ts)}}function D3(t,e){const n=me(t),r=n.Ba.get(e);if(r&&r.Fa)return xe().add(r.key);{let i=xe();const s=n.Oa.get(e);if(!s)return i;for(const o of s){const a=n.xa.get(o);i=i.unionWith(a.view.fa)}return i}}function MA(t){const e=me(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=DA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=D3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=A3.bind(null,e),e.Ma.R_=g3.bind(null,e.eventManager),e.Ma.Wa=m3.bind(null,e.eventManager),e}function VA(t){const e=me(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=x3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=P3.bind(null,e),e}class sh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Mp(e.databaseInfo.databaseId),this.sharedClientState=this.za(e),this.persistence=this.ja(e),await this.persistence.start(),this.localStore=this.Ha(e),this.gcScheduler=this.Ja(e,this.localStore),this.indexBackfillerScheduler=this.Ya(e,this.localStore)}Ja(e,n){return null}Ya(e,n){return null}Ha(e){return pA(this.persistence,new fA,e.initialUser,this.serializer)}ja(e){return new E_(Lp.ei,this.serializer)}za(e){return new vA}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}sh.provider={build:()=>new sh};class O3 extends sh{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,n){le(this.persistence.referenceDelegate instanceof Kf);const r=this.persistence.referenceDelegate.garbageCollector;return new lA(r,e.asyncQueue,n)}ja(e){const n=this.cacheSizeBytes!==void 0?pn.withCacheSize(this.cacheSizeBytes):pn.DEFAULT;return new E_(r=>Kf.ei(r,n),this.serializer)}}class N3 extends sh{constructor(e,n,r){super(),this.Za=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Za.initialize(this,e),await VA(this.Za.syncEngine),await Ih(this.Za.remoteStore),await this.persistence.Si(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Ha(e){return pA(this.persistence,new fA,e.initialUser,this.serializer)}Ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new lA(r,e.asyncQueue,n)}Ya(e,n){const r=new XM(n,this.persistence);return new YM(e.asyncQueue,r)}ja(e){const n=V5(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?pn.withCacheSize(this.cacheSizeBytes):pn.DEFAULT;return new T_(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Y5(),Zd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}za(e){return new vA}}class Qf{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>M1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=R3.bind(null,this.syncEngine),await d3(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new p3}()}createDatastore(e){const n=Mp(e.databaseInfo.databaseId),r=function(s){return new Q5(s)}(e.databaseInfo);return function(s,o,a,l){return new Z5(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new t3(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>M1(this.syncEngine,n,0),function(){return R1.p()?new R1:new W5}())}createSyncEngine(e,n){return function(i,s,o,a,l,h,d){const p=new w3(i,s,o,a,l,h);return d&&(p.$a=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=me(i);Q("RemoteStore","RemoteStore shutting down."),s.k_.add(5),await Th(s),s.Q_.shutdown(),s.K_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Qf.provider={build:()=>new Qf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):bn("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Sn.UNAUTHENTICATED,this.clientId=sC.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{Q("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Q("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ki;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=P_(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Qg(t,e){t.asyncQueue.verifyOperationInProgress(),Q("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await gA(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function j1(t,e){t.asyncQueue.verifyOperationInProgress();const n=await M3(t);Q("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>D1(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>D1(e.remoteStore,i)),t._onlineComponents=e}async function M3(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Q("FirestoreClient","Using user provided OfflineComponentProvider");try{await Qg(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===K.FAILED_PRECONDITION||i.code===K.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Yl("Error using user provided cache. Falling back to memory cache: "+n),await Qg(t,new sh)}}else Q("FirestoreClient","Using default OfflineComponentProvider"),await Qg(t,new O3(void 0));return t._offlineComponents}async function FA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Q("FirestoreClient","Using user provided OnlineComponentProvider"),await j1(t,t._uninitializedComponentsProvider._online)):(Q("FirestoreClient","Using default OnlineComponentProvider"),await j1(t,new Qf))),t._onlineComponents}function V3(t){return FA(t).then(e=>e.syncEngine)}async function Ov(t){const e=await FA(t),n=e.eventManager;return n.onListen=E3.bind(null,e.syncEngine),n.onUnlisten=S3.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=T3.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=b3.bind(null,e.syncEngine),n}function j3(t,e,n={}){const r=new Ki;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,h){const d=new jA({next:m=>{d.eu(),o.enqueueAndForget(()=>AA(s,p));const w=m.docs.has(a);!w&&m.fromCache?h.reject(new ne(K.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&m.fromCache&&l&&l.source==="server"?h.reject(new ne(K.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(m)},error:m=>h.reject(m)}),p=new xA(_h(a.path),d,{includeMetadataChanges:!0,ua:!0});return CA(s,p)}(await Ov(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F1=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $A(t,e,n){if(!n)throw new ne(K.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function F3(t,e,n,r){if(e===!0&&r===!0)throw new ne(K.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function U1(t){if(!te.isDocumentKey(t))throw new ne(K.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function $1(t){if(te.isDocumentKey(t))throw new ne(K.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function D_(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ae()}function Zr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ne(K.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=D_(t);throw new ne(K.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ne(K.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ne(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}F3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=UA((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ne(K.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ne(K.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ne(K.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class O_{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new z1({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ne(K.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ne(K.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new z1(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new FM;switch(r.type){case"firstParty":return new zM(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ne(K.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=F1.get(n);r&&(Q("ComponentProvider","Removing Datastore"),F1.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new jp(this.firestore,e,this._query)}}class kn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new kn(this.firestore,e,this._key)}}class lo extends jp{constructor(e,n,r){super(e,n,_h(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new kn(this.firestore,null,new te(e))}withConverter(e){return new lo(this.firestore,e,this._path)}}function U3(t,e,...n){if(t=Mt(t),$A("collection","path",e),t instanceof O_){const r=Ge.fromString(e,...n);return $1(r),new lo(t,null,r)}{if(!(t instanceof kn||t instanceof lo))throw new ne(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ge.fromString(e,...n));return $1(r),new lo(t.firestore,null,r)}}function Nt(t,e,...n){if(t=Mt(t),arguments.length===1&&(e=sC.newId()),$A("doc","path",e),t instanceof O_){const r=Ge.fromString(e,...n);return U1(r),new kn(t,null,new te(r))}{if(!(t instanceof kn||t instanceof lo))throw new ne(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ge.fromString(e,...n));return U1(r),new kn(t.firestore,t instanceof lo?t.converter:null,new te(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{constructor(e=Promise.resolve()){this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new yA(this,"async_queue_retry"),this.fu=()=>{const r=Zd();r&&Q("AsyncQueue","Visibility state changed to "+r.visibilityState),this.r_.Jo()},this.gu=e;const n=Zd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.Eu){this.Eu=!0,this.Vu=e||!1;const n=Zd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.Eu)return new Promise(()=>{});const n=new Ki;return this.yu(()=>this.Eu&&this.Vu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}async wu(){if(this.Iu.length!==0){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!So(e))throw e;Q("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}}yu(e){const n=this.gu.then(()=>(this.Ru=!0,e().catch(r=>{this.Au=r,this.Ru=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw bn("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Ru=!1,r))));return this.gu=n,n}enqueueAfterDelay(e,n,r){this.pu(),this.mu.indexOf(e)>-1&&(n=0);const i=x_.createAndSchedule(this,e,n,r,s=>this.Su(s));return this.du.push(i),i}pu(){this.Au&&ae()}verifyOperationInProgress(){}async bu(){let e;do e=this.gu,await e;while(e!==this.gu)}Du(e){for(const n of this.du)if(n.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.du.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.du)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){const n=this.du.indexOf(e);this.du.splice(n,1)}}function q1(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class vo extends O_{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new B1,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new B1(e),this._firestoreClient=void 0,await e}}}function $3(t,e,n){n||(n="(default)");const r=Ma(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),s=r.getOptions(n);if(va(s,e))return i;throw new ne(K.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ne(K.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ne(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function N_(t){if(t._terminated)throw new ne(K.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||zA(t),t._firestoreClient}function zA(t){var e,n,r;const i=t._freezeSettings(),s=function(a,l,h,d){return new _V(a,l,h,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,UA(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new L3(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function z3(t,e){Yl("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return B3(t,Qf.provider,{build:r=>new N3(r,n.cacheSizeBytes,void 0)}),Promise.resolve()}function B3(t,e,n){if((t=Zr(t,vo))._firestoreClient||t._terminated)throw new ne(K.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new ne(K.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},zA(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e){this._byteString=e}static fromBase64String(e){try{return new su(Vt.fromBase64String(e))}catch(n){throw new ne(K.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new su(Vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ne(K.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ne(K.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ne(K.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return we(this._lat,e._lat)||we(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q3=/^__.*__$/;class H3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new as(e,this.data,this.fieldMask,n,this.fieldTransforms):new pu(e,this.data,n,this.fieldTransforms)}}class W3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new as(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function BA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae()}}class Up{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Fu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new Up(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.xu({path:r,Nu:!1});return i.Lu(e),i}Bu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.xu({path:r,Nu:!1});return i.Fu(),i}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return Yf(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lu(this.path.get(e))}Lu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(BA(this.Mu)&&q3.test(e))throw this.qu('Document fields cannot begin and end with "__"')}}class K3{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Mp(e)}$u(e,n,r,i=!1){return new Up({Mu:e,methodName:n,Ku:r,path:vt.emptyPath(),Nu:!1,Qu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function V_(t){const e=t._freezeSettings(),n=Mp(t._databaseId);return new K3(t._databaseId,!!e.ignoreUndefinedProperties,n)}function qA(t,e,n,r,i,s={}){const o=t.$u(s.merge||s.mergeFields?2:0,e,n,i);$_("Data must be an object, but it was:",o,r);const a=HA(r,o);let l,h;if(s.merge)l=new nr(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const p of s.mergeFields){const m=KA(e,p,n);if(!o.contains(m))throw new ne(K.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);J3(d,m)||d.push(m)}l=new nr(d),h=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,h=o.fieldTransforms;return new H3(new Cn(a),l,h)}class j_ extends bh{_toFieldTransform(e){if(e.Mu!==2)throw e.Mu===1?e.qu(`${this._methodName}() can only appear at the top level of your update data`):e.qu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof j_}}function G3(t,e,n){return new Up({Mu:3,Ku:e.settings.Ku,methodName:t._methodName,Nu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class F_ extends bh{_toFieldTransform(e){return new h_(e.path,new tu)}isEqual(e){return e instanceof F_}}class U_ extends bh{constructor(e,n){super(e),this.Uu=n}_toFieldTransform(e){const n=G3(this,e,!0),r=this.Uu.map(s=>$p(s,n)),i=new Ia(r);return new h_(e.path,i)}isEqual(e){return e instanceof U_&&va(this.Uu,e.Uu)}}function Q3(t,e,n,r){const i=t.$u(1,e,n);$_("Data must be an object, but it was:",i,r);const s=[],o=Cn.empty();bo(r,(l,h)=>{const d=z_(e,l,n);h=Mt(h);const p=i.Bu(d);if(h instanceof j_)s.push(d);else{const m=$p(h,p);m!=null&&(s.push(d),o.set(d,m))}});const a=new nr(s);return new W3(o,a,i.fieldTransforms)}function Y3(t,e,n,r,i,s){if(t.$u(1,e,n),KA(e,r,n),s.length%2!=0)throw new ne(K.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`)}function $p(t,e){if(WA(t=Mt(t)))return $_("Unsupported field value:",e,t),HA(t,e);if(t instanceof bh)return function(r,i){if(!BA(i.Mu))throw i.qu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.qu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=$p(a,i.ku(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Mt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return UV(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=_t.fromDate(r);return{timestampValue:ru(i.serializer,s)}}if(r instanceof _t){const s=new _t(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ru(i.serializer,s)}}if(r instanceof L_)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof su)return{bytesValue:BC(i.serializer,r._byteString)};if(r instanceof kn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.qu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:v_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof M_)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.qu("VectorValues must only contain numeric values.");return c_(a.serializer,l)})}}}}}}(r,i);throw i.qu(`Unsupported field value: ${D_(r)}`)}(t,e)}function HA(t,e){const n={};return gC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):bo(t,(r,i)=>{const s=$p(i,e.Ou(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function WA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof _t||t instanceof L_||t instanceof su||t instanceof kn||t instanceof bh||t instanceof M_)}function $_(t,e,n){if(!WA(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=D_(n);throw r==="an object"?e.qu(t+" a custom object"):e.qu(t+" "+r)}}function KA(t,e,n){if((e=Mt(e))instanceof Fp)return e._internalPath;if(typeof e=="string")return z_(t,e);throw Yf("Field path arguments must be of type string or ",t,!1,void 0,n)}const X3=new RegExp("[~\\*/\\[\\]]");function z_(t,e,n){if(e.search(X3)>=0)throw Yf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Fp(...e.split("."))._internalPath}catch{throw Yf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Yf(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new ne(K.INVALID_ARGUMENT,a+t+l)}function J3(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new kn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Z3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(QA("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Z3 extends GA{data(){return super.data()}}function QA(t,e){return typeof e=="string"?z_(t,e):e instanceof Fp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ej(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ne(K.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class tj{convertValue(e,n="none"){switch(po(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ts(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ae()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return bo(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>dt(o.doubleValue));return new M_(s)}convertGeoPoint(e){return new L_(dt(e.latitude),dt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Cp(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(th(e));default:return null}}convertTimestamp(e){const n=es(e);return new _t(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ge.fromString(e);le(ZC(r));const i=new Ea(r.get(1),r.get(3)),s=new te(r.popFirst(5));return i.isEqual(n)||bn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YA(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class XA extends GA{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ef(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(QA("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class ef extends XA{data(e={}){return super.data(e)}}class nj{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new uc(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new ef(this._firestore,this._userDataWriter,r.key,r,new uc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ne(K.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new ef(i._firestore,i._userDataWriter,a.doc.key,a.doc,new uc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new ef(i._firestore,i._userDataWriter,a.doc.key,a.doc,new uc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,d=-1;return a.type!==0&&(h=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:rj(a.type),doc:l,oldIndex:h,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function rj(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uo(t){t=Zr(t,kn);const e=Zr(t.firestore,vo);return j3(N_(e),t._key).then(n=>ZA(e,t,n))}class JA extends tj{constructor(e){super(),this.firestore=e}convertBytes(e){return new su(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new kn(this.firestore,null,n)}}function Xf(t,e,n){t=Zr(t,kn);const r=Zr(t.firestore,vo),i=YA(t.converter,e);return B_(r,[qA(V_(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,An.none())])}function dl(t,e,n,...r){t=Zr(t,kn);const i=Zr(t.firestore,vo),s=V_(i);let o;return o=typeof(e=Mt(e))=="string"||e instanceof Fp?Y3(s,"updateDoc",t._key,e,n,r):Q3(s,"updateDoc",t._key,e),B_(i,[o.toMutation(t._key,An.exists(!0))])}function ij(t,e){const n=Zr(t.firestore,vo),r=Nt(t),i=YA(t.converter,e);return B_(n,[qA(V_(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,An.exists(!1))]).then(()=>r)}function sj(t,...e){var n,r,i;t=Mt(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||q1(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(q1(e[o])){const p=e[o];e[o]=(n=p.next)===null||n===void 0?void 0:n.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let l,h,d;if(t instanceof kn)h=Zr(t.firestore,vo),d=_h(t._key.path),l={next:p=>{e[o]&&e[o](ZA(h,t,p))},error:e[o+1],complete:e[o+2]};else{const p=Zr(t,jp);h=Zr(p.firestore,vo),d=p._query;const m=new JA(h);l={next:w=>{e[o]&&e[o](new nj(h,m,p,w))},error:e[o+1],complete:e[o+2]},ej(t._query)}return function(m,w,E,x){const D=new jA(x),A=new xA(w,D,E);return m.asyncQueue.enqueueAndForget(async()=>CA(await Ov(m),A)),()=>{D.eu(),m.asyncQueue.enqueueAndForget(async()=>AA(await Ov(m),A))}}(N_(h),d,a,l)}function B_(t,e){return function(r,i){const s=new Ki;return r.asyncQueue.enqueueAndForget(async()=>C3(await V3(r),i,s)),s.promise}(N_(t),e)}function ZA(t,e,n){const r=n.docs.get(e._key),i=new JA(t);return new XA(t,i,e._key,r,new uc(n.hasPendingWrites,n.fromCache),e.converter)}function oj(){return new F_("serverTimestamp")}function aj(...t){return new U_("arrayUnion",t)}(function(e,n=!0){(function(i){fu=i})(hu),Ii(new ti("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new vo(new UM(r.getProvider("auth-internal")),new qM(r.getProvider("app-check-internal")),function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new ne(K.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ea(h.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Rr(FE,"4.7.5",e),Rr(FE,"4.7.5","esm2017")})();const ex="@firebase/installations",q_="0.6.11";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tx=1e4,nx=`w:${q_}`,rx="FIS_v2",lj="https://firebaseinstallations.googleapis.com/v1",uj=60*60*1e3,cj="installations",hj="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dj={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Aa=new La(cj,hj,dj);function ix(t){return t instanceof ni&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sx({projectId:t}){return`${lj}/projects/${t}/installations`}function ox(t){return{token:t.token,requestStatus:2,expiresIn:pj(t.expiresIn),creationTime:Date.now()}}async function ax(t,e){const r=(await e.json()).error;return Aa.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function lx({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function fj(t,{refreshToken:e}){const n=lx(t);return n.append("Authorization",gj(e)),n}async function ux(t){const e=await t();return e.status>=500&&e.status<600?t():e}function pj(t){return Number(t.replace("s","000"))}function gj(t){return`${rx} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mj({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=sx(t),i=lx(t),s=e.getImmediate({optional:!0});if(s){const h=await s.getHeartbeatsHeader();h&&i.append("x-firebase-client",h)}const o={fid:n,authVersion:rx,appId:t.appId,sdkVersion:nx},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await ux(()=>fetch(r,a));if(l.ok){const h=await l.json();return{fid:h.fid||n,registrationStatus:2,refreshToken:h.refreshToken,authToken:ox(h.authToken)}}else throw await ax("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cx(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vj(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yj=/^[cdef][\w-]{21}$/,Nv="";function _j(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=wj(t);return yj.test(n)?n:Nv}catch{return Nv}}function wj(t){return vj(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zp(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx=new Map;function dx(t,e){const n=zp(t);fx(n,e),Ej(n,e)}function fx(t,e){const n=hx.get(t);if(n)for(const r of n)r(e)}function Ej(t,e){const n=Tj();n&&n.postMessage({key:t,fid:e}),Ij()}let oa=null;function Tj(){return!oa&&"BroadcastChannel"in self&&(oa=new BroadcastChannel("[Firebase] FID Change"),oa.onmessage=t=>{fx(t.data.key,t.data.fid)}),oa}function Ij(){hx.size===0&&oa&&(oa.close(),oa=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sj="firebase-installations-database",bj=1,xa="firebase-installations-store";let Yg=null;function H_(){return Yg||(Yg=cb(Sj,bj,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(xa)}}})),Yg}async function Jf(t,e){const n=zp(t),i=(await H_()).transaction(xa,"readwrite"),s=i.objectStore(xa),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&dx(t,e.fid),e}async function px(t){const e=zp(t),r=(await H_()).transaction(xa,"readwrite");await r.objectStore(xa).delete(e),await r.done}async function Bp(t,e){const n=zp(t),i=(await H_()).transaction(xa,"readwrite"),s=i.objectStore(xa),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&dx(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W_(t){let e;const n=await Bp(t.appConfig,r=>{const i=Cj(r),s=Aj(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===Nv?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function Cj(t){const e=t||{fid:_j(),registrationStatus:0};return gx(e)}function Aj(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(Aa.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=xj(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Pj(t)}:{installationEntry:e}}async function xj(t,e){try{const n=await mj(t,e);return Jf(t.appConfig,n)}catch(n){throw ix(n)&&n.customData.serverCode===409?await px(t.appConfig):await Jf(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function Pj(t){let e=await H1(t.appConfig);for(;e.registrationStatus===1;)await cx(100),e=await H1(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await W_(t);return r||n}return e}function H1(t){return Bp(t,e=>{if(!e)throw Aa.create("installation-not-found");return gx(e)})}function gx(t){return kj(t)?{fid:t.fid,registrationStatus:0}:t}function kj(t){return t.registrationStatus===1&&t.registrationTime+tx<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rj({appConfig:t,heartbeatServiceProvider:e},n){const r=Dj(t,n),i=fj(t,n),s=e.getImmediate({optional:!0});if(s){const h=await s.getHeartbeatsHeader();h&&i.append("x-firebase-client",h)}const o={installation:{sdkVersion:nx,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await ux(()=>fetch(r,a));if(l.ok){const h=await l.json();return ox(h)}else throw await ax("Generate Auth Token",l)}function Dj(t,{fid:e}){return`${sx(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K_(t,e=!1){let n;const r=await Bp(t.appConfig,s=>{if(!mx(s))throw Aa.create("not-registered");const o=s.authToken;if(!e&&Lj(o))return s;if(o.requestStatus===1)return n=Oj(t,e),s;{if(!navigator.onLine)throw Aa.create("app-offline");const a=Vj(s);return n=Nj(t,a),a}});return n?await n:r.authToken}async function Oj(t,e){let n=await W1(t.appConfig);for(;n.authToken.requestStatus===1;)await cx(100),n=await W1(t.appConfig);const r=n.authToken;return r.requestStatus===0?K_(t,e):r}function W1(t){return Bp(t,e=>{if(!mx(e))throw Aa.create("not-registered");const n=e.authToken;return jj(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function Nj(t,e){try{const n=await Rj(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await Jf(t.appConfig,r),n}catch(n){if(ix(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await px(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Jf(t.appConfig,r)}throw n}}function mx(t){return t!==void 0&&t.registrationStatus===2}function Lj(t){return t.requestStatus===2&&!Mj(t)}function Mj(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+uj}function Vj(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function jj(t){return t.requestStatus===1&&t.requestTime+tx<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fj(t){const e=t,{installationEntry:n,registrationPromise:r}=await W_(e);return r?r.catch(console.error):K_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uj(t,e=!1){const n=t;return await $j(n),(await K_(n,e)).token}async function $j(t){const{registrationPromise:e}=await W_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zj(t){if(!t||!t.options)throw Xg("App Configuration");if(!t.name)throw Xg("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Xg(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Xg(t){return Aa.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vx="installations",Bj="installations-internal",qj=t=>{const e=t.getProvider("app").getImmediate(),n=zj(e),r=Ma(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},Hj=t=>{const e=t.getProvider("app").getImmediate(),n=Ma(e,vx).getImmediate();return{getId:()=>Fj(n),getToken:i=>Uj(n,i)}};function Wj(){Ii(new ti(vx,qj,"PUBLIC")),Ii(new ti(Bj,Hj,"PRIVATE"))}Wj();Rr(ex,q_);Rr(ex,q_,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zf="analytics",Kj="firebase_id",Gj="origin",Qj=60*1e3,Yj="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",G_="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hn=new wp("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xj={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},or=new La("analytics","Analytics",Xj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jj(t){if(!t.startsWith(G_)){const e=or.create("invalid-gtag-resource",{gtagURL:t});return Hn.warn(e.message),""}return t}function yx(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function Zj(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function e4(t,e){const n=Zj("firebase-js-sdk-policy",{createScriptURL:Jj}),r=document.createElement("script"),i=`${G_}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function t4(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function n4(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const l=(await yx(n)).find(h=>h.measurementId===i);l&&await e[l.appId]}}catch(a){Hn.error(a)}t("config",i,s)}async function r4(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await yx(n);for(const l of o){const h=a.find(p=>p.measurementId===l),d=h&&e[h.appId];if(d)s.push(d);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){Hn.error(s)}}function i4(t,e,n,r){async function i(s,...o){try{if(s==="event"){const[a,l]=o;await r4(t,e,n,a,l)}else if(s==="config"){const[a,l]=o;await n4(t,e,n,r,a,l)}else if(s==="consent"){const[a,l]=o;t("consent",a,l)}else if(s==="get"){const[a,l,h]=o;t("get",a,l,h)}else if(s==="set"){const[a]=o;t("set",a)}else t(s,...o)}catch(a){Hn.error(a)}}return i}function s4(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=i4(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function o4(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(G_)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a4=30,l4=1e3;class u4{constructor(e={},n=l4){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const _x=new u4;function c4(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function h4(t){var e;const{appId:n,apiKey:r}=t,i={method:"GET",headers:c4(r)},s=Yj.replace("{app-id}",n),o=await fetch(s,i);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw or.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function d4(t,e=_x,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw or.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw or.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new g4;return setTimeout(async()=>{a.abort()},Qj),wx({appId:r,apiKey:i,measurementId:s},o,a,e)}async function wx(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=_x){var s;const{appId:o,measurementId:a}=t;try{await f4(r,e)}catch(l){if(a)return Hn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw l}try{const l=await h4(t);return i.deleteThrottleMetadata(o),l}catch(l){const h=l;if(!p4(h)){if(i.deleteThrottleMetadata(o),a)return Hn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${h==null?void 0:h.message}]`),{appId:o,measurementId:a};throw l}const d=Number((s=h==null?void 0:h.customData)===null||s===void 0?void 0:s.httpStatus)===503?cE(n,i.intervalMillis,a4):cE(n,i.intervalMillis),p={throttleEndTimeMillis:Date.now()+d,backoffCount:n+1};return i.setThrottleMetadata(o,p),Hn.debug(`Calling attemptFetch again in ${d} millis`),wx(t,p,r,i)}}function f4(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(or.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function p4(t){if(!(t instanceof ni)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class g4{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function m4(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,o=Object.assign(Object.assign({},r),{send_to:s});t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v4(){if(qy())try{await ab()}catch(t){return Hn.warn(or.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return Hn.warn(or.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function y4(t,e,n,r,i,s,o){var a;const l=d4(t);l.then(w=>{n[w.measurementId]=w.appId,t.options.measurementId&&w.measurementId!==t.options.measurementId&&Hn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${w.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(w=>Hn.error(w)),e.push(l);const h=v4().then(w=>{if(w)return r.getId()}),[d,p]=await Promise.all([l,h]);o4(s)||e4(s,d.measurementId),i("js",new Date);const m=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return m[Gj]="firebase",m.update=!0,p!=null&&(m[Kj]=p),i("config",d.measurementId,m),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(e){this.app=e}_delete(){return delete Ac[this.app.options.appId],Promise.resolve()}}let Ac={},K1=[];const G1={};let Jg="dataLayer",w4="gtag",Q1,Ex,Y1=!1;function E4(){const t=[];if(sb()&&t.push("This is a browser extension environment."),s2()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=or.create("invalid-analytics-context",{errorInfo:e});Hn.warn(n.message)}}function T4(t,e,n){E4();const r=t.options.appId;if(!r)throw or.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Hn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw or.create("no-api-key");if(Ac[r]!=null)throw or.create("already-exists",{id:r});if(!Y1){t4(Jg);const{wrappedGtag:s,gtagCore:o}=s4(Ac,K1,G1,Jg,w4);Ex=s,Q1=o,Y1=!0}return Ac[r]=y4(t,K1,G1,e,Q1,Jg,n),new _4(t)}function I4(t=db()){t=Mt(t);const e=Ma(t,Zf);return e.isInitialized()?e.getImmediate():S4(t)}function S4(t,e={}){const n=Ma(t,Zf);if(n.isInitialized()){const i=n.getImmediate();if(va(e,n.getOptions()))return i;throw or.create("already-initialized")}return n.initialize({options:e})}function b4(t,e,n,r){t=Mt(t),m4(Ex,Ac[t.app.options.appId],e,n,r).catch(i=>Hn.error(i))}const X1="@firebase/analytics",J1="0.10.10";function C4(){Ii(new ti(Zf,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return T4(r,i,n)},"PUBLIC")),Ii(new ti("analytics-internal",t,"PRIVATE")),Rr(X1,J1),Rr(X1,J1,"esm2017");function t(e){try{const n=e.getProvider(Zf).getImmediate();return{logEvent:(r,i,s)=>b4(n,r,i,s)}}catch(n){throw or.create("interop-component-reg-failed",{reason:n})}}}C4();const A4={apiKey:"AIzaSyDcGX1V06Iox4rkwOm9BW2gfC1-jj8TiSs",authDomain:"chessmatch-b38ef.firebaseapp.com",projectId:"chessmatch-b38ef",storageBucket:"chessmatch-b38ef.firebasestorage.app",messagingSenderId:"293162008011",appId:"1:293162008011:web:e605313c7055f1ce784a4e",measurementId:"G-2V8DL9QX5J"},Q_=hb(A4),ct=NM(Q_),xt=$3(Q_,{cacheSizeBytes:5242880,experimentalForceLongPolling:!0});I4(Q_);z3(xt).catch(t=>{console.error("Error enabling persistence:",t)});function x4(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}const oh="abcdefgh".split(""),tf={a8:"bR",b8:"bN",c8:"bB",d8:"bQ",e8:"bK",f8:"bB",g8:"bN",h8:"bR",a7:"bP",b7:"bP",c7:"bP",d7:"bP",e7:"bP",f7:"bP",g7:"bP",h7:"bP",a2:"wP",b2:"wP",c2:"wP",d2:"wP",e2:"wP",f2:"wP",g2:"wP",h2:"wP",a1:"wR",b1:"wN",c1:"wB",d1:"wQ",e1:"wK",f1:"wB",g1:"wN",h1:"wR"},P4={a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},k4={a:7,b:6,c:5,d:4,e:3,f:2,g:1,h:0},R4=[7,6,5,4,3,2,1,0],D4=[0,1,2,3,4,5,6,7],Z1={wP:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsx("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:"#ffffff",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})})),wR:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{opacity:"1",fill:"#ffffff",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsx("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 34,14 L 31,17 L 14,17 L 11,14"}),y.jsx("path",{d:"M 31,17 L 31,29.5 L 14,29.5 L 14,17",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5"}),y.jsx("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]}))})),wN:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsx("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:"#ffffff",stroke:"#000000"}}),y.jsx("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:"#ffffff",stroke:"#000000"}}),y.jsx("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#000000",stroke:"#000000"}}),y.jsx("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#000000",stroke:"#000000"}})]}))})),wB:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsxs("g",Object.assign({style:{fill:"#ffffff",stroke:"#000000",strokeLinecap:"butt"}},{children:[y.jsx("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),y.jsx("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),y.jsx("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]})),y.jsx("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]}))})),wQ:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{fill:"#ffffff",stroke:"#000000",strokeWidth:"1.5",strokeLinejoin:"round"}},{children:[y.jsx("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"}),y.jsx("path",{d:"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 11,36 11,36 C 9.5,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"}),y.jsx("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30",style:{fill:"none"}}),y.jsx("path",{d:"M 12,33.5 C 18,32.5 27,32.5 33,33.5",style:{fill:"none"}}),y.jsx("circle",{cx:"6",cy:"12",r:"2"}),y.jsx("circle",{cx:"14",cy:"9",r:"2"}),y.jsx("circle",{cx:"22.5",cy:"8",r:"2"}),y.jsx("circle",{cx:"31",cy:"9",r:"2"}),y.jsx("circle",{cx:"39",cy:"12",r:"2"})]}))})),wK:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsx("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:"#ffffff",stroke:"#000000",strokeLinecap:"butt",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:"#ffffff",stroke:"#000000"}}),y.jsx("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30",style:{fill:"none",stroke:"#000000"}}),y.jsx("path",{d:"M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5",style:{fill:"none",stroke:"#000000"}}),y.jsx("path",{d:"M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#000000"}})]}))})),bP:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsx("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:"#000000",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})})),bR:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{opacity:"1",fill:"#000000",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsx("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z ",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z ",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z ",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z ",style:{strokeLinecap:"butt"}}),y.jsx("path",{d:"M 12,35.5 L 33,35.5 L 33,35.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 13,31.5 L 32,31.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 14,29.5 L 31,29.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 14,16.5 L 31,16.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}})]}))})),bN:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsx("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:"#000000",stroke:"#000000"}}),y.jsx("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:"#000000",stroke:"#000000"}}),y.jsx("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#ffffff",stroke:"#ffffff"}}),y.jsx("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#ffffff",stroke:"#ffffff"}}),y.jsx("path",{d:"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z ",style:{fill:"#ffffff",stroke:"none"}})]}))})),bB:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsxs("g",Object.assign({style:{fill:"#000000",stroke:"#000000",strokeLinecap:"butt"}},{children:[y.jsx("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),y.jsx("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),y.jsx("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]})),y.jsx("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#ffffff",strokeLinejoin:"miter"}})]}))})),bQ:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{fill:"#000000",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}},{children:[y.jsx("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z",style:{strokeLinecap:"butt",fill:"#000000"}}),y.jsx("path",{d:"m 9,26 c 0,2 1.5,2 2.5,4 1,1.5 1,1 0.5,3.5 -1.5,1 -1,2.5 -1,2.5 -1.5,1.5 0,2.5 0,2.5 6.5,1 16.5,1 23,0 0,0 1.5,-1 0,-2.5 0,0 0.5,-1.5 -1,-2.5 -0.5,-2.5 -0.5,-2 0.5,-3.5 1,-2 2.5,-2 2.5,-4 -8.5,-1.5 -18.5,-1.5 -27,0 z"}),y.jsx("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30"}),y.jsx("path",{d:"m 12,33.5 c 6,-1 15,-1 21,0"}),y.jsx("circle",{cx:"6",cy:"12",r:"2"}),y.jsx("circle",{cx:"14",cy:"9",r:"2"}),y.jsx("circle",{cx:"22.5",cy:"8",r:"2"}),y.jsx("circle",{cx:"31",cy:"9",r:"2"}),y.jsx("circle",{cx:"39",cy:"12",r:"2"}),y.jsx("path",{d:"M 11,38.5 A 35,35 1 0 0 34,38.5",style:{fill:"none",stroke:"#000000",strokeLinecap:"butt"}}),y.jsxs("g",Object.assign({style:{fill:"none",stroke:"#ffffff"}},{children:[y.jsx("path",{d:"M 11,29 A 35,35 1 0 1 34,29"}),y.jsx("path",{d:"M 12.5,31.5 L 32.5,31.5"}),y.jsx("path",{d:"M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"}),y.jsx("path",{d:"M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"})]}))]}))})),bK:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:y.jsxs("g",Object.assign({style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[y.jsx("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"},id:"path6570"}),y.jsx("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:"#000000",fillOpacity:"1",strokeLinecap:"butt",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:"#000000",stroke:"#000000"}}),y.jsx("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),y.jsx("path",{d:"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.5,26.6 L 22.5,24.5 C 20,18 10.85,14 6.97,19.85 C 4.5,25.5 13,29.5 13,29.5",style:{fill:"none",stroke:"#ffffff"}}),y.jsx("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30 M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5 M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#ffffff"}})]}))}))};function Lv(t,e,n){const r=e/8,i=t==="white"?P4:k4,s=t==="white"?R4:D4,o=i[n[0]]*r+r/2,a=s[parseInt(n[1],10)-1]*r+r/2;return{x:o,y:a}}function eT(t){let e=!1;return Object.keys(tf).forEach(n=>{t[n]!==tf[n]&&(e=!0)}),Object.keys(t).forEach(n=>{tf[n]!==t[n]&&(e=!0)}),e}function O4(t,e){const n={removed:{},added:{}};return Object.keys(t).forEach(r=>{e[r]!==t[r]&&(n.removed[r]=t[r])}),Object.keys(e).forEach(r=>{t[r]!==e[r]&&(n.added[r]=e[r])}),n}function tT(t){return t==="start"?tf:typeof t=="string"?N4(t):t}function N4(t){if(!L4(t))return{};t=t.replace(/ .+$/,"");const e=t.split("/"),n={};let r=8;for(let i=0;i<8;i++){const s=e[i].split("");let o=0;for(let a=0;a<s.length;a++)if(s[a].search(/[1-8]/)!==-1){const l=parseInt(s[a],10);o=o+l}else{const l=oh[o]+r;n[l]=V4(s[a]),o=o+1}r=r-1}return n}function L4(t){t=t.replace(/ .+$/,""),t=M4(t);const e=t.split("/");if(e.length!==8)return!1;for(let n=0;n<8;n++)if(e[n].length!==8||e[n].search(/[^kqrnbpKQRNBP1]/)!==-1)return!1;return!0}function M4(t){return t.replace(/8/g,"11111111").replace(/7/g,"1111111").replace(/6/g,"111111").replace(/5/g,"11111").replace(/4/g,"1111").replace(/3/g,"111").replace(/2/g,"11")}function V4(t){return t.toLowerCase()===t?"b"+t.toUpperCase():"w"+t.toUpperCase()}const j4=(t,e=!0,n,r)=>{const[i,s]=N.useState([]),[o,a]=N.useState([]),[l,h]=N.useState();N.useEffect(()=>{Array.isArray(t)&&(d(),s(t==null?void 0:t.filter(E=>E[0]!==E[1])))},[t]),N.useEffect(()=>{n==null||n(o)},[o]);function d(){a([]),h(void 0)}const p=(E,x)=>{e&&h([E,x,r])},m=[...o,...i];return{arrows:m,newArrow:l,clearArrows:d,drawNewArrow:p,setArrows:a,onArrowDrawEnd:(E,x)=>{if(E===x||!e)return;let D;const A=[E,x,r];m.every(([S,M])=>!(S===E&&M===x))?D=[...o,A]:D=o.filter(([S,M])=>!(S===E&&M===x)),h(void 0),a(D)}}},Tx=N.createContext({}),ls=()=>N.useContext(Tx),F4=N.forwardRef(({allowDragOutsideBoard:t=!0,animationDuration:e=300,areArrowsAllowed:n=!0,arePiecesDraggable:r=!0,arePremovesAllowed:i=!1,autoPromoteToQueen:s=!1,boardOrientation:o="white",boardWidth:a,children:l,clearPremovesOnRightClick:h=!0,customArrows:d,customArrowColor:p="rgb(255,170,0)",customBoardStyle:m,customNotationStyle:w,customDarkSquareStyle:E={backgroundColor:"#B58863"},customDropSquareStyle:x={boxShadow:"inset 0 0 1px 6px rgba(255,255,255,0.75)"},customLightSquareStyle:D={backgroundColor:"#F0D9B5"},customPieces:A,customPremoveDarkSquareStyle:T={backgroundColor:"#A42323"},customPremoveLightSquareStyle:S={backgroundColor:"#BD2828"},customSquare:M="div",customSquareStyles:q,dropOffBoardAction:W="snapback",id:P=0,isDraggablePiece:C=()=>!0,getPositionObject:R=()=>{},onArrowsChange:O=()=>{},onDragOverSquare:L=()=>{},onMouseOutSquare:V=()=>{},onMouseOverSquare:k=()=>{},onPieceClick:ve=()=>{},onPieceDragBegin:Ie=()=>{},onPieceDragEnd:Fe=()=>{},onPieceDrop:Ce=()=>!0,onPieceDropOffBoard:X=()=>{},onPromotionCheck:ue=(bt,Kt,On)=>(On==="wP"&&bt[1]==="7"&&Kt[1]==="8"||On==="bP"&&bt[1]==="2"&&Kt[1]==="1")&&Math.abs(bt.charCodeAt(0)-Kt.charCodeAt(0))<=1,onPromotionPieceSelect:z=()=>!0,onSparePieceDrop:Ne=()=>!0,onSquareClick:Le=()=>{},onSquareRightClick:Be=()=>{},position:lt="start",promotionDialogVariant:jt="default",promotionToSquare:nt=null,showBoardNotation:de=!0,showPromotionDialog:se=!1,snapToCursor:Wn=!0},Kn)=>{const[bt,Kt]=N.useState(tT(lt)),[On,us]=N.useState({removed:{},added:{}}),[Gn,on]=N.useState(void 0),[mu,Ao]=N.useState(se&&!s),[Ua,cs]=N.useState(null),[$a,xo]=N.useState(nt),[hs,hr]=N.useState([]),Rt=N.useRef(hs),[gt,it]=N.useState(),[Qn,Mr]=N.useState(Object.assign(Object.assign({},Z1),A)),[bi,ds]=N.useState(!1),[Yn,za]=N.useState(),[Ci,ri]=N.useState(!1),[vu,yu]=N.useState(null);N.useImperativeHandle(Kn,()=>({clearPremoves(Ue=!0){Nn(Ue)}})),N.useEffect(()=>{Mr(Object.assign(Object.assign({},Z1),A))},[A]),N.useEffect(()=>{Ao(se),xo(nt)},[nt,se]),N.useEffect(()=>{var Ue,Xe,Ct;yn();const qe=tT(lt),dr=O4(bt,qe),en=((Ue=Object.keys(dr.added))===null||Ue===void 0?void 0:Ue.length)<=2?(Ct=(Xe=Object.entries(dr.added))===null||Xe===void 0?void 0:Xe[0])===null||Ct===void 0?void 0:Ct[1][0]:void 0;if(Ci)Kt(qe),ri(!1),i&&ps(en),Yn&&clearTimeout(Yn);else if(bi)Kt(qe),ri(!1),i&&ps(en);else{eT(qe)&&Gn!==void 0?on(en):eT(qe)?on(void 0):on("b"),us(dr),ri(!0);const ms=setTimeout(()=>{Kt(qe),ri(!1),i&&ps(en)},e);za(ms)}return ds(!1),R(qe),Vr(),()=>{clearTimeout(Yn)}},[lt]);const{arrows:Po,newArrow:ko,clearArrows:Vr,drawNewArrow:ii,onArrowDrawEnd:fs}=j4(d,n,O,p);function Ro(Ue,Xe,Ct,qe){if(Ue===Xe)return;if(Vr(),i&&Ci||i&&(Gn===Ct[0]||Rt.current.filter(en=>en.piece[0]===Ct[0]).length>0)){const en=[...Rt.current];en.push({sourceSq:Ue,targetSq:Xe,piece:Ct}),Rt.current=en,hr([...en]),yn();return}if(!i&&Ci)return;const dr=Object.assign({},bt);ds(!!qe),on(Ct[0]),Ce.length?Ce(Ue,Xe,Ct)||(Nn(),ds(!1)):(delete dr[Ue],dr[Xe]=Ct,Kt(dr)),yn(),R(dr)}function jr(Ue){const Xe=Object.assign({},bt);delete Xe[Ue],Kt(Xe),R(Xe)}function ps(Ue){if(Rt.current.length===0)return;const Xe=Rt.current[0];if(Xe.piece[0]!==void 0&&Xe.piece[0]!==Ue&&Ce.length)if(on(Xe.piece[0]),ds(!0),Ce(Xe.sourceSq,Xe.targetSq,Xe.piece)){const qe=[...Rt.current];qe.shift(),Rt.current=qe,hr([...qe])}else Nn()}function gs(Ue,Xe){if(!Ne(Ue,Xe))return;const qe=Object.assign({},bt);qe[Xe]=Ue,Kt(qe),R(qe)}function Nn(Ue=!0){Ue&&on(void 0),Rt.current=[],hr([])}function yn(){cs(null),xo(null),Ao(!1)}function Ba(Ue){it(Ue)}function Ft(Ue){if(gt){if(gt===Ue){it(void 0),h&&Nn(!1),Be(Ue);return}}else it(void 0)}function qa(){it(void 0)}const Ai={allowDragOutsideBoard:t,animationDuration:e,arePiecesDraggable:r,arePremovesAllowed:i,arrows:Po,autoPromoteToQueen:s,boardOrientation:o,boardWidth:a,chessPieces:Qn,clearArrows:Vr,clearCurrentRightClickDown:qa,currentPosition:bt,currentRightClickDown:gt,customArrowColor:p,customBoardStyle:m,customDarkSquareStyle:E,customDropSquareStyle:x,customLightSquareStyle:D,customNotationStyle:w,customPremoveDarkSquareStyle:T,customPremoveLightSquareStyle:S,customSquare:M,customSquareStyles:q,deletePieceFromSquare:jr,drawNewArrow:ii,dropOffBoardAction:W,handleSetPosition:Ro,handleSparePieceDrop:gs,id:P,isDraggablePiece:C,isWaitingForAnimation:Ci,lastPieceColour:Gn,lastSquareDraggedOver:vu,newArrow:ko,onArrowDrawEnd:fs,onDragOverSquare:L,onMouseOutSquare:V,onMouseOverSquare:k,onPieceClick:ve,onPieceDragBegin:Ie,onPieceDragEnd:Fe,onPieceDrop:Ce,onPieceDropOffBoard:X,onPromotionCheck:ue,onPromotionPieceSelect:z,onRightClickDown:Ba,onRightClickUp:Ft,onSparePieceDrop:Ne,onSquareClick:Le,positionDifferences:On,premoves:hs,promoteFromSquare:Ua,promoteToSquare:$a,promotionDialogVariant:jt,setLastSquareDraggedOver:yu,setPromoteFromSquare:cs,setPromoteToSquare:xo,setShowPromoteDialog:Ao,showBoardNotation:de,showPromoteDialog:mu,snapToCursor:Wn};return y.jsx(Tx.Provider,Object.assign({value:Ai},{children:l}))});function U4({row:t,col:e}){const{boardOrientation:n,boardWidth:r,customDarkSquareStyle:i,customLightSquareStyle:s,customNotationStyle:o}=ls(),a=s.backgroundColor,l=i.backgroundColor,h=e===0,d=t===7,p=h&&d;function m(){return n==="white"?8-t:t+1}function w(){return n==="black"?oh[7-e]:oh[e]}function E(){return y.jsxs(y.Fragment,{children:[y.jsx("div",Object.assign({style:Object.assign(Object.assign({zIndex:3,position:"absolute"},{color:a}),rT(r,o))},{children:m()})),y.jsx("div",Object.assign({style:Object.assign(Object.assign({zIndex:3,position:"absolute"},{color:a}),nT(r,o))},{children:w()}))]})}function x(){return y.jsx("div",Object.assign({style:Object.assign(Object.assign({userSelect:"none",zIndex:3,position:"absolute"},{color:e%2!==0?l:a}),nT(r,o))},{children:w()}))}function D(){return y.jsx("div",Object.assign({style:Object.assign(Object.assign({userSelect:"none",zIndex:3,position:"absolute"},n==="black"?{color:t%2===0?l:a}:{color:t%2===0?l:a}),rT(r,o))},{children:m()}))}return p?E():d?x():h?D():null}const nT=(t,e)=>Object.assign({alignSelf:"flex-end",paddingLeft:t/8-t/48,fontSize:t/48},e),rT=(t,e)=>Object.assign({alignSelf:"flex-start",paddingRight:t/8-t/48,fontSize:t/48},e),Ix=N.createContext({dragDropManager:void 0});function Ir(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var iT=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),sT=function(){return Math.random().toString(36).substring(7).split("").join(".")},oT={INIT:"@@redux/INIT"+sT(),REPLACE:"@@redux/REPLACE"+sT()};function $4(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function Sx(t,e,n){var r;if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Ir(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Ir(1));return n(Sx)(t,e)}if(typeof t!="function")throw new Error(Ir(2));var i=t,s=e,o=[],a=o,l=!1;function h(){a===o&&(a=o.slice())}function d(){if(l)throw new Error(Ir(3));return s}function p(x){if(typeof x!="function")throw new Error(Ir(4));if(l)throw new Error(Ir(5));var D=!0;return h(),a.push(x),function(){if(D){if(l)throw new Error(Ir(6));D=!1,h();var T=a.indexOf(x);a.splice(T,1),o=null}}}function m(x){if(!$4(x))throw new Error(Ir(7));if(typeof x.type>"u")throw new Error(Ir(8));if(l)throw new Error(Ir(9));try{l=!0,s=i(s,x)}finally{l=!1}for(var D=o=a,A=0;A<D.length;A++){var T=D[A];T()}return x}function w(x){if(typeof x!="function")throw new Error(Ir(10));i=x,m({type:oT.REPLACE})}function E(){var x,D=p;return x={subscribe:function(T){if(typeof T!="object"||T===null)throw new Error(Ir(11));function S(){T.next&&T.next(d())}S();var M=D(S);return{unsubscribe:M}}},x[iT]=function(){return this},x}return m({type:oT.INIT}),r={dispatch:m,subscribe:p,getState:d,replaceReducer:w},r[iT]=E,r}function Ee(t,e,...n){if(z4()&&e===void 0)throw new Error("invariant requires an error message argument");if(!t){let r;if(e===void 0)r=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let i=0;r=new Error(e.replace(/%s/g,function(){return n[i++]})),r.name="Invariant Violation"}throw r.framesToPop=1,r}}function z4(){return typeof process<"u"&&!0}function B4(t,e,n){return e.split(".").reduce((r,i)=>r&&r[i]?r[i]:n||null,t)}function q4(t,e){return t.filter(n=>n!==e)}function bx(t){return typeof t=="object"}function H4(t,e){const n=new Map,r=s=>{n.set(s,n.has(s)?n.get(s)+1:1)};t.forEach(r),e.forEach(r);const i=[];return n.forEach((s,o)=>{s===1&&i.push(o)}),i}function W4(t,e){return t.filter(n=>e.indexOf(n)>-1)}const Y_="dnd-core/INIT_COORDS",qp="dnd-core/BEGIN_DRAG",X_="dnd-core/PUBLISH_DRAG_SOURCE",Hp="dnd-core/HOVER",Wp="dnd-core/DROP",Kp="dnd-core/END_DRAG";function aT(t,e){return{type:Y_,payload:{sourceClientOffset:e||null,clientOffset:t||null}}}const K4={type:Y_,payload:{clientOffset:null,sourceClientOffset:null}};function G4(t){return function(n=[],r={publishSource:!0}){const{publishSource:i=!0,clientOffset:s,getSourceClientOffset:o}=r,a=t.getMonitor(),l=t.getRegistry();t.dispatch(aT(s)),Q4(n,a,l);const h=J4(n,a);if(h==null){t.dispatch(K4);return}let d=null;if(s){if(!o)throw new Error("getSourceClientOffset must be defined");Y4(o),d=o(h)}t.dispatch(aT(s,d));const m=l.getSource(h).beginDrag(a,h);if(m==null)return;X4(m),l.pinSource(h);const w=l.getSourceType(h);return{type:qp,payload:{itemType:w,item:m,sourceId:h,clientOffset:s||null,sourceClientOffset:d||null,isSourcePublic:!!i}}}}function Q4(t,e,n){Ee(!e.isDragging(),"Cannot call beginDrag while dragging."),t.forEach(function(r){Ee(n.getSource(r),"Expected sourceIds to be registered.")})}function Y4(t){Ee(typeof t=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function X4(t){Ee(bx(t),"Item must be an object.")}function J4(t,e){let n=null;for(let r=t.length-1;r>=0;r--)if(e.canDragSource(t[r])){n=t[r];break}return n}function Z4(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eF(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),r.forEach(function(i){Z4(t,i,n[i])})}return t}function tF(t){return function(n={}){const r=t.getMonitor(),i=t.getRegistry();nF(r),sF(r).forEach((o,a)=>{const l=rF(o,a,i,r),h={type:Wp,payload:{dropResult:eF({},n,l)}};t.dispatch(h)})}}function nF(t){Ee(t.isDragging(),"Cannot call drop while not dragging."),Ee(!t.didDrop(),"Cannot call drop twice during one drag operation.")}function rF(t,e,n,r){const i=n.getTarget(t);let s=i?i.drop(r,t):void 0;return iF(s),typeof s>"u"&&(s=e===0?{}:r.getDropResult()),s}function iF(t){Ee(typeof t>"u"||bx(t),"Drop result must either be an object or undefined.")}function sF(t){const e=t.getTargetIds().filter(t.canDropOnTarget,t);return e.reverse(),e}function oF(t){return function(){const n=t.getMonitor(),r=t.getRegistry();aF(n);const i=n.getSourceId();return i!=null&&(r.getSource(i,!0).endDrag(n,i),r.unpinSource()),{type:Kp}}}function aF(t){Ee(t.isDragging(),"Cannot call endDrag while not dragging.")}function Mv(t,e){return e===null?t===null:Array.isArray(t)?t.some(n=>n===e):t===e}function lF(t){return function(n,{clientOffset:r}={}){uF(n);const i=n.slice(0),s=t.getMonitor(),o=t.getRegistry(),a=s.getItemType();return hF(i,o,a),cF(i,s,o),dF(i,s,o),{type:Hp,payload:{targetIds:i,clientOffset:r||null}}}}function uF(t){Ee(Array.isArray(t),"Expected targetIds to be an array.")}function cF(t,e,n){Ee(e.isDragging(),"Cannot call hover while not dragging."),Ee(!e.didDrop(),"Cannot call hover after drop.");for(let r=0;r<t.length;r++){const i=t[r];Ee(t.lastIndexOf(i)===r,"Expected targetIds to be unique in the passed array.");const s=n.getTarget(i);Ee(s,"Expected targetIds to be registered.")}}function hF(t,e,n){for(let r=t.length-1;r>=0;r--){const i=t[r],s=e.getTargetType(i);Mv(s,n)||t.splice(r,1)}}function dF(t,e,n){t.forEach(function(r){n.getTarget(r).hover(e,r)})}function fF(t){return function(){if(t.getMonitor().isDragging())return{type:X_}}}function pF(t){return{beginDrag:G4(t),publishDragSource:fF(t),hover:lF(t),drop:tF(t),endDrag:oF(t)}}class gF{receiveBackend(e){this.backend=e}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const e=this,{dispatch:n}=this.store;function r(s){return(...o)=>{const a=s.apply(e,o);typeof a<"u"&&n(a)}}const i=pF(this);return Object.keys(i).reduce((s,o)=>{const a=i[o];return s[o]=r(a),s},{})}dispatch(e){this.store.dispatch(e)}constructor(e,n){this.isSetUp=!1,this.handleRefCountChange=()=>{const r=this.store.getState().refCount>0;this.backend&&(r&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!r&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=e,this.monitor=n,e.subscribe(this.handleRefCountChange)}}function mF(t,e){return{x:t.x+e.x,y:t.y+e.y}}function Cx(t,e){return{x:t.x-e.x,y:t.y-e.y}}function vF(t){const{clientOffset:e,initialClientOffset:n,initialSourceClientOffset:r}=t;return!e||!n||!r?null:Cx(mF(e,r),n)}function yF(t){const{clientOffset:e,initialClientOffset:n}=t;return!e||!n?null:Cx(e,n)}const xc=[],J_=[];xc.__IS_NONE__=!0;J_.__IS_ALL__=!0;function _F(t,e){return t===xc?!1:t===J_||typeof e>"u"?!0:W4(e,t).length>0}class wF{subscribeToStateChange(e,n={}){const{handlerIds:r}=n;Ee(typeof e=="function","listener must be a function."),Ee(typeof r>"u"||Array.isArray(r),"handlerIds, when specified, must be an array of strings.");let i=this.store.getState().stateId;const s=()=>{const o=this.store.getState(),a=o.stateId;try{a===i||a===i+1&&!_F(o.dirtyHandlerIds,r)||e()}finally{i=a}};return this.store.subscribe(s)}subscribeToOffsetChange(e){Ee(typeof e=="function","listener must be a function.");let n=this.store.getState().dragOffset;const r=()=>{const i=this.store.getState().dragOffset;i!==n&&(n=i,e())};return this.store.subscribe(r)}canDragSource(e){if(!e)return!1;const n=this.registry.getSource(e);return Ee(n,`Expected to find a valid source. sourceId=${e}`),this.isDragging()?!1:n.canDrag(this,e)}canDropOnTarget(e){if(!e)return!1;const n=this.registry.getTarget(e);if(Ee(n,`Expected to find a valid target. targetId=${e}`),!this.isDragging()||this.didDrop())return!1;const r=this.registry.getTargetType(e),i=this.getItemType();return Mv(r,i)&&n.canDrop(this,e)}isDragging(){return!!this.getItemType()}isDraggingSource(e){if(!e)return!1;const n=this.registry.getSource(e,!0);if(Ee(n,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()||!this.isSourcePublic())return!1;const r=this.registry.getSourceType(e),i=this.getItemType();return r!==i?!1:n.isDragging(this,e)}isOverTarget(e,n={shallow:!1}){if(!e)return!1;const{shallow:r}=n;if(!this.isDragging())return!1;const i=this.registry.getTargetType(e),s=this.getItemType();if(s&&!Mv(i,s))return!1;const o=this.getTargetIds();if(!o.length)return!1;const a=o.indexOf(e);return r?a===o.length-1:a>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return vF(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return yF(this.store.getState().dragOffset)}constructor(e,n){this.store=e,this.registry=n}}const lT=typeof global<"u"?global:self,Ax=lT.MutationObserver||lT.WebKitMutationObserver;function xx(t){return function(){const n=setTimeout(i,0),r=setInterval(i,50);function i(){clearTimeout(n),clearInterval(r),t()}}}function EF(t){let e=1;const n=new Ax(t),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){e=-e,r.data=e}}const TF=typeof Ax=="function"?EF:xx;class IF{enqueueTask(e){const{queue:n,requestFlush:r}=this;n.length||(r(),this.flushing=!0),n[n.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const n=this.index;if(this.index++,e[n].call(),this.index>this.capacity){for(let r=0,i=e.length-this.index;r<i;r++)e[r]=e[r+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=TF(this.flush),this.requestErrorThrow=xx(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class SF{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,n){this.onError=e,this.release=n,this.task=null}}class bF{create(e){const n=this.freeTasks,r=n.length?n.pop():new SF(this.onError,i=>n[n.length]=i);return r.task=e,r}constructor(e){this.onError=e,this.freeTasks=[]}}const Px=new IF,CF=new bF(Px.registerPendingError);function AF(t){Px.enqueueTask(CF.create(t))}const Z_="dnd-core/ADD_SOURCE",e0="dnd-core/ADD_TARGET",t0="dnd-core/REMOVE_SOURCE",Gp="dnd-core/REMOVE_TARGET";function xF(t){return{type:Z_,payload:{sourceId:t}}}function PF(t){return{type:e0,payload:{targetId:t}}}function kF(t){return{type:t0,payload:{sourceId:t}}}function RF(t){return{type:Gp,payload:{targetId:t}}}function DF(t){Ee(typeof t.canDrag=="function","Expected canDrag to be a function."),Ee(typeof t.beginDrag=="function","Expected beginDrag to be a function."),Ee(typeof t.endDrag=="function","Expected endDrag to be a function.")}function OF(t){Ee(typeof t.canDrop=="function","Expected canDrop to be a function."),Ee(typeof t.hover=="function","Expected hover to be a function."),Ee(typeof t.drop=="function","Expected beginDrag to be a function.")}function Vv(t,e){if(e&&Array.isArray(t)){t.forEach(n=>Vv(n,!1));return}Ee(typeof t=="string"||typeof t=="symbol",e?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var Ar;(function(t){t.SOURCE="SOURCE",t.TARGET="TARGET"})(Ar||(Ar={}));let NF=0;function LF(){return NF++}function MF(t){const e=LF().toString();switch(t){case Ar.SOURCE:return`S${e}`;case Ar.TARGET:return`T${e}`;default:throw new Error(`Unknown Handler Role: ${t}`)}}function uT(t){switch(t[0]){case"S":return Ar.SOURCE;case"T":return Ar.TARGET;default:throw new Error(`Cannot parse handler ID: ${t}`)}}function cT(t,e){const n=t.entries();let r=!1;do{const{done:i,value:[,s]}=n.next();if(s===e)return!0;r=!!i}while(!r);return!1}class VF{addSource(e,n){Vv(e),DF(n);const r=this.addHandler(Ar.SOURCE,e,n);return this.store.dispatch(xF(r)),r}addTarget(e,n){Vv(e,!0),OF(n);const r=this.addHandler(Ar.TARGET,e,n);return this.store.dispatch(PF(r)),r}containsHandler(e){return cT(this.dragSources,e)||cT(this.dropTargets,e)}getSource(e,n=!1){return Ee(this.isSourceId(e),"Expected a valid source ID."),n&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}getTarget(e){return Ee(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}getSourceType(e){return Ee(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}getTargetType(e){return Ee(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}isSourceId(e){return uT(e)===Ar.SOURCE}isTargetId(e){return uT(e)===Ar.TARGET}removeSource(e){Ee(this.getSource(e),"Expected an existing source."),this.store.dispatch(kF(e)),AF(()=>{this.dragSources.delete(e),this.types.delete(e)})}removeTarget(e){Ee(this.getTarget(e),"Expected an existing target."),this.store.dispatch(RF(e)),this.dropTargets.delete(e),this.types.delete(e)}pinSource(e){const n=this.getSource(e);Ee(n,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=n}unpinSource(){Ee(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(e,n,r){const i=MF(e);return this.types.set(i,n),e===Ar.SOURCE?this.dragSources.set(i,r):e===Ar.TARGET&&this.dropTargets.set(i,r),i}constructor(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}}const jF=(t,e)=>t===e;function FF(t,e){return!t&&!e?!0:!t||!e?!1:t.x===e.x&&t.y===e.y}function UF(t,e,n=jF){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!n(t[r],e[r]))return!1;return!0}function $F(t=xc,e){switch(e.type){case Hp:break;case Z_:case e0:case Gp:case t0:return xc;case qp:case X_:case Kp:case Wp:default:return J_}const{targetIds:n=[],prevTargetIds:r=[]}=e.payload,i=H4(n,r);if(!(i.length>0||!UF(n,r)))return xc;const o=r[r.length-1],a=n[n.length-1];return o!==a&&(o&&i.push(o),a&&i.push(a)),i}function zF(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BF(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),r.forEach(function(i){zF(t,i,n[i])})}return t}const hT={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function qF(t=hT,e){const{payload:n}=e;switch(e.type){case Y_:case qp:return{initialSourceClientOffset:n.sourceClientOffset,initialClientOffset:n.clientOffset,clientOffset:n.clientOffset};case Hp:return FF(t.clientOffset,n.clientOffset)?t:BF({},t,{clientOffset:n.clientOffset});case Kp:case Wp:return hT;default:return t}}function HF(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fl(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),r.forEach(function(i){HF(t,i,n[i])})}return t}const WF={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function KF(t=WF,e){const{payload:n}=e;switch(e.type){case qp:return fl({},t,{itemType:n.itemType,item:n.item,sourceId:n.sourceId,isSourcePublic:n.isSourcePublic,dropResult:null,didDrop:!1});case X_:return fl({},t,{isSourcePublic:!0});case Hp:return fl({},t,{targetIds:n.targetIds});case Gp:return t.targetIds.indexOf(n.targetId)===-1?t:fl({},t,{targetIds:q4(t.targetIds,n.targetId)});case Wp:return fl({},t,{dropResult:n.dropResult,didDrop:!0,targetIds:[]});case Kp:return fl({},t,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return t}}function GF(t=0,e){switch(e.type){case Z_:case e0:return t+1;case t0:case Gp:return t-1;default:return t}}function QF(t=0){return t+1}function YF(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XF(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),r.forEach(function(i){YF(t,i,n[i])})}return t}function JF(t={},e){return{dirtyHandlerIds:$F(t.dirtyHandlerIds,{type:e.type,payload:XF({},e.payload,{prevTargetIds:B4(t,"dragOperation.targetIds",[])})}),dragOffset:qF(t.dragOffset,e),refCount:GF(t.refCount,e),dragOperation:KF(t.dragOperation,e),stateId:QF(t.stateId)}}function ZF(t,e=void 0,n={},r=!1){const i=eU(r),s=new wF(i,new VF(i)),o=new gF(i,s),a=t(o,e,n);return o.receiveBackend(a),o}function eU(t){const e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return Sx(JF,t&&e&&e({name:"dnd-core",instanceId:"dnd-core"}))}function tU(t,e){if(t==null)return{};var n=nU(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function nU(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}let dT=0;const nf=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var rU=N.memo(function(e){var{children:n}=e,r=tU(e,["children"]);const[i,s]=iU(r);return N.useEffect(()=>{if(s){const o=kx();return++dT,()=>{--dT===0&&(o[nf]=null)}}},[]),y.jsx(Ix.Provider,{value:i,children:n})});function iU(t){if("manager"in t)return[{dragDropManager:t.manager},!1];const e=sU(t.backend,t.context,t.options,t.debugMode),n=!t.context;return[e,n]}function sU(t,e=kx(),n,r){const i=e;return i[nf]||(i[nf]={dragDropManager:ZF(t,e,n,r)}),i[nf]}function kx(){return typeof global<"u"?global:window}var oU=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;i--!==0;){var o=s[i];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n};const Pa=typeof window<"u"?N.useLayoutEffect:N.useEffect;function Rx(t,e,n){const[r,i]=N.useState(()=>e(t)),s=N.useCallback(()=>{const o=e(t);oU(r,o)||(i(o),n&&n())},[r,t,n]);return Pa(s),[r,s]}function aU(t,e,n){const[r,i]=Rx(t,e,n);return Pa(function(){const o=t.getHandlerId();if(o!=null)return t.subscribeToStateChange(i,{handlerIds:[o]})},[t,i]),r}function Dx(t,e,n){return aU(e,t||(()=>({})),()=>n.reconnect())}function Ox(t,e){const n=[...e||[]];return e==null&&typeof t!="function"&&n.push(t),N.useMemo(()=>typeof t=="function"?t():t,n)}function lU(t){return N.useMemo(()=>t.hooks.dragSource(),[t])}function uU(t){return N.useMemo(()=>t.hooks.dragPreview(),[t])}let Zg=!1,em=!1;class cU{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){Ee(!Zg,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Zg=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{Zg=!1}}isDragging(){if(!this.sourceId)return!1;Ee(!em,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return em=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{em=!1}}subscribeToStateChange(e,n){return this.internalMonitor.subscribeToStateChange(e,n)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,n){return this.internalMonitor.isOverTarget(e,n)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}let tm=!1;class hU{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,n){return this.internalMonitor.subscribeToStateChange(e,n)}canDrop(){if(!this.targetId)return!1;Ee(!tm,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return tm=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{tm=!1}}isOver(e){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,e):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}}function dU(t,e,n){const r=n.getRegistry(),i=r.addTarget(t,e);return[i,()=>r.removeTarget(i)]}function fU(t,e,n){const r=n.getRegistry(),i=r.addSource(t,e);return[i,()=>r.removeSource(i)]}function jv(t,e,n,r){let i;if(i!==void 0)return!!i;if(t===e)return!0;if(typeof t!="object"||!t||typeof e!="object"||!e)return!1;const s=Object.keys(t),o=Object.keys(e);if(s.length!==o.length)return!1;const a=Object.prototype.hasOwnProperty.bind(e);for(let l=0;l<s.length;l++){const h=s[l];if(!a(h))return!1;const d=t[h],p=e[h];if(i=void 0,i===!1||i===void 0&&d!==p)return!1}return!0}function Fv(t){return t!==null&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function pU(t){if(typeof t.type=="string")return;const e=t.type.displayName||t.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${e} into a <div>, or turn it into a drag source or a drop target itself.`)}function gU(t){return(e=null,n=null)=>{if(!N.isValidElement(e)){const s=e;return t(s,n),s}const r=e;return pU(r),mU(r,n?s=>t(s,n):t)}}function Nx(t){const e={};return Object.keys(t).forEach(n=>{const r=t[n];if(n.endsWith("Ref"))e[n]=t[n];else{const i=gU(r);e[n]=()=>i}}),e}function fT(t,e){typeof t=="function"?t(e):t.current=e}function mU(t,e){const n=t.ref;return Ee(typeof n!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),n?N.cloneElement(t,{ref:r=>{fT(n,r),fT(e,r)}}):N.cloneElement(t,{ref:e})}class vU{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,n=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return n&&this.disconnectDragSource(),this.handlerId?e?(n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),n):(this.lastConnectedDragSource=e,n):n}reconnectDragPreview(e=!1){const n=this.dragPreview,r=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(r&&this.disconnectDragPreview(),!!this.handlerId){if(!n){this.lastConnectedDragPreview=n;return}r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=n,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,n,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!jv(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!jv(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=Nx({dragSource:(n,r)=>{this.clearDragSource(),this.dragSourceOptions=r||null,Fv(n)?this.dragSourceRef=n:this.dragSourceNode=n,this.reconnectDragSource()},dragPreview:(n,r)=>{this.clearDragPreview(),this.dragPreviewOptions=r||null,Fv(n)?this.dragPreviewRef=n:this.dragPreviewNode=n,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}class yU{get connectTarget(){return this.dropTarget}reconnect(){const e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();const n=this.dropTarget;if(this.handlerId){if(!n){this.lastConnectedDropTarget=n;return}e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=n,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,n,this.dropTargetOptions))}}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!jv(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=Nx({dropTarget:(n,r)=>{this.clearDropTarget(),this.dropTargetOptions=r,Fv(n)?this.dropTargetRef=n:this.dropTargetNode=n,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}}function Fa(){const{dragDropManager:t}=N.useContext(Ix);return Ee(t!=null,"Expected drag drop context"),t}function _U(t,e){const n=Fa(),r=N.useMemo(()=>new vU(n.getBackend()),[n]);return Pa(()=>(r.dragSourceOptions=t||null,r.reconnect(),()=>r.disconnectDragSource()),[r,t]),Pa(()=>(r.dragPreviewOptions=e||null,r.reconnect(),()=>r.disconnectDragPreview()),[r,e]),r}function wU(){const t=Fa();return N.useMemo(()=>new cU(t),[t])}class EU{beginDrag(){const e=this.spec,n=this.monitor;let r=null;return typeof e.item=="object"?r=e.item:typeof e.item=="function"?r=e.item(n):r={},r??null}canDrag(){const e=this.spec,n=this.monitor;return typeof e.canDrag=="boolean"?e.canDrag:typeof e.canDrag=="function"?e.canDrag(n):!0}isDragging(e,n){const r=this.spec,i=this.monitor,{isDragging:s}=r;return s?s(i):n===e.getSourceId()}endDrag(){const e=this.spec,n=this.monitor,r=this.connector,{end:i}=e;i&&i(n.getItem(),n),r.reconnect()}constructor(e,n,r){this.spec=e,this.monitor=n,this.connector=r}}function TU(t,e,n){const r=N.useMemo(()=>new EU(t,e,n),[e,n]);return N.useEffect(()=>{r.spec=t},[t]),r}function IU(t){return N.useMemo(()=>{const e=t.type;return Ee(e!=null,"spec.type must be defined"),e},[t])}function SU(t,e,n){const r=Fa(),i=TU(t,e,n),s=IU(t);Pa(function(){if(s!=null){const[a,l]=fU(s,i,r);return e.receiveHandlerId(a),n.receiveHandlerId(a),l}},[r,e,n,i,s])}function bU(t,e){const n=Ox(t,e);Ee(!n.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const r=wU(),i=_U(n.options,n.previewOptions);return SU(n,r,i),[Dx(n.collect,r,i),lU(i),uU(i)]}function CU(t){const n=Fa().getMonitor(),[r,i]=Rx(n,t);return N.useEffect(()=>n.subscribeToOffsetChange(i)),N.useEffect(()=>n.subscribeToStateChange(i)),r}function AU(t){return N.useMemo(()=>t.hooks.dropTarget(),[t])}function xU(t){const e=Fa(),n=N.useMemo(()=>new yU(e.getBackend()),[e]);return Pa(()=>(n.dropTargetOptions=t||null,n.reconnect(),()=>n.disconnectDropTarget()),[t]),n}function PU(){const t=Fa();return N.useMemo(()=>new hU(t),[t])}function kU(t){const{accept:e}=t;return N.useMemo(()=>(Ee(t.accept!=null,"accept must be defined"),Array.isArray(e)?e:[e]),[e])}class RU{canDrop(){const e=this.spec,n=this.monitor;return e.canDrop?e.canDrop(n.getItem(),n):!0}hover(){const e=this.spec,n=this.monitor;e.hover&&e.hover(n.getItem(),n)}drop(){const e=this.spec,n=this.monitor;if(e.drop)return e.drop(n.getItem(),n)}constructor(e,n){this.spec=e,this.monitor=n}}function DU(t,e){const n=N.useMemo(()=>new RU(t,e),[e]);return N.useEffect(()=>{n.spec=t},[t]),n}function OU(t,e,n){const r=Fa(),i=DU(t,e),s=kU(t);Pa(function(){const[a,l]=dU(s,i,r);return e.receiveHandlerId(a),n.receiveHandlerId(a),l},[r,e,i,n,s.map(o=>o.toString()).join("|")])}function NU(t,e){const n=Ox(t,e),r=PU(),i=xU(n.options);return OU(n,r,i),[Dx(n.collect,r,i),AU(i)]}function Lx(t){let e=null;return()=>(e==null&&(e=t()),e)}function LU(t,e){return t.filter(n=>n!==e)}function MU(t,e){const n=new Set,r=s=>n.add(s);t.forEach(r),e.forEach(r);const i=[];return n.forEach(s=>i.push(s)),i}class VU{enter(e){const n=this.entered.length,r=i=>this.isNodeInDocument(i)&&(!i.contains||i.contains(e));return this.entered=MU(this.entered.filter(r),[e]),n===0&&this.entered.length>0}leave(e){const n=this.entered.length;return this.entered=LU(this.entered.filter(this.isNodeInDocument),e),n>0&&this.entered.length===0}reset(){this.entered=[]}constructor(e){this.entered=[],this.isNodeInDocument=e}}class jU{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(e=>{Object.defineProperty(this.item,e,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${e}" until the drop event.`),null}})})}loadDataTransfer(e){if(e){const n={};Object.keys(this.config.exposeProperties).forEach(r=>{const i=this.config.exposeProperties[r];i!=null&&(n[r]={value:i(e,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,n)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(e,n){return n===e.getSourceId()}endDrag(){}constructor(e){this.config=e,this.item={},this.initializeExposedProperties()}}const Mx="__NATIVE_FILE__",Vx="__NATIVE_URL__",jx="__NATIVE_TEXT__",Fx="__NATIVE_HTML__";var pT=Object.freeze({__proto__:null,FILE:Mx,HTML:Fx,TEXT:jx,URL:Vx});function nm(t,e,n){const r=e.reduce((i,s)=>i||t.getData(s),"");return r??n}const Uv={[Mx]:{exposeProperties:{files:t=>Array.prototype.slice.call(t.files),items:t=>t.items,dataTransfer:t=>t},matchesTypes:["Files"]},[Fx]:{exposeProperties:{html:(t,e)=>nm(t,e,""),dataTransfer:t=>t},matchesTypes:["Html","text/html"]},[Vx]:{exposeProperties:{urls:(t,e)=>nm(t,e,"").split(`
`),dataTransfer:t=>t},matchesTypes:["Url","text/uri-list"]},[jx]:{exposeProperties:{text:(t,e)=>nm(t,e,""),dataTransfer:t=>t},matchesTypes:["Text","text/plain"]}};function FU(t,e){const n=Uv[t];if(!n)throw new Error(`native type ${t} has no configuration`);const r=new jU(n);return r.loadDataTransfer(e),r}function rm(t){if(!t)return null;const e=Array.prototype.slice.call(t.types||[]);return Object.keys(Uv).filter(n=>{const r=Uv[n];return r!=null&&r.matchesTypes?r.matchesTypes.some(i=>e.indexOf(i)>-1):!1})[0]||null}const UU=Lx(()=>/firefox/i.test(navigator.userAgent)),Ux=Lx(()=>!!window.safari);class gT{interpolate(e){const{xs:n,ys:r,c1s:i,c2s:s,c3s:o}=this;let a=n.length-1;if(e===n[a])return r[a];let l=0,h=o.length-1,d;for(;l<=h;){d=Math.floor(.5*(l+h));const w=n[d];if(w<e)l=d+1;else if(w>e)h=d-1;else return r[d]}a=Math.max(0,h);const p=e-n[a],m=p*p;return r[a]+i[a]*p+s[a]*m+o[a]*p*m}constructor(e,n){const{length:r}=e,i=[];for(let w=0;w<r;w++)i.push(w);i.sort((w,E)=>e[w]<e[E]?-1:1);const s=[],o=[];let a,l;for(let w=0;w<r-1;w++)a=e[w+1]-e[w],l=n[w+1]-n[w],s.push(a),o.push(l/a);const h=[o[0]];for(let w=0;w<s.length-1;w++){const E=o[w],x=o[w+1];if(E*x<=0)h.push(0);else{a=s[w];const D=s[w+1],A=a+D;h.push(3*A/((A+D)/E+(A+a)/x))}}h.push(o[o.length-1]);const d=[],p=[];let m;for(let w=0;w<h.length-1;w++){m=o[w];const E=h[w],x=1/s[w],D=E+h[w+1]-m-m;d.push((m-E-D)*x),p.push(D*x*x)}this.xs=e,this.ys=n,this.c1s=h,this.c2s=d,this.c3s=p}}const $U=1;function $x(t){const e=t.nodeType===$U?t:t.parentElement;if(!e)return null;const{top:n,left:r}=e.getBoundingClientRect();return{x:r,y:n}}function bd(t){return{x:t.clientX,y:t.clientY}}function zU(t){var e;return t.nodeName==="IMG"&&(UU()||!(!((e=document.documentElement)===null||e===void 0)&&e.contains(t)))}function BU(t,e,n,r){let i=t?e.width:n,s=t?e.height:r;return Ux()&&t&&(s/=window.devicePixelRatio,i/=window.devicePixelRatio),{dragPreviewWidth:i,dragPreviewHeight:s}}function qU(t,e,n,r,i){const s=zU(e),a=$x(s?t:e),l={x:n.x-a.x,y:n.y-a.y},{offsetWidth:h,offsetHeight:d}=t,{anchorX:p,anchorY:m}=r,{dragPreviewWidth:w,dragPreviewHeight:E}=BU(s,e,h,d),x=()=>{let W=new gT([0,.5,1],[l.y,l.y/d*E,l.y+E-d]).interpolate(m);return Ux()&&s&&(W+=(window.devicePixelRatio-1)*E),W},D=()=>new gT([0,.5,1],[l.x,l.x/h*w,l.x+w-h]).interpolate(p),{offsetX:A,offsetY:T}=i,S=A===0||A,M=T===0||T;return{x:S?A:D(),y:M?T:x()}}let HU=class{get window(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}get document(){var e;return!((e=this.globalContext)===null||e===void 0)&&e.document?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var e;return((e=this.optionsArgs)===null||e===void 0?void 0:e.rootElement)||this.window}constructor(e,n){this.ownerDocument=null,this.globalContext=e,this.optionsArgs=n}};function WU(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mT(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),r.forEach(function(i){WU(t,i,n[i])})}return t}class KU{profile(){var e,n;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((e=this.dragStartSourceIds)===null||e===void 0?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((n=this.dragOverTargetIds)===null||n===void 0?void 0:n.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const e=this.rootElement;if(e!==void 0){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}teardown(){const e=this.rootElement;if(e!==void 0&&(e.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var n;(n=this.window)===null||n===void 0||n.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(e,n,r){return this.sourcePreviewNodeOptions.set(e,r),this.sourcePreviewNodes.set(e,n),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDragSource(e,n,r){this.sourceNodes.set(e,n),this.sourceNodeOptions.set(e,r);const i=o=>this.handleDragStart(o,e),s=o=>this.handleSelectStart(o);return n.setAttribute("draggable","true"),n.addEventListener("dragstart",i),n.addEventListener("selectstart",s),()=>{this.sourceNodes.delete(e),this.sourceNodeOptions.delete(e),n.removeEventListener("dragstart",i),n.removeEventListener("selectstart",s),n.setAttribute("draggable","false")}}connectDropTarget(e,n){const r=o=>this.handleDragEnter(o,e),i=o=>this.handleDragOver(o,e),s=o=>this.handleDrop(o,e);return n.addEventListener("dragenter",r),n.addEventListener("dragover",i),n.addEventListener("drop",s),()=>{n.removeEventListener("dragenter",r),n.removeEventListener("dragover",i),n.removeEventListener("drop",s)}}addEventListeners(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const e=this.monitor.getSourceId(),n=this.sourceNodeOptions.get(e);return mT({dropEffect:this.altKeyPressed?"copy":"move"},n||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const e=this.monitor.getSourceId(),n=this.sourcePreviewNodeOptions.get(e);return mT({anchorX:.5,anchorY:.5,captureDraggingState:!1},n||{})}isDraggingNativeItem(){const e=this.monitor.getItemType();return Object.keys(pT).some(n=>pT[n]===e)}beginDragNativeItem(e,n){this.clearCurrentDragSourceNode(),this.currentNativeSource=FU(e,n),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(e){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;const n=1e3;this.mouseMoveTimeoutTimer=setTimeout(()=>{var r;return(r=this.rootElement)===null||r===void 0?void 0:r.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},n)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var e;(e=this.window)===null||e===void 0||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(e,n){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(n))}handleDragEnter(e,n){this.dragEnterTargetIds.unshift(n)}handleDragOver(e,n){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(n)}handleDrop(e,n){this.dropTargetIds.unshift(n)}constructor(e,n,r){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=i=>{const s=this.sourceNodes.get(i);return s&&$x(s)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=i=>!!(i&&this.document&&this.document.body&&this.document.body.contains(i)),this.endDragIfSourceWasRemovedFromDOM=()=>{const i=this.currentDragSourceNode;i==null||this.isNodeInDocument(i)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=i=>{this.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(i||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{this.hoverRafId!==null&&typeof cancelAnimationFrame<"u"&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=i=>{if(i.defaultPrevented)return;const{dragStartSourceIds:s}=this;this.dragStartSourceIds=null;const o=bd(i);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(s||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:o});const{dataTransfer:a}=i,l=rm(a);if(this.monitor.isDragging()){if(a&&typeof a.setDragImage=="function"){const d=this.monitor.getSourceId(),p=this.sourceNodes.get(d),m=this.sourcePreviewNodes.get(d)||p;if(m){const{anchorX:w,anchorY:E,offsetX:x,offsetY:D}=this.getCurrentSourcePreviewNodeOptions(),S=qU(p,m,o,{anchorX:w,anchorY:E},{offsetX:x,offsetY:D});a.setDragImage(m,S.x,S.y)}}try{a==null||a.setData("application/json",{})}catch{}this.setCurrentDragSourceNode(i.target);const{captureDraggingState:h}=this.getCurrentSourcePreviewNodeOptions();h?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(l)this.beginDragNativeItem(l);else{if(a&&!a.types&&(i.target&&!i.target.hasAttribute||!i.target.hasAttribute("draggable")))return;i.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=i=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var s;(s=this.currentNativeSource)===null||s===void 0||s.loadDataTransfer(i.dataTransfer)}if(!this.enterLeaveCounter.enter(i.target)||this.monitor.isDragging())return;const{dataTransfer:a}=i,l=rm(a);l&&this.beginDragNativeItem(l,a)},this.handleTopDragEnter=i=>{const{dragEnterTargetIds:s}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=i.altKey,s.length>0&&this.actions.hover(s,{clientOffset:bd(i)}),s.some(a=>this.monitor.canDropOnTarget(a))&&(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=i=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var s;(s=this.currentNativeSource)===null||s===void 0||s.loadDataTransfer(i.dataTransfer)}},this.handleTopDragOver=i=>{const{dragOverTargetIds:s}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect="none");return}this.altKeyPressed=i.altKey,this.lastClientOffset=bd(i),this.scheduleHover(s),(s||[]).some(a=>this.monitor.canDropOnTarget(a))?(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?i.preventDefault():(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=i=>{this.isDraggingNativeItem()&&i.preventDefault(),this.enterLeaveCounter.leave(i.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=i=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var s;i.preventDefault(),(s=this.currentNativeSource)===null||s===void 0||s.loadDataTransfer(i.dataTransfer)}else rm(i.dataTransfer)&&i.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=i=>{const{dropTargetIds:s}=this;this.dropTargetIds=[],this.actions.hover(s,{clientOffset:bd(i)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=i=>{const s=i.target;typeof s.dragDrop=="function"&&(s.tagName==="INPUT"||s.tagName==="SELECT"||s.tagName==="TEXTAREA"||s.isContentEditable||(i.preventDefault(),s.dragDrop()))},this.options=new HU(n,r),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new VU(this.isNodeInDocument)}}let Cd;function GU(){return Cd||(Cd=new Image,Cd.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),Cd}const QU=function(e,n,r){return new KU(e,n,r)};function vT({isPremovedPiece:t=!1,piece:e,square:n,squares:r}){const{animationDuration:i,arePiecesDraggable:s,boardWidth:o,boardOrientation:a,chessPieces:l,currentPosition:h,deletePieceFromSquare:d,dropOffBoardAction:p,id:m,isDraggablePiece:w,isWaitingForAnimation:E,onPieceClick:x,onPieceDragBegin:D,onPieceDragEnd:A,onPieceDropOffBoard:T,onPromotionCheck:S,positionDifferences:M}=ls(),[q,W]=N.useState({opacity:1,zIndex:5,touchAction:"none",cursor:s&&w({piece:e,sourceSquare:n})?"-webkit-grab":"default"}),[{canDrag:P,isDragging:C},R,O]=bU(()=>({type:"piece",item:()=>(D(e,n),{piece:e,square:n,id:m}),end:(V,k)=>{A(e,n),!k.didDrop()&&(p==="trash"&&d(n),T==null||T(n,e))},collect:V=>({canDrag:w({piece:e,sourceSquare:n}),isDragging:!!V.isDragging()})}),[e,n,h,m]);O(GU(),{captureDraggingState:!0}),N.useEffect(()=>{W(V=>Object.assign(Object.assign({},V),{opacity:C?0:1}))},[C]),N.useEffect(()=>{var V;const k=(V=M.removed)===null||V===void 0?void 0:V[n];if(!M.added||!k)return;const ve=Object.entries(M.added).find(([Ie,Fe])=>Fe===k||S(n,Ie,k));if(E&&k&&ve&&!t){const Ie=n,Fe=ve[0];if(Ie&&Fe){const Ce=o/8;W(X=>Object.assign(Object.assign({},X),{transform:`translate(${(a==="black"?-1:1)*(Fe.charCodeAt(0)-Ie.charCodeAt(0))*Ce}px, ${(a==="black"?-1:1)*(Number(Ie[1])-Number(Fe[1]))*Ce}px)`,transition:`transform ${i}ms`,zIndex:6}))}}},[M]),N.useEffect(()=>{const{sourceSq:V}=L();V&&W(k=>Object.assign(Object.assign({},k),{transform:"translate(0px, 0px)",transition:"transform 0ms"}))},[h]),N.useEffect(()=>{W(V=>Object.assign(Object.assign({},V),{cursor:s&&w({piece:e,sourceSquare:n})?"-webkit-grab":"default"}))},[n,h,s]);function L(){return{sourceSq:r[n]}}return y.jsx("div",Object.assign({ref:s&&P?R:null,onClick:()=>x(e,n),"data-piece":e,style:q},{children:typeof l[e]=="function"?l[e]({squareWidth:o/8,isDragging:C,square:n}):y.jsx("svg",Object.assign({viewBox:"1 1 43 43",width:o/8,height:o/8,style:{display:"block"}},{children:y.jsx("g",{children:l[e]})}))}))}function YU({square:t,squareColor:e,setSquares:n,squareHasPremove:r,children:i}){const s=N.useRef(null),{autoPromoteToQueen:o,boardWidth:a,boardOrientation:l,clearArrows:h,currentPosition:d,currentRightClickDown:p,customBoardStyle:m,customDarkSquareStyle:w,customDropSquareStyle:E,customLightSquareStyle:x,customPremoveDarkSquareStyle:D,customPremoveLightSquareStyle:A,customSquare:T,customSquareStyles:S,drawNewArrow:M,handleSetPosition:q,handleSparePieceDrop:W,isWaitingForAnimation:P,lastPieceColour:C,lastSquareDraggedOver:R,onArrowDrawEnd:O,onDragOverSquare:L,onMouseOutSquare:V,onMouseOverSquare:k,onPieceDrop:ve,onPromotionCheck:Ie,onRightClickDown:Fe,onRightClickUp:Ce,onSquareClick:X,setLastSquareDraggedOver:ue,setPromoteFromSquare:z,setPromoteToSquare:Ne,setShowPromoteDialog:Le}=ls(),[{isOver:Be},lt]=NU(()=>({accept:"piece",drop:jt,collect:de=>({isOver:!!de.isOver()})}),[t,d,ve,P,C]);function jt(de){if(de.isSpare){W(de.piece,t);return}Ie(de.square,t,de.piece)?o?q(de.square,t,de.piece[0]==="w"?"wQ":"bQ"):(z(de.square),Ne(t),Le(!0)):q(de.square,t,de.piece,!0)}N.useEffect(()=>{if(s.current){const{x:de,y:se}=s.current.getBoundingClientRect();n(Wn=>Object.assign(Object.assign({},Wn),{[t]:{x:de,y:se}}))}},[a,l]);const nt=Object.assign(Object.assign(Object.assign(Object.assign({},XU(t,l,m)),e==="black"?w:x),r&&(e==="black"?D:A)),Be&&E);return y.jsx("div",Object.assign({ref:lt,style:nt,"data-square-color":e,"data-square":t,onTouchMove:de=>{var se;const Wn=de.touches[0],Kn=document.elementsFromPoint(Wn.clientX,Wn.clientY),bt=(se=Kn==null?void 0:Kn.find(Kt=>Kt.getAttribute("data-square")))===null||se===void 0?void 0:se.getAttribute("data-square");bt&&bt!==R&&(ue(bt),L(bt))},onMouseOver:de=>{de.buttons===2&&p&&M(p,t),!(de.relatedTarget&&de.currentTarget.contains(de.relatedTarget))&&k(t)},onMouseOut:de=>{de.relatedTarget&&de.currentTarget.contains(de.relatedTarget)||V(t)},onMouseDown:de=>{de.button===2&&Fe(t)},onMouseUp:de=>{de.button===2&&(p&&O(p,t),Ce(t))},onDragEnter:()=>L(t),onClick:()=>{const de=d[t];X(t,de),h()},onContextMenu:de=>{de.preventDefault()}},{children:typeof T=="string"?y.jsx(T,Object.assign({ref:s,style:Object.assign(Object.assign(Object.assign({},_T(a)),yT),!r&&(S==null?void 0:S[t]))},{children:i})):y.jsx(T,Object.assign({ref:s,square:t,squareColor:e,style:Object.assign(Object.assign(Object.assign({},_T(a)),yT),!r&&(S==null?void 0:S[t]))},{children:i}))}))}const yT={display:"flex",justifyContent:"center"},_T=t=>({width:t/8,height:t/8}),XU=(t,e,n)=>n!=null&&n.borderRadius?t==="a1"?e==="white"?{borderBottomLeftRadius:n.borderRadius}:{borderTopRightRadius:n.borderRadius}:t==="a8"?e==="white"?{borderTopLeftRadius:n.borderRadius}:{borderBottomRightRadius:n.borderRadius}:t==="h1"?e==="white"?{borderBottomRightRadius:n.borderRadius}:{borderTopLeftRadius:n.borderRadius}:t==="h8"?e==="white"?{borderTopRightRadius:n.borderRadius}:{borderBottomLeftRadius:n.borderRadius}:{}:{};function JU(){const[t,e]=N.useState({}),{arePremovesAllowed:n,boardOrientation:r,boardWidth:i,currentPosition:s,id:o,premoves:a,showBoardNotation:l}=ls(),h=N.useMemo(()=>{const d=[];return n?(a.forEach((p,m)=>{const{sourceSq:w,targetSq:E,piece:x}=p,D=d.find(A=>{var T;return A.piece===x&&((T=A.premovesRoute.at(-1))===null||T===void 0?void 0:T.targetSq)===w});D?D.premovesRoute.push({sourceSq:w,targetSq:E,index:m}):d.push({piece:x,premovesRoute:[{sourceSq:w,targetSq:E,index:m}]})}),d):[]},[a]);return y.jsx("div",Object.assign({"data-boardid":o},{children:[...Array(8)].map((d,p)=>y.jsx("div",Object.assign({style:{display:"flex",flexWrap:"nowrap",width:i}},{children:[...Array(8)].map((m,w)=>{const E=r==="black"?oh[7-w]+(p+1):oh[w]+(8-p),x=w%2===p%2?"white":"black",D=a.find(T=>T.sourceSq===E||T.targetSq===E),A=h.filter(({premovesRoute:T})=>{var S;return((S=T.at(-1))===null||S===void 0?void 0:S.targetSq)===E}).sort((T,S)=>{var M,q;return((M=S.premovesRoute.at(-1))===null||M===void 0?void 0:M.index)-((q=T.premovesRoute.at(-1))===null||q===void 0?void 0:q.index)}).at(0);return y.jsxs(YU,Object.assign({square:E,squareColor:x,setSquares:e,squareHasPremove:!!D},{children:[!D&&s[E]&&y.jsx(vT,{piece:s[E],square:E,squares:t}),A&&y.jsx(vT,{isPremovedPiece:!0,piece:A.piece,square:E,squares:t}),l&&y.jsx(U4,{row:p,col:w})]}),`${w}${p}`)})}),p.toString()))}))}const ZU=()=>{const{arrows:t,newArrow:e,boardOrientation:n,boardWidth:r,customArrowColor:i}=ls(),s=[...t,e].filter(Boolean);return y.jsx("svg",Object.assign({width:r,height:r,style:{position:"absolute",top:"0",left:"0",pointerEvents:"none",zIndex:"10"}},{children:s.map((o,a)=>{const[l,h,d]=o;if(l===h)return null;const p=Lv(n,r,l),m=Lv(n,r,h);let w=r/32;const E=a===t.length;t.some(S=>S[0]!==l&&S[1]===h)&&!E&&(w=r/16);const x=m.x-p.x,D=m.y-p.y,A=Math.hypot(D,x),T={x:p.x+x*(A-w)/A,y:p.y+D*(A-w)/A};return y.jsxs(N.Fragment,{children:[y.jsx("marker",Object.assign({id:`arrowhead-${a}`,markerWidth:"2",markerHeight:"2.5",refX:"1.25",refY:"1.25",orient:"auto"},{children:y.jsx("polygon",{points:"0.3 0, 2 1.25, 0.3 2.5",fill:d??i})})),y.jsx("line",{x1:p.x,y1:p.y,x2:T.x,y2:T.y,opacity:E?"0.5":"0.65",stroke:d??i,strokeWidth:E?.9*r/40:r/40,markerEnd:`url(#arrowhead-${a})`})]},`${l}-${h}${E?"-active":""}`)})}))};function e6({option:t}){const[e,n]=N.useState(!1),{boardWidth:r,chessPieces:i,customDarkSquareStyle:s,customLightSquareStyle:o,handleSetPosition:a,onPromotionPieceSelect:l,promoteFromSquare:h,promoteToSquare:d,promotionDialogVariant:p}=ls(),m=()=>{switch(t[1]){case"Q":return s.backgroundColor;case"R":return o.backgroundColor;case"N":return p==="default"?o.backgroundColor:s.backgroundColor;case"B":return p==="default"?s.backgroundColor:o.backgroundColor}};return y.jsx("div",Object.assign({onClick:()=>{l(t,h??void 0,d??void 0)&&a(h,d,t,!0)},onMouseOver:()=>n(!0),onMouseOut:()=>n(!1),"data-piece":t,style:{cursor:"pointer",backgroundColor:e?m():`${m()}aa`,borderRadius:"4px",transition:"all 0.1s ease-out"}},{children:typeof i[t]=="function"?y.jsx("div",Object.assign({style:{transition:"all 0.1s ease-out",transform:e?"scale(1)":"scale(0.85)"}},{children:i[t]({squareWidth:r/8,isDragging:!1})})):y.jsx("svg",Object.assign({viewBox:"1 1 43 43",width:r/8,height:r/8,style:{transition:"all 0.1s ease-out",transform:e?"scale(1)":"scale(0.85)"}},{children:y.jsx("g",{children:i[t]})}))}))}function t6(){const{boardOrientation:t,boardWidth:e,promotionDialogVariant:n,promoteToSquare:r}=ls(),i=(r==null?void 0:r[1])==="1"?"b":"w",s=[`${i??"w"}Q`,`${i??"w"}R`,`${i??"w"}N`,`${i??"w"}B`],o={default:{display:"grid",gridTemplateColumns:"1fr 1fr",transform:`translate(${-e/8}px, ${-e/8}px)`},vertical:{transform:`translate(${-e/16}px, ${-e/16}px)`},modal:{display:"flex",justifyContent:"center",alignItems:"center",transform:`translate(0px, ${3*e/8}px)`,width:"100%",height:`${e/4}px`,top:0,backgroundColor:"white",left:0}},a=Lv(t,e,r||"a8");return y.jsx("div",Object.assign({style:Object.assign({position:"absolute",top:`${a==null?void 0:a.y}px`,left:`${a==null?void 0:a.x}px`,zIndex:1e3},o[n]),title:"Choose promotion piece"},{children:s.map(l=>y.jsx(e6,{option:l},l))}))}const n6={whiteKing:y.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",imageRendering:"crisp-edges"},viewBox:"0 0 4210 12970",x:"0px",y:"0px",fillRule:"evenodd",clipRule:"evenodd",width:"250",height:"250"},{children:y.jsx("g",{children:y.jsx("path",{style:{fill:"black",fillRule:"nonzero"},d:"M2105 0c169,0 286,160 249,315l200 0c-172,266 -231,479 -256,792 315,-24 530,-86 792,-255l0 897c-265,-171 -479,-231 -792,-256 18,234 75,495 185,682l339 0c233,0 369,269 225,456l545 0 -595 1916c130,94 158,275 59,402 465,0 416,568 51,568l-334 0 465 2867 332 0c250,0 381,306 199,485 162,63 273,220 273,399l0 633 168 0 0 475c-1403,0 -2807,0 -4210,0l0 -475 167 0 0 -633c0,-179 112,-336 274,-399 -181,-178 -52,-485 199,-485l332 0 465 -2867 -335 0c-353,0 -418,-568 51,-568 -98,-127 -70,-308 59,-402l-594 -1916c181,0 363,0 545,0 -144,-187 -9,-456 225,-456l339 0c110,-187 167,-448 185,-682 -315,25 -530,87 -793,256l0 -897c266,171 480,231 793,255 -25,-315 -87,-529 -256,-792l199 0c-36,-155 81,-315 250,-315zm-1994 10012l0 253 3988 0 0 -253c-1330,0 -2659,0 -3988,0zm484 -1060c-174,0 -316,142 -316,316l0 633 3652 0 0 -633c0,-174 -142,-316 -316,-316 -1007,0 -2013,0 -3020,0zm45 -457c-230,0 -225,345 0,345l2930 0c230,0 225,-345 0,-345 -977,0 -1953,0 -2930,0zm2020 -2978l-1111 0 -465 2867 2041 0 -465 -2867zm-1558 -456c-229,0 -224,345 0,345 669,0 1337,0 2005,0 230,0 225,-345 0,-345 -668,0 -1336,0 -2005,0zm1730 -457l-1454 0c-229,0 -224,345 0,345l1454 0c229,0 224,-345 0,-345zm-2064 -1862l544 1751c529,0 1057,0 1586,0l544 -1751c-892,0 -1783,0 -2674,0zm1085 -567l504 0c-126,-247 -163,-526 -177,-800 273,15 553,52 800,177l0 -504c-247,126 -527,163 -800,177 14,-273 51,-552 177,-799 -168,0 -336,0 -504,0 125,247 162,526 177,799 -274,-14 -553,-51 -800,-177l0 504c247,-125 527,-162 800,-177 -15,274 -52,553 -177,800zm969 111l-1434 0c-230,0 -225,345 0,345l1434 0c230,0 225,-345 0,-345zm-717 -2175c-105,0 -175,109 -133,204l266 0c42,-96 -30,-205 -133,-204z"})})}))};function r6({children:t}){try{return y.jsx(y.Fragment,{children:t})}catch(e){return console.log(e),y.jsx(zx,{showError:!0})}}function zx({showError:t=!1}){return y.jsxs("div",Object.assign({style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},{children:[y.jsx("div",Object.assign({style:{width:250,height:250,transform:"rotate(90deg)"}},{children:n6.whiteKing})),t&&y.jsx("h1",{children:"Something went wrong"})]}))}function i6(){const t=N.useRef(null),{boardWidth:e,clearCurrentRightClickDown:n,onPromotionPieceSelect:r,setShowPromoteDialog:i,showPromoteDialog:s,customBoardStyle:o}=ls();return N.useEffect(()=>{function a(l){t.current&&!t.current.contains(l.target)&&n()}return document.addEventListener("mouseup",a),()=>{document.removeEventListener("mouseup",a)}},[]),e?y.jsx("div",Object.assign({style:{perspective:"1000px"}},{children:y.jsxs("div",Object.assign({ref:t,style:Object.assign(Object.assign({position:"relative"},s6(e)),o)},{children:[y.jsx(JU,{}),y.jsx(ZU,{}),s&&y.jsxs(y.Fragment,{children:[y.jsx("div",{onClick:()=>{i(!1),r==null||r()},style:{position:"absolute",top:"0",left:"0",zIndex:"100",backgroundColor:"rgba(22,21,18,.7)",width:e,height:e}}),y.jsx(t6,{})]})]}))})):y.jsx(zx,{})}const s6=t=>({cursor:"default",height:t,width:t});var co;(function(t){t.mouse="mouse",t.touch="touch",t.keyboard="keyboard"})(co||(co={}));class o6{get delay(){var e;return(e=this.args.delay)!==null&&e!==void 0?e:0}get scrollAngleRanges(){return this.args.scrollAngleRanges}get getDropTargetElementsAtPoint(){return this.args.getDropTargetElementsAtPoint}get ignoreContextMenu(){var e;return(e=this.args.ignoreContextMenu)!==null&&e!==void 0?e:!1}get enableHoverOutsideTarget(){var e;return(e=this.args.enableHoverOutsideTarget)!==null&&e!==void 0?e:!1}get enableKeyboardEvents(){var e;return(e=this.args.enableKeyboardEvents)!==null&&e!==void 0?e:!1}get enableMouseEvents(){var e;return(e=this.args.enableMouseEvents)!==null&&e!==void 0?e:!1}get enableTouchEvents(){var e;return(e=this.args.enableTouchEvents)!==null&&e!==void 0?e:!0}get touchSlop(){return this.args.touchSlop||0}get delayTouchStart(){var e,n,r,i;return(i=(r=(e=this.args)===null||e===void 0?void 0:e.delayTouchStart)!==null&&r!==void 0?r:(n=this.args)===null||n===void 0?void 0:n.delay)!==null&&i!==void 0?i:0}get delayMouseStart(){var e,n,r,i;return(i=(r=(e=this.args)===null||e===void 0?void 0:e.delayMouseStart)!==null&&r!==void 0?r:(n=this.args)===null||n===void 0?void 0:n.delay)!==null&&i!==void 0?i:0}get window(){if(this.context&&this.context.window)return this.context.window;if(typeof window<"u")return window}get document(){var e;if(!((e=this.context)===null||e===void 0)&&e.document)return this.context.document;if(this.window)return this.window.document}get rootElement(){var e;return((e=this.args)===null||e===void 0?void 0:e.rootElement)||this.document}constructor(e,n){this.args=e,this.context=n}}function a6(t,e,n,r){return Math.sqrt(Math.pow(Math.abs(n-t),2)+Math.pow(Math.abs(r-e),2))}function l6(t,e,n,r,i){if(!i)return!1;const s=Math.atan2(r-e,n-t)*180/Math.PI+180;for(let o=0;o<i.length;++o){const a=i[o];if(a&&(a.start==null||s>=a.start)&&(a.end==null||s<=a.end))return!0}return!1}const u6={Left:1},c6={Left:0};function im(t){return t.button===void 0||t.button===c6.Left}function h6(t){return t.buttons===void 0||(t.buttons&u6.Left)===0}function Bx(t){return!!t.targetTouches}const d6=1;function f6(t){const e=t.nodeType===d6?t:t.parentElement;if(!e)return;const{top:n,left:r}=e.getBoundingClientRect();return{x:r,y:n}}function p6(t,e){if(t.targetTouches.length===1)return ep(t.targetTouches[0]);if(e&&t.touches.length===1&&t.touches[0].target===e.target)return ep(t.touches[0])}function ep(t,e){return Bx(t)?p6(t,e):{x:t.clientX,y:t.clientY}}const wT=(()=>{let t=!1;try{addEventListener("test",()=>{},Object.defineProperty({},"passive",{get(){return t=!0,!0}}))}catch{}return t})(),Xu={[co.mouse]:{start:"mousedown",move:"mousemove",end:"mouseup",contextmenu:"contextmenu"},[co.touch]:{start:"touchstart",move:"touchmove",end:"touchend"},[co.keyboard]:{keydown:"keydown"}};class Pc{profile(){var e;return{sourceNodes:this.sourceNodes.size,sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,targetNodes:this.targetNodes.size,dragOverTargetIds:((e=this.dragOverTargetIds)===null||e===void 0?void 0:e.length)||0}}get document(){return this.options.document}setup(){const e=this.options.rootElement;e&&(Ee(!Pc.isSetUp,"Cannot have two Touch backends at the same time."),Pc.isSetUp=!0,this.addEventListener(e,"start",this.getTopMoveStartHandler()),this.addEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.addEventListener(e,"move",this.handleTopMove),this.addEventListener(e,"move",this.handleTopMoveCapture,!0),this.addEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.addEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.addEventListener(e,"keydown",this.handleCancelOnEscape,!0))}teardown(){const e=this.options.rootElement;e&&(Pc.isSetUp=!1,this._mouseClientOffset={},this.removeEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.removeEventListener(e,"start",this.handleTopMoveStart),this.removeEventListener(e,"move",this.handleTopMoveCapture,!0),this.removeEventListener(e,"move",this.handleTopMove),this.removeEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.removeEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.removeEventListener(e,"keydown",this.handleCancelOnEscape,!0),this.uninstallSourceNodeRemovalObserver())}addEventListener(e,n,r,i=!1){const s=wT?{capture:i,passive:!1}:i;this.listenerTypes.forEach(function(o){const a=Xu[o][n];a&&e.addEventListener(a,r,s)})}removeEventListener(e,n,r,i=!1){const s=wT?{capture:i,passive:!1}:i;this.listenerTypes.forEach(function(o){const a=Xu[o][n];a&&e.removeEventListener(a,r,s)})}connectDragSource(e,n){const r=this.handleMoveStart.bind(this,e);return this.sourceNodes.set(e,n),this.addEventListener(n,"start",r),()=>{this.sourceNodes.delete(e),this.removeEventListener(n,"start",r)}}connectDragPreview(e,n,r){return this.sourcePreviewNodeOptions.set(e,r),this.sourcePreviewNodes.set(e,n),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDropTarget(e,n){const r=this.options.rootElement;if(!this.document||!r)return()=>{};const i=s=>{if(!this.document||!r||!this.monitor.isDragging())return;let o;switch(s.type){case Xu.mouse.move:o={x:s.clientX,y:s.clientY};break;case Xu.touch.move:var a,l;o={x:((a=s.touches[0])===null||a===void 0?void 0:a.clientX)||0,y:((l=s.touches[0])===null||l===void 0?void 0:l.clientY)||0};break}const h=o!=null?this.document.elementFromPoint(o.x,o.y):void 0,d=h&&n.contains(h);if(h===n||d)return this.handleMove(s,e)};return this.addEventListener(this.document.body,"move",i),this.targetNodes.set(e,n),()=>{this.document&&(this.targetNodes.delete(e),this.removeEventListener(this.document.body,"move",i))}}getTopMoveStartHandler(){return!this.options.delayTouchStart&&!this.options.delayMouseStart?this.handleTopMoveStart:this.handleTopMoveStartDelay}installSourceNodeRemovalObserver(e){this.uninstallSourceNodeRemovalObserver(),this.draggedSourceNode=e,this.draggedSourceNodeRemovalObserver=new MutationObserver(()=>{e&&!e.parentElement&&(this.resurrectSourceNode(),this.uninstallSourceNodeRemovalObserver())}),!(!e||!e.parentElement)&&this.draggedSourceNodeRemovalObserver.observe(e.parentElement,{childList:!0})}resurrectSourceNode(){this.document&&this.draggedSourceNode&&(this.draggedSourceNode.style.display="none",this.draggedSourceNode.removeAttribute("data-reactid"),this.document.body.appendChild(this.draggedSourceNode))}uninstallSourceNodeRemovalObserver(){this.draggedSourceNodeRemovalObserver&&this.draggedSourceNodeRemovalObserver.disconnect(),this.draggedSourceNodeRemovalObserver=void 0,this.draggedSourceNode=void 0}constructor(e,n,r){this.getSourceClientOffset=i=>{const s=this.sourceNodes.get(i);return s&&f6(s)},this.handleTopMoveStartCapture=i=>{im(i)&&(this.moveStartSourceIds=[])},this.handleMoveStart=i=>{Array.isArray(this.moveStartSourceIds)&&this.moveStartSourceIds.unshift(i)},this.handleTopMoveStart=i=>{if(!im(i))return;const s=ep(i);s&&(Bx(i)&&(this.lastTargetTouchFallback=i.targetTouches[0]),this._mouseClientOffset=s),this.waitingForDelay=!1},this.handleTopMoveStartDelay=i=>{if(!im(i))return;const s=i.type===Xu.touch.start?this.options.delayTouchStart:this.options.delayMouseStart;this.timeout=setTimeout(this.handleTopMoveStart.bind(this,i),s),this.waitingForDelay=!0},this.handleTopMoveCapture=()=>{this.dragOverTargetIds=[]},this.handleMove=(i,s)=>{this.dragOverTargetIds&&this.dragOverTargetIds.unshift(s)},this.handleTopMove=i=>{if(this.timeout&&clearTimeout(this.timeout),!this.document||this.waitingForDelay)return;const{moveStartSourceIds:s,dragOverTargetIds:o}=this,a=this.options.enableHoverOutsideTarget,l=ep(i,this.lastTargetTouchFallback);if(!l)return;if(this._isScrolling||!this.monitor.isDragging()&&l6(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,l.x,l.y,this.options.scrollAngleRanges)){this._isScrolling=!0;return}if(!this.monitor.isDragging()&&this._mouseClientOffset.hasOwnProperty("x")&&s&&a6(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,l.x,l.y)>(this.options.touchSlop?this.options.touchSlop:0)&&(this.moveStartSourceIds=void 0,this.actions.beginDrag(s,{clientOffset:this._mouseClientOffset,getSourceClientOffset:this.getSourceClientOffset,publishSource:!1})),!this.monitor.isDragging())return;const h=this.sourceNodes.get(this.monitor.getSourceId());this.installSourceNodeRemovalObserver(h),this.actions.publishDragSource(),i.cancelable&&i.preventDefault();const d=(o||[]).map(E=>this.targetNodes.get(E)).filter(E=>!!E),p=this.options.getDropTargetElementsAtPoint?this.options.getDropTargetElementsAtPoint(l.x,l.y,d):this.document.elementsFromPoint(l.x,l.y),m=[];for(const E in p){if(!p.hasOwnProperty(E))continue;let x=p[E];for(x!=null&&m.push(x);x;)x=x.parentElement,x&&m.indexOf(x)===-1&&m.push(x)}const w=m.filter(E=>d.indexOf(E)>-1).map(E=>this._getDropTargetId(E)).filter(E=>!!E).filter((E,x,D)=>D.indexOf(E)===x);if(a)for(const E in this.targetNodes){const x=this.targetNodes.get(E);if(h&&x&&x.contains(h)&&w.indexOf(E)===-1){w.unshift(E);break}}w.reverse(),this.actions.hover(w,{clientOffset:l})},this._getDropTargetId=i=>{const s=this.targetNodes.keys();let o=s.next();for(;o.done===!1;){const a=o.value;if(i===this.targetNodes.get(a))return a;o=s.next()}},this.handleTopMoveEndCapture=i=>{if(this._isScrolling=!1,this.lastTargetTouchFallback=void 0,!!h6(i)){if(!this.monitor.isDragging()||this.monitor.didDrop()){this.moveStartSourceIds=void 0;return}i.cancelable&&i.preventDefault(),this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.drop(),this.actions.endDrag()}},this.handleCancelOnEscape=i=>{i.key==="Escape"&&this.monitor.isDragging()&&(this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.endDrag())},this.options=new o6(r,n),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.sourceNodes=new Map,this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.targetNodes=new Map,this.listenerTypes=[],this._mouseClientOffset={},this._isScrolling=!1,this.options.enableMouseEvents&&this.listenerTypes.push(co.mouse),this.options.enableTouchEvents&&this.listenerTypes.push(co.touch),this.options.enableKeyboardEvents&&this.listenerTypes.push(co.keyboard)}}const g6=function(e,n={},r={}){return new Pc(e,n,r)},m6=N.createContext({isCustomDndProviderSet:!1}),v6=({children:t})=>y.jsx(y.Fragment,{children:t}),y6=({customDndBackend:t,customDndBackendOptions:e,children:n})=>{const[r,i]=N.useState(),[s,o]=N.useState(!1),[a,l]=N.useState(!1),{isCustomDndProviderSet:h}=N.useContext(m6);N.useEffect(()=>{l("ontouchstart"in window),o(!0),i(window)},[]);const d=h?v6:rU;return s?r?y.jsx(d,Object.assign({backend:t||(a?g6:QU),context:r,options:t?e:void 0},{children:n})):y.jsx(y.Fragment,{children:n}):null};function _6({boardContainer:t}){const{boardWidth:e,chessPieces:n,id:r,snapToCursor:i,allowDragOutsideBoard:s}=ls(),o=CU(m=>({item:m.getItem(),clientOffset:m.getClientOffset(),sourceClientOffset:m.getSourceClientOffset(),isDragging:m.isDragging()})),{isDragging:a,item:l,clientOffset:h,sourceClientOffset:d}=o,p=N.useCallback((m,w)=>{if(!m||!w)return{display:"none"};let{x:E,y:x}=i?m:w;const D=e/8/2;if(i&&(E-=D,x-=D),!s){const{left:T,top:S}=t,M=T-D,q=S-D,W=T+e-D,P=S+e-D;E=Math.max(M,Math.min(E,W)),x=Math.max(q,Math.min(x,P))}const A=`translate(${E}px, ${x}px)`;return{transform:A,WebkitTransform:A,touchAction:"none"}},[e,s,i,t]);return a&&l.id===r?y.jsx("div",Object.assign({style:{position:"fixed",pointerEvents:"none",zIndex:10,left:0,top:0}},{children:y.jsx("div",Object.assign({style:p(h,d)},{children:typeof n[l.piece]=="function"?n[l.piece]({squareWidth:e/8,isDragging:!0}):y.jsx("svg",Object.assign({viewBox:"1 1 43 43",width:e/8,height:e/8},{children:y.jsx("g",{children:n[l.piece]})}))}))})):null}const qx=N.forwardRef((t,e)=>{const{customDndBackend:n,customDndBackendOptions:r,onBoardWidthChange:i}=t,s=x4(t,["customDndBackend","customDndBackendOptions","onBoardWidthChange"]),[o,a]=N.useState(t.boardWidth),l=N.useRef(null),h=N.useRef(null),[d,p]=N.useState({left:0,top:0}),m=N.useMemo(()=>{var w;return(w=l.current)===null||w===void 0?void 0:w.getBoundingClientRect()},[l.current]);return N.useEffect(()=>{o&&(i==null||i(o))},[o]),N.useEffect(()=>{p({left:m!=null&&m.left?m==null?void 0:m.left:0,top:m!=null&&m.top?m==null?void 0:m.top:0})},[m]),N.useEffect(()=>{var w;if(t.boardWidth===void 0&&(!((w=l.current)===null||w===void 0)&&w.offsetWidth)){const E=new ResizeObserver(()=>{var x;a((x=l.current)===null||x===void 0?void 0:x.offsetWidth)});return E.observe(l.current),()=>{E.disconnect()}}},[l.current]),y.jsx(r6,{children:y.jsxs("div",Object.assign({ref:h,style:{display:"flex",flexDirection:"column",width:"100%"}},{children:[y.jsx("div",{ref:l,style:{width:"100%"}}),y.jsx(y6,Object.assign({customDndBackend:n,customDndBackendOptions:r},{children:o&&y.jsxs(F4,Object.assign({boardWidth:o},s,{ref:e},{children:[y.jsx(_6,{boardContainer:d}),y.jsx(i6,{})]}))}))]}))})});/**
 * @license
 * Copyright (c) 2023, Jeff Hlywa (jhlywa@gmail.com)
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice,
 *    this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */const fn="w",Sr="b",Yt="p",$v="n",rf="b",cc="r",Vs="q",zt="k",sm="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",Fn=-1,w6={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},ge={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},Te={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},om={b:[16,32,17,15],w:[-16,-32,-17,-15]},ET={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},E6=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],T6=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],I6={p:1,n:2,b:4,r:8,q:16,k:32},S6="pnbrqkPNBRQK",TT=[$v,rf,cc,Vs],b6=7,C6=6,A6=1,x6=0,Ad={[zt]:ge.KSIDE_CASTLE,[Vs]:ge.QSIDE_CASTLE},Os={w:[{square:Te.a1,flag:ge.QSIDE_CASTLE},{square:Te.h1,flag:ge.KSIDE_CASTLE}],b:[{square:Te.a8,flag:ge.QSIDE_CASTLE},{square:Te.h8,flag:ge.KSIDE_CASTLE}]},P6={b:A6,w:C6},k6=["1-0","0-1","1/2-1/2","*"];function ha(t){return t>>4}function ah(t){return t&15}function Hx(t){return"0123456789".indexOf(t)!==-1}function Zn(t){const e=ah(t),n=ha(t);return"abcdefgh".substring(e,e+1)+"87654321".substring(n,n+1)}function Ju(t){return t===fn?Sr:fn}function R6(t){const e=t.split(/\s+/);if(e.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const n=parseInt(e[5],10);if(isNaN(n)||n<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const r=parseInt(e[4],10);if(isNaN(r)||r<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(e[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(e[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(e[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const i=e[0].split("/");if(i.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let o=0;o<i.length;o++){let a=0,l=!1;for(let h=0;h<i[o].length;h++)if(Hx(i[o][h])){if(l)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};a+=parseInt(i[o][h],10),l=!0}else{if(!/^[prnbqkPRNBQK]$/.test(i[o][h]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};a+=1,l=!1}if(a!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(e[3][1]=="3"&&e[1]=="w"||e[3][1]=="6"&&e[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const s=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:o,regex:a}of s){if(!a.test(e[0]))return{ok:!1,error:`Invalid FEN: missing ${o} king`};if((e[0].match(a)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${o} kings`}}return Array.from(i[0]+i[7]).some(o=>o.toUpperCase()==="P")?{ok:!1,error:"Invalid FEN: some pawns are on the edge rows"}:{ok:!0}}function D6(t,e){const n=t.from,r=t.to,i=t.piece;let s=0,o=0,a=0;for(let l=0,h=e.length;l<h;l++){const d=e[l].from,p=e[l].to,m=e[l].piece;i===m&&n!==d&&r===p&&(s++,ha(n)===ha(d)&&o++,ah(n)===ah(d)&&a++)}return s>0?o>0&&a>0?Zn(n):a>0?Zn(n).charAt(1):Zn(n).charAt(0):""}function Ns(t,e,n,r,i,s=void 0,o=ge.NORMAL){const a=ha(r);if(i===Yt&&(a===b6||a===x6))for(let l=0;l<TT.length;l++){const h=TT[l];t.push({color:e,from:n,to:r,piece:i,captured:s,promotion:h,flags:o|ge.PROMOTION})}else t.push({color:e,from:n,to:r,piece:i,captured:s,flags:o})}function IT(t){let e=t.charAt(0);return e>="a"&&e<="h"?t.match(/[a-h]\d.*[a-h]\d/)?void 0:Yt:(e=e.toLowerCase(),e==="o"?zt:e)}function am(t){return t.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function lm(t){return t.split(" ").slice(0,4).join(" ")}class js{constructor(e=sm){Tr(this,"_board",new Array(128));Tr(this,"_turn",fn);Tr(this,"_header",{});Tr(this,"_kings",{w:Fn,b:Fn});Tr(this,"_epSquare",-1);Tr(this,"_halfMoves",0);Tr(this,"_moveNumber",0);Tr(this,"_history",[]);Tr(this,"_comments",{});Tr(this,"_castling",{w:0,b:0});Tr(this,"_positionCount",{});this.load(e)}clear({preserveHeaders:e=!1}={}){this._board=new Array(128),this._kings={w:Fn,b:Fn},this._turn=fn,this._castling={w:0,b:0},this._epSquare=Fn,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=e?this._header:{},this._positionCount={},delete this._header.SetUp,delete this._header.FEN}removeHeader(e){e in this._header&&delete this._header[e]}load(e,{skipValidation:n=!1,preserveHeaders:r=!1}={}){let i=e.split(/\s+/);if(i.length>=2&&i.length<6){const a=["-","-","0","1"];e=i.concat(a.slice(-(6-i.length))).join(" ")}if(i=e.split(/\s+/),!n){const{ok:a,error:l}=R6(e);if(!a)throw new Error(l)}const s=i[0];let o=0;this.clear({preserveHeaders:r});for(let a=0;a<s.length;a++){const l=s.charAt(a);if(l==="/")o+=8;else if(Hx(l))o+=parseInt(l,10);else{const h=l<"a"?fn:Sr;this._put({type:l.toLowerCase(),color:h},Zn(o)),o++}}this._turn=i[1],i[2].indexOf("K")>-1&&(this._castling.w|=ge.KSIDE_CASTLE),i[2].indexOf("Q")>-1&&(this._castling.w|=ge.QSIDE_CASTLE),i[2].indexOf("k")>-1&&(this._castling.b|=ge.KSIDE_CASTLE),i[2].indexOf("q")>-1&&(this._castling.b|=ge.QSIDE_CASTLE),this._epSquare=i[3]==="-"?Fn:Te[i[3]],this._halfMoves=parseInt(i[4],10),this._moveNumber=parseInt(i[5],10),this._updateSetup(e),this._incPositionCount(e)}fen(){var s,o;let e=0,n="";for(let a=Te.a8;a<=Te.h1;a++){if(this._board[a]){e>0&&(n+=e,e=0);const{color:l,type:h}=this._board[a];n+=l===fn?h.toUpperCase():h.toLowerCase()}else e++;a+1&136&&(e>0&&(n+=e),a!==Te.h1&&(n+="/"),e=0,a+=8)}let r="";this._castling[fn]&ge.KSIDE_CASTLE&&(r+="K"),this._castling[fn]&ge.QSIDE_CASTLE&&(r+="Q"),this._castling[Sr]&ge.KSIDE_CASTLE&&(r+="k"),this._castling[Sr]&ge.QSIDE_CASTLE&&(r+="q"),r=r||"-";let i="-";if(this._epSquare!==Fn){const a=this._epSquare+(this._turn===fn?16:-16),l=[a+1,a-1];for(const h of l){if(h&136)continue;const d=this._turn;if(((s=this._board[h])==null?void 0:s.color)===d&&((o=this._board[h])==null?void 0:o.type)===Yt){this._makeMove({color:d,from:h,to:this._epSquare,piece:Yt,captured:Yt,flags:ge.EP_CAPTURE});const p=!this._isKingAttacked(d);if(this._undoMove(),p){i=Zn(this._epSquare);break}}}}return[n,this._turn,r,i,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(e){this._history.length>0||(e!==sm?(this._header.SetUp="1",this._header.FEN=e):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(sm)}get(e){return this._board[Te[e]]||!1}put({type:e,color:n},r){return this._put({type:e,color:n},r)?(this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0):!1}_put({type:e,color:n},r){if(S6.indexOf(e.toLowerCase())===-1||!(r in Te))return!1;const i=Te[r];if(e==zt&&!(this._kings[n]==Fn||this._kings[n]==i))return!1;const s=this._board[i];return s&&s.type===zt&&(this._kings[s.color]=Fn),this._board[i]={type:e,color:n},e===zt&&(this._kings[n]=i),!0}remove(e){const n=this.get(e);return delete this._board[Te[e]],n&&n.type===zt&&(this._kings[n.color]=Fn),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),n}_updateCastlingRights(){var r,i,s,o,a,l,h,d,p,m,w,E;const e=((r=this._board[Te.e1])==null?void 0:r.type)===zt&&((i=this._board[Te.e1])==null?void 0:i.color)===fn,n=((s=this._board[Te.e8])==null?void 0:s.type)===zt&&((o=this._board[Te.e8])==null?void 0:o.color)===Sr;(!e||((a=this._board[Te.a1])==null?void 0:a.type)!==cc||((l=this._board[Te.a1])==null?void 0:l.color)!==fn)&&(this._castling.w&=~ge.QSIDE_CASTLE),(!e||((h=this._board[Te.h1])==null?void 0:h.type)!==cc||((d=this._board[Te.h1])==null?void 0:d.color)!==fn)&&(this._castling.w&=~ge.KSIDE_CASTLE),(!n||((p=this._board[Te.a8])==null?void 0:p.type)!==cc||((m=this._board[Te.a8])==null?void 0:m.color)!==Sr)&&(this._castling.b&=~ge.QSIDE_CASTLE),(!n||((w=this._board[Te.h8])==null?void 0:w.type)!==cc||((E=this._board[Te.h8])==null?void 0:E.color)!==Sr)&&(this._castling.b&=~ge.KSIDE_CASTLE)}_updateEnPassantSquare(){var s,o;if(this._epSquare===Fn)return;const e=this._epSquare+(this._turn===fn?-16:16),n=this._epSquare+(this._turn===fn?16:-16),r=[n+1,n-1];if(this._board[e]!==null||this._board[this._epSquare]!==null||((s=this._board[n])==null?void 0:s.color)!==Ju(this._turn)||((o=this._board[n])==null?void 0:o.type)!==Yt){this._epSquare=Fn;return}const i=a=>{var l,h;return!(a&136)&&((l=this._board[a])==null?void 0:l.color)===this._turn&&((h=this._board[a])==null?void 0:h.type)===Yt};r.some(i)||(this._epSquare=Fn)}_attacked(e,n){for(let r=Te.a8;r<=Te.h1;r++){if(r&136){r+=7;continue}if(this._board[r]===void 0||this._board[r].color!==e)continue;const i=this._board[r],s=r-n;if(s===0)continue;const o=s+119;if(E6[o]&I6[i.type]){if(i.type===Yt){if(s>0){if(i.color===fn)return!0}else if(i.color===Sr)return!0;continue}if(i.type==="n"||i.type==="k")return!0;const a=T6[o];let l=r+a,h=!1;for(;l!==n;){if(this._board[l]!=null){h=!0;break}l+=a}if(!h)return!0}}return!1}_isKingAttacked(e){const n=this._kings[e];return n===-1?!1:this._attacked(Ju(e),n)}isAttacked(e,n){return this._attacked(n,Te[e])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const e={b:0,n:0,r:0,q:0,k:0,p:0},n=[];let r=0,i=0;for(let s=Te.a8;s<=Te.h1;s++){if(i=(i+1)%2,s&136){s+=7;continue}const o=this._board[s];o&&(e[o.type]=o.type in e?e[o.type]+1:1,o.type===rf&&n.push(i),r++)}if(r===2)return!0;if(r===3&&(e[rf]===1||e[$v]===1))return!0;if(r===e[rf]+2){let s=0;const o=n.length;for(let a=0;a<o;a++)s+=n[a];if(s===0||s===o)return!0}return!1}isThreefoldRepetition(){return this._getPositionCount(this.fen())>=3}isDraw(){return this._halfMoves>=100||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:e=!1,square:n=void 0,piece:r=void 0}={}){const i=this._moves({square:n,piece:r});return e?i.map(s=>this._makePretty(s)):i.map(s=>this._moveToSan(s,i))}_moves({legal:e=!0,piece:n=void 0,square:r=void 0}={}){var w;const i=r?r.toLowerCase():void 0,s=n==null?void 0:n.toLowerCase(),o=[],a=this._turn,l=Ju(a);let h=Te.a8,d=Te.h1,p=!1;if(i)if(i in Te)h=d=Te[i],p=!0;else return[];for(let E=h;E<=d;E++){if(E&136){E+=7;continue}if(!this._board[E]||this._board[E].color===l)continue;const{type:x}=this._board[E];let D;if(x===Yt){if(s&&s!==x)continue;D=E+om[a][0],this._board[D]||(Ns(o,a,E,D,Yt),D=E+om[a][1],P6[a]===ha(E)&&!this._board[D]&&Ns(o,a,E,D,Yt,void 0,ge.BIG_PAWN));for(let A=2;A<4;A++)D=E+om[a][A],!(D&136)&&(((w=this._board[D])==null?void 0:w.color)===l?Ns(o,a,E,D,Yt,this._board[D].type,ge.CAPTURE):D===this._epSquare&&Ns(o,a,E,D,Yt,Yt,ge.EP_CAPTURE))}else{if(s&&s!==x)continue;for(let A=0,T=ET[x].length;A<T;A++){const S=ET[x][A];for(D=E;D+=S,!(D&136);){if(!this._board[D])Ns(o,a,E,D,x);else{if(this._board[D].color===a)break;Ns(o,a,E,D,x,this._board[D].type,ge.CAPTURE);break}if(x===$v||x===zt)break}}}}if((s===void 0||s===zt)&&(!p||d===this._kings[a])){if(this._castling[a]&ge.KSIDE_CASTLE){const E=this._kings[a],x=E+2;!this._board[E+1]&&!this._board[x]&&!this._attacked(l,this._kings[a])&&!this._attacked(l,E+1)&&!this._attacked(l,x)&&Ns(o,a,this._kings[a],x,zt,void 0,ge.KSIDE_CASTLE)}if(this._castling[a]&ge.QSIDE_CASTLE){const E=this._kings[a],x=E-2;!this._board[E-1]&&!this._board[E-2]&&!this._board[E-3]&&!this._attacked(l,this._kings[a])&&!this._attacked(l,E-1)&&!this._attacked(l,x)&&Ns(o,a,this._kings[a],x,zt,void 0,ge.QSIDE_CASTLE)}}if(!e||this._kings[a]===-1)return o;const m=[];for(let E=0,x=o.length;E<x;E++)this._makeMove(o[E]),this._isKingAttacked(a)||m.push(o[E]),this._undoMove();return m}move(e,{strict:n=!1}={}){let r=null;if(typeof e=="string")r=this._moveFromSan(e,n);else if(typeof e=="object"){const s=this._moves();for(let o=0,a=s.length;o<a;o++)if(e.from===Zn(s[o].from)&&e.to===Zn(s[o].to)&&(!("promotion"in s[o])||e.promotion===s[o].promotion)){r=s[o];break}}if(!r)throw typeof e=="string"?new Error(`Invalid move: ${e}`):new Error(`Invalid move: ${JSON.stringify(e)}`);const i=this._makePretty(r);return this._makeMove(r),this._incPositionCount(i.after),i}_push(e){this._history.push({move:e,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(e){const n=this._turn,r=Ju(n);if(this._push(e),this._board[e.to]=this._board[e.from],delete this._board[e.from],e.flags&ge.EP_CAPTURE&&(this._turn===Sr?delete this._board[e.to-16]:delete this._board[e.to+16]),e.promotion&&(this._board[e.to]={type:e.promotion,color:n}),this._board[e.to].type===zt){if(this._kings[n]=e.to,e.flags&ge.KSIDE_CASTLE){const i=e.to-1,s=e.to+1;this._board[i]=this._board[s],delete this._board[s]}else if(e.flags&ge.QSIDE_CASTLE){const i=e.to+1,s=e.to-2;this._board[i]=this._board[s],delete this._board[s]}this._castling[n]=0}if(this._castling[n]){for(let i=0,s=Os[n].length;i<s;i++)if(e.from===Os[n][i].square&&this._castling[n]&Os[n][i].flag){this._castling[n]^=Os[n][i].flag;break}}if(this._castling[r]){for(let i=0,s=Os[r].length;i<s;i++)if(e.to===Os[r][i].square&&this._castling[r]&Os[r][i].flag){this._castling[r]^=Os[r][i].flag;break}}e.flags&ge.BIG_PAWN?n===Sr?this._epSquare=e.to-16:this._epSquare=e.to+16:this._epSquare=Fn,e.piece===Yt?this._halfMoves=0:e.flags&(ge.CAPTURE|ge.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,n===Sr&&this._moveNumber++,this._turn=r}undo(){const e=this._undoMove();if(e){const n=this._makePretty(e);return this._decPositionCount(n.after),n}return null}_undoMove(){const e=this._history.pop();if(e===void 0)return null;const n=e.move;this._kings=e.kings,this._turn=e.turn,this._castling=e.castling,this._epSquare=e.epSquare,this._halfMoves=e.halfMoves,this._moveNumber=e.moveNumber;const r=this._turn,i=Ju(r);if(this._board[n.from]=this._board[n.to],this._board[n.from].type=n.piece,delete this._board[n.to],n.captured)if(n.flags&ge.EP_CAPTURE){let s;r===Sr?s=n.to-16:s=n.to+16,this._board[s]={type:Yt,color:i}}else this._board[n.to]={type:n.captured,color:i};if(n.flags&(ge.KSIDE_CASTLE|ge.QSIDE_CASTLE)){let s,o;n.flags&ge.KSIDE_CASTLE?(s=n.to+1,o=n.to-1):(s=n.to-2,o=n.to+1),this._board[s]=this._board[o],delete this._board[o]}return n}pgn({newline:e=`
`,maxWidth:n=0}={}){const r=[];let i=!1;for(const m in this._header)r.push("["+m+' "'+this._header[m]+'"]'+e),i=!0;i&&this._history.length&&r.push(e);const s=m=>{const w=this._comments[this.fen()];if(typeof w<"u"){const E=m.length>0?" ":"";m=`${m}${E}{${w}}`}return m},o=[];for(;this._history.length>0;)o.push(this._undoMove());const a=[];let l="";for(o.length===0&&a.push(s(""));o.length>0;){l=s(l);const m=o.pop();if(!m)break;if(!this._history.length&&m.color==="b"){const w=`${this._moveNumber}. ...`;l=l?`${l} ${w}`:w}else m.color==="w"&&(l.length&&a.push(l),l=this._moveNumber+".");l=l+" "+this._moveToSan(m,this._moves({legal:!0})),this._makeMove(m)}if(l.length&&a.push(s(l)),typeof this._header.Result<"u"&&a.push(this._header.Result),n===0)return r.join("")+a.join(" ");const h=function(){return r.length>0&&r[r.length-1]===" "?(r.pop(),!0):!1},d=function(m,w){for(const E of w.split(" "))if(E){if(m+E.length>n){for(;h();)m--;r.push(e),m=0}r.push(E),m+=E.length,r.push(" "),m++}return h()&&m--,m};let p=0;for(let m=0;m<a.length;m++){if(p+a[m].length>n&&a[m].includes("{")){p=d(p,a[m]);continue}p+a[m].length>n&&m!==0?(r[r.length-1]===" "&&r.pop(),r.push(e),p=0):m!==0&&(r.push(" "),p++),r.push(a[m]),p+=a[m].length}return r.join("")}header(...e){for(let n=0;n<e.length;n+=2)typeof e[n]=="string"&&typeof e[n+1]=="string"&&(this._header[e[n]]=e[n+1]);return this._header}loadPgn(e,{strict:n=!1,newlineChar:r=`\r?
`}={}){function i(S){return S.replace(/\\/g,"\\")}function s(S){const M={},q=S.split(new RegExp(i(r)));let W="",P="";for(let C=0;C<q.length;C++){const R=/^\s*\[\s*([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;W=q[C].replace(R,"$1"),P=q[C].replace(R,"$2"),W.trim().length>0&&(M[W]=P)}return M}e=e.trim();const a=new RegExp("^(\\[((?:"+i(r)+")|.)*\\])((?:\\s*"+i(r)+"){2}|(?:\\s*"+i(r)+")*$)").exec(e),l=a&&a.length>=2?a[1]:"";this.reset();const h=s(l);let d="";for(const S in h)S.toLowerCase()==="fen"&&(d=h[S]),this.header(S,h[S]);if(!n)d&&this.load(d,{preserveHeaders:!0});else if(h.SetUp==="1"){if(!("FEN"in h))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(h.FEN,{preserveHeaders:!0})}function p(S){return Array.from(S).map(function(M){return M.charCodeAt(0)<128?M.charCodeAt(0).toString(16):encodeURIComponent(M).replace(/%/g,"").toLowerCase()}).join("")}function m(S){return S.length==0?"":decodeURIComponent("%"+(S.match(/.{1,2}/g)||[]).join("%"))}const w=function(S){return S=S.replace(new RegExp(i(r),"g")," "),`{${p(S.slice(1,S.length-1))}}`},E=function(S){if(S.startsWith("{")&&S.endsWith("}"))return m(S.slice(1,S.length-1))};let x=e.replace(l,"").replace(new RegExp(`({[^}]*})+?|;([^${i(r)}]*)`,"g"),function(S,M,q){return M!==void 0?w(M):" "+w(`{${q.slice(1)}}`)}).replace(new RegExp(i(r),"g")," ");const D=/(\([^()]+\))+?/g;for(;D.test(x);)x=x.replace(D,"");x=x.replace(/\d+\.(\.\.)?/g,""),x=x.replace(/\.\.\./g,""),x=x.replace(/\$\d+/g,"");let A=x.trim().split(new RegExp(/\s+/));A=A.filter(S=>S!=="");let T="";for(let S=0;S<A.length;S++){const M=E(A[S]);if(M!==void 0){this._comments[this.fen()]=M;continue}const q=this._moveFromSan(A[S],n);if(q==null)if(k6.indexOf(A[S])>-1)T=A[S];else throw new Error(`Invalid move in PGN: ${A[S]}`);else T="",this._makeMove(q),this._incPositionCount(this.fen())}T&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",T)}_moveToSan(e,n){let r="";if(e.flags&ge.KSIDE_CASTLE)r="O-O";else if(e.flags&ge.QSIDE_CASTLE)r="O-O-O";else{if(e.piece!==Yt){const i=D6(e,n);r+=e.piece.toUpperCase()+i}e.flags&(ge.CAPTURE|ge.EP_CAPTURE)&&(e.piece===Yt&&(r+=Zn(e.from)[0]),r+="x"),r+=Zn(e.to),e.promotion&&(r+="="+e.promotion.toUpperCase())}return this._makeMove(e),this.isCheck()&&(this.isCheckmate()?r+="#":r+="+"),this._undoMove(),r}_moveFromSan(e,n=!1){const r=am(e);let i=IT(r),s=this._moves({legal:!0,piece:i});for(let m=0,w=s.length;m<w;m++)if(r===am(this._moveToSan(s[m],s)))return s[m];if(n)return null;let o,a,l,h,d,p=!1;if(a=r.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),a?(o=a[1],l=a[2],h=a[3],d=a[4],l.length==1&&(p=!0)):(a=r.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),a&&(o=a[1],l=a[2],h=a[3],d=a[4],l.length==1&&(p=!0))),i=IT(r),s=this._moves({legal:!0,piece:o||i}),!h)return null;for(let m=0,w=s.length;m<w;m++)if(l){if((!o||o.toLowerCase()==s[m].piece)&&Te[l]==s[m].from&&Te[h]==s[m].to&&(!d||d.toLowerCase()==s[m].promotion))return s[m];if(p){const E=Zn(s[m].from);if((!o||o.toLowerCase()==s[m].piece)&&Te[h]==s[m].to&&(l==E[0]||l==E[1])&&(!d||d.toLowerCase()==s[m].promotion))return s[m]}}else if(r===am(this._moveToSan(s[m],s)).replace("x",""))return s[m];return null}ascii(){let e=`   +------------------------+
`;for(let n=Te.a8;n<=Te.h1;n++){if(ah(n)===0&&(e+=" "+"87654321"[ha(n)]+" |"),this._board[n]){const r=this._board[n].type,s=this._board[n].color===fn?r.toUpperCase():r.toLowerCase();e+=" "+s+" "}else e+=" . ";n+1&136&&(e+=`|
`,n+=8)}return e+=`   +------------------------+
`,e+="     a  b  c  d  e  f  g  h",e}perft(e){const n=this._moves({legal:!1});let r=0;const i=this._turn;for(let s=0,o=n.length;s<o;s++)this._makeMove(n[s]),this._isKingAttacked(i)||(e-1>0?r+=this.perft(e-1):r++),this._undoMove();return r}_makePretty(e){const{color:n,piece:r,from:i,to:s,flags:o,captured:a,promotion:l}=e;let h="";for(const w in ge)ge[w]&o&&(h+=w6[w]);const d=Zn(i),p=Zn(s),m={color:n,piece:r,from:d,to:p,san:this._moveToSan(e,this._moves({legal:!0})),flags:h,lan:d+p,before:this.fen(),after:""};return this._makeMove(e),m.after=this.fen(),this._undoMove(),a&&(m.captured=a),l&&(m.promotion=l,m.lan+=l),m}turn(){return this._turn}board(){const e=[];let n=[];for(let r=Te.a8;r<=Te.h1;r++)this._board[r]==null?n.push(null):n.push({square:Zn(r),type:this._board[r].type,color:this._board[r].color}),r+1&136&&(e.push(n),n=[],r+=8);return e}squareColor(e){if(e in Te){const n=Te[e];return(ha(n)+ah(n))%2===0?"light":"dark"}return null}history({verbose:e=!1}={}){const n=[],r=[];for(;this._history.length>0;)n.push(this._undoMove());for(;;){const i=n.pop();if(!i)break;e?r.push(this._makePretty(i)):r.push(this._moveToSan(i,this._moves())),this._makeMove(i)}return r}_getPositionCount(e){const n=lm(e);return this._positionCount[n]||0}_incPositionCount(e){const n=lm(e);this._positionCount[n]===void 0&&(this._positionCount[n]=0),this._positionCount[n]+=1}_decPositionCount(e){const n=lm(e);this._positionCount[n]===1?delete this._positionCount[n]:this._positionCount[n]-=1}_pruneComments(){const e=[],n={},r=i=>{i in this._comments&&(n[i]=this._comments[i])};for(;this._history.length>0;)e.push(this._undoMove());for(r(this.fen());;){const i=e.pop();if(!i)break;this._makeMove(i),r(this.fen())}this._comments=n}getComment(){return this._comments[this.fen()]}setComment(e){this._comments[this.fen()]=e.replace("{","[").replace("}","]")}deleteComment(){const e=this._comments[this.fen()];return delete this._comments[this.fen()],e}getComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>({fen:e,comment:this._comments[e]}))}deleteComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>{const n=this._comments[e];return delete this._comments[e],{fen:e,comment:n}})}setCastlingRights(e,n){for(const i of[zt,Vs])n[i]!==void 0&&(n[i]?this._castling[e]|=Ad[i]:this._castling[e]&=~Ad[i]);this._updateCastlingRights();const r=this.getCastlingRights(e);return(n[zt]===void 0||n[zt]===r[zt])&&(n[Vs]===void 0||n[Vs]===r[Vs])}getCastlingRights(e){return{[zt]:(this._castling[e]&Ad[zt])!==0,[Vs]:(this._castling[e]&Ad[Vs])!==0}}moveNumber(){return this._moveNumber}}const tp=({timeInMinutes:t,increment:e,isActive:n,color:r,onTimeout:i,onTimeUpdate:s,remainingTime:o})=>{const[a,l]=N.useState(o);N.useEffect(()=>{l(o)},[o]),N.useEffect(()=>{let p;return n&&a>0&&(p=setInterval(()=>{l(m=>{const w=m-1;return s(w),w<=0&&i(),w})},1e3)),()=>{p&&clearInterval(p)}},[n,a,i,s]);const h=()=>{const p=["game-clock"];return n&&p.push("active"),a<30&&p.push("warning"),p.join(" ")},d=p=>{const m=Math.floor(p/60),w=p%60;return`${m}:${w.toString().padStart(2,"0")}`};return y.jsx("div",{className:h(),children:d(a)})},hc=({isPuzzle:t=!1,timeControl:e})=>{const[n,r]=N.useState(null),[i,s]=N.useState(null),[o,a]=N.useState("Cargando puzzle..."),[l,h]=N.useState(0),[d,p]=N.useState("white");N.useEffect(()=>{let E=!0,x=!1;return t&&(async()=>{try{if(n||i||x)return;x=!0;const A=await fetch("https://lichess.org/api/puzzle/daily");if(!A.ok)throw new Error("Error al cargar el puzzle");const T=await A.json(),S=new js;try{S.loadPgn(T.game.pgn);const M=S.history();console.log("Movimientos totales:",M.length),console.log("Initial Ply:",T.puzzle.initialPly),console.log("Moves:",M),S.reset();for(let P=0;P<T.puzzle.initialPly;P++)S.move(M[P]);const q=S.fen(),W=M[T.puzzle.initialPly];if(console.log("Siguiente movimiento:",W),!W){console.error("No se encontr el siguiente movimiento"),E&&a("Error al cargar el puzzle. Intenta recargar la pgina.");return}E&&(s({fen:q,moves:T.puzzle.solution,rating:T.puzzle.rating,themes:T.puzzle.themes}),r(new js(q)),a("Observa el movimiento del oponente..."),setTimeout(()=>{if(!E)return;const P=new js(q);try{if(console.log("Intentando mover:",W),!P.move(W))throw new Error(`Movimiento invlido: ${W}`);r(P),a("Tu turno - Encuentra el mejor movimiento")}catch(C){console.error("Error al realizar el movimiento:",C),a("Error al cargar el puzzle. Intenta recargar la pgina.")}},1e3))}catch(M){console.error("Error al procesar el puzzle:",M),E&&a("Error al cargar el puzzle. Intenta recargar la pgina.")}}catch(A){console.error("Error al obtener el puzzle:",A),E&&a("Error al cargar el puzzle. Intenta recargar la pgina.")}})(),()=>{E=!1}},[t]);function m(E){return E.includes("O-O-O")?{from:"e1",to:"c1"}:E.includes("O-O")?{from:"e1",to:"g1"}:{from:E.slice(0,2),to:E.slice(2,4),promotion:E.length===5?E[4]:void 0}}function w(E){if(!n||!i)return!1;try{const x=new js(n.fen());if(x.move(E)){const A=i.moves[l],T=m(A),S=x.fen().split(" ")[0],M=new js(n.fen()),W=M.move(T)?M.fen().split(" ")[0]:"";if(S===W)return r(x),l===i.moves.length-1?(a("Felicidades!  Has resuelto el puzzle correctamente."),!0):(h(l+1),setTimeout(()=>{if(l+1<i.moves.length){const P=i.moves[l+1],C=P.slice(0,2),R=P.slice(2,4);x.move({from:C,to:R,promotion:P.length===5?P[4]:void 0})&&(r(new js(x.fen())),h(l+2),a("Tu turno"))}},500),!0)}return a("Movimiento incorrecto. Intenta de nuevo."),!1}catch(x){return console.error("Error en makeAMove:",x),!1}}return y.jsxs("div",{className:"board-container",children:[e&&y.jsx(tp,{timeInMinutes:e.time,increment:e.increment,isActive:d==="black",color:"black",onTimeout:async()=>{},onTimeUpdate:E=>{},remainingTime:e.time*60}),n&&y.jsx(qx,{position:n.fen(),boardOrientation:"white",onPieceDrop:(E,x)=>{const D=w({from:E,to:x,promotion:"q"});return D&&p(n.turn()==="w"?"white":"black"),D}}),e&&y.jsx(tp,{timeInMinutes:e.time,increment:e.increment,isActive:d==="white",color:"white",onTimeout:async()=>{},onTimeUpdate:E=>{},remainingTime:e.time*60}),o&&y.jsx("div",{className:"puzzle-message",style:{marginTop:"1rem",padding:"1rem",backgroundColor:i&&l===i.moves.length-1?"#e6ffe6":"#fff",border:"1px solid #ccc",borderRadius:"4px"},children:o})]})};class Rl{constructor(){this.cache=new Map}static getInstance(){return Rl.instance||(Rl.instance=new Rl),Rl.instance}set(e,n,r=5*60*1e3){this.cache.set(e,{value:n,timestamp:Date.now(),expiresIn:r})}get(e){const n=this.cache.get(e);return n?Date.now()-n.timestamp>n.expiresIn?(this.cache.delete(e),null):n.value:null}clear(){this.cache.clear()}}const Wx=N.createContext({currentUser:null,userData:null,loading:!0,refreshUserData:async()=>{}}),O6=()=>N.useContext(Wx),N6=({children:t})=>{const[e,n]=N.useState(null),[r,i]=N.useState(null),[s,o]=N.useState(!0),a=Rl.getInstance(),l=async p=>{const m=a.get(`userData_${p}`);if(m)return m;const w=await uo(Nt(xt,"users",p));if(w.exists()){const E=w.data();return a.set(`userData_${p}`,E,5*60*1e3),E}return null},h=async()=>{if(e){const p=await l(e.uid);i(p)}};N.useEffect(()=>{const p=ct.onAuthStateChanged(async m=>{if(n(m),m){const w=await l(m.uid);i(w)}else i(null),a.clear();o(!1)});return()=>p()},[]);const d={currentUser:e,userData:r,loading:s,refreshUserData:h};return y.jsx(Wx.Provider,{value:d,children:!s&&t})},ka=()=>{console.log("Renderizando Header");const{currentUser:t}=O6(),e=async()=>{try{await Ub(ct)}catch(n){console.error("Error al cerrar sesin:",n)}};return y.jsxs("header",{className:"main-header",children:[y.jsxs(sr,{to:"/",className:"logo",children:[y.jsx("i",{className:"fas fa-chess-knight logo-icon"}),y.jsxs("div",{className:"logo-text",children:[y.jsx("span",{className:"logo-chess",children:"CHESS"}),y.jsx("span",{className:"logo-match",children:"MATCH"})]})]}),y.jsx("div",{className:"auth-buttons",children:t?y.jsxs("button",{onClick:e,className:"btn-logout",children:[y.jsx("i",{className:"fas fa-sign-out-alt"}),"Cerrar sesin"]}):y.jsxs(y.Fragment,{children:[y.jsx(sr,{to:"/register",className:"btn-signup",children:"Registrarse"}),y.jsx(sr,{to:"/login",className:"btn-login",children:"Iniciar sesin"})]})})]})},ST=()=>(N.useEffect(()=>{console.log("Home montado");const t=document.querySelectorAll(".game-button");console.log("Botones encontrados:",t.length)},[]),console.log("Renderizando componente Home"),console.log("Estilos cargados:",document.styleSheets),y.jsxs("div",{className:"page-container",children:[y.jsx(ka,{}),y.jsx("div",{className:"home-container",children:y.jsxs("div",{className:"game-options",children:[y.jsx("h1",{children:"Play Chess Online on the #1 Site!"}),y.jsxs("div",{className:"stats",children:[y.jsx("span",{className:"games-today",children:"13,562,492 Games Today"}),y.jsx("span",{className:"playing-now",children:"118,172 Playing Now"})]}),y.jsxs("div",{className:"game-buttons",children:[y.jsxs(sr,{to:"/play/online",className:"game-button primary",children:[y.jsx("span",{className:"icon",children:""}),y.jsxs("div",{className:"button-content",children:[y.jsx("h3",{children:"Play Online"}),y.jsx("p",{children:"Play with someone at your level"})]})]}),y.jsxs(sr,{to:"/play/computer",className:"game-button",children:[y.jsx("span",{className:"icon",children:""}),y.jsxs("div",{className:"button-content",children:[y.jsx("h3",{children:"Play Computer"}),y.jsx("p",{children:"Play vs customizable training bots"})]})]})]}),y.jsxs("div",{className:"puzzle-section",children:[y.jsx("h2",{children:"Solve Chess Puzzles"}),y.jsx("div",{className:"mini-board",children:y.jsx(hc,{isPuzzle:!0})}),y.jsx("div",{className:"quote",children:y.jsxs("p",{children:['"En Ajedrez, el vencedor es quien hace la siguiente jugada al ltimo error." ',y.jsx("br",{})," GM S. Tartakower"]})}),y.jsx("button",{className:"game-button",children:"Solve Puzzles"})]}),y.jsx("button",{className:"game-button chess-today",children:"Chess Today"})]})})]}));let L6={data:""},M6=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||L6,V6=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,j6=/\/\*[^]*?\*\/|  +/g,bT=/\n+/g,Hs=(t,e)=>{let n="",r="",i="";for(let s in t){let o=t[s];s[0]=="@"?s[1]=="i"?n=s+" "+o+";":r+=s[1]=="f"?Hs(o,s):s+"{"+Hs(o,s[1]=="k"?"":e)+"}":typeof o=="object"?r+=Hs(o,e?e.replace(/([^,])+/g,a=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,a):a?a+" "+l:l)):s):o!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=Hs.p?Hs.p(s,o):s+":"+o+";")}return n+(e&&i?e+"{"+i+"}":i)+r},Mi={},Kx=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+Kx(t[n]);return e}return t},F6=(t,e,n,r,i)=>{let s=Kx(t),o=Mi[s]||(Mi[s]=(l=>{let h=0,d=11;for(;h<l.length;)d=101*d+l.charCodeAt(h++)>>>0;return"go"+d})(s));if(!Mi[o]){let l=s!==t?t:(h=>{let d,p,m=[{}];for(;d=V6.exec(h.replace(j6,""));)d[4]?m.shift():d[3]?(p=d[3].replace(bT," ").trim(),m.unshift(m[0][p]=m[0][p]||{})):m[0][d[1]]=d[2].replace(bT," ").trim();return m[0]})(t);Mi[o]=Hs(i?{["@keyframes "+o]:l}:l,n?"":"."+o)}let a=n&&Mi.g?Mi.g:null;return n&&(Mi.g=Mi[o]),((l,h,d,p)=>{p?h.data=h.data.replace(p,l):h.data.indexOf(l)===-1&&(h.data=d?l+h.data:h.data+l)})(Mi[o],e,r,a),o},U6=(t,e,n)=>t.reduce((r,i,s)=>{let o=e[s];if(o&&o.call){let a=o(n),l=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=l?"."+l:a&&typeof a=="object"?a.props?"":Hs(a,""):a===!1?"":a}return r+i+(o??"")},"");function Qp(t){let e=this||{},n=t.call?t(e.p):t;return F6(n.unshift?n.raw?U6(n,[].slice.call(arguments,1),e.p):n.reduce((r,i)=>Object.assign(r,i&&i.call?i(e.p):i),{}):n,M6(e.target),e.g,e.o,e.k)}let Gx,zv,Bv;Qp.bind({g:1});let ns=Qp.bind({k:1});function $6(t,e,n,r){Hs.p=e,Gx=t,zv=n,Bv=r}function Co(t,e){let n=this||{};return function(){let r=arguments;function i(s,o){let a=Object.assign({},s),l=a.className||i.className;n.p=Object.assign({theme:zv&&zv()},a),n.o=/ *go\d+/.test(l),a.className=Qp.apply(n,r)+(l?" "+l:"");let h=t;return t[0]&&(h=a.as||t,delete a.as),Bv&&h[0]&&Bv(a),Gx(h,a)}return i}}var z6=t=>typeof t=="function",qv=(t,e)=>z6(t)?t(e):t,B6=(()=>{let t=0;return()=>(++t).toString()})(),q6=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),H6=20,sf=new Map,W6=1e3,CT=t=>{if(sf.has(t))return;let e=setTimeout(()=>{sf.delete(t),Yp({type:4,toastId:t})},W6);sf.set(t,e)},K6=t=>{let e=sf.get(t);e&&clearTimeout(e)},Hv=(t,e)=>{switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,H6)};case 1:return e.toast.id&&K6(e.toast.id),{...t,toasts:t.toasts.map(s=>s.id===e.toast.id?{...s,...e.toast}:s)};case 2:let{toast:n}=e;return t.toasts.find(s=>s.id===n.id)?Hv(t,{type:1,toast:n}):Hv(t,{type:0,toast:n});case 3:let{toastId:r}=e;return r?CT(r):t.toasts.forEach(s=>{CT(s.id)}),{...t,toasts:t.toasts.map(s=>s.id===r||r===void 0?{...s,visible:!1}:s)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(s=>s.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+i}))}}},G6=[],um={toasts:[],pausedAt:void 0},Yp=t=>{um=Hv(um,t),G6.forEach(e=>{e(um)})},Q6=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||B6()}),Ch=t=>(e,n)=>{let r=Q6(e,t,n);return Yp({type:2,toast:r}),r.id},be=(t,e)=>Ch("blank")(t,e);be.error=Ch("error");be.success=Ch("success");be.loading=Ch("loading");be.custom=Ch("custom");be.dismiss=t=>{Yp({type:3,toastId:t})};be.remove=t=>Yp({type:4,toastId:t});be.promise=(t,e,n)=>{let r=be.loading(e.loading,{...n,...n==null?void 0:n.loading});return t.then(i=>(be.success(qv(e.success,i),{id:r,...n,...n==null?void 0:n.success}),i)).catch(i=>{be.error(qv(e.error,i),{id:r,...n,...n==null?void 0:n.error})}),t};var Y6=ns`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,X6=ns`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,J6=ns`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Z6=Co("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Y6} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${X6} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${J6} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,e9=ns`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,t9=Co("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${e9} 1s linear infinite;
`,n9=ns`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,r9=ns`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,i9=Co("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${n9} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${r9} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,s9=Co("div")`
  position: absolute;
`,o9=Co("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,a9=ns`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,l9=Co("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${a9} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,u9=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?N.createElement(l9,null,e):e:n==="blank"?null:N.createElement(o9,null,N.createElement(t9,{...r}),n!=="loading"&&N.createElement(s9,null,n==="error"?N.createElement(Z6,{...r}):N.createElement(i9,{...r})))},c9=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,h9=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,d9="0%{opacity:0;} 100%{opacity:1;}",f9="0%{opacity:1;} 100%{opacity:0;}",p9=Co("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,g9=Co("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,m9=(t,e)=>{let n=t.includes("top")?1:-1,[r,i]=q6()?[d9,f9]:[c9(n),h9(n)];return{animation:e?`${ns(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ns(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}};N.memo(({toast:t,position:e,style:n,children:r})=>{let i=t.height?m9(t.position||e||"top-center",t.visible):{opacity:0},s=N.createElement(u9,{toast:t}),o=N.createElement(g9,{...t.ariaProps},qv(t.message,t));return N.createElement(p9,{className:t.className,style:{...i,...n,...t.style}},typeof r=="function"?r({icon:s,message:o}):N.createElement(N.Fragment,null,s,o))});$6(N.createElement);Qp`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`;const v9=()=>{var p;const t=Na(),n=((p=Oa().state)==null?void 0:p.redirect)||"/lobby",[r,i]=N.useState(""),[s,o]=N.useState(""),[a,l]=N.useState(!1),h=async m=>{m.preventDefault();try{await EL(ct,r,s),t(n)}catch(w){console.error("Error al iniciar sesin:",w),w.code==="auth/invalid-credential"?be.error("Email o contrasea incorrectos"):w.code==="auth/user-not-found"?be.error("Usuario no encontrado"):w.code==="auth/wrong-password"?be.error("Contrasea incorrecta"):be.error("Error al iniciar sesin")}},d=async()=>{const m=new vi;try{const w=await Xb(ct,m);if(!(await uo(Nt(xt,"users",w.user.uid))).exists()){t("/complete-profile",{state:{uid:w.user.uid,email:w.user.email,photoURL:w.user.photoURL}});return}t(n)}catch(w){console.error("Error con Google login:",w),be.error("Error al iniciar sesin con Google")}};return y.jsxs("div",{className:"page-container",children:[y.jsx(ka,{}),y.jsx("div",{className:"auth-container",children:y.jsxs("div",{className:"auth-card",children:[y.jsx(sr,{to:"/",className:"back-button",children:y.jsx("i",{className:"fas fa-arrow-left"})}),y.jsx("h2",{children:"Ingresa tu email y contrasea"}),y.jsx("p",{className:"auth-subtitle",children:"Esto te permite iniciar sesin en cualquier dispositivo"}),y.jsxs("form",{onSubmit:h,children:[y.jsx("div",{className:"form-group",children:y.jsxs("div",{className:"input-icon",children:[y.jsx("i",{className:"fas fa-envelope"}),y.jsx("input",{type:"email",placeholder:"Email",value:r,onChange:m=>i(m.target.value),required:!0})]})}),y.jsx("div",{className:"form-group",children:y.jsxs("div",{className:"input-icon",children:[y.jsx("i",{className:"fas fa-lock"}),y.jsx("input",{type:a?"text":"password",placeholder:"Contrasea",value:s,onChange:m=>o(m.target.value),required:!0}),y.jsx("button",{type:"button",className:"toggle-password",onClick:()=>l(!a),children:y.jsx("i",{className:`fas fa-eye${a?"-slash":""}`})})]})}),y.jsx("button",{type:"submit",className:"btn-continue",children:"Continuar"})]}),y.jsx("div",{className:"auth-divider",children:"O"}),y.jsxs("div",{className:"social-buttons",children:[y.jsxs("button",{className:"btn-social google",onClick:d,children:[y.jsx("i",{className:"fab fa-google"}),"Continuar con Google"]}),y.jsxs("button",{className:"btn-social apple",children:[y.jsx("i",{className:"fab fa-apple"}),"Continuar con Apple"]})]}),y.jsxs("div",{className:"auth-links",children:[y.jsx(sr,{to:"/forgot-password",children:"Olvidaste tu contrasea?"}),y.jsx(sr,{to:"/register",children:"No tienes una cuenta? Regstrate"})]})]})})]})},y9=()=>{const t=Na(),[e,n]=N.useState({username:"",email:"",password:""}),r=async a=>{if(!/^[a-zA-Z0-9_]{3,15}$/.test(a))return!1;const l=Nt(xt,"usernames",a.toLowerCase());return!(await uo(l)).exists()},i=async(a,l,h,d)=>{try{await Xf(Nt(xt,"usernames",l.toLowerCase()),{uid:a}),await Xf(Nt(xt,"users",a),{username:l,email:h,createdAt:new Date,rating:1200,photoURL:d||null}),await jb(ct.currentUser,{displayName:l,photoURL:d||null})}catch(p){throw console.error("Error guardando datos de usuario:",p),p}},s=async a=>{a.preventDefault();try{if(!await r(e.username)){be.error("Nombre de usuario no vlido o ya est en uso");return}const h=await wL(ct,e.email,e.password);await i(h.user.uid,e.username,e.email),be.success("Cuenta creada exitosamente!"),t("/lobby")}catch(l){l.code==="auth/email-already-in-use"?be.error("Este email ya est registrado"):be.error("Error al crear la cuenta")}},o=async()=>{var a,l;try{const h=new vi,d=await Xb(ct,h);let p=((a=d.user.email)==null?void 0:a.split("@")[0])||"",m=await r(p),w=1;for(;!m&&w<100;)p=`${(l=d.user.email)==null?void 0:l.split("@")[0]}_${w}`,m=await r(p),w++;if(!m){be.error("No se pudo generar un nombre de usuario nico");return}await i(d.user.uid,p,d.user.email,d.user.photoURL||void 0),be.success("Cuenta creada exitosamente!"),t("/lobby")}catch(h){h.code==="auth/popup-closed-by-user"?be.error("Registro cancelado"):be.error("Error al registrarse con Google")}};return y.jsx("div",{className:"auth-container",children:y.jsxs("div",{className:"auth-card",children:[y.jsx(sr,{to:"/",className:"back-button",children:y.jsx("i",{className:"fas fa-arrow-left"})}),y.jsxs(sr,{to:"/",className:"logo",children:[y.jsx("i",{className:"fas fa-chess-knight logo-icon"}),y.jsxs("div",{className:"logo-text",children:[y.jsx("span",{className:"logo-chess",children:"CHESS"}),y.jsx("span",{className:"logo-match",children:"MATCH"})]})]}),y.jsx("h2",{children:"Crear cuenta"}),y.jsx("p",{className:"auth-subtitle",children:"Este es el nombre que vern tus amigos y otros jugadores"}),y.jsxs("form",{onSubmit:s,children:[y.jsx("div",{className:"form-group",children:y.jsxs("div",{className:"input-icon",children:[y.jsx("i",{className:"fas fa-user"}),y.jsx("input",{type:"text",placeholder:"Nombre de usuario",value:e.username,onChange:a=>n({...e,username:a.target.value}),required:!0,minLength:3,maxLength:15,pattern:"^[a-zA-Z0-9_]+$",title:"El nombre de usuario debe tener entre 3 y 15 caracteres y solo puede contener letras, nmeros y guiones bajos"})]})}),y.jsx("div",{className:"form-group",children:y.jsxs("div",{className:"input-icon",children:[y.jsx("i",{className:"fas fa-envelope"}),y.jsx("input",{type:"email",placeholder:"Email",value:e.email,onChange:a=>n({...e,email:a.target.value}),required:!0})]})}),y.jsx("div",{className:"form-group",children:y.jsxs("div",{className:"input-icon",children:[y.jsx("i",{className:"fas fa-lock"}),y.jsx("input",{type:"password",placeholder:"Contrasea",value:e.password,onChange:a=>n({...e,password:a.target.value}),required:!0})]})}),y.jsx("button",{type:"submit",className:"btn-continue",children:"Crear cuenta"})]}),y.jsx("div",{className:"auth-divider",children:"O"}),y.jsxs("div",{className:"social-buttons",children:[y.jsxs("button",{className:"btn-social google",onClick:o,children:[y.jsx("i",{className:"fab fa-google"}),"Continuar con Google"]}),y.jsxs("button",{className:"btn-social apple",children:[y.jsx("i",{className:"fab fa-apple"}),"Continuar con Apple"]})]}),y.jsx("div",{className:"auth-links",children:y.jsx(sr,{to:"/login",children:"Ya tienes una cuenta? Inicia sesin"})})]})})},_9=()=>{const[t,e]=N.useState(""),[n,r]=N.useState(!1),i=s=>{s.preventDefault(),console.log("Recuperar contrasea para:",t),r(!0)};return y.jsxs("div",{className:"page-container",children:[y.jsx(ka,{}),y.jsx("div",{className:"auth-container",children:y.jsxs("div",{className:"auth-card",children:[y.jsx(sr,{to:"/login",className:"back-button",children:y.jsx("i",{className:"fas fa-arrow-left"})}),n?y.jsxs("div",{className:"success-message",children:[y.jsx("i",{className:"fas fa-check-circle"}),y.jsx("h2",{children:"Email enviado!"}),y.jsxs("p",{children:["Hemos enviado las instrucciones para restablecer tu contrasea a ",t]}),y.jsx("p",{className:"small",children:"Si no recibes el email en unos minutos, revisa tu carpeta de spam"}),y.jsx(sr,{to:"/login",className:"btn-continue",children:"Volver al inicio de sesin"})]}):y.jsxs(y.Fragment,{children:[y.jsx("h2",{children:"Recuperar contrasea"}),y.jsx("p",{className:"auth-subtitle",children:"Ingresa tu email y te enviaremos instrucciones para restablecer tu contrasea"}),y.jsxs("form",{onSubmit:i,children:[y.jsx("div",{className:"form-group",children:y.jsxs("div",{className:"input-icon",children:[y.jsx("i",{className:"fas fa-envelope"}),y.jsx("input",{type:"email",placeholder:"Email",value:t,onChange:s=>e(s.target.value),required:!0})]})}),y.jsx("button",{type:"submit",className:"btn-continue",children:"Enviar instrucciones"})]})]})]})})]})},kc=[{name:"Bullet",time:1,increment:0},{name:"Bullet",time:1,increment:1},{name:"Blitz",time:3,increment:0},{name:"Blitz",time:3,increment:2},{name:"Blitz",time:5,increment:0},{name:"Blitz",time:5,increment:3},{name:"Rpida",time:10,increment:0},{name:"Rpida",time:15,increment:10},{name:"Clsica",time:30,increment:0}];kc.find(t=>t.time===3&&t.increment===2)||kc[0];const AT=({options:t,selected:e,onSelect:n})=>{const r=["Bullet","Blitz","Rpida","Clsica"];return y.jsxs("div",{className:"time-control",children:[y.jsx("h3",{children:"Control de Tiempo"}),y.jsx("div",{className:"time-options",children:r.map(i=>y.jsxs(FT.Fragment,{children:[y.jsx("div",{className:"time-category",children:i}),y.jsx("div",{className:"time-category-options",children:t.filter(s=>s.name===i).map((s,o)=>y.jsx("button",{className:`time-option ${e===s?"selected":""}`,onClick:()=>n(s),children:y.jsxs("span",{className:"time",children:[s.time,"+",s.increment]})},`${s.time}-${s.increment}-${o}`))})]},i))})]})},xT=({config:t,onChange:e})=>y.jsxs("div",{className:"match-settings",children:[y.jsxs("div",{className:"setting-group",children:[y.jsx("h3",{children:"Tipo de Match"}),y.jsxs("div",{className:"toggle-group",children:[y.jsx("button",{className:t.rated?"selected":"",onClick:()=>e({...t,rated:!0}),children:"Clasificatorio"}),y.jsx("button",{className:t.rated?"":"selected",onClick:()=>e({...t,rated:!1}),children:"Amistoso"})]})]}),y.jsxs("div",{className:"setting-group",children:[y.jsx("h3",{children:"Color de Piezas"}),y.jsxs("div",{className:"color-selector",children:[y.jsxs("button",{className:t.color==="random"?"selected":"",onClick:()=>e({...t,color:"random"}),children:[y.jsx("i",{className:"fas fa-random"}),"Aleatorio"]}),y.jsxs("button",{className:t.color==="white"?"selected":"",onClick:()=>e({...t,color:"white"}),children:[y.jsx("i",{className:"fas fa-chess-pawn"}),"Blancas"]}),y.jsxs("button",{className:t.color==="black"?"selected":"",onClick:()=>e({...t,color:"black"}),children:[y.jsx("i",{className:"fas fa-chess-pawn chess-piece-black"}),"Negras"]})]})]})]}),w9=()=>{console.log("Renderizando Lobby");const t=Na(),[e,n]=N.useState(null);N.useEffect(()=>{console.log("Componentes importados:",{TimeControl:!!AT,MatchSettings:!!xT,Header:!!ka}),console.log("Iniciando efecto de autenticacin en Lobby");const l=Fb(ct,d=>{console.log("Estado de autenticacin cambiado:",!!d),d||(console.log("Usuario no autenticado, redirigiendo a login"),t("/login"))});return(async()=>{if(ct.currentUser){const d=await uo(Nt(xt,"users",ct.currentUser.uid));d.exists()&&n(d.data())}})(),()=>{console.log("Limpiando efecto de autenticacin en Lobby"),l()}},[t]);const[r,i]=N.useState({timeControl:kc.find(l=>l.time===3&&l.increment===2)||kc[0],numberOfGames:3,rated:!0,color:"random"}),s=async()=>{try{if(!ct.currentUser){be.error("Debes iniciar sesin para crear un reto"),t("/login");return}if(!(e!=null&&e.username)){be.error("Error: No se pudo obtener la informacin del usuario");return}const l=r.timeControl.time*60,h={createdBy:ct.currentUser.uid,creatorUsername:e.username,createdAt:oj(),config:r,status:"waiting",currentGame:1,gameStarted:!1,timeLeft:{white:l,black:l},players:{white:null,black:null},currentTurn:"white",fen:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"};console.log("Intentando crear reto con datos:",h);const d=await ij(U3(xt,"challenges"),h);if(!d.id)throw new Error("No se pudo obtener el ID del reto");be.success("Reto creado!"),t(`/challenge/${d.id}`)}catch(l){console.error("Error al crear reto:",l),l.code==="resource-exhausted"?be.error("Se ha excedido el lmite de operaciones. Intenta ms tarde."):be.error("Error al crear el reto")}},o=async()=>{try{await Ub(ct),t("/")}catch(l){console.error("Error al cerrar sesin:",l)}},a=l=>{i(l)};return y.jsxs("div",{className:"lobby-container",children:[y.jsx(ka,{}),y.jsx("div",{className:"lobby-content",children:y.jsxs("div",{className:"lobby-card",children:[y.jsx("h2",{children:"Crear Match Personalizado"}),y.jsx("button",{onClick:o,children:"Cerrar Sesin"}),y.jsx(AT,{options:kc,selected:r.timeControl,onSelect:l=>i({...r,timeControl:l})}),y.jsxs("div",{className:"game-count-section",children:[y.jsx("h3",{children:"Nmero de Partidas"}),y.jsx("div",{className:"game-count-options",children:[1,3,5,10,20].map(l=>y.jsx("button",{className:`game-count-button ${r.numberOfGames===l?"active":""}`,onClick:()=>i({...r,numberOfGames:l}),children:l===1?"1 partida":`${l} partidas`},l))})]}),y.jsx(xT,{config:r,onChange:a}),y.jsx("button",{className:"btn-create-challenge",onClick:s,children:"Crear Reto"})]})}),y.jsx("div",{className:"lobby-footer",children:y.jsxs("button",{className:"btn-puzzles",children:[y.jsx("i",{className:"fas fa-puzzle-piece"}),"Resolver puzzles"]})})]})},E9=()=>{var W,P,C,R,O,L,V;const[t,e]=N.useState(new js),[n,r]=N.useState(!1),[i,s]=N.useState(null),[o,a]=N.useState(!0),[l,h]=N.useState({isCreator:!1,gameStarted:!1,timeWhite:0,timeBlack:0,currentGame:1,totalGames:1,challenge:null,isWhiteTurn:!0,isLoading:!0,error:null,players:{white:null,black:null,whiteUsername:null,blackUsername:null}}),{challengeId:d}=yO(),p=Na(),[m,w]=N.useState(!1),[E,x]=N.useState(0);N.useEffect(()=>{if(console.log("Iniciando efecto con challengeId:",d),!d)return;(async()=>{try{const Ie=Nt(xt,"challenges",d),Fe=await uo(Ie);if(!Fe.exists()){be.error("Reto no encontrado"),p("/");return}const Ce=Fe.data();console.log("Datos del reto cargados:",Ce);const X=(Ce.config.timeControl.time||0)*60;if(x(X),h(ue=>({...ue,challenge:{id:d,...Ce},timeWhite:X,timeBlack:X,isLoading:!1,gameStarted:Ce.gameStarted||!1})),ct.currentUser){const ue=Ce.players.white===ct.currentUser.uid,z=Ce.players.black===ct.currentUser.uid;if(ue)s("white");else if(z)s("black");else if(!Ce.players.white||!Ce.players.black){const Ne=Ce.players.white?"black":"white";await D(Ne)}}w(Ce.gameStarted||!1),a(!1)}catch(Ie){console.error("Error cargando el reto:",Ie),a(!1)}})();const ve=sj(Nt(xt,"challenges",d),Ie=>{if(!Ie.exists())return;const Fe=Ie.data();w(Fe.gameStarted||!1),Fe.timeLeft&&h(Ce=>({...Ce,timeWhite:Fe.timeLeft.white,timeBlack:Fe.timeLeft.black}))});return()=>ve()},[d]);const D=async k=>{if(!(!d||!ct.currentUser))try{const ve=Nt(xt,"challenges",d);await dl(ve,{[`players.${k}`]:ct.currentUser.uid,...k==="black"?{gameStarted:!0}:{}}),s(k),be.success("Te has unido al juego")}catch(ve){console.error("Error al unirse al juego:",ve),be.error("Error al unirse al juego")}};if(N.useEffect(()=>{!l.gameStarted||l.challenge},[l.gameStarted,l.challenge]),N.useEffect(()=>{(async()=>{if(l.players.white){const ve=await uo(Nt(xt,"users",l.players.white));ve.exists()&&h(Ie=>({...Ie,players:{...Ie.players,whiteUsername:ve.data().username}}))}if(l.players.black){const ve=await uo(Nt(xt,"users",l.players.black));ve.exists()&&h(Ie=>({...Ie,players:{...Ie.players,blackUsername:ve.data().username}}))}})()},[l.players.white,l.players.black]),N.useEffect(()=>{console.log("Estado del challenge:",{isLoading:o,challengeState:l,playerColor:i,game:t==null?void 0:t.fen()})},[o,l,i,t]),o)return y.jsx("div",{className:"loading",children:"Cargando reto..."});const A=(k,ve,Ie)=>{if(!n||!d||!ct.currentUser)return!1;try{const Fe=new js(t.fen()),Ce=Fe.move({from:k,to:ve,promotion:Ie[1]==="P"?"q":void 0});return Ce?(dl(Nt(xt,"challenges",d),{fen:Fe.fen(),lastMove:{from:k,to:ve,piece:Ie,color:i},currentTurn:i==="white"?"black":"white",moves:aj({from:k,to:ve,piece:Ie,san:Ce.san,timestamp:Date.now()})}).catch(X=>{console.error("Error al realizar movimiento:",X),be.error("Error al realizar el movimiento")}),e(Fe),r(!1),!0):!1}catch(Fe){return console.error("Error al realizar movimiento:",Fe),be.error("Error al realizar el movimiento"),!1}},T=async()=>{if(!(!d||!ct.currentUser))try{const k=Nt(xt,"challenges",d);await dl(k,{drawOffer:{offeredBy:ct.currentUser.uid,offeredAt:Date.now()}}),be.success("Oferta de tablas enviada")}catch{be.error("Error al ofrecer tablas")}},S=async()=>{if(!(!d||!ct.currentUser))try{const k=Nt(xt,"challenges",d);await dl(k,{status:"completed",winner:i==="white"?"black":"white",result:i==="white"?"0-1":"1-0",endReason:"resignation"}),be.success("Has abandonado la partida")}catch{be.error("Error al abandonar la partida")}},M=async(k,ve)=>{if(d)try{const Ie=Nt(xt,"challenges",d);await dl(Ie,{[`timeLeft.${k}`]:ve})}catch(Ie){console.error("Error al actualizar el tiempo:",Ie)}},q=async k=>{if(d)try{const ve=Nt(xt,"challenges",d);await dl(ve,{status:"completed",winner:k,result:k==="white"?"1-0":"0-1",endReason:"timeout"})}catch{be.error("Error al finalizar la partida por tiempo")}};return y.jsxs("div",{className:"challenge-container",children:[y.jsx(ka,{}),y.jsx("div",{className:"challenge-content container-fluid pt-5",children:y.jsxs("div",{className:"row",children:[y.jsxs("div",{className:"col-12 col-lg-8",children:[y.jsx("div",{className:"player-box black mb-3",children:y.jsxs("div",{className:"row align-items-center w-100",children:[y.jsx("div",{className:"col-auto",children:y.jsx("div",{className:"player-avatar",children:y.jsx("i",{className:"fas fa-user"})})}),y.jsx("div",{className:"col",children:y.jsxs("div",{className:"player-info",children:[y.jsx("span",{className:"player-name text-white",children:l.players.blackUsername||"Esperando..."}),y.jsxs("span",{className:"player-rating",children:[y.jsx("i",{className:"fas fa-star me-1"}),"1500"]})]})}),y.jsx("div",{className:"col-auto",children:y.jsx(tp,{timeInMinutes:((W=l.challenge)==null?void 0:W.config.timeControl.time)||0,increment:((P=l.challenge)==null?void 0:P.config.timeControl.increment)||0,isActive:m&&t.turn()==="b",color:"black",onTimeout:async()=>await q("white"),onTimeUpdate:k=>M("black",k),remainingTime:l.timeBlack})})]})}),y.jsx("div",{className:"board-wrapper mb-3",children:y.jsx("div",{className:"board-container",children:y.jsx(qx,{position:t.fen(),onPieceDrop:A,boardOrientation:i==="black"?"black":"white",customBoardStyle:{borderRadius:"4px",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.3)"}})})}),y.jsx("div",{className:"player-box white mb-3",children:y.jsxs("div",{className:"row align-items-center w-100",children:[y.jsx("div",{className:"col-auto order-3",children:y.jsx("div",{className:"player-avatar",children:y.jsx("i",{className:"fas fa-user"})})}),y.jsx("div",{className:"col order-2",children:y.jsxs("div",{className:"player-info text-end",children:[y.jsx("span",{className:"player-name text-white",children:l.players.whiteUsername||"Esperando..."}),y.jsxs("span",{className:"player-rating",children:[y.jsx("i",{className:"fas fa-star me-1"}),"1500"]})]})}),y.jsx("div",{className:"col-auto order-1",children:y.jsx(tp,{timeInMinutes:((C=l.challenge)==null?void 0:C.config.timeControl.time)||0,increment:((R=l.challenge)==null?void 0:R.config.timeControl.increment)||0,isActive:m&&t.turn()==="w",color:"white",onTimeout:async()=>await q("black"),onTimeUpdate:k=>M("white",k),remainingTime:l.timeWhite})})]})}),y.jsx("div",{className:"game-actions",children:y.jsxs("div",{className:"row g-2",children:[y.jsx("div",{className:"col",children:y.jsxs("button",{className:"btn btn-secondary w-100",onClick:T,disabled:!n,children:[y.jsx("i",{className:"fas fa-handshake me-2"}),"Tablas"]})}),y.jsx("div",{className:"col",children:y.jsxs("button",{className:"btn btn-danger w-100",onClick:S,children:[y.jsx("i",{className:"fas fa-flag me-2"}),"Abandonar"]})})]})})]}),y.jsx("div",{className:"col-12 col-lg-4",children:y.jsxs("div",{className:"card bg-dark text-light",children:[y.jsx("div",{className:"card-header",children:y.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[y.jsxs("div",{className:"time-control",children:[y.jsx("i",{className:"fas fa-clock me-2"}),y.jsx("span",{children:`${(O=l.challenge)==null?void 0:O.config.timeControl.time}+${(L=l.challenge)==null?void 0:L.config.timeControl.increment}`})]}),y.jsx("div",{className:"game-type",children:(V=l.challenge)!=null&&V.config.rated?y.jsx("i",{className:"fas fa-trophy",title:"Partida clasificatoria"}):y.jsx("i",{className:"fas fa-handshake",title:"Partida amistosa"})})]})}),y.jsx("div",{className:"card-body",children:y.jsx("div",{className:"moves-history"})})]})})]})})]})},T9=()=>{const t=Na(),e=Oa(),{uid:n,email:r,photoURL:i}=e.state||{},[s,o]=N.useState(""),a=async h=>{if(!/^[a-zA-Z0-9_]{3,15}$/.test(h))return!1;const d=Nt(xt,"usernames",h.toLowerCase());return!(await uo(d)).exists()},l=async h=>{h.preventDefault();try{if(!await a(s)){be.error("Nombre de usuario no vlido o ya est en uso");return}await Xf(Nt(xt,"usernames",s.toLowerCase()),{uid:n}),await Xf(Nt(xt,"users",n),{username:s,email:r,createdAt:new Date,rating:1200,photoURL:i||null}),ct.currentUser&&await jb(ct.currentUser,{displayName:s}),be.success("Perfil completado!"),t("/lobby")}catch(d){console.error("Error al guardar el perfil:",d),be.error("Error al guardar el perfil")}};return y.jsxs("div",{className:"page-container",children:[y.jsx(ka,{}),y.jsx("div",{className:"auth-container",children:y.jsxs("div",{className:"auth-card",children:[y.jsx("h2",{children:"Completa tu perfil"}),y.jsx("p",{className:"auth-subtitle",children:"Solo necesitamos un nombre de usuario para continuar"}),y.jsxs("form",{onSubmit:l,children:[y.jsx("div",{className:"form-group",children:y.jsxs("div",{className:"input-icon",children:[y.jsx("i",{className:"fas fa-user"}),y.jsx("input",{type:"text",placeholder:"Nombre de usuario",value:s,onChange:h=>o(h.target.value),required:!0,minLength:3,maxLength:15,pattern:"^[a-zA-Z0-9_]+$",title:"El nombre de usuario debe tener entre 3 y 15 caracteres y solo puede contener letras, nmeros y guiones bajos"})]})}),y.jsx("div",{className:"form-info",children:y.jsxs("p",{children:["Email: ",r]})}),y.jsx("button",{type:"submit",className:"btn-continue",children:"Completar perfil"})]})]})})]})},xd=({children:t})=>{const[e,n]=N.useState("loading");return N.useEffect(()=>{const r=Fb(ct,i=>{n(i?"authenticated":"unauthenticated")});return()=>r()},[]),e==="loading"?y.jsx("div",{children:"Cargando..."}):e==="unauthenticated"?y.jsx(JS,{to:"/login",replace:!0}):y.jsx(y.Fragment,{children:t})};function I9(){return y.jsx(N6,{children:y.jsx($O,{children:y.jsx("div",{className:"app-container",children:y.jsxs(NO,{children:[y.jsx(Tn,{index:!0,element:y.jsx(ST,{})}),y.jsx(Tn,{path:"/",element:y.jsx(ST,{})}),y.jsx(Tn,{path:"/login",element:y.jsx(v9,{})}),y.jsx(Tn,{path:"/register",element:y.jsx(y9,{})}),y.jsx(Tn,{path:"/forgot-password",element:y.jsx(_9,{})}),y.jsx(Tn,{path:"/lobby",element:y.jsx(xd,{children:y.jsx(w9,{})})}),y.jsx(Tn,{path:"/challenge/:challengeId",element:y.jsx(xd,{children:y.jsx(E9,{})})}),y.jsxs(Tn,{path:"/play",children:[y.jsx(Tn,{path:"computer",element:y.jsx(hc,{})}),y.jsx(Tn,{path:"online",element:y.jsx(xd,{children:y.jsx(hc,{})})}),y.jsx(Tn,{path:"friend",element:y.jsx(xd,{children:y.jsx(hc,{})})}),y.jsx(Tn,{path:"puzzle",element:y.jsx(hc,{isPuzzle:!0})})]}),y.jsx(Tn,{path:"/complete-profile",element:y.jsx(T9,{})}),y.jsx(Tn,{path:"*",element:y.jsx(JS,{to:"/",replace:!0})})]})})})})}console.log("Iniciando aplicacin");const Qx=document.getElementById("root");console.log("Elemento root encontrado:",Qx);zS(Qx).render(y.jsx(N.StrictMode,{children:y.jsx(I9,{})}));
